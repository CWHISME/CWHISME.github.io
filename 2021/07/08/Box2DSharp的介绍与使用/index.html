<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="CWHISME" href="https://wangjiaying.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="CWHISME" href="https://wangjiaying.top/atom.xml"><link rel="alternate" type="application/json" title="CWHISME" href="https://wangjiaying.top/feed.json"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Unity3D,物理"><link rel="canonical" href="https://wangjiaying.top/2021/07/08/Box2DSharp%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8/"><title>Box2DSharp 的介绍与使用 - 其它 - Unity3D | Jiaying's Note = CWHISME = 人不能没有梦想，也要有足够的敬畏</title><meta name="generator" content="Hexo 5.4.2"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Box2DSharp 的介绍与使用</h1><div class="meta"><span class="item" title="创建时间：2021-07-08 16:48:34"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-07-08T16:48:34+08:00">2021-07-08</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>5.5k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>5 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Jiaying's Note</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="/images/coverimages/large/b809ff629a1d90e78bdb611156b6d413_2_2_art.webp"></li><li class="item" data-background-image="/images/coverimages/large/107054238_p0.webp"></li><li class="item" data-background-image="/images/coverimages/large/deef1a0cly8gy0wt2eo0lj21hc0u0qb4.webp"></li><li class="item" data-background-image="/images/coverimages/large/102966884_p0.webp"></li><li class="item" data-background-image="/images/coverimages/large/acg19.webp"></li><li class="item" data-background-image="/images/coverimages/large/87348116_p0.webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Unity3D/" itemprop="item" rel="index" title="分类于 Unity3D"><span itemprop="name">Unity3D</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Unity3D/%E5%85%B6%E5%AE%83/" itemprop="item" rel="index" title="分类于 其它"><span itemprop="name">其它</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://wangjiaying.top/2021/07/08/Box2DSharp%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/../img/avator"><meta itemprop="name" content="WangJiaYing"><meta itemprop="description" content="人不能没有梦想，也要有足够的敬畏, 己所不欲，勿施于人"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="CWHISME"></span><div class="body md" itemprop="articleBody"><h2 id="前言"><a class="anchor" href="#前言">#</a> 前言</h2><p>上文 <a href="/2021/07/07/%E6%88%98%E6%96%97%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">关于手游战斗系统</a> 提到了作为一个独立的战斗系统，前后端可能都是需要运行的，因此物理系统自然不能使用前端引擎自带的，本文介绍了一下 Box2DSharp —— 一个 Box2D 的 C# 版本。</p><h2 id="简介"><a class="anchor" href="#简介">#</a> 简介</h2><p>在 Box2D 中，一个 World 代表一个物理世界。</p><p>其中，一个完整物体，分为 Body、Shape、Fixture</p><ul><li>Body：代表一个对象</li><li>Shape：形状</li><li>Fixture：负责将形状 Shape 与对象 Body 连接</li></ul><p>一个 World 需要实际『动』起来，就需要调用其 Step 进行更新，Step 方法接收三个参数，分别为：</p><ul><li>timeStep：物理更新间隔，类似于 Unity 的 Time.deltaTime</li><li>velocityIterations：速度迭代解算值</li><li>positionIterations：位置迭代解算值</li></ul><p><span class="exturl" data-url="aHR0cHM6Ly9ib3gyZC5vcmcvZG9jdW1lbnRhdGlvbi9tZF9fZF8xX19naXRfaHViX2JveDJkX2RvY3NfaGVsbG8uaHRtbCNhdXRvdG9jX21kMjE=">参考 - Simulating the World</span></p><blockquote><p>The suggested iteration count for Box2D is 8 for velocity and 3 for position. You can tune this number to your liking, just keep in mind that this has a trade-off between performance and accuracy. Using fewer iterations increases performance but accuracy suffers. Likewise, using more iterations decreases performance but improves the quality of your simulation. For this simple example, we don't need much iteration. Here are our chosen iteration counts.</p></blockquote><p>官方推荐 velocityIterations 为 8，positionIterations 为 3，更小的值会减少模拟精度，但有更好的性能，反之亦然。这个值可以取决于使用者对精度与性能的需求，进行调整。</p><h3 id="基本使用"><a class="anchor" href="#基本使用">#</a> 基本使用</h3><p>一个最基础的动态对象创建如下：</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">World</span> _world<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">Body</span> _body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    _world <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">World</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Numerics<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    _body <span class="token operator">=</span> _world<span class="token punctuation">.</span><span class="token function">CreateBody</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">BodyDef</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        Position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Numerics<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        BodyType <span class="token operator">=</span> BodyType<span class="token punctuation">.</span>DynamicBody<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token class-name"><span class="token keyword">var</span></span> shape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PolygonShape</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    shape<span class="token punctuation">.</span><span class="token function">SetAsBox</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    _body<span class="token punctuation">.</span><span class="token function">CreateFixture</span><span class="token punctuation">(</span>shape<span class="token punctuation">,</span> <span class="token number">0.1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    _world<span class="token punctuation">.</span><span class="token function">Step</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">60f</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>_body<span class="token punctuation">.</span><span class="token function">GetPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2021/2021-07-08/1.png" alt="效果"></p><p>上述代码在 (0,100) 处创建了一个 1x1 大小的 Box 对象，质量 0.1，运行时将会以 -10 的重力加速度往下掉，由于此处我们并未创建地板，因此对象会一直往下掉，表现在打印的字符串上，值就会越来越小。</p><p>此外，这里在更新线程中，并未将 时间与执行间隔 对应起来，相当于 white 类型的一直更新。</p><p>所以可以将实际时间间隔加进去：</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> FrameTime <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">60f</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> FrameTimeMis <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>FrameTime <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> VelocityIterations <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> PositionIterations <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">World</span> _world<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">Body</span> _body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">double</span></span> _time<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    _world <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">World</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Numerics<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    _body <span class="token operator">=</span> _world<span class="token punctuation">.</span><span class="token function">CreateBody</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">BodyDef</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        Position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Numerics<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        BodyType <span class="token operator">=</span> BodyType<span class="token punctuation">.</span>DynamicBody<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token class-name"><span class="token keyword">var</span></span> shape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PolygonShape</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    shape<span class="token punctuation">.</span><span class="token function">SetAsBox</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    _body<span class="token punctuation">.</span><span class="token function">CreateFixture</span><span class="token punctuation">(</span>shape<span class="token punctuation">,</span> <span class="token number">0.1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    _time <span class="token operator">+=</span> FrameTime<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    _world<span class="token punctuation">.</span><span class="token function">Step</span><span class="token punctuation">(</span>FrameTime<span class="token punctuation">,</span> VelocityIterations<span class="token punctuation">,</span> PositionIterations<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token expression language-csharp">_time</span><span class="token punctuation">&#125;</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token expression language-csharp">_body<span class="token punctuation">.</span><span class="token function">GetPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>FrameTimeMis<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2021/2021-07-08/2.gif" alt=""></p><p>如此，运行频率就跟现实的实际的时间挂钩了。</p><h3 id="带属性物理对象"><a class="anchor" href="#带属性物理对象">#</a> 带属性物理对象</h3><p>例如，带 弹性 物体。</p><p>在 Box2D 中，物体属性设置位于创建 Fixture 传参 FixtureDef 中：</p><ul><li>Restitution：弹性</li><li>Friction：摩擦力</li></ul><p>这两个值都是 0~1 之间。另外还有 Density (密度)、IsSensor (类似 Unity 的 IsTrigger)、RestitutionThreshold (弹性阀值，超出阀值才会反弹) 等。</p><p>为了测试这一点，接下来，可以创建一个地板，并对上述创建的对象增加一点弹性。</p><p>为了方便起见，我将创建物体封装为了一个 单独方法：</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> FrameTime <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">60f</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> FrameTimeMis <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>FrameTime <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> VelocityIterations <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> PositionIterations <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">World</span> _world<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">Body</span> _body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">Body</span> _grounder<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">double</span></span> _time<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    _world <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">World</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    _body <span class="token operator">=</span> <span class="token function">CreateBody</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> BodyType<span class="token punctuation">.</span>DynamicBody<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    _grounder <span class="token operator">=</span> <span class="token function">CreateBody</span><span class="token punctuation">(</span>Vector2<span class="token punctuation">.</span>Zero<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> BodyType<span class="token punctuation">.</span>StaticBody<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    _time <span class="token operator">+=</span> FrameTime<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    _world<span class="token punctuation">.</span><span class="token function">Step</span><span class="token punctuation">(</span>FrameTime<span class="token punctuation">,</span> VelocityIterations<span class="token punctuation">,</span> PositionIterations<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token expression language-csharp">_time</span><span class="token punctuation">&#125;</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token expression language-csharp">_body<span class="token punctuation">.</span><span class="token function">GetPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>FrameTimeMis<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name">Body</span> <span class="token function">CreateBody</span><span class="token punctuation">(</span><span class="token class-name">Vector2</span> pos<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">float</span></span> sizeX<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">float</span></span> sizeY<span class="token punctuation">,</span> <span class="token class-name">BodyType</span> bodyType<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token class-name">Body</span> body <span class="token operator">=</span> _world<span class="token punctuation">.</span><span class="token function">CreateBody</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">BodyDef</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        Position <span class="token operator">=</span> pos<span class="token punctuation">,</span><span class="token comment">//new Vector2(0, 100),</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        BodyType <span class="token operator">=</span> bodyType<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token class-name"><span class="token keyword">var</span></span> shape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PolygonShape</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    shape<span class="token punctuation">.</span><span class="token function">SetAsBox</span><span class="token punctuation">(</span>sizeX<span class="token punctuation">,</span> sizeY<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    body<span class="token punctuation">.</span><span class="token function">CreateFixture</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">FixtureDef</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        Shape <span class="token operator">=</span> shape<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        Density <span class="token operator">=</span> <span class="token number">1f</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        Restitution <span class="token operator">=</span> <span class="token number">0.5f</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">return</span> body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2021/2021-07-08/3.png" alt=""></p><p>可以看到，该物体在与地面接触之后，被反弹上去，而后又掉下来。</p><p>另外的属性例如：根据物体掉落速度到地面的最大速度 (12.5)，若将 RestitutionThreshold (弹性阀值) 修改为 13，则该物体就会出现不再反弹的情况：</p><p><img data-src="/blogimages/2021/2021-07-08/4.png" alt=""></p><h2 id="在unity3d中使用"><a class="anchor" href="#在unity3d中使用">#</a> 在 Unity3D 中使用</h2><p>上述只是在控制台程序中进行了一下简单的使用，因为没有可视化，因此也只能看看数值而已，作为物理模拟，若想实际看到效果，就得将其与渲染引擎 链接 起来。</p><p>这里直接选择 Unity3D</p><h3 id="准备"><a class="anchor" href="#准备">#</a> 准备</h3><p>因为不是直接使用 Box2D 原始 C 语言版本，作为 C# 的库，直接将上述代码生成类库，编译成 DLL 放进引擎即可。</p><p>这里个人在项目中创建了 Plugins 目录，将编译好的 DLL 放入。</p><hr><p>中间稍微还是有些坑的：</p><ul><li><p>首先是平台问题，上面测试时，个人直接创建的 DotNetCore 控制台项目，Box2DSharp 放进来没问题，可以直接使用。但是 Unity3D 不支持 DotNetCore 库，因此创建的库项目必须为 .Net 平台。而 Box2DSharp 中使用到的一些引用，例如 System.Buffers、System.Memery 就必须额外安装模块了：<br><img data-src="/blogimages/2021/2021-07-08/5.png" alt=""></p></li><li><p>此外 Box2DSharp 使用过指针代码，因此必须开启『不安全代码选项』，不管是 DLL 项目还是 Unity 设置都是如此。<br><img data-src="/blogimages/2021/2021-07-08/6.png" alt=""><br>其中，不安全代码可能会与 Unity 本身产生冲突，导致编译失败且无法继续进行：<br><img data-src="/blogimages/2021/2021-07-08/7.png" alt=""><br>个人升级了一下 Collections 版本至 0.14.0 解决了这个问题：<br><img data-src="/blogimages/2021/2021-07-08/8.png" alt=""></p></li></ul><hr><p>新版 Unity 若出现报错，无法加载 pdb 的调试信息，需要修改一下生成设置：</p><p><img data-src="/blogimages/2021/2021-07-08/9.png" alt=""></p><h3 id="测试"><a class="anchor" href="#测试">#</a> 测试</h3><p>然后创建了一个普通的 Box2DTest.cs 测试脚本：</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">BattleWorld</span> _battle<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token class-name">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>CancellationTokenSource</span> _token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>CancellationTokenSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>BodyObject<span class="token punctuation">></span></span> _bodyList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>BodyObject<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    _battle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BattleWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    _battle<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    Task<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>PhysicsWorldUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">UpdatePositon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>_battle<span class="token punctuation">.</span>IsWorldLocked<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        _bodyList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">BodyObject</span><span class="token punctuation">(</span>_battle<span class="token punctuation">.</span><span class="token function">CreateBody</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Numerics<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span>Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">,</span> BodyType<span class="token punctuation">.</span>DynamicBody<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    _token<span class="token punctuation">.</span><span class="token function">Cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name">IEnumerator</span> <span class="token function">UpdatePositon</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> item <span class="token keyword">in</span> _bodyList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            item<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PhysicsWorldUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>_token<span class="token punctuation">.</span>IsCancellationRequested<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>            _battle<span class="token punctuation">.</span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>            <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        _battle<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">BodyObject</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">Body</span> _body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">GameObject</span> _obj<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token keyword">public</span> <span class="token function">BodyObject</span><span class="token punctuation">(</span><span class="token class-name">Body</span> body<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>        _body <span class="token operator">=</span> body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>        _obj <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">CreatePrimitive</span><span class="token punctuation">(</span>PrimitiveType<span class="token punctuation">.</span>Cube<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        _obj<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>_body<span class="token punctuation">.</span><span class="token function">GetPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>X<span class="token punctuation">,</span> _body<span class="token punctuation">.</span><span class="token function">GetPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2021/2021-07-08/10.gif" alt=""></p><p>如此，就是一个最简单的链接使用了。</p><h2 id="结语"><a class="anchor" href="#结语">#</a> 结语</h2><p>本文简单介绍了一下 Box2D 结构与使用流程，并将其挪到 Unity 中进行了一个可视化观察。</p><p>当然，后续实际使用的话，代码自然还需要进行更好的设计，例如设计中介者将物理系统的相关属性适配出来，而非直接 Unity 脚本就直接读取物理系统内属性，以及优化表现层与物理层物体的更新方式等。</p><p>不过本文目的应该是达到了：即个人对 Box2D 使用方式及其概念的熟悉，为后续做帧同步战斗做个前置。</p><p>虽然这个物理引擎也不是定点数物理引擎，不过胜在简单，且定点数必然会导致性能下降，个人就在考虑先使用普通物理引擎进行试验，有情况的话后续再看需不需要做改造。<br>另外 Box2D 作为 2D 物理引擎也有所局限性，后续或许还会研究下 3D 类型的物理引擎。</p><div class="tags"><a href="/tags/Unity3D/" rel="tag"><i class="ic i-tag"></i> Unity3D</a> <a href="/tags/%E7%89%A9%E7%90%86/" rel="tag"><i class="ic i-tag"></i> 物理</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-12-22 11:29:48" itemprop="dateModified" datetime="2022-12-22T11:29:48+08:00">2022-12-22</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>WangJiaYing <i class="ic i-at"><em>@</em></i>CWHISME</li><li class="link"><strong>本文链接：</strong> <a href="https://wangjiaying.top/2021/07/08/Box2DSharp%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8/" title="Box2DSharp 的介绍与使用">https://wangjiaying.top/2021/07/08/Box2DSharp的介绍与使用/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/07/07/%E6%88%98%E6%96%97%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="prev" data-background-image="&#x2F;images&#x2F;coverimages&#x2F;large&#x2F;9bd9b167gy1g4lhiavgk7j21hc0xcdsm.webp" title="关于手游战斗系统"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 理论研究</span><h3>关于手游战斗系统</h3></a></div><div class="item right"><a href="/2021/07/15/%E4%BD%BF%E7%94%A8VS2019%E8%B0%83%E8%AF%95Unity2020%E4%B8%ADDLL%E9%97%AE%E9%A2%98/" itemprop="url" rel="next" data-background-image="&#x2F;images&#x2F;coverimages&#x2F;large&#x2F;42947917_p0.webp" title="使用VS2019调试Unity2020中DLL的问题"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 其它</span><h3>使用VS2019调试Unity2020中DLL的问题</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">2.1.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E5%B1%9E%E6%80%A7%E7%89%A9%E7%90%86%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.2.</span> <span class="toc-text">带属性物理对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8unity3d%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">在 Unity3D 中使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-number">3.1.</span> <span class="toc-text">准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">3.2.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">4.</span> <span class="toc-text">结语</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2015/12/09/Unity3D-%E9%80%9A%E8%BF%87%E5%8A%A8%E7%94%BB%E4%BA%8B%E4%BB%B6%E5%AE%9E%E7%8E%B0%E6%B8%B8%E6%88%8F%E8%84%9A%E5%8D%B0/" rel="bookmark" title="Unity3D 通过动画事件实现游戏脚印">Unity3D 通过动画事件实现游戏脚印</a></li><li><a href="/2015/12/29/%E5%B5%8C%E5%A5%97Prefab%E7%9A%84Editor%E5%8A%9F%E8%83%BD/" rel="bookmark" title="嵌套Prefab的Editor功能">嵌套Prefab的Editor功能</a></li><li><a href="/2016/04/19/%E5%9C%A8Unity%E4%B8%AD%E5%8A%A8%E6%80%81%E5%88%9B%E5%BB%BAMesh/" rel="bookmark" title="在Unity中动态创建Mesh">在Unity中动态创建Mesh</a></li><li><a href="/2016/04/23/%E5%9C%A8Unity%E4%B8%AD%E5%8A%A8%E6%80%81%E6%94%B9%E5%8F%98Mesh/" rel="bookmark" title="在Unity中动态改变Mesh">在Unity中动态改变Mesh</a></li><li><a href="/2016/07/01/%E6%A0%B9%E6%8D%AE%E5%9C%B0%E5%BD%A2%E8%B4%B4%E5%9B%BE%E5%AE%9E%E7%8E%B0%E8%84%9A%E5%8D%B0%E5%8F%8A%E7%9B%B8%E5%BA%94%E6%95%88%E6%9E%9C/" rel="bookmark" title="根据所在地形贴图实现脚印等效果">根据所在地形贴图实现脚印等效果</a></li><li><a href="/2016/08/13/%E4%BD%9C%E5%93%81-CryStoryEditor/" rel="bookmark" title="CryStoryEditor">CryStoryEditor</a></li><li><a href="/2016/10/29/%E4%BD%9C%E5%93%81-CryDialogSystem/" rel="bookmark" title="CryDialogSystem与设计原因">CryDialogSystem与设计原因</a></li><li><a href="/2016/11/17/Unity3D%E8%B5%84%E6%BA%90%E5%BC%95%E7%94%A8%E6%9F%A5%E8%AF%A2%E5%B7%A5%E5%85%B7/" rel="bookmark" title="Unity3D资源引用查询工具">Unity3D资源引用查询工具</a></li><li><a href="/2017/02/14/%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%B1%BB%E5%9E%8B%E7%9A%84%E4%BD%9C%E5%BC%8A%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/" rel="bookmark" title="【工具】控制台类型的作弊系统实现">【工具】控制台类型的作弊系统实现</a></li><li><a href="/2017/03/09/2017-3-9-Unity-Optimization-Summary/" rel="bookmark" title="Unity3D性能优化总结">Unity3D性能优化总结</a></li><li><a href="/2017/05/07/2017-5-7-Unity-use-othographic-camera-map/" rel="bookmark" title="Unity3D以正交相机截取作大地图">Unity3D以正交相机截取作大地图</a></li><li class="active"><a href="/2021/07/08/Box2DSharp%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8/" rel="bookmark" title="Box2DSharp的介绍与使用">Box2DSharp的介绍与使用</a></li><li><a href="/2021/07/15/%E4%BD%BF%E7%94%A8VS2019%E8%B0%83%E8%AF%95Unity2020%E4%B8%ADDLL%E9%97%AE%E9%A2%98/" rel="bookmark" title="使用VS2019调试Unity2020中DLL的问题">使用VS2019调试Unity2020中DLL的问题</a></li><li><a href="/2021/07/23/%E3%80%8E%E9%94%81%E3%80%8F%E5%B8%A7%E5%90%8C%E6%AD%A5%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/" rel="bookmark" title="『锁』帧同步的简单实现">『锁』帧同步的简单实现</a></li><li><a href="/2021/07/28/%E4%BD%BF%E7%94%A8MagicCloth%E5%81%9A%E8%A1%A3%E7%89%A9%E6%88%96%E5%A4%B4%E5%8F%91%E7%89%A9%E7%90%86%E6%95%88%E6%9E%9C/" rel="bookmark" title="使用MagicCloth做衣物或头发物理效果">使用MagicCloth做衣物或头发物理效果</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="WangJiaYing" data-src="/images/../img/avator"><p class="name" itemprop="name">WangJiaYing</p><div class="description" itemprop="description">己所不欲，勿施于人</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">100</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">21</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">28</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2N3aGlzbWU=" title="https:&#x2F;&#x2F;github.com&#x2F;cwhisme"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9jd2hpc21lLTMzL3Bvc3Rz" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;cwhisme-33&#x2F;posts"><i class="ic i-zhihu"></i></span> <span class="exturl item email" data-url="bWFpbHRvOmN3aGlzbWVAMTI2LmNvbQ==" title="mailto:cwhisme@126.com"><i class="ic i-envelope"></i></span> <a href="/atom.xml" title="&#x2F;atom.xml" class="item feedback"><i class="ic i-heart"></i></a></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/bookmark/" rel="section"><i class="ic i-tag"></i>书签</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-magic"></i>链接</a><ul class="submenu"><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友達</a></li></ul></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/07/07/%E6%88%98%E6%96%97%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/07/15/%E4%BD%BF%E7%94%A8VS2019%E8%B0%83%E8%AF%95Unity2020%E4%B8%ADDLL%E9%97%AE%E9%A2%98/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8D%9A%E5%AE%A2/" title="分类于 博客">博客</a></div><span><a href="/2016/04/16/Hexo%E9%85%8D%E7%BD%AE/" title="Hexo配置">Hexo配置</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%99%9A%E5%B9%BB%E5%BC%95%E6%93%8E/" title="分类于 虚幻引擎">虚幻引擎</a></div><span><a href="/2017/04/26/2017-4-26-UMG-Runtime-Instantiate/" title="C++对UMG的控件实例化操作">C++对UMG的控件实例化操作</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Unity3D/" title="分类于 Unity3D">Unity3D</a> <i class="ic i-angle-right"></i> <a href="/categories/Unity3D/%E7%83%AD%E6%9B%B4/" title="分类于 热更">热更</a></div><span><a href="/2022/06/14/%E6%96%B0%E5%87%BA%E7%9A%84Huatuo%E7%83%AD%E6%9B%B4%E7%9A%84%E4%B8%80%E7%82%B9%E5%B0%9D%E8%AF%95/" title="新出的Huatuo热更的一点尝试">新出的Huatuo热更的一点尝试</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment count_3"></ul></div></div><div class="status"><div class="copyright">&copy; 2015 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">WangJiaYing @ Jiaying's Note</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">516k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">7:49</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/07/08/Box2DSharp的介绍与使用/",favicon:{show:"（●´3｀●）",hide:"(´Д｀)"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script><script src="https://cdn.staticfile.org/pjax/0.2.8/pjax.min.js"></script><script src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3.6.2/dist/fetch.umd.min.js"></script><script src="https://cdn.staticfile.org/animejs/3.2.1/anime.min.js"></script><script src="https://cdn.staticfile.org/algoliasearch/4.17.0/algoliasearch-lite.umd.js"></script><script src="https://cdn.staticfile.org/instantsearch.js/4.54.1/instantsearch.production.min.js"></script><script src="https://cdn.staticfile.org/lozad.js/1.16.0/lozad.min.js"></script><script src="https://cdn.staticfile.org/quicklink/2.3.0/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script src="/js/DateTimeAfeterCalc.js"></script><script src="https://fastly.jsdelivr.net/gh/CWHISME/live2d_api_models@master/autoload.js"></script><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?62952472c154f9131a14a4ab57bfefec";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></body></html>