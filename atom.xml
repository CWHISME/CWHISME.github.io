<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>WangJiaYing</title>
  
  <subtitle>äººä¸èƒ½æ²¡æœ‰æ¢¦æƒ³ï¼Œä¹Ÿè¦æœ‰è¶³å¤Ÿçš„æ•¬ç•</subtitle>
  <link href="https://cwhisme.github.io/atom.xml" rel="self"/>
  
  <link href="https://cwhisme.github.io/"/>
  <updated>2022-12-23T12:17:21.192Z</updated>
  <id>https://cwhisme.github.io/</id>
  
  <author>
    <name>CWHISME</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¿®å¤ Shoka ä¸»é¢˜çš„ä¸€ç‚¹å°é—®é¢˜</title>
    <link href="https://cwhisme.github.io/2022/12/23/%E4%BF%AE%E5%A4%8DShoka%E4%B8%BB%E9%A2%98%E7%9A%84%E4%B8%80%E7%82%B9%E5%B0%8F%E9%97%AE%E9%A2%98/"/>
    <id>https://cwhisme.github.io/2022/12/23/%E4%BF%AE%E5%A4%8DShoka%E4%B8%BB%E9%A2%98%E7%9A%84%E4%B8%80%E7%82%B9%E5%B0%8F%E9%97%AE%E9%A2%98/</id>
    <published>2022-12-23T02:40:28.000Z</published>
    <updated>2022-12-23T12:17:21.192Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h1><p>åç»­åˆå‘ç°ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å½“æ•´ä¸ªé¡µé¢å†…å®¹é«˜åº¦ä¸è¶³ï¼Œå¾€ä¸‹æ‹–åŠ¨æ—¶é¡µé¢åº•éƒ¨ä¼šé—ªçƒå›å¼¹</li><li>é¡µé¢ç™¾åˆ†æ¯”è¿›åº¦æ˜¾ç¤ºä¸å¤§å‡†ç¡®</li></ol><h1 id="æ ‡ç­¾é¡µå›å¼¹é—®é¢˜"><a class="anchor" href="#æ ‡ç­¾é¡µå›å¼¹é—®é¢˜">#</a> æ ‡ç­¾é¡µå›å¼¹é—®é¢˜</h1><p>å›å®¶é¢„è§ˆäº†ä¸‹ï¼Œå‘ç°é¡µé¢å†…å®¹é«˜åº¦ä¸è¶³ä¼šæœ‰æ˜¾ç¤ºé—®é¢˜ï¼Œä¾‹å¦‚æ ‡ç­¾é¡µä¼šå˜å¾—æ¯”è¾ƒé¬¼ç•œï¼šé¡µé¢æ— æ³•æ‹‰åˆ°åº•ï¼Œåº•éƒ¨çš„è¯„è®ºåŠç½‘ç«™åº•éƒ¨ä¸€é—ªä¸€é—ªçš„ï¼š</p><p><img data-src="/blogimages/2022/2022-12-17/GIF2022-12-1921-01-23.gif" alt="" /></p><p>è°ƒè¯•äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†  <code>global.js</code>  ä¸­çš„  <code>scrollHandle</code>  æ–¹æ³•ä¸­è®¡ç®—å¯¼è‡´çš„ã€‚</p><p>å®ƒä¼šä¸º  <code>sidebar</code>  å¢åŠ ä¸€ä¸ª  <code>affix</code>  çš„ classï¼Œå­˜åœ¨æ—¶ä¼šæ˜¾ç¤ºé¡µé¢ä¸‹æ–¹çš„å…ƒç´ ï¼Œå¦åˆ™å°±ä¼šéšè—ã€‚</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sidebar<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>affix<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>ä¸çŸ¥é“ä¸ºå•¥åœ¨æˆ‘è¿™åå¤æ¨ªè·³ï¼Œé€ æˆäº†è¿™ç§é—ªçƒçš„ç»“æœã€‚</p><p>å…¶å¯¹åº”ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>sideBar<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">'affix'</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>pageYOffset <span class="token operator">></span> headerHight <span class="token operator">&amp;&amp;</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetWidth <span class="token operator">></span> <span class="token number">991</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>çœ‹åˆ¤æ–­æ¡ä»¶ï¼Œç»“åˆå®é™…æƒ…å†µï¼Œå®½åº¦å› ç´ å¯ä»¥æ’é™¤ï¼šé‚£ä¹ˆå°±æ˜¯ææ€•å°±æ˜¯è¿™ä¸ªé«˜åº¦åˆ¤æ–­å‡ºäº†å•¥é—®é¢˜å§ï¼Ÿ</p><ul><li>window.pageYOffset = å½“å‰é¡µé¢ç›¸å¯¹äºçª—å£å‚ç›´æ–¹å‘æ»šåŠ¨çš„åƒç´ </li><li>headerHight=header é«˜åº¦ + waves é«˜åº¦ (å°±é‚£ä¸ªæ³¢çº¹ç‰¹æ•ˆé«˜åº¦)</li></ul><p>è¿™é‡Œçš„é€»è¾‘ä¼°è®¡æ˜¯æƒ³ï¼šå¦‚æœæ»šåŠ¨é«˜åº¦è¶…è¿‡æ•´ä¸ªé¡µé¢çš„å¤´éƒ¨ï¼Œé‚£å°±æ˜¾ç¤ºåº•éƒ¨åŒºåŸŸï¼Œå¦åˆ™éšè— (å®é™…ä¸Šå…ƒç´ åªæ˜¯çœ‹ä¸è§è€Œå·²ï¼Œä¸œè¥¿è¿˜æ˜¯åœ¨åŸåœ°çš„)ã€‚</p><p><s>æ‰€ä»¥ä¸çŸ¥é“è¿™ä¸ªå…·ä½“ç”¨æ¥å¤„ç†å•¥æƒ…å†µçš„ï¼Œä½†æ¯•ç«Ÿæˆ‘è¿™å‡ºé—®é¢˜äº†ï¼Œåªèƒ½å‡å°è¯¥å€¼ã€‚æ”¹æˆ  <code>window.pageYOffset &gt; headerHightInner</code>  å°±å¥½äº†ã€‚</s></p><p>è¿™æ ·æ”¹æ˜¯ä¸å¯¹çš„ï¼Œ <code>è¿‡äº†ä¸¤å¤©</code>  å‘ç°ä¸è¡Œï¼Œå•çº¯ä¿®æ”¹è¿™ä¸ªé«˜åº¦åˆ¤æ–­ï¼Œæ¢ä¸€ä¸ªåˆ†è¾¨ç‡åˆç‚¸äº†ã€‚</p><p>åˆç ”ç©¶äº†ä¸‹ï¼Œè§‰å¾—å®ƒä¸»è¦é—®é¢˜è¿˜æ˜¯  <code>window.pageYOffset &gt; headerHight</code>  è®¡ç®—é—®é¢˜ï¼Œè¿™é‡Œç›¸å½“äºåªåˆ¤æ–­äº†  <code>å½“å‰é¡µé¢æ»‘åŠ¨é«˜åº¦</code>  æ˜¯å¦å¤§äº  <code>æ ‡é¢˜å›¾åƒé«˜åº¦</code> ï¼Œä½†æ˜¯å¹¶æ²¡åˆ¤æ–­è¦æ˜¯æ•´ä¸ªæ–‡æ¡£åŒºåŸŸçš„é«˜åº¦éƒ½æ¯” æ ‡é¢˜å›¾åƒé«˜åº¦ ä½çš„æƒ…å†µã€‚è¿™æ · å½“å‰é¡µé¢æ»‘åŠ¨é«˜åº¦ å¯èƒ½å°±åˆ’ä¸è¿‡å»äº†ã€‚</p><ul><li>æ³¨ 1ï¼š <code>sideBar</code>  å…¶å®æ˜¯æˆ‘ä»¬æ˜¾ç¤ºçš„å¤´åƒé‚£ä¸ªç»„ä»¶ï¼Œä¸çŸ¥é“ä¸ºå•¥è¿˜ä¼šå½±å“åˆ°åº•éƒ¨åŒºåŸŸçš„æ˜¾ç¤ºï¼Œæœ‰ affix class åº•éƒ¨æ‰èƒ½æ˜¾ç¤ºï¼Œåˆ æ‰å°±ä¼šå¯¼è‡´éšè—ã€‚</li><li>æ³¨ 2ï¼š <code>document.body.offsetWidth &gt; 991</code>  ä»£è¡¨çš„æ˜¯ä¼šå¯¼è‡´æ’ç‰ˆåˆ‡æ¢ä¸ºæ‰‹æœºç±»å‹æ’ç‰ˆçš„æœ€ä½å®½åº¦ï¼Œåˆ‡æ¢ä¸ºæ‰‹æœºæ’ç‰ˆå  <code>sideBar affix class</code>  ä¹Ÿä¸äº§ç”Ÿå½±å“</li></ul><h1 id="é¡µé¢ç™¾åˆ†æ¯”è®¡ç®—ä¸ä¸€è‡´é—®é¢˜"><a class="anchor" href="#é¡µé¢ç™¾åˆ†æ¯”è®¡ç®—ä¸ä¸€è‡´é—®é¢˜">#</a> é¡µé¢ç™¾åˆ†æ¯”è®¡ç®—ä¸ä¸€è‡´é—®é¢˜</h1><p>åœ¨ä¿®æ”¹ä¸Šé¢æ ‡ç­¾é¡µé—®é¢˜æ—¶ï¼Œå‘ç°é¡µé¢çš„ ç™¾åˆ†æ¯” è¿›åº¦æ˜¾ç¤ºä¹Ÿä¸å¯¹åŠ² â€”â€” è·Ÿå®é™…é¡µé¢æ»‘åŠ¨è¿‡çš„ç™¾åˆ†æ¯”ä¸ä¸€è‡´ã€‚</p><p>æ„Ÿè§‰åŸæ¥çš„è®¡ç®—æ–¹å¼ï¼Œä»…è®¡ç®—ç™¾åˆ†æ¯”å°±ä¸å¤§å¯¹åŠ²ï¼š <code>å½“å‰æ»‘åŠ¨é«˜åº¦/å¯æ˜¾ç¤ºåŒºåŸŸé«˜åº¦</code></p><p>è€Œ  <code>å½“å‰æ»‘åŠ¨é«˜åº¦</code>  è‚¯å®šä¼šæ¯”  <code>å¯æ˜¾ç¤ºåŒºåŸŸé«˜åº¦</code>  æ›´å¤§çš„ï¼Œè¿™ç§è®¡ç®—æ–¹å¼å°±æ„Ÿè§‰æ¯”è¾ƒå¥‡æ€ªï¼Œç„¶ååœ¨å…¶å®ƒé¡µé¢è¯•äº†è¯•ï¼Œå¹¶ç‰¹æ„å»ä½œè€…çš„åšå®¢çœ‹äº†ä¸‹ï¼Œæ˜¾ç¤ºä¸Šéƒ½ä¸å¤§å¯¹çš„ä¸Šå·ã€‚</p><p>äºæ˜¯æŠŠç™¾åˆ†æ¯”è®¡ç®—å’Œæ˜¾ç¤ºä¸å¦åˆ¤æ–­éƒ½æ”¹äº†ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">scrollHandle</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">var</span> winHeight <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">var</span> docHeight <span class="token operator">=</span> <span class="token function">getDocHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token comment">// var contentVisibilityHeight = docHeight > winHeight ? docHeight - winHeight : document.body.scrollHeight - winHeight;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">var</span> contentVisibilityHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> winHeight<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">var</span> <span class="token constant">SHOW</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>pageYOffset <span class="token operator">></span> headerHightInner<span class="token operator">||</span>docHeight<span class="token operator">&lt;</span>headerHight<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">var</span> startScroll <span class="token operator">=</span> window<span class="token punctuation">.</span>pageYOffset <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">SHOW</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">changeMetaTheme</span><span class="token punctuation">(</span><span class="token string">'#FFF'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token function">changeMetaTheme</span><span class="token punctuation">(</span><span class="token string">'#222'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>  siteNav<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">'show'</span><span class="token punctuation">,</span> <span class="token constant">SHOW</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  toolBtn<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">'affix'</span><span class="token punctuation">,</span> startScroll<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  siteBrand<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">'affix'</span><span class="token punctuation">,</span> startScroll<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token comment">// å¦‚æœæ»šåŠ¨é«˜åº¦è¶…è¿‡æ•´ä¸ªé¡µé¢çš„å¤´éƒ¨ï¼Œé‚£å°±æ˜¾ç¤ºåº•éƒ¨åŒºåŸŸï¼Œå¦åˆ™éšè— (å®é™…ä¸Šå…ƒç´ åªæ˜¯çœ‹ä¸è§è€Œå·²ï¼Œä¸œè¥¿è¿˜æ˜¯åœ¨åŸåœ°çš„)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token comment">// sideBar.toggleClass('affix', window.pageYOffset > headerHight &amp;&amp; document.body.offsetWidth > 991);</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token comment">// æ‰€ä»¥ä¸æ¸…æ¥šå…·ä½“ç”¨æ¥å¤„ç†å•¥ï¼Œå•çº¯ window.pageYOffset > headerHight åˆ¤æ–­å¯èƒ½å¯¼è‡´åº•éƒ¨æœ€è¿‘è¯„è®ºé—ªçƒé—®é¢˜</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  sideBar<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">'affix'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>pageYOffset <span class="token operator">></span> headerHight <span class="token operator">||</span>docHeight<span class="token operator">&lt;</span>headerHight<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetWidth <span class="token operator">></span> <span class="token number">991</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> scrollAction<span class="token punctuation">.</span>y <span class="token operator">==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    scrollAction<span class="token punctuation">.</span>y <span class="token operator">=</span> window<span class="token punctuation">.</span>pageYOffset<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">//scrollAction.x = Container.scrollLeft;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token comment">//scrollAction.y = Container.scrollTop;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token comment">//var diffX = scrollAction.x - Container.scrollLeft;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  diffY <span class="token operator">=</span> scrollAction<span class="token punctuation">.</span>y <span class="token operator">-</span> window<span class="token punctuation">.</span>pageYOffset<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token comment">//if (diffX &lt; 0) &#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token comment">// Scroll right</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token comment">//&#125; else if (diffX > 0) &#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  <span class="token comment">// Scroll left</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token comment">//&#125; else</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>diffY <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token comment">// Scroll down</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    siteNav<span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'up'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    siteNav<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">'down'</span><span class="token punctuation">,</span> <span class="token constant">SHOW</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>diffY <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token comment">// Scroll up</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    siteNav<span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'down'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    siteNav<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">'up'</span><span class="token punctuation">,</span> <span class="token constant">SHOW</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token comment">// First scroll event</span></pre></td></tr><tr><td data-num="46"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>  <span class="token comment">//scrollAction.x = Container.scrollLeft;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  scrollAction<span class="token punctuation">.</span>y <span class="token operator">=</span> window<span class="token punctuation">.</span>pageYOffset<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>  <span class="token comment">// var scrollPercent = Math.round(Math.min(100 * window.pageYOffset / contentVisibilityHeight, 100)) + '%';</span></pre></td></tr><tr><td data-num="51"></td><td><pre>  <span class="token comment">// ä¸Šé¢çš„è®¡ç®—æ–¹å¼æ„Ÿè§‰å¯¹ä¸ä¸Šï¼Œè¿™ä¸ªæ”¹ç€è¯•è¯•</span></pre></td></tr><tr><td data-num="52"></td><td><pre>  <span class="token keyword">var</span> scrollPercent <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span>window<span class="token punctuation">.</span>pageYOffset<span class="token operator">/</span><span class="token punctuation">(</span>contentVisibilityHeight<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"%"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>  backToTop<span class="token punctuation">.</span><span class="token function">child</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> scrollPercent<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.percent'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span>scrollPercent<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æš‚æ—¶ç®—æ˜¯å¥½äº†ï¼Œä¸çŸ¥é“è¿˜æœ‰æ²¡æœ‰å…¶å®ƒé—®é¢˜ã€‚åç»­å¦‚æœå‘ç°é—®é¢˜å†çœ‹äº†ã€‚</p><h1 id="æœç„¶å‡ºç°æ–°çš„é—®é¢˜äº†"><a class="anchor" href="#æœç„¶å‡ºç°æ–°çš„é—®é¢˜äº†">#</a> æœç„¶å‡ºç°æ–°çš„é—®é¢˜äº†</h1><p>å¤´åƒç»„ä»¶ä¼šæµ®åŠ¨è‡³é¡µé¢é¡¶ç«¯å» â€”â€” ç»ˆäºä¹Ÿæ˜ç™½  <code>affix</code>  ç”¨æ¥åˆ¤æ–­ä»€ä¹ˆçš„äº†ï¼Œæœ‰è¿™ä¸ªæ ‡è®°æ—¶å¯ä»¥æµ®åŠ¨ï¼Œå¦åˆ™ä¸è¡Œã€‚</p><p>æ„Ÿè§‰é€ æˆé—ªçƒçš„åŸå› ï¼Œæœ€å¤§çš„é—®é¢˜æ˜¯ docHeight å–å‡ºæ¥çš„å€¼ä¸ä¸€æ ·ï¼Œä¼šäº§ç”Ÿå˜åŒ–ã€‚</p><p>æœ€ç»ˆåˆæ”¹äº†ä¸‹ï¼Œæ”¹æˆè¦æ˜¯å®é™…é«˜åº¦æ¯”é¡µé¡¶å›¾ç‰‡é‚£å—è¿˜ä½ï¼Œé‚£ä¹ˆåˆ¤æ–­æ ‡å‡†å°±å–  <code>docHeight/2</code> ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>sideBar<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">'affix'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>pageYOffset <span class="token operator">></span> headerHight <span class="token operator">||</span><span class="token punctuation">(</span>docHeight<span class="token operator">&lt;</span>headerHight<span class="token operator">&amp;&amp;</span>window<span class="token punctuation">.</span>pageYOffset<span class="token operator">></span>docHeight<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetWidth <span class="token operator">></span> <span class="token number">991</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¿™æ ·ä¿®æ”¹è™½ç„¶ä¸ä¼šé—ªçƒï¼Œä½†è¦æ˜¯ å®é™…å†…å®¹é«˜åº¦æ¯”é¡µé¡¶å›¾ç‰‡é‚£å—è¿˜ä½ï¼Œæ»‘åŠ¨æ—¶å¤´åƒç»„ä»¶è¿›å…¥æµ®åŠ¨æ¨¡å¼åï¼Œè¿˜æ˜¯å¯èƒ½è·‘åˆ°é¡µé¡¶å›¾ç‰‡ä¸Šå»ã€‚</p><p>å¦‚æœæƒ³å½»åº•è§£å†³ï¼Œå¾—ç ”ç©¶ä¸‹ä¸ºä»€ä¹ˆ  <code>affix</code>  ä¼šå¯¼è‡´ä¸‹æ–¹å¯¹è±¡çœ‹ä¸è§ï¼Œç„¶åå†é’ˆå¯¹ã€æ¶ˆå¤±ã€é—®é¢˜ä½œå¤„ç† â€”â€” è€Œä¸æ˜¯åœ¨è¿™é‡Œæ”¹æ­¤å¤„ä»£ç ï¼Œå› ä¸ºç†è®ºä¸Šåœ¨è¿™ç§æƒ…å†µä¸‹åº”è¯¥å§‹ç»ˆæ˜¾ç¤ºæ‰å¯¹ã€‚</p><p>è‡³äºä¸ºä»€ä¹ˆä¼šå¯¼è‡´ä¸‹æ–¹å¯¹è±¡çœ‹ä¸è§äº†ï¼Ÿä¼°è®¡è·Ÿ CSS æ’ç‰ˆé‚£è¾¹æœ‰å…³ç³»ï¼Œä¸æƒ³çœ‹äº†ï¼Œå†ç ”ç©¶ä¸‹å»èŠ±çš„æ—¶é—´å°±å¤ªå¤šäº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h1&gt;
&lt;p&gt;åç»­åˆå‘ç°ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å½“æ•´ä¸ªé¡µé¢å†…å®¹é«˜åº¦ä¸è¶³ï¼Œå¾€ä¸‹æ‹–åŠ¨æ—¶é¡µé¢åº•éƒ¨ä¼šé—ªçƒå›å¼¹&lt;/li&gt;
&lt;li&gt;é¡µé¢ç™¾åˆ†æ¯”è¿›åº¦æ˜¾ç¤ºä¸å¤§å‡†ç¡®&lt;/li&gt;
&lt;/o</summary>
      
    
    
    
    <category term="åšå®¢" scheme="https://cwhisme.github.io/categories/%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="åšå®¢" scheme="https://cwhisme.github.io/tags/%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºæˆ‘åˆæŠŠåšå®¢ä¸»é¢˜æ¢æˆ Shoka çš„äº‹</title>
    <link href="https://cwhisme.github.io/2022/12/19/%E5%85%B3%E4%BA%8E%E6%88%91%E5%8F%88%E6%8A%8A%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E6%8D%A2%E6%88%90Shoka%E7%9A%84%E4%BA%8B/"/>
    <id>https://cwhisme.github.io/2022/12/19/%E5%85%B3%E4%BA%8E%E6%88%91%E5%8F%88%E6%8A%8A%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E6%8D%A2%E6%88%90Shoka%E7%9A%84%E4%BA%8B/</id>
    <published>2022-12-19T03:14:43.000Z</published>
    <updated>2022-12-23T12:20:25.993Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h1><p>æ€ä¹ˆè¯´å‘¢... ä¸€å¼€å§‹æ ¹æœ¬æ²¡æƒ³èŠ±è¿™ä¹ˆå¤šæ—¶é—´å»æ¢ä¸»é¢˜çš„ã€‚</p><p>ä¸€å¼€å§‹æˆ‘åªæ˜¯å•çº¯æƒ³ç»™è€ä¸»é¢˜ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tsdWdqby9oZXhvLXRoZW1lLWFub2R5bmU=">anodyne</span> åŠ ä¸€ä¸ªã€ç›®å½•ã€çš„åŠŸèƒ½ç½¢äº†...</p><p>çœ‹åˆ°ä¸€ä¸ª <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FyZ3ZjaHMvaGV4by10aGVtZS1wYXJ0aWNsZXg=">hexo-theme-particlex</span> ï¼Œæ„Ÿè§‰ä¸é”™ã€‚<br />åˆçœ‹åˆ°ä¸€ä¸ª <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYS5naXQ=">hexo-theme-shoka</span>ï¼Œæ„Ÿè§‰ä¹ŸæŒºå¯ä»¥ï¼ŒShoka ä¸»é¢˜è®°å¾—ä¸€å¼€å§‹æ˜¯çœ‹çš„<br />å†çœ‹ä¸€ä¸ª <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Bwb2ZmaWNlL2hleG8tdGhlbWUtaWNhcnVz">hexo-theme-icarus</span>ï¼Œæ„Ÿè§‰ä¹Ÿä¸é”™å•Š (âœ§â—¡âœ§)ã€‚</p><p>ä¸€é¡¿æ“ä½œåï¼Œè¶Šçœ‹è¶Šè§‰å¾—è‡ªå·±çš„ä¸»é¢˜å¤ªç®€æ´äº†ã€‚</p><p>å¯¹æ¯”äº†ä¸‹å‡ ä¸ªä¸»é¢˜ï¼Œicarus ä¹Ÿæ˜¯ç®€æ´é£ã€‚è€Œ Particlex å’Œ Shoka éƒ½å·®ä¸å¤šç±»ä¼¼ç±»å‹ï¼Œä¸€å¼€å§‹æƒ³æ¢æˆ Particlexã€‚ä¸è¿‡ Particlex è‡ªå®šä¹‰çš„å­—ä½“é›†æœ‰ç‚¹å¤§... æ•´ä¸ªä¸»é¢˜å‡ åå…†å¤§åŠå®¹é‡éƒ½åœ¨å­—ä½“é›†ä¸Šäº†ã€‚å°è¯•å»æ‰å­—ä½“å°±å˜å¾—éš¾çœ‹èµ·æ¥ï¼Œé»˜è®¤è®¾ç½®ç™½èŒ«èŒ«åœ°ä¹Ÿä¸å¥½çœ‹... æ„Ÿè§‰å¤´åƒ widget è¿˜æœ‰ç‚¹æ­ªï¼Œä¸»é¡µæ–‡ç« åˆ—è¡¨å†…å®¹é¢„è§ˆæˆªå–å­—ç¬¦æ²¡æœ‰å¤„ç†æ ‡é¢˜ä»¥åçš„é€»è¾‘ (å¼€å§‹å°±æ˜¯ã€å‰è¨€ã€æ ‡é¢˜çš„è¯å°±ç©ºç™½äº†)ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰ç›®å½•åŠŸèƒ½ï¼Œæ¢è¿‡å»åˆæ”¹ä¸€æ¬¡æ˜¯å§ï¼Ÿ</p><p>äºæ˜¯å¯¹æ¯”äº†è§£äº†ä¸‹ï¼Œæœ€ç»ˆå†³å®šæ¢ Shokaâ€”â€” æ„Ÿè§‰ä¸€å®šèƒ½çœä¸å°‘äº‹ï¼ˆä¸ä¼šè¯´æ˜¯å› ä¸ºçœ‹é‡éšæœºèƒŒæ™¯å›¾ç‰‡å¥½çœ‹ä¸”æ–¹ä¾¿ â€”â€” ç®€ç›´æ˜¯é€‰æ‹©å›°éš¾ç—‡çš„ç¦éŸ³ï¼‰<br />(è™½ç„¶æœ€åä¾ç„¶èŠ±äº†æŒºå¤šæ—¶é—´ç ”ç©¶å»ç»“åˆè‡ªå·±çš„æ”¹åŠ¨)</p><h1 id="è¿‡ç¨‹"><a class="anchor" href="#è¿‡ç¨‹">#</a> è¿‡ç¨‹</h1><h2 id="æœ€æ–°è¯„è®º-éšæœºæ–‡ç« æ•°é‡ä¿®æ”¹"><a class="anchor" href="#æœ€æ–°è¯„è®º-éšæœºæ–‡ç« æ•°é‡ä¿®æ”¹">#</a> æœ€æ–°è¯„è®ºã€éšæœºæ–‡ç« æ•°é‡ä¿®æ”¹</h2><p>ä¸€å¼€å§‹æœ¬æ¥ä¸æƒ³å±•ç¤ºè¿™ä¸ªçš„ï¼Œåé¢åˆä»”ç»†ä¸€æƒ³ï¼šæˆ‘è¿™åšå®¢ä¹Ÿæ²¡ä¸ªè¯„è®ºæç¤ºï¼Œæœ€è¿‘çš„ç•™è¨€ä¸æ˜¯æ­£å¥½å¯ä»¥å½“åšä¸€ä¸ªæç¤ºå—ï¼Ÿçœ‹åˆ°æœ€è¿‘ç•™è¨€å°±å¯ä»¥çŸ¥é“è°è°åŠ äº†è¯„è®º (è™½ç„¶æˆ‘è§‰å¾—è¿™ä¸ªå†·æ¸…çš„åšå®¢ä¸å¤§å¯èƒ½ä¼šæœ‰å•¥è¯„è®º)ï¼Œä¸è¿‡å¤šä¸€ä¸ªæç¤ºä¹Ÿæ˜¯å¥½çš„ã€‚</p><p>ä½†æ˜¯åˆæ„Ÿè§‰è¿™ä¸ªä¸»é¢˜é¡µé¢ä¸‹é¢çš„éšæœºæ–‡ç« å’Œæœ€è¿‘è¯„è®ºå¤ªé•¿äº†ï¼šä½œè€…ä¸¤è€…é»˜è®¤éƒ½æ˜¯å†™æ­»çš„ 10 æ¡ï¼Œæƒ³å‡å°‘ä¸€ç‚¹ã€‚<br />éšæœºæ–‡ç« è¿˜å¥½è¯´ï¼Œç›´æ¥æ”¹ä¸»é¢˜ä»£ç å°±è¡Œäº†</p><p>åœ¨ _config.shoka.yml é‡Œè¾¹åŠ äº†ä¸€ä¸ª count çš„é…ç½®ï¼š</p><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">widgets</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token comment"># if true, will show random posts</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token key atrule">random_posts</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token comment"># if true, will show recent comments</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token key atrule">recent_comments</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token key atrule">count</span><span class="token punctuation">:</span> <span class="token number">3</span></pre></td></tr></table></figure><p>ç„¶åæ‰¾åˆ° widgets.njk åŠ å…¥å¯¹æ•°é‡å‚æ•°çš„è§£æï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// æ³¨æ„å°‘äº†ä¸ªå–å‚çš„èŠ±æ‹¬å·ï¼Œå› ä¸ºä¸çŸ¥é“ä¸ºå•¥ä½äºä»£ç å—ä¹Ÿä¼šè¢«è½¬ä¹‰æ‰</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token operator">&lt;</span>ul <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"leancloud-recent-comment count_&#123; theme.widgets.count &#125;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span></pre></td></tr></table></figure><p>ç„¶è€Œæœ€è¿‘è¯„è®ºçš„æ•°é‡æ”¹èµ·æ¥å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œå› ä¸ºåŠŸèƒ½æ˜¯ç›´æ¥å†™æ­»åœ¨ MiniValine çš„ä»£ç é‡Œçš„ï¼Œæ²¡æœ‰æ”¯æŒè‡ªå®šä¹‰çš„åŠŸèƒ½ã€‚<br />å¦‚æœæƒ³è¦å‡å°‘ï¼Œå¾—æ”¹æºç æ‰è¡Œã€‚<br />ç”±äºè¯¥ä¸»é¢˜çš„ js æ˜¯ä»£ç åŠ¨æ€åŠ è½½ï¼Œå¹¶ä¸”åœ¨é…ç½®è·¯å¾„ä¸Šè¯´åƒä¸‡ä¸è¦åŠ¨ï¼šé™¤éçŸ¥é“åœ¨å¹²ä»€ä¹ˆï¼<br />çœ‹èµ·æ¥ï¼ŒåŸå› æ˜¯ä½œè€…å¯¹åŠ é€Ÿè„šæœ¬åšäº†åˆå¹¶å¤„ç†ï¼Œç„¶åæˆ‘è°ƒè¯•äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰ MiniValine å¹¶æ²¡æœ‰å¤„äºåˆå¹¶åˆ—è¡¨ï¼Œç›¸å½“äºè¿˜æ˜¯å•ä¸ªåŠ è½½çš„ã€‚<br />äºæ˜¯å°±æƒ³ç€ä¸€ä¸‹ï¼Œfork äº†ä¸€ä¸ªå·¥ç¨‹ï¼Œå…ˆåœ¨æœ¬åœ°æ”¹ç€è¯•è¯•ã€‚</p><p>æ‹‰ä¸‹æ¥åï¼Œè¦†ç›– vendors.js.valine è·¯å¾„è®¾ç½®ï¼š</p><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">vendors</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token key atrule">js</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token key atrule">valine</span><span class="token punctuation">:</span> /MiniValine/dist/MiniValine.min.js <span class="token comment">#gh/amehime/MiniValine@4.2.2-beta10/dist/MiniValine.min.js</span></pre></td></tr></table></figure><p>æœ¬åœ°è°ƒè¯•äº†ä¸‹ï¼Œæ„Ÿè§‰æ²¡ä»€ä¹ˆå¤§é—®é¢˜ã€‚</p><p>äºæ˜¯å‡†å¤‡å¼€æ”¹ã€‚</p><p>ç¬¬ä¸€æ­¥å°±æ˜¯ç¼–è¯‘ MiniValine ï¼Œå› ä¸ºæ²¡åœ¨ Readme ä¸Šçœ‹åˆ°ç¼–è¯‘æ–¹å¼ï¼Œå°±è‡ªå·±ç ”ç©¶äº†ä¸‹ï¼Œå‘ç°ã€å¯èƒ½ã€æ˜¯ç”¨çš„ webpackã€‚</p><p>äºæ˜¯å°è¯•  <code>npm i webpack</code>  å®‰è£…é‡æ–°è¯•ï¼Œåˆç¼ºå¤±  <code>webpack-cli</code> ...... ä¸€æ³¢å®‰è£…ä¸‹å»ï¼Œç¼ºå¤± Python éƒ½æ¥äº† â€”â€” ä¹Ÿä¸çŸ¥é“å“ªä¸ªä¾èµ–åŒ…éœ€è¦ Python ç¼–è¯‘ã€‚</p><p>ç°åœ¨è¿™ä¸ªç”µè„‘è¿˜æ²¡å®‰è£…è¿‡ pyï¼Œäºæ˜¯ä¸‹è½½äº†æœ€æ–°ç‰ˆï¼šç¼–è¯‘ç¡®å®å¼€å§‹äº†ï¼Œç»“æœåˆæŠ¥æ–°çš„é”™è¯¯ã€‚</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> path E:<span class="token punctuation">\</span>é¡¹ç›®<span class="token punctuation">\</span>Blog<span class="token punctuation">\</span>HexoBlog<span class="token punctuation">\</span>MiniValine<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>fibers</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token builtin class-name">command</span> failed</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token builtin class-name">command</span> C:<span class="token punctuation">\</span>WINDOWS<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>cmd.exe /d /s /c <span class="token function">node</span> build.js <span class="token operator">||</span> nodejs build.js</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp info it worked <span class="token keyword">if</span> it ends with ok</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp info using node-gyp@3.8.0</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp info using node@18.12.1 <span class="token operator">|</span> win32 <span class="token operator">|</span> x64</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> configure error</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack Error: Command failed: C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>CWHIS<span class="token punctuation">\</span>AppData<span class="token punctuation">\</span>Local<span class="token punctuation">\</span>Programs<span class="token punctuation">\</span>Python<span class="token punctuation">\</span>Python311<span class="token punctuation">\</span>python.EXE <span class="token parameter variable">-c</span> <span class="token function">import</span> sys<span class="token punctuation">;</span> print <span class="token string">"%s.%s.%s"</span> % sys.version_info<span class="token punctuation">[</span>:3<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack   File <span class="token string">"&lt;string>"</span>, line <span class="token number">1</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack     <span class="token function">import</span> sys<span class="token punctuation">;</span> print <span class="token string">"%s.%s.%s"</span> % sys.version_info<span class="token punctuation">[</span>:3<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack SyntaxError: Missing parentheses <span class="token keyword">in</span> call to <span class="token string">'print'</span><span class="token builtin class-name">.</span> Did you mean print<span class="token punctuation">(</span><span class="token punctuation">..</span>.<span class="token punctuation">)</span>?</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack     at ChildProcess.exithandler <span class="token punctuation">(</span>node:child_process:412:12<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack     at ChildProcess.emit <span class="token punctuation">(</span>node:events:513:28<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack     at maybeClose <span class="token punctuation">(</span>node:internal/child_process:1091:16<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> stack     at ChildProcess._handle.onexit <span class="token punctuation">(</span>node:internal/child_process:302:5<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> System Windows_NT <span class="token number">10.0</span>.22621</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> <span class="token builtin class-name">command</span> <span class="token string">"D:<span class="token entity" title="\\">\\</span>Solfware<span class="token entity" title="\\">\\</span>GreenSolfware<span class="token entity" title="\\">\\</span>node-v18.12.1-win-x64<span class="token entity" title="\\">\\</span>node.exe"</span> <span class="token string">"E:<span class="token entity" title="\\">\\</span>é¡¹ç›®<span class="token entity" title="\\">\\</span>Blog<span class="token entity" title="\\">\\</span>HexoBlog<span class="token entity" title="\\">\\</span>MiniValine<span class="token entity" title="\\">\\</span>node_modules<span class="token entity" title="\\">\\</span>node-gyp<span class="token entity" title="\\">\\</span>bin<span class="token entity" title="\\">\\</span>node-gyp.js"</span> <span class="token string">"rebuild"</span> <span class="token string">"--release"</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> cwd E:<span class="token punctuation">\</span>é¡¹ç›®<span class="token punctuation">\</span>Blog<span class="token punctuation">\</span>HexoBlog<span class="token punctuation">\</span>MiniValine<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>fibers</pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> <span class="token function">node</span> <span class="token parameter variable">-v</span> v18.12.1</pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> node-gyp <span class="token parameter variable">-v</span> v3.8.0</pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> gyp ERR<span class="token operator">!</span> not ok</pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> node-gyp exited with code: <span class="token number">1</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> Please <span class="token function">make</span> sure you are using a supported platform and <span class="token function">node</span> version. If you</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> would like to compile fibers on this machine please <span class="token function">make</span> sure you have setup your</pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> build environment--</pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> Windows + OS X instructions here: https://github.com/nodejs/node-gyp</pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> Ubuntu <span class="token function">users</span> please run: <span class="token variable"><span class="token variable">`</span><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> g++ build-essential<span class="token variable">`</span></span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> RHEL <span class="token function">users</span> please run: <span class="token variable"><span class="token variable">`</span>yum <span class="token function">install</span> gcc-c++<span class="token variable">`</span></span> and <span class="token variable"><span class="token variable">`</span>yum groupinstall <span class="token string">'Development Tools'</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> Alpine <span class="token function">users</span> please run: <span class="token variable"><span class="token variable">`</span><span class="token function">sudo</span> apk <span class="token function">add</span> python <span class="token function">make</span> g++<span class="token variable">`</span></span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> <span class="token string">'nodejs'</span> ï¿½ï¿½ï¿½ï¿½ï¿½Ú²ï¿½ï¿½ï¿½ï¿½â²¿ï¿½ï¿½ï¿½î£¬Ò²ï¿½ï¿½ï¿½Ç¿ï¿½ï¿½ï¿½ï¿½ĞµÄ³ï¿½ï¿½ï¿½</pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token function">npm</span> ERR<span class="token operator">!</span> ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä¼ï¿½ï¿½ï¿½</pre></td></tr></table></figure><p>çœ‹ç€å°±åƒæ˜¯ python ç‰ˆæœ¬è¿‡é«˜ï¼Œä¾èµ–åŒ…è¿˜åœ¨ç”¨è€ç‰ˆæœ¬çš„è¯­æ³•ï¼Ÿ</p><p>è¿™å·²ç»æ˜¯åå¤å®‰è£…å’Œå¸è½½ npm åŒ…ç®¡ç†å°è¯•åäº†<br />æ¯•ç«Ÿæˆ‘ä¸æ˜¯ä¸“ä¸šçš„... è¿™æ—¶å€™å·²ç»èŠ±äº†ä¸å°‘æ—¶é—´äº† â€”â€” å°±æ¢ä¸ªä¸»é¢˜... åŠ ä¸ªå°åŠŸèƒ½è€Œå·²ï¼Œæˆ‘è¿˜æœ‰æ›´é‡è¦çš„ä¸œè¥¿è¦åšï¼Œæ€ä¹ˆèƒ½åœ¨è¿™é‡Œè´¹è¿™ä¹ˆå¤§åŠŸå¤«ï¼Œå¹²è„†ç›´æ¥åœ¨  <code>MiniValine.min.js</code>  åŸºç¡€ä¸Šä¿®æ”¹ç®—äº†ã€‚</p><p>äºæ˜¯æ‰“å¼€æ§åˆ¶å°è¦ç½‘é¡µè°ƒè¯•çª—å£ï¼Œä¸‹äº†ä¸ªæ–­ç‚¹ï¼Œå¾ˆå¿«å°±æŠŠ  <code>count_æ•°é‡</code>  è¿™ä¸ªé…ç½®è§£ææˆæŸ¥è¯¢æ•°é‡ä¸Šé™å€¼äº†ã€‚</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> recentCount <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>t <span class="token operator">&amp;&amp;</span> t<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"count_"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        recentCount <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"_"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>å¾ˆç®€å•çš„ä¸€è¡Œä»£ç ã€‚</p><p>ä¸è¿‡ç”±äºéœ€è¦æ‹‰å–å·¥ç¨‹æ”¹ MiniValineï¼Œå¦‚æœæœ‰éœ€è¦çš„è¯å¯ä»¥ç›´æ¥ç”¨æˆ‘æ”¹å¥½çš„ (... å¦‚æœçœŸçš„è¿˜æœ‰äººéœ€è¦çš„è¯)ï¼š</p><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">vendors</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token key atrule">js</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token key atrule">valine</span><span class="token punctuation">:</span> gh/CWHISME/MiniValine/dist/MiniValine.min.js <span class="token comment">#gh/amehime/MiniValine@4.2.2-beta10/dist/MiniValine.min.js</span></pre></td></tr></table></figure><p>ä»¥åŠæ”¹è¿‡çš„ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NXSElTTUUvaGV4by10aGVtZS1zaG9rYS5naXQ=">Shoka</span> åœ°å€ã€‚</p><h2 id="æ ‡é¢˜æ˜¾ç¤ºå¼€å¤´æ˜¾ç¤ºæˆ-å·"><a class="anchor" href="#æ ‡é¢˜æ˜¾ç¤ºå¼€å¤´æ˜¾ç¤ºæˆ-å·">#</a> æ ‡é¢˜æ˜¾ç¤ºå¼€å¤´æ˜¾ç¤ºæˆ # å·</h2><p>æœ€å¼€å§‹å‘ç°çš„æ˜¯ï¼Œæ–‡ç« ç›®å½•æ ‡é¢˜ä¸åƒä½œè€…é‚£æ ·æ˜¾ç¤º H1ã€H2 ä¹‹ç±»çš„ï¼Œè€Œæ˜¯ã€#ã€å·å¼€å¤´ï¼Œæ¯”å¦‚ï¼š</p><p><img data-src="/blogimages/2022/2022-12-17/Snipaste_2022-12-17_15-59-47.png" alt="" /></p><p>å¯¹æ¯”äº†ä¸‹ä½œè€…å’Œå…¶å®ƒä¸»é¢˜ä½¿ç”¨è€…çš„æƒ…å†µï¼Œå‘ç°æ˜¯è¿™ä¸ª markdownIt-Anchor class çš„é—®é¢˜ï¼Œæ‰‹åŠ¨å°†å…¶æ”¹æˆ anchor å°±æ­£å¸¸äº†ã€‚</p><p>çŸ¥é“åŸå› ï¼Œå°±å¾—æ‰¾ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ<br />å®‰è£…è¿‡ç¨‹ä¹Ÿæ˜¯æŒ‰ç…§è¦æ±‚æ“ä½œçš„ï¼Œä¸ºä½• anchor å˜æˆäº† markdownIt-Anchorï¼Ÿ</p><p>äºæ˜¯å…ˆåç»å†äº†åå¤ å®‰è£…ã€å¸è½½ï¼ŒæŸ¥è¯¢ä¾èµ–åŒ…ç‰ˆæœ¬ç­‰ç­‰æ“ä½œ...... æ£€æŸ¥å¾—æ€€ç–‘äººç”Ÿï¼<br />ç»“æœæœ€åæ‰å‘ç°ï¼šæ˜¯å®‰è£…è¯´æ˜ä¸­çš„ hexo-renderer-multi-markdown-it é…ç½®æ²¡æœ‰æ²¾ä¸‹æ¥ï¼</p><p>ä¸»é¢˜è‡ªå¸¦çš„ _config.yml å¹¶æ²¡æœ‰å…³äºè¿™ä¸ªçš„é»˜è®¤é…ç½®ï¼Œå¿…é¡»æ‰‹åŠ¨ç²˜è´´è¿›è‡ªå·±çš„ _config.yml ç„¶åæˆ‘ä¹‹å‰å®‰è£…çš„æ—¶å€™ä¼°è®¡æ¼äº†ï¼Œç„¶åå°±å˜æˆè¿™æ ·äº†... ğŸ˜­</p><h2 id="å¤´åƒ"><a class="anchor" href="#å¤´åƒ">#</a> å¤´åƒ</h2><p>çœ‹åˆ°ä½œè€…åœ¨å…³äºé¡µé¢å†™çš„è‡ªè®¾ï¼Œå¹¶ç•™ä¸‹äº†ä¸€ä¸ª <span class="exturl" data-url="aHR0cHM6Ly9waWNyZXcubWUv">Picrew</span> çš„é“¾æ¥ï¼Œç‚¹è¿›å»è¯•äº†ä¸‹ï¼Œæ„Ÿè§‰è¿˜æ„å¤–çš„ä¸é”™ã€‚</p><p>äºæ˜¯æŠŠè‡ªå·±çš„ä¸Šå¤å¤´åƒä¹Ÿæ¢äº†ã€‚</p><h2 id="é¡µé¡¶å›¾ç‰‡æ·»åŠ ç½‘æ ¼è’™ç‰ˆ"><a class="anchor" href="#é¡µé¡¶å›¾ç‰‡æ·»åŠ ç½‘æ ¼è’™ç‰ˆ">#</a> é¡µé¡¶å›¾ç‰‡æ·»åŠ ç½‘æ ¼è’™ç‰ˆ</h2><p>å› ä¸ºæ„Ÿè§‰æœ‰æ—¶å€™æ”¾å¤§å¤ªç³Šäº†ï¼Œå‚è€ƒ <span class="exturl" data-url="aHR0cHM6Ly93d3cubGF2ZW5kZXJkaC5jbi9wb3N0cy8zOTI4OTY2Mjg3Lw==">Lavender</span> çš„æ–‡ç« ï¼Œå¢åŠ äº†ç½‘æ ¼æ•ˆæœã€‚</p><p>ä½œè€…æ˜¯ç›´æ¥ä¿®æ”¹çš„  <code>themes\shoka\source\css\_common\outline\header\header.styl</code></p><p>å…¶å®åœ¨  <code>source/_data/</code>  ç›®å½•å»ºç«‹ä¸€ä¸ª  <code>custom.styl</code>  è‡ªå®šä¹‰æ ·å¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>å¹¶ä¸”å› ä¸ºæˆ‘æ²¡æœ‰æŠŠå›¾æ”¹æˆå…¨å±ï¼Œæ‰€ä»¥ä»£ç æœ‰æ‰€å·®å¼‚ï¼š</p><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">#header</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token selector">&amp;::before</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>/img/dot.png<span class="token punctuation">)</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token property">height</span><span class="token punctuation">:</span> 70vh<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token property">z-index</span><span class="token punctuation">:</span> -4<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token property">background-attachment</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token property">height</span><span class="token punctuation">:</span> 50vh<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token property">text-shadow</span><span class="token punctuation">:</span> 0rem .2rem .3rem <span class="token function">alpha</span><span class="token punctuation">(</span>#000<span class="token punctuation">,</span> .5<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--header-text-color<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token selector">a:hover</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token property">color</span><span class="token punctuation">:</span> currentColor<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ç›¸å½“äºåªæ˜¯åœ¨ Shoka æœ¬æ¥åŸºç¡€ä¸ŠåŠ äº†ä¸€ä¸ªç½‘æ ¼è’™ç‰ˆæ•ˆæœã€‚</p><hr /><p>åè¾¹æƒ³ç€æŠŠæ™®é€š cover ä¹ŸåŠ äº†ä¸€ä¸ªï¼Œä¸è¿‡é™ä½äº†é€æ˜åº¦ã€‚</p><p>è¯´é“è¿™ä¸ªï¼ŒGIMP ä¸­çš„é¢œè‰²æ¨¡å¼ï¼Œå°±ç®—é»‘ç™½è‰²ä¹Ÿä¸èƒ½é‡‡ç”¨ç°åº¦ï¼Œè¿˜æ˜¯å¾— RGB é¢œè‰²æ‰è¡Œã€‚</p><p>æƒ³ç€å‡å°‘å¤§å° (å…¶å®æ ¹æœ¬æ²¡å¿…è¦) è¯•äº†ä¸‹æ„Ÿè§‰è’™ç‰ˆæ ¼å­éƒ½ä¸å¯¹å‘³äº†ã€‚</p><h2 id="éŸ³ä¹æ’­æ”¾å™¨"><a class="anchor" href="#éŸ³ä¹æ’­æ”¾å™¨">#</a> éŸ³ä¹æ’­æ”¾å™¨</h2><p>æ³¨æ„ QQ éŸ³ä¹çš„é“¾æ¥å¿…é¡»å¸¦ .html åç¼€ï¼Œå¦åˆ™éŸ³ä¹æ’­æ”¾å™¨ä¼šåæ‰çš„ã€‚</p><p>ç­›é€‰ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼è§„åˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span><span class="token string">'music.163.com.*song.*id=(\\d+)'</span><span class="token punctuation">,</span> <span class="token string">'netease'</span><span class="token punctuation">,</span> <span class="token string">'song'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span><span class="token string">'music.163.com.*album.*id=(\\d+)'</span><span class="token punctuation">,</span> <span class="token string">'netease'</span><span class="token punctuation">,</span> <span class="token string">'album'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span><span class="token string">'music.163.com.*artist.*id=(\\d+)'</span><span class="token punctuation">,</span> <span class="token string">'netease'</span><span class="token punctuation">,</span> <span class="token string">'artist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span><span class="token string">'music.163.com.*playlist.*id=(\\d+)'</span><span class="token punctuation">,</span> <span class="token string">'netease'</span><span class="token punctuation">,</span> <span class="token string">'playlist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span><span class="token string">'music.163.com.*discover/toplist.*id=(\\d+)'</span><span class="token punctuation">,</span> <span class="token string">'netease'</span><span class="token punctuation">,</span> <span class="token string">'playlist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span><span class="token string">'y.qq.com.*song/(\\w+).html'</span><span class="token punctuation">,</span> <span class="token string">'tencent'</span><span class="token punctuation">,</span> <span class="token string">'song'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">[</span><span class="token string">'y.qq.com.*album/(\\w+).html'</span><span class="token punctuation">,</span> <span class="token string">'tencent'</span><span class="token punctuation">,</span> <span class="token string">'album'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">[</span><span class="token string">'y.qq.com.*singer/(\\w+).html'</span><span class="token punctuation">,</span> <span class="token string">'tencent'</span><span class="token punctuation">,</span> <span class="token string">'artist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">[</span><span class="token string">'y.qq.com.*playsquare/(\\w+).html'</span><span class="token punctuation">,</span> <span class="token string">'tencent'</span><span class="token punctuation">,</span> <span class="token string">'playlist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">[</span><span class="token string">'y.qq.com.*playlist/(\\w+).html'</span><span class="token punctuation">,</span> <span class="token string">'tencent'</span><span class="token punctuation">,</span> <span class="token string">'playlist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">[</span><span class="token string">'xiami.com.*song/(\\w+)'</span><span class="token punctuation">,</span> <span class="token string">'xiami'</span><span class="token punctuation">,</span> <span class="token string">'song'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">[</span><span class="token string">'xiami.com.*album/(\\w+)'</span><span class="token punctuation">,</span> <span class="token string">'xiami'</span><span class="token punctuation">,</span> <span class="token string">'album'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">[</span><span class="token string">'xiami.com.*artist/(\\w+)'</span><span class="token punctuation">,</span> <span class="token string">'xiami'</span><span class="token punctuation">,</span> <span class="token string">'artist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">[</span><span class="token string">'xiami.com.*collect/(\\w+)'</span><span class="token punctuation">,</span> <span class="token string">'xiami'</span><span class="token punctuation">,</span> <span class="token string">'playlist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr></table></figure><h3 id="æ­Œå•æ›´æ¢åé”™ä½é—®é¢˜"><a class="anchor" href="#æ­Œå•æ›´æ¢åé”™ä½é—®é¢˜">#</a> æ­Œå•æ›´æ¢åé”™ä½é—®é¢˜</h3><p>è‡ªå®šä¹‰çš„éŸ³ä¹ï¼Œæ›´æ¢äº†éŸ³ä¹åˆ—è¡¨éŸ³ä¹éœ€è¦æ‰‹åŠ¨æ¸…ç©ºä¸€ä¸‹ loacalStorageï¼Œå› ä¸ºä½œè€…ä¸ºäº†ä¼˜åŒ–ï¼Œæ¯ä¸ªæ­Œå•æ•°æ®æ‹‰å–ä¸€æ¬¡åéƒ½æ˜¯ç›´æ¥å­˜å‚¨æœ¬åœ°çš„ã€‚</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// ä¾‹å¦‚ utils.parse è¿”å›æ•°æ®</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token string">'tencent'</span><span class="token punctuation">,</span> <span class="token string">'playlist'</span><span class="token punctuation">,</span> <span class="token string">'8733616535'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// æœ¬åœ°æœ‰å°±å–æœ¬åœ°ï¼Œå¦åˆ™è§£æå­˜å‚¨æœ¬åœ°</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">var</span> meta <span class="token operator">=</span> utils<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>meta<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">var</span> skey <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>meta<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">var</span> playlist <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">if</span><span class="token punctuation">(</span>playlist<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>playlist<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.i-meto.com/meting/api?server='</span><span class="token operator">+</span>meta<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&amp;type='</span><span class="token operator">+</span>meta<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&amp;id='</span><span class="token operator">+</span>meta<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&amp;r='</span><span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        store<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>skey<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> json<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ex</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿™æ ·è¦æ˜¯å®æ—¶åœ¨å¦å¤–ä¸€è¾¹æ›´æ¢äº†æ­Œå•ä¸­çš„æ­Œæ›²å°±ä¼šå‡ºé—®é¢˜ï¼šæ¯”å¦‚æ­Œæ›²é”™ä½å•Šã€åå­—ä¸å¯¹ã€æ’­æ”¾å¤±è´¥ä¹‹ç±»çš„ã€‚</p><p>ä¼¼ä¹è®¿é—®ä¸€æ¬¡åï¼Œæ­Œå•è®°å½•ä¸‹æ¥å˜ä¸äº†äº† (å¯¹è®¿é—®è€…æ¥è¯´)ï¼Œå› ä¸ºè²Œä¼¼æ²¡æœ‰çœ‹åˆ°åˆ é™¤çš„åœ°æ–¹...</p><h2 id="è‡ªå®šä¹‰è„šæœ¬æ‰§è¡Œæ—¶æœºé—®é¢˜"><a class="anchor" href="#è‡ªå®šä¹‰è„šæœ¬æ‰§è¡Œæ—¶æœºé—®é¢˜">#</a> è‡ªå®šä¹‰è„šæœ¬æ‰§è¡Œæ—¶æœºé—®é¢˜</h2><p>æƒ³æŠŠä¹‹å‰æ˜¾ç¤ºæ–‡ç« ã€å¤šå°‘å¤©ã€å‰çš„è„šæœ¬æ”¾è¿›æ¥ï¼Œä¸è¿‡ä¸€æ—¶é—´æ²¡æ‰¾åˆ°å¯ä»¥é…ç½®çš„åœ°æ–¹ã€‚</p><p>æœ€åè¿˜æ˜¯ç›´æ¥æ”¹çš„ä¸»é¢˜ä»£ç ï¼Œåœ¨ layout.njk å¯¼å…¥ app.js ä¸»é¢˜ä»£ç ä¹‹åæ·»åŠ è‡ªå®šä¹‰çš„è„šæœ¬ã€‚</p><p>å…¶ä¸­æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œè¿™ä¸ªç‚¹å‡»è¿›å»å¦å¤–çš„é¡µé¢è²Œä¼¼åšäº†ä¼˜åŒ–çš„ï¼Œä¸ä¼šé‡æ–°è¯·æ±‚æ‰€æœ‰é¡µé¢æ•°æ®ï¼Œå› æ­¤å¯¼å…¥è„šæœ¬è‹¥æ˜¯æƒ³æ¯æ¬¡é¡µé¢å‘é€æ”¹å˜æ‰§è¡Œï¼Œå°±ä¸èƒ½ç›´æ¥ç”¨è€æ–¹å¼äº†ã€‚</p><p>ç›®å‰ Shoka åŠ è½½æµç¨‹æ˜¯ï¼š</p><ol><li>é¡µé¢åˆå§‹åŒ–ï¼Œç»‘å®š DOMContentLoaded siteInit äº‹ä»¶</li><li>åœ¨è¯¥æ–¹æ³•ä¸­ç»‘å®šåŠ¨æ€äº‹ä»¶ï¼Œä¾‹å¦‚ pjax åŠ¨æ€æˆåŠŸåŠ è½½äº†æ–°é¡µé¢çš„å¤„ç† siteRefresh å‡½æ•°</li><li>åœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨ä¸€æ¬¡ siteRefresh æ‰§è¡Œä¸€æ¬¡æ‰‹åŠ¨åˆ·æ–°</li><li>siteRefresh ä¸­è¿›è¡Œå®é™…é¡µé¢çš„åˆ·æ–°å¤„ç†</li></ol><p>æ‰€ä»¥å…³é”®ç‚¹å°±åœ¨äº pjax:success ç»‘å®šçš„ siteRefresh å‡½æ•°äº†ã€‚</p><p>ä¸»é¢˜é‡Œé¢çš„ä»£ç è‚¯å®šæ˜¯ä¸å¥½å»æ”¹åŠ¨çš„ï¼Œäºæ˜¯å°è¯•åœ¨è‡ªå·±å¯¼å…¥çš„è„šæœ¬ä¸­ç»‘å®š pjax:success äº‹ä»¶ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//shoka ç‰ˆæœ¬</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">refreshDateTimeOfDay</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    $<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token parameter">x</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>innerText<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>dateTime<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">var</span> dateNow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">var</span> dayCount <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dateNow <span class="token operator">-</span> date<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">86400</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token keyword">var</span> finalStr <span class="token operator">=</span> dayCount <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> nowStr <span class="token operator">:</span> dayCount <span class="token operator">+</span> dayStr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        x<span class="token punctuation">.</span>innerText <span class="token operator">=</span> x<span class="token punctuation">.</span>innerText<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">,</span> finalStr<span class="token punctuation">,</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'pjax:success'</span><span class="token punctuation">,</span> refreshDateTimeOfDay<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">refreshDateTimeOfDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¯•äº†ä¸‹å¯ä»¥ç”¨ï¼š</p><p><img data-src="/blogimages/2022/2022-12-17/Snipaste_2022-12-18_17-09-05.jpg" alt="" /></p><p>é‚£å°±å…ˆè¿™æ ·äº†ã€‚</p><p>å¼•ç”¨ live2d çš„æ–¹å¼ä¹Ÿå·®ä¸å¤šï¼Œä¹‹å‰æˆ‘å·²ç»å®Œå…¨åˆ†ç¦»äº† live2d åº“ï¼Œåªéœ€è¦å¼•ç”¨è„šæœ¬å°±è¡Œäº†ã€‚</p><p>â€”â€” ä¸è¿‡ç”±äº live2d ä¹‹å‰ ui ä½¿ç”¨çš„æ˜¯ FontAwesome å›¾æ ‡ï¼Œå¯¼è‡´æ˜¾ç¤ºä¸å‡ºæ¥ã€‚</p><p>ä¸å¯èƒ½ä¸ºäº† live2d ä¸“é—¨å†å¯¼å…¥ä¸€ä¸ª FontAwesome åº“çš„...... ä» shoka å·²æœ‰çš„ Iconfont å›¾æ ‡é‡Œæ‰¾äº†å‡ ä¸ªæ›¿æ¢ä¸€ä¸‹å§ã€‚</p><h2 id="html-æ ‡ç­¾æ²¡æœ‰è¢«è§£æ"><a class="anchor" href="#html-æ ‡ç­¾æ²¡æœ‰è¢«è§£æ">#</a> HTML æ ‡ç­¾æ²¡æœ‰è¢«è§£æ</h2><p>ä»¥å‰ä½¿ç”¨é»˜è®¤ markdown æ¸²æŸ“å™¨çš„æ—¶å€™ï¼Œå› ä¸ºæ²¡æœ‰ä¿®æ”¹å­—ä½“é¢œè‰²åŠŸèƒ½ï¼Œéƒ½æ˜¯ç›´æ¥é‡‡ç”¨ html æ ‡ç­¾å¦‚  <code>&lt;font color=red&gt; é™æ€å¯¹è±¡çš„æ‰€æœ‰ç›´æ¥å…‰ç…§ã€é—´æ¥å…‰ç…§ã€é˜´å½±å‡çƒ˜ç„™ &lt;/font&gt;</code>  è¿™ç§æ–¹å¼å®ç°çš„ã€‚</p><p>ç„¶åå°±å‘ç° shoka æ²¡æœ‰è§£æäº†ï¼Œç›´æ¥è¢«å½“åšçº¯æ–‡æœ¬ç»™æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>æŸ¥äº†å¹¶è¯•äº†ä¸‹ï¼Œæ˜¯ç”±äº hexo-renderer-multi-markdown-it æ¸²æŸ“å™¨çš„é…ç½®é—®é¢˜ï¼Œmarkdown.render.html å­—æ®µéœ€è¦è®¾ç½®ä¸º trueâ€”â€” ä½œè€…é»˜è®¤ç»™å‡ºçš„æ¨¡æ¿æ˜¯ falseï¼Œæ‰€ä»¥ä½œä¸ºçº¯æ–‡æœ¬æ˜¾ç¤ºäº†ã€‚</p><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">markdown</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token key atrule">render</span><span class="token punctuation">:</span> <span class="token comment"># æ¸²æŸ“å™¨è®¾ç½®</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token key atrule">html</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># è¿‡æ»¤ HTML æ ‡ç­¾ ----- true è¡¨ç¤ºä¼šè½¬ä¹‰ html æ ‡ç­¾ï¼Œå¦åˆ™ä½œä¸ºçº¯æ–‡æœ¬</span></pre></td></tr></table></figure><h2 id="å‹ç¼©æ’ä»¶é—®é¢˜"><a class="anchor" href="#å‹ç¼©æ’ä»¶é—®é¢˜">#</a> å‹ç¼©æ’ä»¶é—®é¢˜</h2><p>æˆ‘è¿™è¾¹ hexo-renderer-multi-markdown-it è‡ªå¸¦å‹ç¼©æ’ä»¶ç”¨èµ·æ¥æœ‰ç‚¹é—®é¢˜ï¼Œå‹ç¼©è‡ªå·±çš„ä»£ç è·Ÿ Shoka çš„ç«Ÿç„¶è¿˜äº§ç”Ÿäº†éšæœºæ–¹æ³•åçš„å†²çªï¼Œæ¢å› hexo-all-minifier äº†ã€‚</p><h2 id="å¼•å…¥è‡ªå®šä¹‰è„šæœ¬å¢åŠ é…ç½®åŠŸèƒ½"><a class="anchor" href="#å¼•å…¥è‡ªå®šä¹‰è„šæœ¬å¢åŠ é…ç½®åŠŸèƒ½">#</a> å¼•å…¥è‡ªå®šä¹‰è„šæœ¬å¢åŠ é…ç½®åŠŸèƒ½</h2><p>ä¸Šé¢ç›´æ¥é€šè¿‡ç›´æ¥ä¿®æ”¹ä¸»é¢˜æ¨¡æ¿å¼•å…¥äº†è‡ªå®šä¹‰è„šæœ¬ä»£ç ï¼Œä¸è¿‡æ„Ÿè§‰å¯ä»¥å°†è¿™ä¸ªä¿®æ”¹è½¬ç§»åˆ°é…ç½®ä¸­ã€‚<br />äºæ˜¯ä»¿ç…§ å·²æœ‰çš„æ¸²æŸ“æ–¹å¼ï¼Œåœ¨  <code>ä¸»é¢˜ _config.yml(_config.shoka.yml)</code>  å¢åŠ   <code>customJs</code>  é…ç½®ï¼Œä¾‹å¦‚</p><figure class="highlight yml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">customJs</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token punctuation">-</span> /js/DateTimeAfeterCalc.js</pre></td></tr></table></figure><p>ç„¶ååœ¨  <code>asset.js</code>  æ³¨å†Œæ–¹æ³•ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>hexo<span class="token punctuation">.</span>extend<span class="token punctuation">.</span>helper<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'_custom_js'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">const</span> customJs <span class="token operator">=</span> hexo<span class="token punctuation">.</span>theme<span class="token punctuation">.</span>config<span class="token punctuation">.</span>customJs<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>customJs<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">let</span> str<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> customJs<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    str<span class="token operator">+=</span> <span class="token function">htmlTag</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">src</span><span class="token operator">:</span>  customJs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">return</span> str<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æœ€ååœ¨  <code>layout.njk</code>  è°ƒç”¨ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">&#123;</span> <span class="token function">_vendor_js</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span> <span class="token function">_js</span><span class="token punctuation">(</span><span class="token string">'app.js'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span><span class="token function">_custom_js</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å¦‚æ­¤åç»­è¦æ˜¯è¿˜æœ‰å¼•ç”¨è‡ªå·±çš„è„šæœ¬ï¼Œåªéœ€è¦æ”¹  <code>_config.shoka.yml</code>  é…ç½®ï¼Œä¸ä¼šåŠ¨åˆ°ä¸»é¢˜æœ¬èº«ä»£ç è¿™è¾¹äº†ã€‚</p><h2 id="æœç´¢"><a class="anchor" href="#æœç´¢">#</a> æœç´¢</h2><p>æœ€åæ˜¯ algolia æœç´¢ï¼Œè¿™ä¸ªæ²¡ä»€ä¹ˆæ”¹çš„ï¼Œè™½ç„¶ä¹‹å‰ä¹Ÿæ²¡ç”¨è¿‡ï¼Œå®‰è£…å¥½ hexo-algoliasearchï¼Œç„¶åæ³¨å†Œä¸€ä¸ªè´¦å·æŒ‰ç…§å»ºè®®æ¥<s>å°±è¡Œäº†</s> â€”â€” éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œalgolia é…ç½®å¿…é¡»é…ç½®åˆ° Hexo æ ¹ç›®å½•çš„  <code>_config.yml</code>  ä¸­ï¼Œå¦‚æœé…åˆ°äº†ä¸»é¢˜å¦‚  <code>_config.shoka.yml</code>  é…ç½®é‡Œè¾¹æ˜¯ä¸è¡Œçš„ã€‚</p><p>åˆšå¼€å§‹æˆ‘å°±æŒ‰ç…§æƒ¯ä¾‹é…ç½®åœ¨  <code>_config.shoka.yml</code>  å†…ï¼Œç»“æœå‘ç°æ²¡ä»€ä¹ˆæ•ˆæœ â€”â€” ç‚¹æŒ‰é’®ä¹Ÿæ²¡ååº”ï¼ŒæŸ¥äº†ä»£ç å‘ç°å‘ç°å®é™…æ˜¯å–çš„ config é…ç½®ã€‚</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> config <span class="token operator">=</span> hexo<span class="token punctuation">.</span>config<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> theme <span class="token operator">=</span> hexo<span class="token punctuation">.</span>theme<span class="token punctuation">.</span>config<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>algolia<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  siteConfig<span class="token punctuation">.</span>search <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">appID</span>    <span class="token operator">:</span> config<span class="token punctuation">.</span>algolia<span class="token punctuation">.</span>appId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token literal-property property">apiKey</span>   <span class="token operator">:</span> config<span class="token punctuation">.</span>algolia<span class="token punctuation">.</span>apiKey<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token literal-property property">indexName</span><span class="token operator">:</span> config<span class="token punctuation">.</span>algolia<span class="token punctuation">.</span>indexName<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token literal-property property">hits</span>     <span class="token operator">:</span> theme<span class="token punctuation">.</span>search<span class="token punctuation">.</span>hits</pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ”¹åˆ°å…¨å±€é…ç½®é‡Œå°±å¯ä»¥äº†ã€‚</p><h1 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h1><p>æœ¬æ¥åªæ˜¯æƒ³ï¼š</p><ol><li>ä¸ºæ—§ä¸»é¢˜åŠ ä¸ªç›®å½•</li><li>æƒ³è®©ç›®å½• (ç›®å½•åŒçº§å¤´åƒä¸å˜) å¯ä»¥è·Ÿéšé¡µé¢ç§»åŠ¨]</li><li>ç ”ç©¶å¦‚ä½•å¤„ç†æ‰‹æœºç«¯å…¼å®¹æ€§é—®é¢˜</li><li>æ„Ÿè§‰ä¸»é¢˜ä¸å¥½çœ‹</li><li>æ¢</li><li>æ¢å“ªä¸ªï¼Ÿ</li><li>ç ”ç©¶ ing</li><li>æ¢ Shoka å§</li><li>ç ”ç©¶ ing</li><li>è‡ªå®šä¹‰</li><li>ç ”ç©¶åŠŸèƒ½å¦‚ä½•å®ç°çš„</li><li>è§£å†³é—®é¢˜</li><li>ç»ˆäºå®Œæˆäº†ï¼Œå‘¨æœ«éƒ½è¿‡å»äº†......</li></ol><p>ä½•å†µä¹‹å‰å°±æ—©åœ¨çœ‹ï¼Œåªæ˜¯å‘¨æœ«æ‰å¼€å§‹åœ¨å®é™…åŠ¨æ‰‹è€Œå·²ï¼Œæœ¬æ¥æ‰“ç®—æå®Œå‘¨æœ«è¡¥ä¸€ä¸‹ Unity å†…å­˜çŸ¥è¯†çš„ï¼Œç°åœ¨å·²ç»æ˜¯<s>å‘¨æ—¥æ™šä¸Š 10 ç‚¹å¤š</s> <s>å‘¨ä¸€</s> å‘¨äºŒäº†ï¼</p><p>èŠ±äº†è¿™ä¹ˆå¤šæ—¶é—´ï¼Œç®—æ˜¯å¯¹ä¸»é¢˜åŸºæœ¬æ¡†æ¶éƒ½æœ‰äº†ä¸ªè®¤è¯†... æ¯”å¦‚ï¼š</p><ul><li>ä½œè€…é¢„ç•™äº†å¾ˆå¤šè‡ªå®šä¹‰çš„å£å­ï¼š <code>source/_data/</code>  ç›®å½•åˆ›å»ºå¯¹åº” yml æˆ– styl å°±å¯ä»¥è¦†ç›–ä¸»é¢˜æœ¬æ¥é…ç½®å’Œæ ·å¼ (images.yml é…ç½®ä¹Ÿå¯ä»¥åœ¨è¿™è¦†ç›–)</li><li>åŠ¨æ€åŠ è½½åŠŸèƒ½ä½¿ç”¨ pjax å®ç°ï¼Œè‡ªå·±åŠ è„šæœ¬æƒ³é¡µé¢åˆå§‹åŒ–æ‰§è¡Œéœ€è¦ç»‘å¯¹åº”äº‹ä»¶</li><li>æµ‹è¯•éŸ³ä¹æ’­æ”¾å™¨æ³¨æ„æ­Œå•ç¼“å­˜é—®é¢˜</li><li>å¼•ç”¨è‡ªå®šä¹‰è„šæœ¬</li></ul><p>è™½ç„¶è‡ªä¿¡ä¸‹ä¸€æ¬¡æƒ³æ”¹ä»€ä¹ˆè‚¯å®šèƒ½æ›´å¿«æ‰¾åˆ°è¯¥æ”¹å“ªé‡Œï¼Œä½†å¿™æ´»è¿™ä¹ˆä¹…ï¼Œä¹ä¸€çœ‹ä¼¼ä¹åƒæ˜¯åˆæ²¡æ”¹åˆ°å•¥çš„æ ·å­ï¼Œè¿˜æ˜¯æ„Ÿè§‰æœ‰ç‚¹æƒ¨äº†ã€‚</p><p><s>å¤„ç†ä¸€ä¸‹æ”¶å°¾è¯¥ç¡è§‰äº†ï¼Œæœ¬æ¥æ€»ç»“è¿˜æ‰“ç®—å†å†™ç‚¹ä»€ä¹ˆçš„ï¼Œç®—äº†ç®—äº†ã€‚</s></p><p>å¼„å®Œæœç´¢å’Œæ‹–åŠ¨é—®é¢˜ï¼Œå†çœ‹äº†ä¸‹é¡µé¢ï¼Œçªç„¶åˆæƒ³æŠŠ cover å›¾ç‰‡ä¹ŸåŠ ä¸Šä¸€ç‚¹è’™ç‰ˆï¼Œä¸è¿‡è‚¯å®šéœ€è¦é™ä½é€æ˜åº¦ â€”â€” è™½ç„¶ CSS è‡ªå¸¦é€æ˜åº¦è°ƒæ•´ï¼Œä½†æ˜¯ä¸€å¼€å§‹æˆ‘ç«Ÿç„¶æ„å›¾é€šè¿‡ç¼–è¾‘å›¾ç‰‡æ¥æ§åˆ¶...(ï¾‰Ğ”`)ï¼Œä¸ç†Ÿæ‚‰çš„ä¸œè¥¿å°±æ˜¯è¿™æ ·ã€‚å¦å¤–å‘ç°ä½¿ç”¨  <code>background-attachment</code>  css å±æ€§ä¼šå¯¼è‡´åœ¨ cover ä¸Š repeat ä¸æ­£å¸¸ï¼Œå»æ‰å°±å¥½äº†ã€‚</p><p>å†çœ‹ä¸€çœ¼è€åšå®¢çš„æ ·å­ï¼š</p><p><img data-src="/blogimages/2022/2022-12-17/Snipaste_2022-12-20_10-28-08.jpg" alt="" /></p><p>æœ€åï¼Œæ·»åŠ äº†æœ€è¿‘è¯„è®ºåŠè‡ªå®šä¹‰è„šæœ¬é…ç½®çš„ï¼š <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NXSElTTUUvaGV4by10aGVtZS1zaG9rYS5naXQ=">Shoka</span><br /> æ·»åŠ è§£æ class='count_æ•°é‡ ' ä¸ºæœ€è¿‘è¯„è®ºæ•°é‡åŠŸèƒ½çš„ï¼š <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NXSElTTUUvTWluaVZhbGluZS5naXQ=">MiniValine</span> (åªæ”¹äº† *.min.js é‚£ä¸€ä¸ªè§£æçš„åœ°æ–¹)</p><p>åé¢å†æ•´ç†ä¸€ä¸‹è€æ–‡ç« çš„æ ‡ç­¾å’Œåˆ†ç±»ï¼Œè¿™æ¬¡åº”è¯¥å°±çœŸæå·®ä¸å¤šäº†ã€‚</p><h1 id="ç–‘é—®"><a class="anchor" href="#ç–‘é—®">#</a> ç–‘é—®</h1><p>å‡ºç°ä¸ªç–‘é—®ï¼Œè€Œä¸”æ²¡ç ”ç©¶å‡ºæ¥é—®é¢˜ï¼šæŒ‡å®šéšæœºçš„å›¾ç‰‡æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</p><p>å› ä¸º Hexo æ˜¯é™æ€çš„ï¼Œåªå¯èƒ½æ˜¯åæœŸä¿®æ”¹ã€‚</p><p>ç„¶åå´åˆæ²¡æ‰¾åˆ°é™¤äº†  <code>engine.js</code>  ç”Ÿæˆåšå®¢æ—¶è°ƒç”¨  <code>images.yml</code>  éšæœºå›¾ç‰‡çš„æ¥å£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªåœ¨ç”Ÿæˆæ—¶å°±åº”è¯¥å·²ç»è¢«å›ºå®šäº†ï¼Œè€Œä¸”ç ”ç©¶åŠå¤©ï¼Œå‘ç°åŠ¨æ€åˆ·æ–°é¡µé¢æ—¶æŸ¥è¯¢ç›¸å…³æ¥å£çš„æ•°æ® (å›¾ç‰‡é“¾æ¥) å°±å·²ç»å˜äº†ã€‚</p><p><img data-src="/blogimages/2022/2022-12-17/Snipaste_2022-12-23_14-58-37.jpg" alt="Imgs ä¸ä¹‹å‰çš„ä¸ä¸€æ ·äº†" /></p><p>æ‰€ä»¥è¦ä¹ˆè¿™ä¸ªåŠŸèƒ½æ˜¯ä½œè€…æ”¾åœ¨äº†å…¶å®ƒçš„å·²åˆå¹¶çš„å…¬å…±è„šæœ¬ä¸­ï¼Ÿä½†æ˜¯åˆæ²¡å‘ç°å“ªé‡ŒæŒ‡å®šçš„  <code>images.yml</code>  ä¸­çš„é…ç½®å›¾ç‰‡å€¼ã€‚</p><p>æ€»ä¸èƒ½ç”± Hexo åŠ¨æ€éšæœºå‡ºæ¥çš„å§ï¼Ÿæƒ³ä¸é€šã€‚</p><hr /><p>ç»è¿‡å¤šæ–¹é¢ç ”ç©¶ï¼Œç ´æ¡ˆäº† â€”â€” è¿™ä¸œè¥¿è¿˜çœŸæ˜¯å®æ—¶ç”Ÿæˆçš„ï¼</p><p>æµ‹è¯•æ–¹æ³•æ˜¯ç»™  <code>hexo.extend.helper</code>  å¤šç»‘ä¸€ä¸ªè®¡ç®—æ—¶é—´çš„ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>hexo<span class="token punctuation">.</span>extend<span class="token punctuation">.</span>helper<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'_date'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">language</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ç„¶ååœ¨ç”Ÿæˆå›¾ç‰‡é‚£ç»™åŠ ä¸Šå»ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"item"</span> data<span class="token operator">-</span>background<span class="token operator">-</span>image<span class="token operator">=</span><span class="token string">"&#123; image &#125;"</span> date<span class="token operator">=</span><span class="token string">"&#123; _date() &#125;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr></table></figure><p>è¿è¡Œæ—¶ï¼Œè¿™ä¸ªæ—¶é—´ä¸€ç›´åœ¨å˜åŒ–ï¼š</p><p><img data-src="/blogimages/2022/2022-12-17/Snipaste_2022-12-23_15-31-04.jpg" alt="" /></p><p>è¯´æ˜ä¸æ˜¯é™æ€çš„ï¼Hexo ä»€ä¹ˆæ—¶å€™æ”¯æŒè¿™ç§åŠ¨æ€æ‰§è¡Œç”Ÿæˆé¡µé¢çš„æ–¹æ³•äº†ï¼Ÿ</p><p>ç„¶è€Œæˆ‘ä»¬ç”Ÿæˆåä¸Šä¼ çš„ä¸œçš„ç¡®åˆæ˜¯çº¯é™æ€çš„ä¸œè¥¿... æƒ³ä¸æ˜ç™½ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ€ä¹ˆè¯´å‘¢... ä¸€å¼€å§‹æ ¹æœ¬æ²¡æƒ³èŠ±è¿™ä¹ˆå¤šæ—¶é—´å»æ¢ä¸»é¢˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹æˆ‘åªæ˜¯å•çº¯æƒ³ç»™è€ä¸»é¢˜ &lt;span class=&quot;exturl&quot; data-url=&quot;aH</summary>
      
    
    
    
    <category term="åšå®¢" scheme="https://cwhisme.github.io/categories/%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="åšå®¢" scheme="https://cwhisme.github.io/tags/%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
  <entry>
    <title>ä¸º Anodyne ä¸»é¢˜å¢åŠ ç›®å½•è¡¨ç°</title>
    <link href="https://cwhisme.github.io/2022/12/17/%E4%B8%BAAnodyne%E4%B8%BB%E9%A2%98%E5%A2%9E%E5%8A%A0%E7%9B%AE%E5%BD%95%E8%A1%A8%E7%8E%B0/"/>
    <id>https://cwhisme.github.io/2022/12/17/%E4%B8%BAAnodyne%E4%B8%BB%E9%A2%98%E5%A2%9E%E5%8A%A0%E7%9B%AE%E5%BD%95%E8%A1%A8%E7%8E%B0/</id>
    <published>2022-12-17T07:38:52.000Z</published>
    <updated>2022-12-19T12:21:07.275Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h1><p>ä¸çŸ¥é“å“ªé‡Œçš„æƒ³æ³•ï¼Œæƒ³ç»™æ–‡ç« åŠ ä¸ªç›®å½•ï¼Œæ–¹ä¾¿é¢„è§ˆï¼šå¯èƒ½å› ä¸º <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tsdWdqby9oZXhvLXRoZW1lLWFub2R5bmU=">anodyne</span> ä¸»é¢˜æœ¬èº«çš„æ’ç‰ˆæ˜¾ç¤ºï¼Œè®©äººæœ‰ç‚¹åˆ†ä¸æ¸…æ ‡é¢˜å­çº§ï¼Ÿ(æŒ‡ä¸€çº§æ ‡é¢˜ã€äºŒçº§æ ‡é¢˜è¿™ç§)</p><p>äºæ˜¯æƒ³æ‰¾ä¸€ä¸ªæœ‰ç›®å½•çš„ä¸»é¢˜çœ‹çœ‹ï¼Œèƒ½ä¸èƒ½å‚è€ƒä¸‹ï¼šäºæ˜¯å°±å¼€å§‹æœç´¢ ã€Hexo ä¸»é¢˜ã€</p><h1 id="ç ”ç©¶"><a class="anchor" href="#ç ”ç©¶">#</a> ç ”ç©¶</h1><h2 id="ç›®å½•è·Ÿéšæ•ˆæœ"><a class="anchor" href="#ç›®å½•è·Ÿéšæ•ˆæœ">#</a> ç›®å½•è·Ÿéšæ•ˆæœ</h2><p>å¼€å§‹å­å­å“§å“§æ”¹è‡ªå·±çš„è€ä¸»é¢˜ï¼Œç”¨ toc åŠ ä¸Šç›®å½•åï¼Œæ„Ÿè§‰ç›®å½•åº”è¯¥æ ¹æ®é¡µé¢æ»‘åŠ¨è€Œæµ®åŠ¨ï¼Œä½†æ˜¯ç”±äºç›®å½•å¤„äºæ•´ä¸ªå³ä¾§ç•Œé¢çš„å­çº§ï¼Œç°åœ¨çš„éœ€æ±‚æ˜¯ï¼š</p><blockquote><p>widget ä¸èƒ½åŠ¨ï¼Œåªæœ‰å½“é¡µé¢æ»‘åŠ¨è¶…å‡º toc èµ·å§‹èŒƒå›´æ—¶ï¼Œä»… toc è·Ÿéšé¡µé¢æ»‘åŠ¨</p></blockquote><p>åŸºæœ¬è¡¨ç°å¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-12-17/Snipaste_2022-12-19_14-58-46.jpg" alt="è¡¨ç°" /></p><p>ç°åœ¨çš„å¤§æ¦‚ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>widget<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>toc å°±æ˜¯ç›®å½•</p><p>ä¸”ä¸è¯´ç»„ä»¶è·Ÿæ–‡ç« ä¸æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œç”¨ fixed ä¹‹ç±»çš„å±æ€§åªèƒ½ä¸€ç›´å›ºå®šåœ¨ä¸€ä¸ªä½ç½®ï¼Œéš¾é“æ”¹è¿™ä¸ªæˆ‘è¿˜è¦å†™ js ä»£ç åŠ¨æ€å»è®¾ç½® css èŠ‚ç‚¹å±æ€§ä¹ˆï¼Ÿ</p><p>äºæ˜¯å¼€å§‹ é¢å‘æœç´¢ç¼–ç¨‹ğŸ˜Š ï¼Œæ‰¾äº†ä¸‹ï¼Œå…ˆæ˜¯æ‰¾åˆ° <span class="exturl" data-url="aHR0cHM6Ly93d3cuY29kZW5vbmcuY29tLzY3OTQwMDAv">å…³äº CSSï¼šå›ºå®šä½ç½®ï¼Œä½†ç›¸å¯¹äºå®¹å™¨</span>ï¼Œå¾—çŸ¥äº†  <code>position sticky</code>  è¿™æ¡å±æ€§ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šåœ¨æ¦‚å¿µä¸Šç±»ä¼¼äº position: fixedã€‚åŒºåˆ«åœ¨äºï¼Œå…·æœ‰ position: sticky çš„å…ƒç´ åœ¨å…¶çˆ¶çº§ä¸­çš„è¡Œä¸ºç±»ä¼¼äº position: relativeï¼Œç›´åˆ°åœ¨è§†å£ä¸­æ»¡è¶³ç»™å®šçš„åç§»é˜ˆå€¼ä¸ºæ­¢ã€‚</p><p>ç°åœ¨éœ€æ±‚å¯ä»¥åšäº†ï¼Œé‚£ä¹ˆä½™ä¸‹çš„é—®é¢˜å°±æ˜¯ï¼šè®© toc å®¹å™¨å¤§å°ä¸ content ä¸€è‡´ â€”â€” æ‰€ä»¥ widget å¤§å°ä¹Ÿå¿…é¡»ä¸ content ä¸€è‡´ï¼Œå¦åˆ™ widget å®é™…é«˜åº¦å¤šå°‘å°±æ˜¯å¤šå°‘ï¼Œé¡µé¢å°±ç®— 1000 ä¸ªé«˜åº¦ï¼Œ widget å¯èƒ½ä¹Ÿè¿˜æ˜¯ 200 ä¸ªé«˜åº¦ã€‚</p><p>å› ä¸ºæ•´ä¸ªé¡µé¢ä¸»è¦é  content æ’‘èµ·æ¥çš„ï¼Œä¸ç®¡æ˜¯è®¾ç½® toc è¿˜æ˜¯ widgetï¼Œéƒ½æ²¡æ³•è®©å¦å¤–ä¸€è¾¹çš„è‡ªé€‚åº” contentã€‚</p><p>ç„¶ååˆæ‰¾åˆ°ä¸€ä¸ªæ–‡ç«  <a href="https://blog.csdn.net/ltmtianming/article/details/109588841">css å®ç° div çš„é«˜åº¦éšç€å¦ä¸€ä¸ª div çš„é«˜åº¦æ”¹å˜<br /></a></p><p>å…ˆæ˜¯å‚è€ƒä¸Šé¢çš„è®¾ç½®ï¼Œå°† widget è®¾ç½®ä¸º  <code>position: absolute</code> ï¼Œå®¹å™¨å¤§å°ä¿æŒä¸æ•´ä¸ªé¡µé¢é«˜åº¦ä¸€è‡³ï¼Œtoc è®¾ç½®ä¸º  <code>position sticky</code></p><p>ç»“æœä¸è¡Œï¼Œäºæ˜¯ç»§ç»­ç ”ç©¶ï¼šæœ€åå¾—å‡ºç»“è®ºæ˜¯ parent æ˜¯é»˜è®¤é™æ€çš„ï¼Œå³  <code>position: static</code> ã€‚</p><blockquote><p>staticï¼Œé™æ€å®šä½ï¼ŒHTML å…ƒç´ çš„é»˜è®¤å€¼ï¼Œå³æ²¡æœ‰å®šä½ï¼Œå…ƒç´ å‡ºç°åœ¨æ­£å¸¸çš„æµä¸­ã€‚ é™æ€å®šä½çš„å…ƒç´ ä¸ä¼šå—åˆ° top, bottom, left, right, z-index å½±å“ã€‚</p></blockquote><p>äºæ˜¯åˆæ˜¯ä¸€é€šæ”¹ï¼ŒæˆåŠŸè§£å†³ã€‚</p><h2 id="æ‰‹æœºç«¯é”™ä½é—®é¢˜"><a class="anchor" href="#æ‰‹æœºç«¯é”™ä½é—®é¢˜">#</a> æ‰‹æœºç«¯é”™ä½é—®é¢˜</h2><p>æ„Ÿè§‰æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸Šä¼ æœåŠ¡å™¨ã€‚</p><p>ä¸è¿‡å¾ˆå¿«å°±å‘ç°ï¼šæ‰‹æœºç«¯é¢„è§ˆåˆæœ‰é—®é¢˜äº†ã€‚</p><p>ç”±äºå·²ç»ä¿®å¤äº†ï¼Œç°åœ¨ä¹Ÿçœ‹ä¸åˆ°æˆªå›¾ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥æƒ³è±¡ï¼š</p><ul><li>parent relative</li><li>widget absolute</li></ul><p>é‚£ä¹ˆåœ¨ content ä¸ widget å®½åº¦ä¸è¶³ä»¥åŒæ—¶æ˜¾ç¤ºçš„æ—¶å€™ï¼Œä»–ä»¬å°±æ²¡æ³•è‡ªåŠ¨æ’ç‰ˆäº†ã€‚äºæ˜¯ä¸¤è€…æŒ¤åœ¨äº†ä¸€å—ï¼Œç›¸å½“äºå åŠ äº†èµ·æ¥ã€‚</p><p>æ€»ä¹‹çœ‹ç€æŒºç³Ÿç³•çš„ï¼Œäºæ˜¯æƒ³æƒ³è¦ä¸ç®—äº†å§ï¼Œç›®å½•ä¹Ÿä¸è¦æµ®åŠ¨å®šä½äº†ï¼Œè¿™éœ€æ±‚<s>æˆ‘å…¶å®æ²¡é‚£ä¹ˆå¼ºçƒˆ</s>ã€‚</p><p>ä¸‹æ¥åæƒ³ç€æƒ³ç€åˆä¸å¤§ç”˜å¿ƒï¼Œäºæ˜¯å†æ¬¡ä¸€é€šç ”ç©¶ï¼Œå‘ç°äº† <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvQ1NTL2ZsZXg=">flex</span> è¿™ä¸ªè‡ªå®šå®šä½æ’ç‰ˆçš„å®¹å™¨å±æ€§ã€‚ç«‹åˆ»æƒŠä¸ºå¤©äººï¼Œé©¬ä¸Šç”¨èµ·æ¥ï¼Œè§£å†³äº†ç›®å½•é—®é¢˜ã€‚</p><h1 id="æƒ³æ¢æ–°ä¸»é¢˜äº†"><a class="anchor" href="#æƒ³æ¢æ–°ä¸»é¢˜äº†">#</a> æƒ³æ¢æ–°ä¸»é¢˜äº†ï¼</h1><p>ç„¶ååœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œçœ‹ç€å…¶å®ƒçš„ä¸»é¢˜æ ·å¼ï¼Œçªç„¶å°±è§‰å¾—è‡ªå·±çš„åšå®¢ä¸»é¢˜ä¹Ÿå¤ª... ç®€æ´äº† â€”â€” è™½ç„¶è¿™ä¸ªç®€æ´ä¹Ÿæ˜¯ä»¥å‰æˆ‘è§‰å¾—æŒºå¥½çœ‹çš„ï¼Œç°åœ¨å´æƒ³å†åŠ ç‚¹ä»€ä¹ˆã€‚</p><p>æ¯”å¦‚çœ‹ç€ Shoka çš„éšæœºèƒŒæ™¯ï¼Œäºæ˜¯åˆäº†è§£åˆ°äº† éšæœºäºŒæ¬¡å…ƒå›¾ç‰‡ æ¥å£è¿™å›äº‹ï¼Œäºæ˜¯æƒ³è¦..... æ•´ä¸€ä¸ªã€‚</p><p>æ‰¾äº†ä¸‹èµ„æ–™ï¼Œä¾‹å¦‚ç”¨è¿™ç§æ–¹å¼å°±å¯ä»¥å–å¾—ä¸€ä¸ªéšæœºå›¾ç‰‡ï¼š</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">fetch</span> <span class="token punctuation">(</span><span class="token string">"https://www.dmoe.cc/random.php?return=json"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=></span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>imgurl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>äºæ˜¯å†åœ¨è‡ªå·±çš„ä¸»é¢˜ä¸Šï¼Œæ‰¾ä¸ªåˆé€‚çš„ä½ç½®è´´ä¸Šå»ï¼Œå°±å¯ä»¥éšæœºå±•ç¤ºå›¾ç‰‡äº†å¯¹å§ï¼Ÿç¨å¾®ç ”ç©¶äº†ä¸€ä¸‹ä¸‹..... æ²¡å®Œæ²¡äº†äº†æ˜¯å§ï¼(æ‘” (ï¾‰ï½€âŠ¿Â´)ï¾‰)</p><p>è¿™æ ·ä¸å¦‚... ç›´æ¥æŠŠä¸»é¢˜æ¢äº†ï¼Ÿ</p><p>ç‰¹åˆ«æ˜¯çœ‹ç€è‡ªå·±ä¸»é¢˜çš„ä»£ç æ ·å¼ã€Markdown è§£ææ˜¾ç¤ºçš„æ ·å¼ï¼Œè™½ç„¶ä»¥å‰æ„Ÿè§‰ç®€æ´ä¹Ÿä¸é”™... ç°åœ¨æ€ä¹ˆçœ‹æ€ä¹ˆæ„Ÿè§‰ä¸é¦™äº†ã€‚</p><hr /><p>æ‰€ä»¥...?</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h1&gt;
&lt;p&gt;ä¸çŸ¥é“å“ªé‡Œçš„æƒ³æ³•ï¼Œæƒ³ç»™æ–‡ç« åŠ ä¸ªç›®å½•ï¼Œæ–¹ä¾¿é¢„è§ˆï¼šå¯èƒ½å› ä¸º &lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly9naXRodWIuY29</summary>
      
    
    
    
    <category term="åšå®¢" scheme="https://cwhisme.github.io/categories/%E5%8D%9A%E5%AE%A2/"/>
    
    
  </entry>
  
  <entry>
    <title>åå˜å’Œé€†å˜</title>
    <link href="https://cwhisme.github.io/2022/12/10/%E5%8D%8F%E5%8F%98%E5%92%8C%E9%80%86%E5%8F%98/"/>
    <id>https://cwhisme.github.io/2022/12/10/%E5%8D%8F%E5%8F%98%E5%92%8C%E9%80%86%E5%8F%98/</id>
    <published>2022-12-10T09:06:56.000Z</published>
    <updated>2022-12-22T03:29:48.152Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>å…³äºåå˜å’Œé€†å˜ï¼Œæ—©åœ¨å‰äº›æ—¥å­å°±åœ¨æƒ³æ•´ç†ä¸€ä¸‹äº†ï¼Œä¸è¿‡ç”±äºå‰å‡ å¤©ç ”ç©¶äº†ä¸‹ <a href="">Unity çš„é˜´å½±ä¸å…‰ç…§çƒ˜ç„™</a> ï¼Œæ‰€ä»¥ä¸€ç›´æ”¾åœ¨å¿ƒä¸Šå´æ²¡æœ‰å®æ–½ï¼Œéƒ½å¿˜äº†ä¹‹å‰æ˜¯å‡†å¤‡æƒ³æ€ä¹ˆå†™å¼€å¤´äº†... ä¹Ÿå¿˜äº†ä½œç¬”è®°ï¼Œåªèƒ½ç°åœ¨é‡æ–°æƒ³ä¸€æƒ³ã€‚</p><p>é€†å˜ å’Œ åå˜å…¶å®æ˜¯å¯¹é¢å‘å¯¹è±¡çš„ä¸€ä¸ªè¡¥å……ï¼Œåœ¨ C# ä¸­é€šè¿‡ in æ ‡è¯†é€†å˜ï¼Œout æ ‡è¯† åå˜ï¼Œå¦‚æœæ²¡æœ‰æ ‡è¯†ï¼Œé‚£ä¹ˆé»˜è®¤å°±æ˜¯ ã€ä¸å˜ã€ã€‚</p><p>ä¹‹å‰æƒ³æ€è€ƒäº†å¥½äº›å¤©äº†ï¼Œæ„Ÿè§‰æœ‰äº›åœ°æ–¹è¿˜æ˜¯æœ‰ç‚¹æ²¡æƒ³é€å½»ï¼Œè¿™æ¬¡æ•´ç†çš„åŒæ—¶è¿›è¡Œæ›´å¤šçš„è¯•éªŒï¼Œç¡®å®šè‡ªå·±çš„æƒ³æ³•å¯¹ä¸å¯¹ã€‚</p><h2 id="æè¿°"><a class="anchor" href="#æè¿°">#</a> æè¿°</h2><p>å˜ä½“ä»…é’ˆå¯¹å¼•ç”¨ç±»å‹ï¼Œä¸”åªæœ‰ æ•°ç»„ (éšå¼åå˜)ã€æ³›å‹å§”æ‰˜ã€æ³›å‹æ¥å£ å¯ä»¥ä½¿ç”¨ã€‚</p><p><font color=red>æ³¨ï¼šå¯¹äºåŒä¸€æ³›å‹å‚æ•°ï¼Œé€†å˜å’Œåå˜ä¸èƒ½åŒæ—¶å­˜åœ¨ã€‚</font></p><p>æ­£å¸¸æ¥è¯´ï¼Œæ ¹æ®é‡Œæ°æ›¿æ¢åŸåˆ™ï¼šå­ç±»å‹ï¼ˆsubtypeï¼‰å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰ä»–ä»¬çš„åŸºç±»å‹ï¼ˆbase typeï¼‰</p><p>æˆ‘ä»¬é€šå¸¸åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œä¹Ÿä¼šä¸è‡ªè§‰åœ°ç”¨åˆ°è¿™ä¸€ç‚¹ï¼šä¾‹å¦‚æ´¾ç”Ÿå‡ºå¤šä¸ªå­ç±»çš„çˆ¶ç±»ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªã€ç»Ÿä¸€çš„æ–¹æ³•å‚æ•°ã€æ¥å—å­ç±»ä¼ é€’ç„¶åå¤„ç†ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token class-name">Parent</span> pt<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>pt<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token class-name">Child</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token class-name">ChildBoy</span> childBoy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ChildBoy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">Log</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token function">Log</span><span class="token punctuation">(</span>childBoy<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥è¯´ä¸€ä¸ªç±»æ˜¯å¦ä¸€ä¸ªç±»çš„åŸºç±»ï¼Œä½†æ˜¯ä¸€ä¸ªæ¥å£ã€ä¸€ä¸ªå§”æ‰˜æ­£å¸¸æ˜¯æ²¡æœ‰è¿™ç§å…³ç³»çš„ï¼Œæ‰€ä»¥å½“åŒ…è£¹ä¸€å±‚ (å§”æ‰˜ã€æ¥å£) åå°±ä¸è¡Œäº† â€”â€” ç†è®ºä¸Šå®ƒä»¬å¹¶æ²¡æœ‰å­ç±»æŒ‡å‘çˆ¶ç±»çš„å…³ç³»ã€‚</p><p>æ³›å‹æ˜¯å¯¹ç±»å‹ç³»ç»Ÿçš„è¿›ä¸€æ­¥æŠ½è±¡ï¼Œä¸Šé¢çš„å˜åŒ–æ˜ å°„è‡³ (æ•°ç»„ã€æ³›å‹å§”æ‰˜ã€æ³›å‹æ¥å£) å°±æ˜¯é€†å˜ä¸åå˜çš„æ¦‚å¿µã€‚</p><p>ä»ç®€å•è¡¨ç°ä¸Šæ¥çœ‹ï¼š</p><ul><li>åå˜ç”¨äºéšå¼å°†è¿”å›å‚æ•° (å®¹å™¨) çš„å­ç±»è½¬ä¸ºçˆ¶ç±»</li><li>é€†å˜ç”¨äºéšå¼å°†ä¼ å…¥å‚æ•° (å®¹å™¨) çš„çˆ¶ç±»è½¬ä¸ºå­ç±»</li></ul><p>æƒ³æƒ³çœ‹ï¼š</p><ul><li>å â€”â€” å­ç±»æŒ‡å‘çˆ¶ç±»çš„å…³ç³»ç¬¦åˆåŸå§‹çš„å…³ç³»è½¬æ¢æ–¹å‘</li><li>é€† â€”â€” çˆ¶ç±»è½¬å­ç±»</li></ul><h2 id="æµ‹è¯•"><a class="anchor" href="#æµ‹è¯•">#</a> æµ‹è¯•</h2><h3 id="æµ‹è¯•åå˜"><a class="anchor" href="#æµ‹è¯•åå˜">#</a> æµ‹è¯•åå˜</h3><h4 id="1-æ•°ç»„"><a class="anchor" href="#1-æ•°ç»„">#</a> (1) æ•°ç»„</h4><p>æ•°ç»„çš„åå˜ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½ä¸è‡ªè§‰ä½¿ç”¨è¿‡ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> strings <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">object</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> objects <span class="token operator">=</span> strings<span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å°±æ˜¯æ•°ç»„éšå¼æ”¯æŒçš„åå˜ï¼šæˆ‘ä»¬å¯ä»¥æŠŠå­ç±»æ•°ç»„ç›´æ¥èµ‹å€¼ç»™å®šä¹‰çš„åŸºç±»æ•°ç»„ã€‚</p><p>ä¸Šé¢å·²ç»è§£é‡Šè¿‡ï¼Œåå˜ç”¨äº ã€è¿”å›å€¼éšå¼è½¬æ¢ä¸ºçˆ¶ç±»ã€</p><blockquote><p>å› ä¸ºä¸ç®¡å¦‚ä½•ä»æ•°ç»„ä¸­å–å€¼ï¼šstrings [index] éƒ½å¯ä»¥è½¬ä¸º object</p></blockquote><p>ç¬¦åˆ ã€å­ç±»æŒ‡å‘çˆ¶ç±»çš„å…³ç³»ã€ï¼Œåå˜æˆç«‹ã€‚</p><h4 id="2-æ¥å£"><a class="anchor" href="#2-æ¥å£">#</a> (2) æ¥å£</h4><p>æ¥å£çš„åå˜ä»¥ C# å†…ç½® IReadOnlyList æ¥å£ä¸ºä¾‹ï¼Œè¯¥æ¥å£æ ‡è®°äº† outï¼ŒList å°±å®ç°äº†è¯¥æ¥å£ã€‚</p><p>é¦–å…ˆå®šä¹‰ä¸¤ä¸ªæœ‰çˆ¶å­å…³ç³»çš„å¼•ç”¨å¯¹è±¡ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Parent</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">return</span> <span class="token string">"Parentï¼šçˆ¶ç±»"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Parent</span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">return</span> <span class="token string">"Childï¼šå­ç±»"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ç„¶åè¿›è¡Œè°ƒç”¨æµ‹è¯•ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">List<span class="token punctuation">&lt;</span>Child<span class="token punctuation">></span></span> childList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Child<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//==== æŠ¥é”™ ==== åˆ—è¡¨æ˜¯æ™®é€šç±»ï¼Œæ²¡æœ‰ä¹Ÿä¸æ”¯æŒåå˜åŠŸèƒ½</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//List&lt;Parent> parentList = childList;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// æ­£å¸¸èµ‹å€¼ï¼Œåå˜ä½¿å¾—å£°æ˜å­ç±»çš„æ¥å£å¯éšå¼è½¬ä¸ºçˆ¶ç±»</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Parent<span class="token punctuation">></span></span> baseList <span class="token operator">=</span> childList<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>baseList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p><pre><code>Test (0.008s)---Childï¼šå­ç±»</code></pre><p>å¯èƒ½åœ¨è¿™é‡Œè¿˜ä¼šæœ‰ç‚¹ä¸æ˜ç™½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå†ä»¥ List å®ç°çš„å¦ä¸€ä¸ªæ¥å£  <code>IList&lt;T&gt;</code>  ä¸ºä¾‹ï¼ŒIList æ¥å£å¹¶æœªåšæ ‡è¯†ï¼Œå› æ­¤å®ƒæ˜¯ã€ä¸å˜ã€çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¿™æ ·èµ‹å€¼ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// æŠ¥é”™ï¼Œæç¤ºæ— æ³•éšå¼è½¬æ¢ List&lt;Child>->IList&lt;Panret></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">IList<span class="token punctuation">&lt;</span>Parent<span class="token punctuation">></span></span> list <span class="token operator">=</span> childList<span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä½œä¸ºã€ä¸å˜ã€çš„æ³›å‹æ¥å£ï¼Œæƒ³è¦å°†æ³›å‹å­ç±»èµ‹å€¼æ³›å‹çˆ¶ç±»å°±ä¼šå¾—åˆ°æŠ¥é”™ã€‚</p><p>ç°åœ¨åº”è¯¥å¤§æ¦‚æœ‰ç‚¹æ„Ÿè§‰äº† â€”â€” ç‰¹åˆ«æ˜¯å½“æ‹¥æœ‰å¤šä¸ªå­ç±»ï¼Œæˆ‘ä»¬æƒ³ç»Ÿä¸€æ¥æ”¶çš„æ—¶å€™ï¼Œæ‹¥æœ‰åå˜å°±å¯ä»¥ç›´æ¥è¿™æ ·å†™ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">List<span class="token punctuation">&lt;</span>Child<span class="token punctuation">></span></span> childList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Child<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">List<span class="token punctuation">&lt;</span>ChildBoy<span class="token punctuation">></span></span> childList2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>ChildBoy<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ChildBoy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token class-name">List<span class="token punctuation">&lt;</span>ChildGirl<span class="token punctuation">></span></span> childList3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>ChildGirl<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ChildGirl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">Log</span><span class="token punctuation">(</span>childList<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">Log</span><span class="token punctuation">(</span>childList2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">Log</span><span class="token punctuation">(</span>childList3<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token class-name">IReadOnlyList<span class="token punctuation">&lt;</span>Parent<span class="token punctuation">></span></span> baseList<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>baseList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p><pre><code>Test (0.009s)---Childï¼šå­ç±»ChildBoyï¼šå­ç±»ChildGirlï¼šå­ç±»</code></pre><blockquote><p>å½“æˆ‘ä»¬è°ƒç”¨ childList [0] å¯ä»¥å¾—åˆ°ä¸€ä¸ª Child<br /> å½“æˆ‘ä»¬è°ƒç”¨ childList2 [0] å¯ä»¥å¾—åˆ°ä¸€ä¸ª ChildBoy<br /> å½“æˆ‘ä»¬è°ƒç”¨ childList3 [0] å¯ä»¥å¾—åˆ°ä¸€ä¸ª ChildGirl</p></blockquote><p>æœ€åä»æ¥å£å¾—åˆ°çš„è¿™ä¸ªå¯¹è±¡ï¼Œéƒ½å¯ä»¥å®‰å…¨è½¬ä¸º Parent<br /> ç¬¦åˆ ã€å­ç±»æŒ‡å‘çˆ¶ç±»çš„å…³ç³»ã€ï¼Œåå˜æˆç«‹ã€‚</p><h4 id="3-å§”æ‰˜"><a class="anchor" href="#3-å§”æ‰˜">#</a> (3) å§”æ‰˜</h4><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰æ¥è§¦æœ€å¤šçš„  <code>TResult Func&lt;out TResult&gt;</code>  å§”æ‰˜ï¼Œå®ƒçš„è¿”å›å€¼ä¹Ÿæ˜¯æ”¯æŒåå˜çš„ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">Func<span class="token punctuation">&lt;</span>Parent<span class="token punctuation">></span></span> parentFunc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">Func<span class="token punctuation">&lt;</span>Child<span class="token punctuation">></span></span> childFunc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>parentFunc <span class="token operator">=</span> childFunc<span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¸Šé¢å·²ç»è§£é‡Šè¿‡ï¼Œåå˜ç”¨äº ã€è¿”å›å€¼éšå¼è½¬æ¢ä¸ºçˆ¶ç±»ã€ï¼šå› ä¸º Child å¯ä»¥è½¬ä¸º Parentï¼Œæ‰€ä»¥ <code>Func&lt;Child&gt;</code>  ä¹Ÿå¯ä»¥å®‰å…¨è½¬ä¸º  <code>Func&lt;Parent&gt;</code> .</p><blockquote><p>å½“æˆ‘ä»¬è°ƒç”¨ childFunc () å¯ä»¥å¾—åˆ°ä¸€ä¸ª å­ç±»<br />å½“æˆ‘ä»¬è°ƒç”¨ parentFunc () å¯ä»¥å¾—åˆ°ä¸€ä¸ª çˆ¶ç±»<br />å½“ parentFunc=childFunc è°ƒç”¨å¯ä»¥å¾—åˆ°ä¸€ä¸ª çˆ¶ç±»</p></blockquote><p>ç¬¦åˆ ã€å­ç±»æŒ‡å‘çˆ¶ç±»çš„å…³ç³»ã€ï¼Œåå˜æˆç«‹ã€‚</p><h3 id="æµ‹è¯•é€†å˜"><a class="anchor" href="#æµ‹è¯•é€†å˜">#</a> æµ‹è¯•é€†å˜</h3><p>åå˜æ ‡è¯†è¿”å›å€¼ï¼Œé€†å˜æ ‡è¯†å‚æ•°ã€‚</p><p>è™½ç„¶å¬èµ·æ¥å·®ä¸å¤šï¼Œä¸è¿‡åå˜çœ‹ç€å…¶å®æ›´ç¬¦åˆæ€è€ƒï¼Œå› ä¸ºåŸºäºæ¥å£ã€å§”æ‰˜çš„æ‰§è¡Œè¿”å›å€¼æˆ‘ä»¬å¯ä»¥æ›´åŠ ç›´è§‚åœ°å¾—å‡ºç»“è®ºï¼Œé€†å˜å¯èƒ½å°±æ²¡é‚£ä¹ˆå®¹æ˜“ç†è§£äº†ã€‚</p><p>è¿˜æ˜¯å…ˆä»¥ C# å†…ç½® IComparable æ¥å£ä¸ºä¾‹ï¼Œè¯¥æ¥å£æ ‡è®°äº†é€†å˜ï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªç±»ï¼šParent å’Œ Childï¼Œå¹¶ä½¿ Parent å®ç°è¯¥æ¥å£ã€‚</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">IComparable<span class="token punctuation">&lt;</span>Parent<span class="token punctuation">></span></span> ip <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">IComparable<span class="token punctuation">&lt;</span>Child<span class="token punctuation">></span></span> iChild <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//==== æŠ¥é”™ ====</span></pre></td></tr><tr><td data-num="4"></td><td><pre>ip <span class="token operator">=</span> iChild<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// æ­£å¸¸èµ‹å€¼ï¼Œé€†å˜ä½¿å¾—å£°æ˜çˆ¶ç±»æ¥å£éšå¼è½¬ä¸ºå£°æ˜å­ç±»æ¥å£</span></pre></td></tr><tr><td data-num="6"></td><td><pre>iChild <span class="token operator">=</span> ip<span class="token punctuation">;</span></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œåè€Œæ˜¯ Child æ¥å£èƒ½å¤Ÿæ¥å— Parent æ¥å£å¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªåœ°æ–¹å°† iChild (å­ç±»æ¥å£) èµ‹å€¼ ip (çˆ¶ç±»æ¥å£) ä¸ºä»€ä¹ˆä¼šæŠ¥é”™å‘¢ï¼Ÿ</p><p>åœ¨ä¸Šé¢æˆ‘ä»¬å·²ç»æµ‹è¯•è¿‡åå˜äº†ï¼Œåå˜å¾—å‡ºçš„ç»“è®ºæ˜¯æœ€ç»ˆè¿”å›ç»“æœçš„ç±»å‹ä¸€å®šæ˜¯ç¬¦åˆè½¬æ¢è§„åˆ™çš„ï¼Œé‚£ä¹ˆè¿™é‡Œåº”è¯¥ä¹Ÿå¯ä»¥å…ˆä»æ‰§è¡Œç»“æœä¸Šè€ƒè™‘ï¼š</p><blockquote><p>è‹¥æ‰§è¡Œ  <code>IComparable&lt;Parent&gt;</code>  æ¥å£ï¼Œéœ€è¦æ¥å— Parent æˆ– Child å‚æ•°<br />è‹¥æ‰§è¡Œ  <code>IComparable&lt;Child&gt;</code>  æ¥å£ï¼Œåªèƒ½æ¥å— Child å‚æ•°</p></blockquote><ul><li>å¦‚æœæˆ‘ä»¬æŠŠ ip èµ‹å€¼ç»™ iChildï¼Œé‚£ä¹ˆåœ¨å‚æ•°ä¸­å°±å˜æˆåªèƒ½æ¥å— Child ç±»å‹äº†ã€‚</li><li>ä½†æ˜¯å¦‚æœæŠŠ iChild èµ‹å€¼ç»™ ipï¼Œé‚£ä¹ˆå‚æ•°ä¸­ç§å°±å˜æˆä¹Ÿå¯ä»¥æ¥å— Parent ç±»å‹äº†ã€‚</li></ul><p>æ‰€ä»¥ï¼ŒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>åŒºåˆ«åœ¨äºï¼š<font color=red>(1) ip æœ¬æ¥æ˜¯æ¥å—çˆ¶ç±»å‹ï¼Œå˜æˆåªèƒ½æ¥å—å­ç±»å‹ï¼Œæ˜¯åˆç†çš„ã€‚(2) iChild æœ¬æ¥åªèƒ½æ¥å—å­ç±»å‹ï¼Œå¦‚æœå˜æˆæ¥å—çˆ¶ç±»å‹å‚æ•°åˆ™ä¸åˆç†ã€‚</font></p><p>æƒ³ä¸€æƒ³ï¼Œä¸€ä¸ªæ–¹æ³•çš„å‚æ•°æ¥å—çš„æ˜¯å­ç±»ï¼Œä½†æ˜¯æŠŠçˆ¶ç±»ä¼ è¿›å»ï¼Œæ˜¯ä¸æ˜¯åªæœ‰å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Ÿä½†æ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢æ˜¯ä¸æ˜¯åˆæ¶‰åŠåˆ°è¿™ä¸ªã€çˆ¶ç±»å®é™…ä¸Šè£…çš„å¹¶ä¸æ˜¯è¿™ä¸ªå­ç±»ã€é—®é¢˜å‘¢ï¼Ÿ</p><p>è¯´å®è¯ï¼Œé€†å˜ç¡®å®æ„Ÿè§‰æ›´ç»•ï¼Œä½†ä»ç»“æœä¸Šæ¥çœ‹ï¼Œåˆèƒ½æ„Ÿè§‰ç¡®å®åº”å½“å¦‚æ­¤ã€‚</p><p>æ³›å‹å§”æ‰˜ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">Action<span class="token punctuation">&lt;</span>Parent<span class="token punctuation">></span></span> parentAction <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">=></span> Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">Action<span class="token punctuation">&lt;</span>Child<span class="token punctuation">></span></span> childAction <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">=></span> Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// æŠ¥é”™ï¼Œå› ä¸ºå¦‚æœèµ‹å€¼æˆåŠŸï¼Œè°ƒç”¨ parentAction (childAction) å°±å¯ä»¥ä¼ å…¥çˆ¶ç±»å‹äº†</span></pre></td></tr><tr><td data-num="4"></td><td><pre>parentAction <span class="token operator">=</span> childAction<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// æ­£å¸¸èµ‹å€¼ï¼ŒchildAction åªèƒ½æ¥å— Child ç±»å‹ï¼ŒparentAction æ¥å— Child ç±»å‹ç¬¦åˆçˆ¶ç±»æŒ‡å‘å­ç±»çš„å…³ç³»</span></pre></td></tr><tr><td data-num="6"></td><td><pre>childAction <span class="token operator">=</span> parentAction<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p>åå˜ (out) é€†å˜ (inï¼‰ï¼šæ•°ç»„æ˜¯åå˜çš„ - å­ç±»æ•°ç»„å¯ä»¥éšå¼è½¬ä¸ºçˆ¶ç±»æ•°ç»„ä½¿ç”¨ï¼Œåªèƒ½ç”¨äºã€æ•°ç»„ã€æ³›å‹å§”æ‰˜ã€æ³›å‹æ¥å£ã€ï¼Œåå˜ç”¨äºè¿”å›å€¼éšå¼è½¬ä¸ºçˆ¶ç±» (å®¹å™¨)ï¼Œé€†å˜ç”¨äºä¼ å…¥å€¼å¯ä»¥è¢«éšå¼è½¬ä¸ºå­ç±» (å®¹å™¨)(å½“ç„¶åœ¨è°ƒç”¨æ—¶ç±»å‹å°±å˜æˆç¡®å®šäº†)ï¼Œä¸å˜ï¼šä¸å¯äº’è½¬ï¼Œå˜ä½“ä»…é€‚ç”¨äºå¼•ç”¨ç±»å‹ã€‚</p><ul><li>é€†å˜å¸¸è§æ˜¯ Action &lt;å­ç±»&gt;=Action &lt; çˆ¶ç±» &gt;ï¼Œå‚æ•°ä¸ºçˆ¶ç±»çš„å§”æ‰˜èµ‹å€¼ç»™å‚æ•°å­ç±»çš„å§”æ‰˜ï¼Œè°ƒç”¨æ—¶å¿…é¡»ä¼ å…¥å­ç±»å¯¹è±¡ï¼Œæ ¹æ®é¢å‘å¯¹è±¡è§„åˆ™å­ç±»ä¸€å®šåŒ…å«çˆ¶ç±»å­—æ®µæˆ–æ–¹æ³•ï¼Œå¯ä»¥æ­£å¸¸è°ƒç”¨</li><li>åå˜å¸¸è§çš„æ¯”å¦‚ List å®ç°çš„ IEnumerableï¼Œæ­£å¸¸æƒ…å†µä¸‹ List &lt;å­ç±»å‹&gt; æ— æ³•èµ‹å€¼ç»™ List &lt; çˆ¶ç±»å‹ &gt;ï¼Œè¿™ä¸ªæ¥å£å°±æ ‡è®°äº†åå˜ï¼Œä½¿å¾—å¯ä»¥å£°æ˜ IEnumerabl &lt; çˆ¶ç±»å‹ &gt; = List &lt; å­ç±»å‹ &gt;</li><li>ä¹Ÿå¯ä»¥ç®€å•è®°ä¸ºï¼šåå˜å¯ä»¥ä½¿å¾—å£°æ˜ä¸ºçˆ¶ç±»çš„æ³›å‹å¯ä»¥è£…è½½å­ç±»ï¼Œé€†å˜ä½¿å¾—å£°æ˜å­ç±»çš„æ³›å‹å¯ä»¥å¯è£…è½½çˆ¶ç±»ï¼Œå…¶æœ€ç»ˆæ‰§è¡Œçš„è¿”å›å€¼ã€å‚æ•°ç¬¦åˆé‡Œæ°æ›¿æ¢åŸåˆ™ã€‚</li></ul><p>å¯¹äºè¿™ä¸¤è€…ï¼Œä»è¡¨ç°ä¸Šæ¥çœ‹ï¼š</p><ul><li>åå˜ï¼šå£°æ˜çš„æ³›å‹å®¹å™¨å­ç±»å¯ä»¥èµ‹å€¼çˆ¶ç±»</li><li>é€†å˜ï¼šå£°æ˜çš„æ³›å‹å®¹å™¨çˆ¶ç±»å¯ä»¥èµ‹å€¼å­ç±»</li></ul><p>ä»è°ƒç”¨ç»“æœä¸Šæ¥çœ‹ï¼š</p><ul><li>åå˜ï¼šè¿”å›ç»“æœç¬¦åˆé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œè¿”å›å€¼ä¸ºçˆ¶ç±»å‹çš„æ–¹æ³•ä¹Ÿå¯ä»¥è¿”å›å­ç±»å‹</li><li>é€†å˜ï¼šæ¥æ”¶å‚æ•°ç¬¦åˆé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå‚æ•°ä¸ºçˆ¶ç±»å‹çš„æ–¹æ³•å¯ä»¥æ¥å—å­ç±»å‹çš„å‚æ•°</li></ul><p>æ‰€ä»¥å›åˆ°å‰é¢çš„ä¸€ä¸ªé—®é¢˜ï¼šå¯¹äºåŒä¸€ä¸ªæ¨¡æ¿å‚æ•° T ï¼Œåå˜å’Œé€†å˜ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><blockquote><p>ä»”ç»†è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªæ¥å£å‚æ•°åŒæ—¶æ”¯æŒåå˜å’Œé€†å˜ï¼Œé‚£ä¹ˆä¸Šè¿°æµ‹è¯•çš„èµ‹å€¼æ–¹å¼å°±å¿…é¡»åŒæ—¶åŒå‘æ”¯æŒï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å‡ºç°ã€å‚æ•°ä¸ºå­ç±»å‹çš„æ¥å£ï¼Œå¯ä»¥ä¼ å…¥çˆ¶ç±»å‹ã€ï¼Œè¿™æ˜¯ä¸åˆæ³•çš„ã€‚<br />åä¹‹äº¦ç„¶ï¼Œè¿”å›å‚æ•°ä¸ºå­ç±»å‹çš„æ¥å£ï¼Œè¿”å›äº†å®é™…ä¸ºçˆ¶ç±»å‹çš„å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸åˆæ³•çš„ã€‚</p></blockquote><p>C# ä¸­å¸¸è§çš„è‡ªå¸¦åå˜é€†å˜çš„æ¥å£æˆ–å§”æ‰˜ï¼š</p><ul><li><code>IEnumerable&lt;out T&gt;</code></li><li><code>IEnumerator&lt;out T&gt;</code></li><li><code>System.Linq.IQueryable&lt;out T&gt;</code></li><li><code>IComparer&lt;in T&gt;</code></li><li><code>IComparable&lt;in T&gt;</code></li><li><code>IEqualityComparer&lt;in T&gt;</code></li><li><code>IReadOnlyList&lt;out T&gt;</code></li><li><code>TResult Func&lt;in T, out TResult&gt;(T arg) ç­‰</code></li><li><code>void Action&lt;in T&gt;(T obj) ç­‰</code></li><li>æ•°ç»„é»˜è®¤åå˜</li></ul><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><blockquote><p>å‚è€ƒæ–‡æ¡£ï¼š</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9sZWFybi5taWNyb3NvZnQuY29tL3poLWNuL2RvdG5ldC9zdGFuZGFyZC9nZW5lcmljcy9jb3ZhcmlhbmNlLWFuZC1jb250cmF2YXJpYW5jZQ==">covariance-and-contravariance</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vVlZTdHVkeS9wLzExNDA0MzAwLmh0bWw=">C# - åå˜ã€é€†å˜ çœ‹å®Œè¿™ç¯‡å°±æ‡‚äº†</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vQ0xSMDEwL3AvMzI3NDMxMC5odG1s">é€†å˜ä¸åå˜è¯¦è§£ </span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTmlucHV0ZXIvYXJjaGl2ZS8yMDA4LzExLzIyL2dlbmVyaWNfY292YXJpYW50Lmh0bWw=">.NET 4.0 ä¸­çš„æ³›å‹åå˜å’Œåå˜</span></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;å…³äºåå˜å’Œé€†å˜ï¼Œæ—©åœ¨å‰äº›æ—¥å­å°±åœ¨æƒ³æ•´ç†ä¸€ä¸‹äº†ï¼Œä¸è¿‡ç”±äºå‰å‡ å¤©ç ”ç©¶äº†ä¸‹ &lt;a href=&quot;&quot;&gt;Unity çš„é˜´å½±ä¸å…‰ç…§çƒ˜ç„™&lt;/a&gt; ï¼Œæ‰€ä»¥ä¸€ç›´æ”¾åœ¨å¿ƒä¸Šå´æ²¡æœ‰å®æ–½ï¼Œéƒ½å¿˜</summary>
      
    
    
    
    <category term="ç†è®ºç ”ç©¶" scheme="https://cwhisme.github.io/categories/%E7%90%86%E8%AE%BA%E7%A0%94%E7%A9%B6/"/>
    
    
    <category term="C#" scheme="https://cwhisme.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Unity çš„é˜´å½±ä¸å…‰ç…§çƒ˜ç„™</title>
    <link href="https://cwhisme.github.io/2022/12/06/Unity%E7%9A%84%E9%98%B4%E5%BD%B1%E4%B8%8E%E5%85%89%E7%85%A7%E7%83%98%E7%84%99/"/>
    <id>https://cwhisme.github.io/2022/12/06/Unity%E7%9A%84%E9%98%B4%E5%BD%B1%E4%B8%8E%E5%85%89%E7%85%A7%E7%83%98%E7%84%99/</id>
    <published>2022-12-06T10:32:41.000Z</published>
    <updated>2022-12-22T03:29:48.151Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>å‰å‡ å¤©è·ŸåŒäº‹è®¨è®º Unity Lightmap ï¼Œåœ¨ Shader (è‡ªå®šä¹‰) ä¸­æ˜¯æ€ä¹ˆå–çš„ï¼Œç„¶åæˆ‘è¯´ Unity åœ¨ Shader ä¸­ç›´æ¥ä¼šç»™æ•°æ®ï¼Œè°ƒç”¨ Unity æå¼„å‡½æ•°ç›´æ¥é‡‡æ ·å°±è¡Œäº†ã€‚</p><p>åŒäº‹è¡¨ç¤ºè¯´ï¼Œè¿™ä¸ªå…‰ç…§è´´å›¾ UV å‘¢ï¼Ÿå“ªé‡Œå–ã€‚</p><p>å½“æ—¶ä¹Ÿæ˜¯å›ç­”è¯´æ˜¯ Unity ç›´æ¥æä¾›çš„ï¼Œè™½è¯´å®é™…ä¹Ÿå·®ä¸å¤šï¼Œä¸è¿‡åé¢ä¸‹æ¥åˆæƒ³äº†æƒ³ï¼Œç»†èŠ‚æ–¹é¢ä¹Ÿå·²ç»è®°ä¸æ¸…äº†ã€‚</p><p>å†æƒ³åˆ°è¿‡å»ç ”ç©¶å…‰ç…§è¿™å—ï¼Œæ—©å·²ç»æ˜¯å¤šå¹´å‰çš„äº‹äº†ï¼Œäºæ˜¯é‡æ–°å®é™…è¯•äº†è¯•ï¼Œç›´æ¥æŠŠå…‰ç…§çƒ˜ç„™è¿™å—éƒ½é‡æ–°äº†è§£äº†ä¸‹ï¼Œç®€å•åšä¸ªè®°å½•ã€‚</p><p>ä¸»è¦ä½¿ç”¨å·¥å…·æœ‰ï¼š</p><ul><li>Unity3D 2021.3.6f1</li><li>é»˜è®¤æ¸²æŸ“ç®¡çº¿</li><li>Forward RenderPath</li><li>Standard Shader</li></ul><h2 id="lightmapping-æ•°æ®"><a class="anchor" href="#lightmapping-æ•°æ®">#</a> LightMapping æ•°æ®</h2><p>é¦–å…ˆå›åˆ°ä¸Šé¢é‚£ä¸ªé—®é¢˜ï¼Œå…‰ç…§çƒ˜ç„™åï¼Œä¼šä¸ºåœºæ™¯ç”Ÿæˆå¯¹åº”å…‰ç…§è´´å›¾ï¼Œè´´å›¾æ•°æ®æœ¬èº«ä½äºåœºæ™¯åŒååŒçº§çš„å­ç›®å½•ä¸­ï¼ŒLighting è®¾ç½®ä¸­ LightMaps ä¼šè‡ªåŠ¨è¢«è®¾ç½®ä¸Šå»ï¼Œæ­¤æ—¶ç›´æ¥åœ¨åŒåœºæ™¯å¯¹åº”é™æ€ç‰©ä½“ä¸Šä¹Ÿèƒ½é¢„è§ˆï¼š</p><p><img data-src="/blogimages/2022/2022-12-06/m_40890511256b2a6d713c9161123984d2_r.png" alt="" /></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ Lightmap Indexã€TilingXã€TilingYã€OffsetXã€OffsetY è¿™ç±»å‚æ•°è™½ç„¶çœ‹èµ·æ¥æ˜¯ç›´æ¥è®°å½•åœ¨åœºæ™¯å¯¹è±¡ä¸Šçš„ï¼Œå®é™…å¹¶ä¸æ˜¯ï¼Œæœ€ç®€å•çš„æµ‹è¯•æ–¹æ³•å°±æ˜¯å°†è¯¥å¯¹è±¡å­˜å‚¨ä¸º Prefab (æˆ–è€…å¤åˆ¶ä¸€ä»½)ï¼Œå°±ä¼šå‘ç° Prefab ä¸Šçš„ LightMap ä¿¡æ¯å·²ç»ä¸¢å¤± â€”â€” å†æ”¾å›å»ä¹Ÿæ˜¯ä¸¢å¤±çŠ¶æ€ (å¯èƒ½æ˜¯ä¸ºäº†é¿å…æ±¡æŸ“ Prefab)ã€‚<br />å½“ç„¶æ­¤æ—¶ä¹Ÿå¯ä»¥é€šè¿‡è®°å½• Render.lightmapIndex ä¹‹ç±»çš„ï¼Œé€šè¿‡è„šæœ¬ç»™è¿˜åŸã€‚</p><p>åŠ¨æ€åŠ è½½ Lightmap ä¸€èˆ¬éƒ½è¯¥æ˜¯é€šè¿‡è¿™ç§æ–¹å¼è¿›è¡Œï¼šå…ˆç»™ LightmapSettings.lightmaps èµ‹å€¼å¯¹åº”çš„ Lightmap æ•°æ®ã€è´´å›¾ï¼Œç„¶åç»™åœºæ™¯é™æ€ç‰©ä½“ Render è®¾ç½®ä¸Šå¯¹åº”çš„ lightmapIndex ç­‰æ•°æ®ï¼ŒShader ä¸­å°±èƒ½é€šè¿‡ Unity æä¾›çš„å‡½æ•°è¯†åˆ«ç„¶åé‡‡æ ·ã€‚</p><p>æ³¨ 1ï¼šçƒ˜ç„™å…‰ç…§è´´å›¾ Shader ä¸­é€šè¿‡ TEXCOORD1 é‡‡æ ·ï¼š</p><blockquote><p>Unity stores baked lightmap UVs in its mesh in the Mesh.uv2 channel. This channel maps to the TEXCOORD1 shader semantic, and is commonly called â€œUV1â€.</p></blockquote><p>æ³¨ 2ï¼šå®æ—¶å…‰ç…§è´´å›¾ Shader ä¸­é€šè¿‡ TEXCOORD2 é‡‡æ ·ï¼ˆå‹¾é€‰ Lighting-&gt;Realtime Lighting ç”Ÿæ•ˆï¼‰ï¼š</p><blockquote><p>Unity can use data in the Mesh.uv3 channel as input for the real-time lightmap UV calculations. Mesh.uv3 maps to the TEXCOORD2 shader semantic, and is commonly called â€œUV2â€.</p></blockquote><h2 id="å…‰æºä¸é˜´å½±"><a class="anchor" href="#å…‰æºä¸é˜´å½±">#</a> å…‰æºä¸é˜´å½±</h2><p>æ¯ä¸€ä¸ªå…‰æºï¼Œè‹¥å…‰æºæ˜¯å®æ—¶çš„ï¼Œå¯¹äºåŠ¨æ€ç‰©ä½“è‡³å°‘æ˜¯åŒå€æ¶ˆè€—ï¼Œå¯¹äºé™æ€ç‰©ä½“ä¹Ÿä¸€æ ·ã€‚</p><p>æ¶ˆè€—ç‚¹ä¸»è¦åœ¨äºåŠ¨æ€é˜´å½±ä¸Šï¼Œåœ¨ Forwardbase Render Path ä¸­ï¼Œç»˜åˆ¶é˜´å½±åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šè‡ªå·±æ¥æ”¶é˜´å½±ä»¥åŠæŠ•å°„é˜´å½±ï¼ŒMeshRender ä¸Šä¹Ÿå¯ä»¥å•ç‹¬åœ¨ Lighting é€‰é¡¹è®¾ç½®å¼€å…³ã€‚</p><ul><li>æ˜¯å¦æœ‰é˜´å½±è·Ÿä¸‰ä¸ªæ¡ä»¶æœ‰å…³ï¼š<ul><li>(1) Shader ä¸­çš„ æ¥æ”¶æŠ•å°„é˜´å½± Pass</li><li>(2) Render ä¸Šçš„æ¥æ”¶æŠ•å°„å¼€å…³</li><li>(3) å…‰æºæ˜¯å¦è®¾ç½®é˜´å½±</li></ul></li></ul><p>æŠ•å°„é˜´å½±çš„ Pass æ˜¯ç‰¹æœ‰çš„ä¸€ä¸ªï¼Œå®ƒä¼šå°†è‡ªèº«åˆ°å…‰æºçš„æ–¹å‘æ¸²æŸ“è‡³ä¸€å¼ æ·±åº¦å›¾ï¼ŒæŠ•å°„åŠé‡‡æ ·çš„å¤§æ¦‚æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li><p>Shader ä¸­é˜´å½±æŠ•å°„ Pass å¿…é¡»ï¼š</p><ul><li>æ‰“ Tags {&quot;LightMode&quot;:&quot;ShadowCaster&quot;}ï¼Œæ ‡è®°è¯¥ Pass ä¸“ç”¨äºé˜´å½±æŠ•å°„</li><li>å¢åŠ é¢„ç¼–è¯‘æŒ‡ä»¤ #pragma multi_compile_shadowcaster</li><li>åœ¨é¡¶ç‚¹ã€ç‰‡æ®µä¸­è°ƒç”¨ Unity æä¾›çš„é¢„å®šä¹‰è¿›è¡Œå¤„ç†ï¼šV2F_SHADOW_CASTERã€TRANSFER_SHADOW_CASTER_NORMALOFFSETã€SHADOW_CASTER_FRAGMENT<ul><li>V2F_SHADOW_CASTERï¼šé¡¶ç‚¹åˆ°ç‰‡æ®µæ•°æ®å˜é‡ï¼Œç›´æ¥åœ¨ v2f å®šä¹‰å³å¯</li><li>TRANSFER_SHADOW_CASTER_NORMALOFFSETï¼šåœ¨é¡¶ç‚¹ Shader å‡½æ•°ä¸­è®¡ç®—äº† ç‰©ä½“é¡¶ç‚¹ä¸–ç•Œåæ ‡ -(å‡) å…‰æºåæ ‡ï¼Œå³å½“å‰é¡¶ç‚¹åˆ°å…‰æºå‘é‡</li><li>SHADOW_CASTER_FRAGMENTï¼šåœ¨ç‰‡æ®µ Shader å‡½æ•°ä¸­å°†é¡¶ç‚¹åˆ°å…‰æºå‘é‡è½¬é•¿åº¦ï¼Œè®¡ç®—æ·±åº¦ (å…‰æºè®¾ç½®çš„ shadowbias å°±åœ¨è¿™é‡Œç”¨çš„ï¼šUnityEncodeCubeShadowDepth ((é•¿åº¦ + unity_Light_ShadowBias.x)*_LightPositionRange.w))</li></ul></li></ul></li><li><p>Shader ä¸­é˜´å½±æ¥æ”¶ Pass å¿…é¡»ï¼š</p><ul><li>æ‰“ Tags {&quot;LightMode&quot;:&quot;ForwardBase&quot;}ï¼Œæ ‡è®°è¯¥ Pass ä¸ºå‘å‰æ¸²æŸ“</li><li>å¢åŠ é¢„ç¼–è¯‘æŒ‡ä»¤ #pragma multi_compile_fwdbase</li><li>åœ¨é¡¶ç‚¹ã€ç‰‡æ®µä¸­è°ƒç”¨ Unity æä¾›çš„é¢„å®šä¹‰è¿›è¡Œå¤„ç†ï¼š<ul><li>SHADOWCOORDS (ID)ï¼šv2f ç»“æ„ä½“ä½¿ç”¨ï¼ŒID æ˜¯ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºä½¿ç”¨çš„ TEXCOORD+IDï¼Œä¿å­˜é¡¶ç‚¹å‡½æ•°é€šè¿‡ ComputeScreenPos (o.pos) è®¡ç®—çš„ showCoord ä»¥ä¼ å…¥ç‰‡å…ƒç€è‰²å‡½æ•° (å®šä¹‰çš„ ID è¦é¿å…ä¸å…¶å®ƒ TEXCOORD äº§ç”Ÿå†²çª)</li><li>TRANFER_SHADOW (o)ï¼šé€šè¿‡é¡¶ç‚¹ clip è£å‰ªç©ºé—´åæ ‡è®¡ç®—å±å¹•ç©ºé—´é˜´å½±é‡‡æ ·åæ ‡å†…éƒ¨è°ƒç”¨çš„æ˜¯ï¼šComputeScreenPos (o.pos)</li><li>SHADOW_ATTENUATION (i)ï¼šæ ¹æ® showCoord é‡‡æ ·é˜´å½±é¢œè‰²ï¼Œè¿”å›å åŠ çš„é˜´å½±å¼ºåº¦å€¼ã€‚</li></ul></li></ul></li></ul><p>å…¶ä¸­æŠ•å°„ Pass æ˜¯å¿…é¡»çš„ä¸€ä¸ªå•ç‹¬ Passï¼Œå¯¼è‡´äº†é¢å¤– DrawCall æ¶ˆè€—ã€‚æ¥æ”¶ Pass åˆ™å¯ä»¥ä¸æ­£å¸¸ Pass ä¸€å—å¤„ç†å¯¹é¢œè‰²è¿›è¡Œå åŠ ã€‚</p><p>åœ¨ Standard Shader ä¸­ï¼Œå¼€å¯å®æ—¶é˜´å½±çš„æƒ…å†µä¸‹ä¸€ä¸ªæ™®é€šçš„ Sphere å¯¹è±¡ç”šè‡³äº§ç”Ÿäº† 3 ä¸ª DrawCallï¼š</p><p><img data-src="/blogimages/2022/2022-12-06/m_919aead0b6648620444cd393ee1c38f0_r.png" alt="" /></p><p>1 ä¸ªæ¸²æŸ“æ·±åº¦<br /> 1 ä¸ªæ¸²æŸ“ç‰©ä½“åˆ°å…‰æºå‘é‡<br /> 1 ä¸ªæ¸²æŸ“ç‰©ä½“æœ¬èº«</p><p>ç†è®ºä¸ŠåŠ ä¸Šé˜´å½±çš„è¯ï¼Œä¸æ˜¯åªä¼šå¢åŠ ä¸€ä¸ª ShadowCaster DrawCall å—ï¼Ÿä¸ºä»€ä¹ˆå¤šæ¸²æŸ“äº† 2 æ¬¡ï¼Ÿæ¸²æŸ“æ·±åº¦æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Ÿ</p><p>ä»ä¸Šé¢ FrameDebugger æˆªå›¾çš„ä¿¡æ¯ä¸­æ˜¾ç¤ºï¼Œé¢å¤–çš„ä¸€ä¸ªæ·±åº¦æ¸²æŸ“ä¾ç„¶æ˜¯ç”± ShadowCaster å‘èµ·çš„ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å…¶å®ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ PC å¹³å°çš„åŸå› ã€‚</p><p>Unity Standard Shader ä¼šåˆ¤æ–­å¯¹åº”å¹³å°ï¼Œå¦‚æœæ˜¯æ‰‹æœºå¹³å°ï¼Œæ‰ä¼šä½¿ç”¨ä¸Šè¿°ä¼ ç»Ÿçš„ Shadowcaster æ–¹å¼ç»˜åˆ¶é˜´å½±ï¼Œè€Œ PC å¹³å°åˆ™ä¼šå¦å¤–ä½¿ç”¨ ã€å±å¹•ç©ºé—´é˜´å½±ã€ï¼Œå› æ­¤æ‰å¤šé¢å¤–ä¸€ä¸ª DrawCall æ¸²æŸ“ç‰©ä½“çš„æ·±åº¦ã€‚</p><p>å±å¹•ç©ºé—´é˜´å½±åŸæœ¬åº”è¯¥æ˜¯å»¶è¿Ÿæ¸²æŸ“è·¯å¾„é‡‡ç”¨çš„æ–¹æ³•ï¼ŒUnity åœ¨é»˜è®¤æ¸²æŸ“ç®¡çº¿ä¸‹ï¼Œå¯¹æ”¯æŒçš„å¹³å°çš„å‰å‘æ¸²æŸ“è·¯å¾„ä¹Ÿé‡‡ç”¨ç›¸åŒæ–¹å¼ï¼Œå¯ä»¥å‡å°‘ OverDraw ä½†æ˜¯ä¼šå¢åŠ  DrawCallã€‚</p><p>åˆ‡æ¢è‡³ Adnroid å¹³å°ï¼Œå†åˆ©ç”¨ FrameDebugger æŸ¥çœ‹ï¼š</p><p><img data-src="/blogimages/2022/2022-12-06/m_0ac8f9f53256d5e74b1ff0d17f2b99cc_r.png" alt="" /></p><p>1 ä¸ªæ¸²æŸ“ç‰©ä½“åˆ°å…‰æºå‘é‡<br /> 1 ä¸ªæ¸²æŸ“ç‰©ä½“æœ¬èº«</p><p>å¯¹ä¸Šå·äº†ã€‚</p><h2 id="çƒ˜ç„™"><a class="anchor" href="#çƒ˜ç„™">#</a> çƒ˜ç„™</h2><p>çƒ˜ç„™åªç”¨äºé™æ€ç‰©ä½“ï¼Œå¯ä»¥è®©é™æ€ç‰©ä½“å•ç‹¬é‡‡æ ·çƒ˜ç„™å¥½çš„è´´å›¾ï¼Œè€Œéå®æ—¶å…‰æºï¼Œå‡å°‘è®¡ç®—ã€‚</p><p>çƒ˜ç„™åçš„æ•ˆæœ â€”â€” ç¦»çº¿æ¸²æŸ“è‡ªç„¶ä¹Ÿä¼šæ¯”å®æ—¶æ¸²æŸ“æ•ˆæœå¥½ã€‚</p><p>Light Probe Groupï¼šæ ¹æ®å®˜æ–¹æ–‡æ¡£åŠç»è¿‡æµ‹è¯•è¡¨æ˜ï¼Œè¯¥ç»„ä»¶ä½¿å¾—å·²çƒ˜ç„™çš„é—´æ¥å…‰ç…§æ•ˆæœå¯ä»¥æ–½åŠ äºåŠ¨æ€ç‰©ä½“ä¸Šï¼Œæ›´å¤šæ˜¯å¯¹å†…å­˜æ¶ˆè€—ã€‚ï¼ˆçƒ˜ç„™é™æ€ç‰©ä½“ä¸ä½¿ç”¨ï¼ŒæŸ¥çœ‹é™æ€å¯¹è±¡é¢æ¿ï¼Œçƒ˜ç„™åçš„ Light Probe é€‰é¡¹æ˜¯ç½®ç° Off æ— æ³•ä¿®æ”¹çš„ï¼‰</p><p>Reflection Probeï¼šå¯¹åŠ¨æ€ã€é™æ€å¯¹è±¡éƒ½æœ‰å½±å“ï¼Œé…åˆ Light Probe Group æ•ˆæœæ›´å¥½ã€‚</p><p>å¯¹äºçƒ˜ç„™çš„ä¸‰ä¸ªæ¨¡å¼ï¼Œå®˜æ–¹æ–‡æ¡£è§£é‡Šæœ‰ï¼š</p><blockquote><ul><li>Baked Indirect æ¨¡å¼å°†å®æ—¶ç›´æ¥å…‰ç…§ä¸çƒ˜ç„™é—´æ¥å…‰ç…§ç»“åˆåœ¨ä¸€èµ·ï¼Œæä¾›å®æ—¶é˜´å½±ã€‚è¿™ç§å…‰ç…§æ¨¡å¼æä¾›é€¼çœŸçš„å…‰ç…§å’Œåˆç†çš„é˜´å½±ä¿çœŸåº¦ï¼Œé€‚ç”¨äºä¸­æ¡£ç¡¬ä»¶ã€‚</li></ul></blockquote><ul><li>Shadowmask æ¨¡å¼å°†å®æ—¶ç›´æ¥å…‰ç…§ä¸çƒ˜ç„™é—´æ¥å…‰ç…§ç»“åˆåœ¨ä¸€èµ·ï¼Œä¸ºè¿œå¤„çš„æ¸¸æˆå¯¹è±¡å¯ç”¨çƒ˜ç„™é˜´å½±ï¼Œå¹¶å°†çƒ˜ç„™é˜´å½±ä¸å®æ—¶é˜´å½±è‡ªåŠ¨èåˆã€‚è¿™æ˜¯æœ€çœŸå®ä½†ä¹Ÿæ˜¯æœ€è€—è´¹èµ„æºçš„å…‰ç…§æ¨¡å¼ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è´¨é‡è®¾ç½® (Quality Settings) æ¥é…ç½®å…¶æ€§èƒ½å’Œè§†è§‰ä¿çœŸåº¦ã€‚è¿™ç§å…‰ç…§æ¨¡å¼é€‚ç”¨äºé«˜ç«¯æˆ–ä¸­æ¡£ç¡¬ä»¶ã€‚</li><li>Subtractive æ¨¡å¼æä¾›çƒ˜ç„™çš„ç›´å°„å’Œé—´æ¥å…‰ç…§ï¼Œä»…é’ˆå¯¹ä¸€ä¸ªæ–¹å‘å…‰æ¸²æŸ“ç›´æ¥å®æ—¶é˜´å½±ã€‚è¿™ç§å…‰ç…§æ¨¡å¼ä¸èƒ½æä¾›ç‰¹åˆ«é€¼çœŸçš„å…‰ç…§æ•ˆæœï¼Œé€‚åˆäºé£æ ¼åŒ–çš„è‰ºæœ¯æ•ˆæœæˆ–ä½ç«¯ç¡¬ä»¶ã€‚</li></ul><h3 id="mixlighting"><a class="anchor" href="#mixlighting">#</a> MixLighting</h3><ul><li>ï¼æ··åˆç¯å…‰ä¼šå¤§é‡ (ç›¸æ¯” Baked æ¨¡å¼) å¢åŠ  Batchesã€é¡¶ç‚¹æ•°é‡ï¼Œå®ƒå¯¹é™æ€ç‰©ä½“ä¹Ÿä¼šäº§ç”Ÿ Baches ï¼Œå¦‚æœä¸æ˜¯ä¸€å®šéœ€æ±‚é˜´å½±æœ€å¥½è¿˜æ˜¯ç”¨çº¯ Baked</li></ul><p>æµ‹è¯•åœºæ™¯ä¸ºï¼š</p><ul><li>ä¸€ä¸ªå¹³è¡Œå…‰ + ä¸€ä¸ªç‚¹å…‰æº</li><li>10 ä¸ªé™æ€ç‰©ä½“ï¼Œ2 ä¸ªåŠ¨æ€ç‰©ä½“</li></ul><h4 id="backed-indirect"><a class="anchor" href="#backed-indirect">#</a> Backed Indirect</h4><ul><li>Backed Indirectï¼šåªçƒ˜ç„™é—´æ¥å…‰ï¼Œç¯å…‰æ•ˆæœã€é˜´å½±å¿…é¡»è®¾ç½®ä¸º Backed æ‰ä¼šçœŸçš„è¢«çƒ˜ç„™ï¼Œå¦åˆ™ (Mixed) é™æ€ç‰©ä½“éƒ½ä¼šç›´æ¥èµ°å®æ—¶è®¡ç®—ã€‚ï¼ˆæ¶ˆè€—å¾ˆé«˜ï¼‰</li></ul><blockquote><p>Shadow Distanceï¼šèŒƒå›´å†…çš„å€¼ä½¿ç”¨å®æ—¶é˜´å½±ï¼Œè¶…è¿‡æ­¤è·ç¦»åˆ™ä¸å†æ¸²æŸ“é˜´å½±ã€‚<br /><font color=red>æ³¨ï¼šMixed ç‚¹å…‰æºåœ¨ Shadow Distance å†…å¯¹æ‰€æœ‰ç‰©ä½“äº§ç”Ÿé˜´å½±ï¼Œå› ä¸ºæ˜¯å®æ—¶çš„ã€‚</font></p></blockquote><p>å¦‚å›¾æ‰€ç¤ºï¼Œçƒ˜ç„™åå¼€å¯ç¯å…‰ + éšè—ç¯å…‰ï¼š<br /><img data-src="/blogimages/2022/2022-12-06/m_8f9e6b0a707f474dc2616ee926fad357_r.png" alt="" /></p><h4 id="subtractive"><a class="anchor" href="#subtractive">#</a> Subtractive</h4><ul><li>Subtractiveï¼šMixed è®¾ç½®çš„ç¯å…‰ç›´æ¥å…‰å’Œé—´æ¥å…‰éƒ½ä¼šè¢«çƒ˜ç„™ï¼Œè¢«çƒ˜ç„™çš„é™æ€ç‰©ä½“åœ¨è¿è¡Œæ—¶ä¸å ç”¨å®æ—¶å…‰è®¡ç®—ï¼ŒåŠ¨æ€ç‰©ä½“åˆ™å•ç‹¬èµ°å®æ—¶è®¡ç®—ã€‚</li></ul><blockquote><p>Shadow Distanceï¼šèŒƒå›´å†…çš„å€¼åŠ¨æ€å¯¹è±¡ä½¿ç”¨å®æ—¶é˜´å½±ï¼Œè¶…è¿‡æ­¤è·ç¦»åˆ™ä¸å†æ¸²æŸ“é˜´å½±ã€‚<br /><font color=red>æ³¨ï¼šMixed ç‚¹å…‰æºå¯¹åŠ¨æ€ç‰©ä½“ä¸äº§ç”Ÿé˜´å½±ã€‚</font></p></blockquote><p>å¦‚å›¾æ‰€ç¤ºï¼Œçƒ˜ç„™åå¼€å¯ç¯å…‰ + éšè—ç¯å…‰ï¼š<br /><img data-src="/blogimages/2022/2022-12-06/m_b350fc47c8c1ea6da34cb43acd1634cb_r.png" alt="" /><br />ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œç‚¹å…‰æºå¹¶æœªå¯¹ç‰©ä½“å½¢æˆé˜´å½±ï¼Œåªæœ‰å¹³è¡Œå…‰çš„é˜´å½±ã€‚</p><h4 id="shadowmask"><a class="anchor" href="#shadowmask">#</a> Shadowmask</h4><ul><li>Shadowmaskï¼šæ ¹æ®è®¾ç½®å†³å®šæ˜¾ç¤ºï¼Œè¿™ä¸ªé€‰é¡¹å¯ä»¥é…åˆ Setting-&gt;Quality-&gt;Shadows ä½¿ç”¨</li></ul><blockquote><p>Shadow Distanceï¼šèŒƒå›´å†…çš„å€¼ä½¿ç”¨å®æ—¶é˜´å½±ï¼Œè¶…è¿‡æ­¤è·ç¦»åˆ™ä½¿ç”¨çƒ˜ç„™é˜´å½±ã€‚<br />ShadowMaskï¼šé™æ€ç‰©ä½“ä½¿ç”¨çƒ˜ç„™é˜´å½±ã€‚<br />Shadow Cascadesï¼šé˜´å½±çº§è”æ•°é‡ï¼Œå®˜æ–¹æ–‡æ¡£è§£é‡Šè¯´çº§è”æ•°é‡è¶Šå¤šè´¨é‡è¶Šé«˜ï¼Œæ€§èƒ½æ¶ˆè€—è¶Šå¤§ã€‚ä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œå¼€å¯åé˜´å½±å˜ç¡¬ï¼Œæ€§èƒ½æ¶ˆè€—æ˜¯æ„Ÿè§‰åˆ°äº†ï¼Œè´¨é‡ä¸Šåè€Œè§‰å¾—æ›´éš¾çœ‹ã€‚<br /><font color=red>æ³¨ï¼šMixed ç‚¹å…‰æºåœ¨ Shadow Distance å†…å¯¹æ‰€æœ‰ç‰©ä½“äº§ç”Ÿé˜´å½±ï¼Œå› ä¸ºæ˜¯å®æ—¶çš„ã€‚</font></p></blockquote><ul><li>Mixed è®¾ç½®çš„ç¯å…‰å¿…é¡»å­˜åœ¨åœºæ™¯ä¸­æ‰èƒ½ç”Ÿæ•ˆï¼Œçƒ˜ç„™åéšè— Light å°± (å¯¹é™æ€ç‰©ä½“ä¹Ÿ) æ— æ•ˆäº†ã€‚å…·ä½“è¡¨ç°å–å†³äº Quality Shadowmask Mode è®¾ç½®ã€‚<br />ä¸¤ç§è®¾ç½®æ¨¡å¼ä¸­ï¼š<ul><li>Shadow Distanceï¼šåœ¨èŒƒå›´å†…é™æ€ç‰©ä½“ä¹Ÿæ˜¯å®æ—¶å…‰ï¼ŒèŒƒå›´å¤–çƒ˜ç„™å…‰ï¼Œ<s>å½“ Distance è®¾ç½®ä¸º 0 æ—¶ä¸ Shadowmask æ¶ˆè€—ä¸€è‡´</s> (é™æ€ç‰©ä½“å‡ä½¿ç”¨çƒ˜ç„™é˜´å½±)â€”â€” æ¯” Shadowmask æ¶ˆè€—è¿˜ä½ï¼Œå› ä¸º... æ²¡æœ‰åŠ¨æ€ç‰©ä½“çš„å®æ—¶é˜´å½±äº†ï¼Œä½†æ˜¯è¿™æ ·ä¸å¦‚ç›´æ¥ç”¨ Subtractive æ¶ˆè€—æ›´ä½ã€‚</li><li>Shadowmaskï¼šé™æ€ç‰©ä½“å§‹ç»ˆä½¿ç”¨çƒ˜ç„™é˜´å½±ï¼ŒåŠ¨æ€ç‰©ä½“ä½¿ç”¨å®æ—¶é˜´å½±ã€‚</li></ul></li></ul><p>çƒ˜ç„™åç›¸æ¯” Backed Indirect å¤šäº†ä¸€å¼  Shadowmask è´´å›¾ï¼Œå®é™…æµ‹è¯•è¿‘è·ç¦»ä¸‹åŒä¸€ä¸ªåœºæ™¯æ•ˆæœåŠ Batches ä¸ Backed Indirect åŸºæœ¬ä¸€è‡´ï¼ˆå› ä¸º Shadow Distance éƒ½æ˜¯å®æ—¶é˜´å½±ï¼‰</p><p>å¦‚å›¾æ‰€ç¤ºï¼Œçƒ˜ç„™å ShadowDistance+ShadowMask æ¨¡å¼ï¼š</p><p><img data-src="/blogimages/2022/2022-12-06/m_b20be5022100021ace39a857015451aa_r.png" alt="" /></p><h3 id="shader-ä½¿ç”¨-lightmap"><a class="anchor" href="#shader-ä½¿ç”¨-lightmap">#</a> Shader ä½¿ç”¨ Lightmap</h3><p>å¤§è‡´ä¸Šåˆ†ä¸ºå››æ­¥ï¼š</p><ul><li>é¡¶ç‚¹ç€è‰²å™¨æ¥æ”¶å‚æ•°ç»“æ„ å®šä¹‰ float2 texcoord1 : TEXCOORD1 ä»¥æ¥æ”¶ Unity ä¼ å…¥çš„å…‰ç…§ uv</li><li>é¡¶ç‚¹ç€è‰²å™¨ä¸º uv åšä¸€æ¬¡è½¬æ¢ï¼š v.texcoord1.xy * unity_LightmapST.xy + unity_LightmapST.zw</li><li>ç‰‡æ®µç€è‰²å™¨è°ƒç”¨å†…ç½®å‡½æ•° DecodeLightmap å¯¹ unity_Lightmap é‡‡æ ·é¢œè‰²</li><li>ä¸ç‰©ä½“åƒç´ æœ¬æ¥é¢œè‰²å åŠ æ··åˆ</li></ul><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p><s>ç›®å‰æµ‹è¯•ä¸‹æ¥ï¼Œå”¯ä¸€çš„é—®é¢˜å°±æ˜¯åœ¨ Forward RenderPath ä¸‹ï¼Œçƒ˜ç„™å…‰ç…§ä¸­ï¼Œä»…å¹³è¡Œå…‰èƒ½è¢«çƒ˜ç„™ä¸ºé™æ€å¯¹è±¡çš„é˜´å½±ï¼Œç‚¹å…‰æºåªèƒ½ç”¨å®æ—¶é˜´å½±ã€‚<br />è¡¨ç°æƒ…å†µæ˜¯ï¼šç‚¹å…‰æºè®¾ç½®ä¸º Baked æ¨¡å¼ï¼Œä»…å…‰æºé¢œè‰²ä¿¡æ¯è¢«çƒ˜ç„™è‡³å…‰ç…§è´´å›¾ï¼Œé˜´å½±å´æ²¡æœ‰ã€‚</s></p><p>ä¸Šè¿°ç»“è®ºä¸ºé”™è¯¯æ“ä½œå¯¼è‡´ï¼<br />Point Light å’Œ Directional Light å‡æœ‰ ã€Baked Shadow Radiusã€å’Œã€Baked Shadow Angleã€ï¼Œåˆé€‚çš„å€¼å¯ä»¥è®©é˜´å½±è¢«çƒ˜ç„™å¾—æ›´åŠ æŸ”å’Œï¼Œä½†ä¸¤è€…å‚æ•°èŒƒå›´æ˜¯å®Œå…¨æ˜¯ä¸åŒçš„ï¼Œè‹¥å…‰æºè®¾ç½®è¿‡å¤§ï¼Œä¼šå¯¼è‡´ç›´æ¥ä¸¢å¤±é˜´å½± â€”â€” å¯èƒ½åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ä¸å°å¿ƒåŠ¨åˆ°ï¼Œå¯¼è‡´äº†ä¸Šè¿°é”™è¯¯çš„ç»“è®ºã€‚</p><p>ç»è¿‡æµ‹è¯•ï¼Œå¯ä»¥ç¡®å®š Subtractive æ¶ˆè€—æœ€ä½ï¼ŒBacked Indirect å’Œ Shadowmask æ¶ˆè€—éƒ½ä¸å°‘ï¼ŒæŒ‰ç…§æ¶ˆè€—å¤šå°‘å¯ä»¥æ’åºä¸ºï¼š</p><ul><li>Shadowmask(Shadow Distance Mode)-&gt;Backed Indirect-&gt;Shadowmask(Shadowmask Mode)-&gt;Subtractive</li></ul><p>å¯¹æ¯”ï¼š</p><ul><li>Shadowmaskï¼š<font color=red>çƒ˜ç„™é—´æ¥å…‰ç…§ã€æœ€å¤šå››ä¸ªå…‰æºçš„ shadowmask</font>(è¶…å‡ºä¼šç›´æ¥å°†é˜´å½±åŠå…‰ç…§çƒ˜ç„™è‡³å…‰ç…§è´´å›¾ä¸Šï¼Œé™çº§ä¸ Subtractive å·®ä¸å¤š)ï¼Œæ‰€æœ‰å¯¹è±¡å‡ä¸ºå®æ—¶ç›´æ¥å…‰ç…§ã€‚(æ¯”å¦å¤–ä¸¤ç§å¤šäº†ä¸€å¼  Shadowmask è´´å›¾)ï¼ŒåŠ¨æ€ä¸é™æ€é˜´å½±å¯ä»¥å­˜åœ¨èåˆã€‚<ul><li>Shadow Distance Modeï¼šèŒƒå›´å†…é™æ€ã€åŠ¨æ€å‡ä¸ºå®æ—¶ç›´æ¥å…‰ç…§ã€é˜´å½±ï¼ŒèŒƒå›´å¤–é™æ€å¯¹è±¡ä¸ºçƒ˜ç„™é˜´å½±ã€‚</li><li>Shadowmask Modeï¼šé™æ€å¯¹è±¡ä½¿ç”¨ å®æ—¶ç›´æ¥å…‰ç…§ã€çƒ˜ç„™é—´æ¥å…‰ç…§ã€é˜´å½±ã€èŒƒå›´å†…åŠ¨æ€å¯¹è±¡ä¸ºå®æ—¶é˜´å½± (åŒä¸Šæ¯”å¦å¤–ä¸¤ç§å¤šäº†ä¸€å¼  Shadowmask è´´å›¾ï¼Œæœ€å¤šå¯å­˜ 4 ä¸ªç¯å…‰çš„ shadowmaskï¼Œå¯ä¸åŠ¨æ€ç‰©ä½“é˜´å½±æ··åˆ)ã€‚</li></ul></li><li>Backed Indirectï¼š<font color=red>ä»…çƒ˜ç„™é—´æ¥å…‰</font>ï¼ŒèŒƒå›´å†…é™æ€ã€åŠ¨æ€å‡ä¸ºå®æ—¶ç›´æ¥å…‰ç…§ã€é˜´å½±ï¼ŒèŒƒå›´å¤–æ— é˜´å½±ã€‚</li><li>Subtractiveï¼š<font color=red>é™æ€å¯¹è±¡çš„æ‰€æœ‰ç›´æ¥å…‰ç…§ã€é—´æ¥å…‰ç…§ã€é˜´å½±å‡çƒ˜ç„™</font>ã€èŒƒå›´å†…åŠ¨æ€å¯¹è±¡ä¸ºå®æ—¶é˜´å½±ï¼ŒèŒƒå›´å¤–æ— é˜´å½±ã€‚Mixed ç‚¹å…‰æºå¯¹åŠ¨æ€ç‰©ä½“æ— é˜´å½± (è¿™æ¬¡åº”è¯¥æ²¡é”™äº†å§ï¼Ÿ)ã€‚é™æ€ç‰©ä½“æ— é«˜å…‰æ•ˆæœ (ä½¿ç”¨ Reflection Probe ä¼šæœ‰æ”¹å–„)ã€‚</li></ul><p>å…¶å®ƒé‡è¦è®¾ç½®ï¼š</p><ul><li>Shadow Distanceï¼šèŒƒå›´å†…é‡‡ç”¨å®æ—¶é˜´å½±ï¼Œå®é™…æƒ…å†µåˆç†è®¾ç½®ï¼Œåœ¨ Shadow Resolution é˜´å½±åˆ†è¾¨ç‡ä¸å˜çš„æƒ…å†µä¸‹ï¼ŒShadow Distance è¶Šå¤§ï¼Œæ˜¾ç¤ºè´¨é‡åè€Œå¯èƒ½é™ä½ã€‚</li><li>Shadow Cascadesï¼šåªå¯¹æ–¹å‘å…‰æœ‰æ•ˆï¼Œå¯ä»¥å°†é˜´å½±çš„æ¸²æŸ“åˆ’åˆ†æˆå¯¹åº”çš„å‡ å—åŒºåŸŸï¼Œæå‡è¿‘å¤„é˜´å½±çš„åˆ†è¾¨ç‡å ç”¨ï¼Œå‡è½»è¿‘å¤„é˜´å½±çš„é”¯é½¿æ„Ÿï¼Œå½“ç„¶ä¹Ÿä¼šäº§ç”Ÿæ›´å¤šæ€§èƒ½æ¶ˆè€—ã€‚ç»è¿‡å®æµ‹å¼€å¯åé˜´å½±ä¼šå˜å¾—æ›´åŠ æ¸…æ™° (æ›´ç¡¬)ã€‚</li><li>Shadow Projectionï¼šé»˜è®¤ä¸º Stable Fitï¼Œæ•´ä½“é˜´å½±åˆ†è¾¨ç‡ä¸å˜çš„æƒ…å†µä¸‹ Close Fit å¯ä»¥è¿›ä¸€æ­¥çš„æé«˜è¿‘å¤„ç‰©ä»¶çš„é˜´å½±åˆ†è¾¨ç‡ï¼ŒåŒæ—¶ä¹Ÿæœ‰æ›´é«˜çš„å¼€é”€</li><li>å…‰ç…§è´´å›¾ UV å¯ä»¥åœ¨æ¨¡å‹è®¾ç½®ä¸Šå¯ç”¨ Generate Lightmap UVs è‡ªåŠ¨ç”Ÿæˆã€‚</li><li>Direction Modeï¼šè®¾ç½®ä¸º Direction ä¼šå¤šçƒ˜ç„™ä¸€å¼ å…‰æºæ–¹å‘è´´å›¾ï¼Œå¯ç”¨äºæ¨¡å‹æ³•çº¿è®¡ç®—ã€‚</li><li>Lightmap Resolution (åƒç´  / å•ä½)ï¼šå…‰ç…§å›¾å ç”¨åƒç´ çš„å…¨å±€å€¼ï¼Œè®¾ç½®è¶Šå¤§è¶Šç²¾ç»†çƒ˜ç„™è¶Šä¹…ï¼Œå½“å ç”¨é‡è¶…å‡º MaxLightMapSize å°±ä¼šå¯¼è‡´çƒ˜ç„™å‡ºå¤šä»½å…‰ç…§è´´å›¾çš„æƒ…å†µã€‚</li><li>Scale in Lightmap (ç‰©ä½“å¯¹è±¡ä¸Šçš„è®¾ç½®)ï¼šå½±å“çƒ˜ç„™æ­¤ç‰©ä½“åœ¨å…‰ç…§å›¾ä¸Šå ç”¨çš„ç²¾åº¦ã€‚</li></ul><p>å‚è€ƒæ–‡æ¡£ï¼š</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5M2QuY29tL2NuLzIwMjEuMy9NYW51YWwvTGlnaHRpbmdHaVV2cy5odG1s">LightingGiUvs</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuLzIwMjEuMy9Eb2N1bWVudGF0aW9uL01hbnVhbC9saWdodGluZy1tb2RlLmh0bWw=">lighting-mode</span></li><li><span class="exturl" data-url="aHR0cDovL21hLXlpZG9uZy5jb20vMjAxNy8wOS8wMi9taXhlZC1saWdodGluZy1saWdodG1hcC1zaGFkZXItaW4tdW5pdHkv">mixed-lighting-lightmap-shader-in-unity</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3plbmdqdW5qaWU1OS9hcnRpY2xlL2RldGFpbHMvMTExMzU2NjM2">Unity æ¥æ”¶é˜´å½±</span></li><li><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80Nzg0MzE2NzE=">Unity ä¸­çš„æ··åˆå…‰ç…§</span></li><li><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82ODg0MTk1Mg==">Unity ç§»åŠ¨å¹³å°ä¸‹çš„å…‰ç…§çƒ˜ç„™åŠä¼˜åŒ–</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI4OTYyMTY2Ng==">Unity ä¸ºä»€ä¹ˆä½¿ç”¨ screen space shadow</span></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;å‰å‡ å¤©è·ŸåŒäº‹è®¨è®º Unity Lightmap ï¼Œåœ¨ Shader (è‡ªå®šä¹‰) ä¸­æ˜¯æ€ä¹ˆå–çš„ï¼Œç„¶åæˆ‘è¯´ Unity åœ¨ Shader ä¸­ç›´æ¥ä¼šç»™æ•°æ®ï¼Œè°ƒç”¨ Unit</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="Shader" scheme="https://cwhisme.github.io/categories/Unity3D/Shader/"/>
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/tags/Unity3D/"/>
    
    <category term="å›¾å½¢å­¦" scheme="https://cwhisme.github.io/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/"/>
    
    <category term="Shader" scheme="https://cwhisme.github.io/tags/Shader/"/>
    
  </entry>
  
  <entry>
    <title>æ‰“åŒ… AssetBundle çš„åŸºç¡€è§„åˆ™æ•´ç†</title>
    <link href="https://cwhisme.github.io/2022/11/23/%E6%89%93%E5%8C%85AssetBundle%E5%9F%BA%E7%A1%80%E8%A7%84%E5%88%99%E6%95%B4%E7%90%86/"/>
    <id>https://cwhisme.github.io/2022/11/23/%E6%89%93%E5%8C%85AssetBundle%E5%9F%BA%E7%A1%80%E8%A7%84%E5%88%99%E6%95%B4%E7%90%86/</id>
    <published>2022-11-23T10:12:11.000Z</published>
    <updated>2022-12-22T03:29:48.151Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>ä¹‹å‰å…¶å®æœ‰å†™ä¸€ç¯‡ ã€<a href="">AssetBundle çš„å®é™…æµ‹è¯•ä¸æ€»ç»“</a>ã€çš„æ–‡ç« ï¼Œä¸è¿‡ç°åœ¨çœ‹äº†ä¸‹ï¼Œæ„Ÿè§‰æ¼äº†ä¸€äº›ï¼Œè€Œä¸”ä¸å¤Ÿå®Œå–„ã€‚</p><p>ä½†æ˜¯æ„Ÿè§‰æ”¹åˆä¸å¥½æ”¹äº†ï¼Œäºæ˜¯æ–°å»ºäº†ä¸€ç¯‡æ–‡ç« ï¼Œé‡æ–°æ•´ç†ä¸€ä¸‹ã€‚</p><p>ä¸»è¦ä½¿ç”¨å·¥å…·æœ‰ï¼š</p><ul><li>Unity3D 2018.4.36f1</li><li>Unity3D 2021.3.6f1</li><li>Microsoft Visual Studio 2022</li><li>Unity å·¥å…·ï¼šAssetBundles-Browser-1.7.0</li></ul><h2 id="åŠŸèƒ½ç®€ä»‹"><a class="anchor" href="#åŠŸèƒ½ç®€ä»‹">#</a> åŠŸèƒ½ç®€ä»‹</h2><p>å·²çŸ¥ç›®å‰ Unity ä¸»è¦æä¾›äº†ä¸¤ç§æ–¹å¼æ‰“ AssetBundle åŒ…</p><ul><li>ä¸€ç§æ˜¯å…¨æ‰“ï¼Œæ ¹æ®æ•´ä¸ªé¡¹ç›®èµ„æºçš„ AssetBundleName æ ‡è®°è‡ªåŠ¨ç”Ÿæˆï¼Œè¯¥è¿‡ç¨‹å…¨è‡ªåŠ¨åŒ–ï¼Œåªæœ‰è®¾ç½® AssetBundleName è¿™ä¸ªæ­¥éª¤å¯ä»¥äººä¸ºæ§åˆ¶</li><li>å¦ä¸€ç§æ˜¯å•æ‰“ï¼Œæ ¹æ®ä¼ å…¥çš„èµ„æºè·¯å¾„ã€æŒ‡å®šçš„ AssetBundleName å•ç‹¬ç”ŸæˆæŒ‡å®šèµ„æºçš„ AssetBundle åŒ…</li></ul><p>å‡ä¸ºä¸€ä¸ªæ¥å£çš„ä¸¤ä¸ªé‡è½½ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// å…¨æ‰“æ¥å£ï¼Œæ ¹æ®é¡¹ç›®å·²è®¾ç½® AssetBundleName çš„èµ„æº</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// ä¼ å…¥å‚æ•°ä¸º æ•´ä¸ªè¾“å‡ºè·¯å¾„ã€æ‰“åŒ…é€‰é¡¹åŠæ‰“åŒ…å¹³å°</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">AssetBundleManifest</span> <span class="token function">BuildAssetBundles</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> outputPath<span class="token punctuation">,</span> <span class="token class-name">BuildAssetBundleOptions</span> assetBundleOptions<span class="token punctuation">,</span> <span class="token class-name">BuildTarget</span> targetPlatform<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// å•æ‰“æ¥å£ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªã€éœ€è¦æ‰“åŒ…ã€çš„èµ„æºåˆ—è¡¨ã€æ‰“åŒ…é€‰é¡¹åŠæ‰“åŒ…å¹³å°</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">AssetBundleManifest</span> <span class="token function">BuildAssetBundles</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> outputPath<span class="token punctuation">,</span> <span class="token class-name">AssetBundleBuild<span class="token punctuation">[</span><span class="token punctuation">]</span></span> builds<span class="token punctuation">,</span> <span class="token class-name">BuildAssetBundleOptions</span> assetBundleOptions<span class="token punctuation">,</span> <span class="token class-name">BuildTarget</span> targetPlatform<span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="å…¬å…±å‚æ•°"><a class="anchor" href="#å…¬å…±å‚æ•°">#</a> å…¬å…±å‚æ•°</h3><p>å…¶ä¸­å…¬å…±å‚æ•°ä¸ºï¼š</p><ul><li>BuildAssetBundleOptions</li><li>BuildTarget</li></ul><h4 id="buildtarget"><a class="anchor" href="#buildtarget">#</a> BuildTarget</h4><p>BuildTarget å°±åƒåå­—ä¸€æ ·å¾ˆç®€å•ï¼Œä¸»è¦æ˜¯å…·ä½“ä¸ºå“ªä¸ªå¹³å°æ‰“çš„èµ„æºåŒ…ï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨  <code>EditorUserBuildSettings.activeBuildTarget</code>  å³å¯ã€‚</p><p>æˆ–è€…åˆ©ç”¨é¢„å®šä¹‰ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_STANDALONE_WIN</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//BuildTarget.StandaloneWindows64</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token preprocessor property">#<span class="token directive keyword">elif</span> UNITY_IPHONE</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">//BuildTarget.iOS</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token preprocessor property">#<span class="token directive keyword">elif</span> UNITY_ANDROID</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">//BuildTarget.Android</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token preprocessor property">#<span class="token directive keyword">endif</span></span></pre></td></tr></table></figure><p>å•ç‹¬åˆ†å¹³å°åˆ¤æ–­ä¹Ÿå¯ä»¥ (ç”¨é¢„å®šä¹‰çš„è¯ï¼Œæœ‰å¿…è¦çš„æƒ…å†µä¸‹è¿™é‡Œè¿˜å¯ä»¥åšäº›å…¶å®ƒæ“ä½œ)ã€‚</p><h4 id="buildassetbundleoptions"><a class="anchor" href="#buildassetbundleoptions">#</a> BuildAssetBundleOptions</h4><p>é»˜è®¤æƒ…å†µä¸‹ AssetBundle å‹ç¼©æ ¼å¼ä¸º LZMAï¼Œè¿™ä¸ªé€‰é¡¹å¯ä»¥é¢å¤–é€‰æ‹©è®¾ç½®ä¸º ä¸å‹ç¼© æˆ–è€… LZ4 å‹ç¼©æ ¼å¼ï¼š</p><pre><code>BuildAssetBundleOptions.UncompressedAssetBundleBuildAssetBundleOptions.ChunkBasedCompression</code></pre><p>å¯èƒ½æœ‰äººä¼šå¥½å¥‡ä¸¤ä¸ªåŒæ—¶ä¼ å…¥ä¼šå¦‚ä½• (æ¯”å¦‚è¯´æˆ‘)?</p><p>è¯•äº†ä¸‹ç¼–è¾‘å™¨ä¼šç›´æ¥æŠ¥é”™ï¼Œæç¤ºï¼š</p><blockquote><p><font color=red>Cannot use options UncompressedAssetBundle and ChunkBasedCompression at the same time.</font></p></blockquote><p>å…¶å®ƒæ¯”è¾ƒé‡è¦çš„è¿˜æœ‰ï¼š</p><h5 id="1buildassetbundleoptionsdeterministicassetbundle"><a class="anchor" href="#1buildassetbundleoptionsdeterministicassetbundle">#</a> 1ï¼‰BuildAssetBundleOptions.DeterministicAssetBundle</h5><p><s>è¿™ä¸ªå‚æ•°ä¼šä¿è¯åŒæ ·çš„èµ„æºæ¯æ¬¡æ‰“å‡ºæ¥çš„ AssetBundle åŒ…äºŒè¿›åˆ¶ä¸€è‡´ã€‚</s></p><p>~~ æˆ‘çš„æµ‹è¯•æ–¹å¼æ˜¯ï¼šä¸ä¼ å…¥è¯¥å‚æ•°ï¼Œå…ˆå…¨æ‰“ä¸€æ¬¡èµ„æºå¤‡ä»½å¥½ï¼Œç„¶ååˆ é™¤é¡¹ç›®çš„ Library å†å…¨æ‰“ä¸€æ¬¡ï¼Œå°±å‘ç°æ–°çš„èµ„æºå¤§å°è™½ç„¶è·ŸåŸæœ¬çš„ä¸€æ ·ï¼Œä½†æ˜¯å†…éƒ¨äºŒè¿›åˆ¶å°±æœ‰å¾ˆå¤§çš„ä¸åŒäº†ï¼š<br />~~<br /><s>(ä»¥ä¸‹é”™è¯¯å°è¯•åŠç»“è®ºå†…å®¹å·²åˆ é™¤)</s></p><p>ç»è¿‡åå¤å°è¯•ï¼Œå¤šæ¬¡è¯•éªŒåå¾—å‡ºç»“æœï¼šDeterministicAssetBundle ä¼¼ä¹å¹¶éè¿™ä¸ªä½œç”¨ã€‚<br />ä¹‹æ‰€ä»¥ç¬¬ä¸€æ¬¡åˆ é™¤ Library åæ‰“åŒ…å¾—å‡ºç»“æœä¸ä¸€è‡´ï¼Œä¸»è¦æ˜¯å› ä¸º Library ç”Ÿæˆçš„ç¼“å­˜ä¸ä¸€è‡´ã€‚åœ¨è¯•éªŒä¸­ï¼Œé™¤äº†ç¬¬ä¸€æ¬¡åˆ é™¤è¯•éªŒï¼Œä¹‹åæ¯æ¬¡é‡æ–°åˆ é™¤ Library ï¼Œå†é‡æ–°æ‰“å¼€ï¼Œåç»­å·¥ç¨‹æ‰“å‡ºæ¥çš„ AssetBundle åŒ…å¯¹æ¯”æ–‡ä»¶å‡ä¸€è‡´äº†ã€‚</p><p>å°è¯•åœ¨ä¸€ä¸ªå·¥ç¨‹åŒæ—¶æ‰“å‡ºå¸¦ DeterministicAssetBundle åŠä¸å¸¦è¯¥é€‰é¡¹çš„èµ„æºåŒ…ï¼Œç»“æœæœ€ç»ˆç”Ÿæˆçš„äºŒè¿›åˆ¶ AssetBundle èµ„æºåŒ…åŒæ ·å®Œå…¨ä¸€è‡´ï¼š</p><p><img data-src="/blogimages/2022/2022-11-23/m_bc96359133bb56dd0d1223b6639bf8d5_r.png" alt="" /></p><p>åªæœ‰åœ¨å•æ‰“æŸä¸ªèµ„æºæ—¶ï¼Œè¯¥é€‰é¡¹æ‰“å‡ºçš„èµ„æºåŒ…æ‰ä¼šäº§ç”Ÿå·®å¼‚ã€‚</p><p>è¯´æ˜è¿™ä¸ªé€‰é¡¹ï¼Œè‡³å°‘åœ¨åŒä¸€ä¸ªç¯å¢ƒä¸‹å…¨æ‰“èµ„æºæ˜¯ä¸ä¼šå¯¹ AssetBundle èµ„æºåŒ…äº§ç”Ÿä»»ä½•å½±å“çš„ã€‚</p><p><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuL2N1cnJlbnQvU2NyaXB0UmVmZXJlbmNlL0J1aWxkQXNzZXRCdW5kbGVPcHRpb25zLkRldGVybWluaXN0aWNBc3NldEJ1bmRsZS5odG1s">å®˜æ–¹æ–‡æ¡£è¯´æ˜</span>ï¼š</p><blockquote><p>é‡æ–°æ„å»ºèµ„æºåŒ…æ—¶ï¼Œèµ„æºåŒ…ä¸­å¯¹è±¡çš„ ID å°†åœ¨å®Œæˆé‡æ–°æ„å»ºå ä¿æŒä¸å˜ã€‚<br />ä» DeterministicAssetBundle ä¸­åŠ è½½å†…å®¹ä¹Ÿæ¯”ä¸€èˆ¬èµ„æºåŒ…è¦æ…¢ã€‚</p></blockquote><p>é‚£ä¹ˆè¿™ä¸ªé€‰é¡¹ç©¶ç«Ÿæ˜¯èµ·ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿæœ‰åå¤„ï¼Œå´æ²¡è¯´æ˜ç™½å¥½å¤„ã€‚</p><p>å®˜æ–¹çš„è¯´æ˜æ–‡æ¡£ä¿¡æ¯å¤ªå°‘äº†ï¼Œåå¤æ–Ÿé…Œä¹‹åï¼Œå¶ç„¶çœ‹åˆ°äº†è¯´æ˜çš„æœ€åä¸€è¡Œæ–‡å­—ï¼š</p><blockquote><p>æ³¨æ„ï¼šæ­¤åŠŸèƒ½ä¼šå§‹ç»ˆå¯ç”¨ã€‚</p></blockquote><p>...... åŸæ¥å¦‚æ­¤ï¼Ÿéš¾æ€ªä¼ å…¥ä¸ä¼ å…¥ï¼Œéƒ½æ²¡æœ‰å½±å“ã€‚</p><p>åæ¥åˆç»è¿‡å¤šæ–¹æŸ¥æ‰¾åï¼Œè¿˜çœ‹åˆ°æœ‰è¯´æ‰¾ Unity å®˜æ–¹ç¡®è®¤ï¼Œç¡®å®š Unity5.X ä»¥åçš„ç¡®æ˜¯é»˜è®¤åŠ å…¥çš„é€‰é¡¹äº†ï¼š</p><blockquote><p><span class="exturl" data-url="aHR0cHM6Ly9hbnN3ZXIudXdhNGQuY29tL3F1ZXN0aW9uLzVhN2E4YjIzODQ3ODAyMjU4YTA2NTAzOA==">https://answer.uwa4d.com/question/5a7a8b23847802258a065038</span></p></blockquote><p>ç„¶ååç»­ç»§ç»­æŸ¥æ‰¾èµ„æ–™ï¼Œåœ¨ Unity å®˜æ–¹è®ºå› <a href="https://forum.unity.com/threads/is-the-deterministic-asset-bundle-option-obsolete.455510/">Is the deterministic asset bundle option obsolete?<br /></a> å¸–å­ä¹Ÿæåˆ°äº†åŒæ ·çš„å›°æƒ‘ï¼ŒUnity å®˜æ–¹äººå‘˜å›ç­”è¯´è¯¥é€‰é¡¹å·²ç»æ— æ•ˆï¼š</p><blockquote><p>It's a bit of a mess, but yes, it's enabled permanently - the option has no effect.</p></blockquote><p>ä½†æ˜¯ä¸ºä»€ä¹ˆå•æ‰“æ—¶ï¼Œè¿™ä¸ªé€‰é¡¹é’ˆå¯¹åŒä¸€ä¸ªèµ„æºï¼Œåˆä¼šäº§ç”Ÿå½±å“äº†ï¼Ÿ</p><p>æµ‹è¯•å•æ‰“èµ„æºæ˜¾ç¤ºï¼š</p><pre><code>BuildAssetBundleOptions.None: 54.7 KB (56,036 å­—èŠ‚)BuildAssetBundleOptions.DeterministicAssetBundleï¼š54.7 KB (56,039 å­—èŠ‚)</code></pre><p>ä¼ å…¥ DeterministicAssetBundle é€‰é¡¹æ—¶å¢åŠ äº† 3 ä¸ªå­—èŠ‚å¤§å°ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥æ€€ç–‘ï¼Œå•æ‰“æ—¶ä¾ç„¶ä¼šæœ‰å½±å“ï¼Œå®˜æ–¹è¯´çš„ã€å§‹ç»ˆå¯ç”¨ã€ä»…é’ˆå¯¹å…¨æ‰“èµ„æºçš„æƒ…å†µï¼Ÿ</p><p>æ¯•ç«Ÿå•æ‰“æ—¶çš„å¼•ç”¨å…³ç³»å¤„ç†ï¼Œè·Ÿå…¨æ‰“ä¹Ÿæ˜¯æœ‰å·®å¼‚çš„ã€‚</p><p>æ‰€ä»¥è¿™é‡Œå¯ä»¥æ€»ç»“ä¸ºï¼šè¯¥é€‰é¡¹ä¸»è¦ç”¨äºç”Ÿæˆç¡®å®šæ€§ ID ä»¥å¤„ç†é‡æ–°æ‰“åŒ…èµ„æºæ—¶ä¾èµ–ã€å¼•ç”¨å…³ç³»ï¼Œç¡®ä¿å¢é‡æ‰“åŒ…æ—¶æ²¡æœ‰çœŸå®ä¿®æ”¹çš„èµ„æºä¸ä¼šè¢«é‡æ‰“ã€‚ç›®å‰ Unity å…¨æ‰“æ¥å£å·²é»˜è®¤åŒ…å«è¯¥é¡¹ï¼Œä¸”æ— è®ºæ˜¯å¦ä¼ å…¥å‡ä¸å½±å“ï¼Œå•æ‰“èµ„æºæ—¶æ‰ä¼šæœ‰å½±å“ä¸”å¯¼è‡´èµ„æºäº§ç”Ÿå·®å¼‚ã€‚</p><h5 id="2buildassetbundleoptionsdisablewritetypetree"><a class="anchor" href="#2buildassetbundleoptionsdisablewritetypetree">#</a> 2ï¼‰BuildAssetBundleOptions.DisableWriteTypeTree</h5><p>ç¦ç”¨å†™å…¥ç±»å‹æ ‘ã€‚</p><p>æ ¹æ®ç›¸å…³ä»‹ç»ï¼Œè¿™ä¸ªä¸ºäº†ç»™ Unity è·¨ç‰ˆæœ¬ä¹‹é—´åšå…¼å®¹æ€§ç”¨çš„ï¼Œåœ¨çœŸæœºåŒ…å‡ºåŒ…ç‰ˆæœ¬ä¸çƒ­æ›´èµ„æºéƒ½æ˜¯ç”±ä¸€ä¸ªç‰ˆæœ¬å‡ºåŒ…æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€‰é¡¹å¯ä»¥è€ƒè™‘ä¼ å…¥ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</p><p>ç¦ç”¨åå¯ä»¥é™ä½åŒ…ä½“å’Œå†…å­˜å¹¶æé«˜åŠ è½½æ•ˆç‡ï¼Œä½†æ˜¯å¯èƒ½ä¼šé€ æˆ Unity ç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜ã€‚</p><p>åŸç†æ˜¯æ ¹æ®åºåˆ—åŒ–çš„å­—æ®µè¿›è¡Œååºåˆ—åŒ–ï¼Œä¾‹å¦‚æˆ‘ä»¬èµ„æº meta ç‰ˆæœ¬éƒ½æœ‰ serializedVersion ï¼Œä»¥åŒºåˆ†å„ä¸ªç‰ˆæœ¬åºåˆ—åŒ–é€‰é¡¹æƒ…å†µï¼Œä¸åŒç‰ˆæœ¬æ¯ä¸ªé€‰é¡¹å¯èƒ½å¹¶ä¸ä¸€è‡´ã€‚</p><p>å¼€å¯å†™å…¥ç±»å‹æ ‘æ—¶ï¼ŒUnity åœ¨æ‰“ AssetBundle æ—¶ä¼šå…ˆæŠŠæ•°æ®å†…å®¹çš„æ ‘çŠ¶ç»“æ„å…ˆå†™å…¥ä¸€éï¼Œç„¶åå†å†™å…¥å¯¹åº”å€¼ï¼Œè¿™æ ·åœ¨åŠ è½½ AssetBundle æ—¶ï¼Œå…ˆè§£æå‡ºå­—æ®µçš„æ ‘çŠ¶ç»“æ„ï¼Œç„¶åä¸çœŸæœºåŒ…åŒ…ä½“çš„è§£æç»“æ„è¿›å¯¹æ¯”ï¼Œå†è§£æå®é™…æ•°æ®å€¼ï¼Œå¤„ç†ç¼ºå¤±æˆ–å¤šä½™å­—æ®µï¼Œé¿å…ååºåˆ—åŒ–å‡ºé”™ (é”™ä½)ã€‚</p><p>å¦‚æœä¸å†™å…¥ï¼Œé‚£å°±æ˜¯ç›´æ¥æ ¹æ®é¡ºåºå»ååºåˆ—åŒ–äº†ï¼Œæ¢äº† Unity ç‰ˆæœ¬å­—æ®µå¯èƒ½å°±ä¼šååºåˆ—åŒ–é”™ä½ï¼Œå¯¼è‡´å‡ºç°é—®é¢˜ã€‚</p><p>ä¸ºäº†ç¡®å®šä¸Šè¿°è¯´æ³•ï¼Œå¯ä»¥è¿›è¡Œä¸€ä¸ªç®€å•çš„æµ‹è¯•ã€‚</p><p>æˆ‘ç”¨ Unity2018.4.36f1 æ‰“äº†ä¸¤ä¸ª Cube.prefab AssetBundle èµ„æºåŒ…ï¼Œåˆ†ä¸ºé»˜è®¤å¯ç”¨ä»¥åŠç¦ç”¨ï¼Œå‹ç¼©æ¨¡å¼ä¸º ä¸å‹ç¼©ï¼š</p><p><img data-src="/blogimages/2022/2022-11-23/m_ce296dced15e16733103cfb044033bab_r.png" alt="" /></p><p>ç„¶ååœ¨ Unity2021.3.6f1 ä¸­è¿›è¡ŒåŠ è½½æµ‹è¯•ï¼š</p><p><img data-src="/blogimages/2022/2022-11-23/m_334251ea9573f4af016c1fdf351a5600_r.png" alt="" /></p><p>é»˜è®¤æ‰“åŒ…æ¨¡å¼æ˜¯å¯ä»¥ç›´æ¥è¯»å–çš„ (è™½ç„¶æŒ‰ç…§åå­—åŠ è½½å¤±è´¥äº†)ï¼Œç¡®å®åŠ è½½åˆ°äº†å¯¹åº”èµ„æºã€‚<br />åœºæ™¯ä¸­ä¹Ÿå¯ä»¥åˆ©ç”¨  <code>GameObject.Instantiate(x[0] as GameObject);</code>  æ­£ç¡®å®ä¾‹åŒ–å‡ºæ¥ã€‚</p><p>è€Œæ¢æˆåŠ è½½ ã€cube2018_disablewritetypetreeã€åˆ™ç›´æ¥æŠ¥é”™ï¼Œæç¤ºï¼š</p><blockquote><p>The AssetBundle 'Assets\MyBundles\cube2018_disablewritetypetree' could not be loaded because it contains run-time classes of incompatible version. Rebuild the AssetBundle to fix this error.</p></blockquote><p>å¯¹äºä¸Šè¿°æµ‹è¯•ï¼Œåˆ©ç”¨ AssetBundles-Browser ä¹Ÿå¯ä»¥ç›´æ¥çœ‹å‡ºé—®é¢˜ï¼Œé»˜è®¤çš„å¯ä»¥é¢„è§ˆ Cube å„é¡¹å±æ€§ï¼ŒDisableWriteTypeTree çš„èµ„æºç‰ˆæœ¬åˆ™æŠ¥åŒæ ·é”™è¯¯ã€‚</p><p>å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img data-src="/blogimages/2022/2022-11-23/m_d2487c01c62a4a665b66a3d1deab67a2_r.png" alt="" /></p><p>å½“ç„¶ï¼Œè¿™ä¸ªå…¼å®¹æ€§ä¹Ÿæœ‰ä»£ä»·ï¼Œé¦–å…ˆæ¯ä¸ª AssetBundle éƒ½å¾—åŒ…å«é¢å¤–çš„ TypeTree ä¿¡æ¯ï¼ŒåŠ è½½ AssetBundle èµ„æºæ—¶ä¼šå…ˆæ„å»ºè¿™ä¸ª TypeTree ç»“æ„ï¼Œç„¶åå†è§£æå­—æ®µï¼Œå¢åŠ éƒ¨åˆ† CPU å’Œ å†…å­˜æ¶ˆè€—ã€‚</p><h5 id="3buildassetbundleoptionsforcerebuildassetbundle"><a class="anchor" href="#3buildassetbundleoptionsforcerebuildassetbundle">#</a> 3ï¼‰BuildAssetBundleOptions.ForceRebuildAssetBundle</h5><p>é»˜è®¤ä¸ºå¢é‡æ„å»ºï¼ŒåŸºäºä¸Šä¸€æ¬¡çš„æ‰“åŒ…ç»“æœï¼Œå¯¹å‘ç”Ÿå˜åŒ–çš„èµ„æºé‡æ–°æ‰“åŒ…ï¼Œè‹¥ä¼ å…¥è¿™ä¸ªå‚æ•°ï¼Œä¼šå®Œå…¨é‡æ–°æ‰“ä¸€æ¬¡ã€‚<br />ç»è¿‡æµ‹è¯•ï¼Œå¢é‡æ„å»ºçš„å…³é”®ç‚¹åœ¨äº Unity ä¸ºæ¯ä¸ª AssetBundle èµ„æºåŒæ—¶ç”Ÿæˆçš„ .manifest æ–‡ä»¶ã€‚<br /><font color=red>æ³¨ 1ï¼šåˆ é™¤æ–‡ä»¶çš„ .manifest ä¹Ÿä¼šäº§ç”ŸåŒæ ·çš„æ•ˆæœã€‚<br />æ³¨ 2ï¼šæˆ‘ä»¬é¡¹ç›®çš„ AssetBundle å…³ç³»ç”±è‡ªå·±ç»´æŠ¤ï¼Œå°è¯•æ‰“å®Œäº†ä¹‹ååˆ é™¤ .manifest èŠ‚çœç©ºé—´ï¼Œå‘ç°ä¼šè¢«é‡æ–°å…¨æ‰“ä¸€æ¬¡ã€‚<br />æ³¨ 3ï¼šå…³ç³»æ€»è¡¨çš„ .manifest å¯¹å…¶å®ƒèµ„æºä¸äº§ç”Ÿå½±å“ï¼Œåªåˆ é™¤æŸä¸ªèµ„æºçš„ .manifest å°±ä¼šå¯¼è‡´è¯¥èµ„æºç›´æ¥è¢«é‡æ‰“ã€‚</font></p><h5 id="4disableloadassetbyfilename-disableloadassetbyfilenamewithextension"><a class="anchor" href="#4disableloadassetbyfilename-disableloadassetbyfilenamewithextension">#</a> 4ï¼‰DisableLoadAssetByFileNameã€DisableLoadAssetByFileNameWithExtension</h5><p>ç¦ç”¨ä½¿ç”¨ åå­—åŠ è½½ï¼Œè¿™ä¸¤ä¸ªé€‰é¡¹åªå½±å“å†…ç½®çš„ AssetBundle.LoadAsset æ–¹æ³•ã€‚</p><p>å¦‚é€šè¿‡ AssetBundle.LoadAllAssets åŠ è½½åæ ¹æ®åå­—åˆ¤æ–­ä¾ç„¶å¯è¡Œã€‚</p><p>æ–‡ä»¶å + æ‰©å±•åä¼šåœ¨åŠ è½½æˆåŠŸåç”Ÿæˆï¼Œå–å†³äºé¡¹ç›®çš„ AssetBundle èµ„æºå…·ä½“åŠ è½½æ–¹å¼ï¼Œå¯ä»¥ä¼ å…¥å‡å°‘ä¸€ç‚¹ç‚¹å†…å­˜å ç”¨ã€‚ä¾‹å¦‚é€šè¿‡å…¨è·¯å¾„æˆ–è€… AssetBundleRequest allAssets è‡ªå·±åˆ¤æ–­æ–¹å¼ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡ AssetBundle.LoadAllAssets (LoadAllAssetsAsync) åŠ è½½å…¨éƒ¨èµ„æºï¼Œç„¶åç®¡ç†ï¼ŒAssetBundle è‡ªå¸¦çš„ LoadAsset æ¥å£æ˜¯ä¸ä¼šä½¿ç”¨çš„ï¼Œæ­¤æ—¶å°±å¯ä»¥ç¦ç”¨åå­—åŠ è½½ã€‚</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> pathDir <span class="token operator">=</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"MyBundles"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">AssetBundle</span> assetBundle <span class="token operator">=</span> AssetBundle<span class="token punctuation">.</span><span class="token function">LoadFromFile</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>pathDir<span class="token punctuation">,</span> Name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token class-name">Object<span class="token punctuation">[</span><span class="token punctuation">]</span></span> x <span class="token operator">=</span> assetBundle<span class="token punctuation">.</span><span class="token function">LoadAllAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name">Object</span> o <span class="token operator">=</span> assetBundle<span class="token punctuation">.</span><span class="token function">LoadAsset</span><span class="token punctuation">(</span><span class="token string">"Cube"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token class-name">Object</span> o1 <span class="token operator">=</span> assetBundle<span class="token punctuation">.</span><span class="token function">LoadAsset</span><span class="token punctuation">(</span><span class="token string">"Cube.prefab"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token class-name">Object</span> o2 <span class="token operator">=</span> assetBundle<span class="token punctuation">.</span><span class="token function">LoadAsset</span><span class="token punctuation">(</span><span class="token string">"Assets/Cube.prefab"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"OK2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¡¨ç°å¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-11-23/m_5b4b541cc358119d2bdfde8bf1e09a6d_r.png" alt="" /></p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>æœ€åï¼Œç®€å•æµ‹è¯•ä¸€ä¸‹å„ä¸ªä¸åŒé€‰é¡¹æ‰“å‡ºæ¥èµ„æºå¤§å°ï¼š</p><h5 id="å›¾ç‰‡"><a class="anchor" href="#å›¾ç‰‡">#</a> å›¾ç‰‡</h5><pre><code>LZMAï¼štex_default:272 KB (279,003 å­—èŠ‚)tex_disablenameï¼š272 KB (278,994 å­—èŠ‚)tex_disablewritetypetreeï¼š271 KB (278,163 å­—èŠ‚)tex_disablewritetypetree_and_disablenameï¼š271 KB (278,147 å­—èŠ‚)Uncompress:tex_defaultï¼š466 KB (477,968 å­—èŠ‚)tex_disablenameï¼š466 KB (477,984 å­—èŠ‚)tex_disablewritetypetreeï¼š466 KB (477,904 å­—èŠ‚)tex_disablewritetypetree_and_disablenameï¼š466 KB (477,936 å­—èŠ‚)LZ4:tex_defaultï¼š302 KB (309,643 å­—èŠ‚)tex_disablenameï¼š302 KB (309,653 å­—èŠ‚)tex_disablewritetypetreeï¼š300 KB (308,172 å­—èŠ‚)tex_disablewritetypetree_and_disablenameï¼š300 KB (308,183 å­—èŠ‚)</code></pre><h5 id="prefab"><a class="anchor" href="#prefab">#</a> Prefab</h5><pre><code>LZMAï¼štex_defaultï¼š54.7 KB (56,036 å­—èŠ‚)tex_disablenameï¼š54.7 KB (56,040 å­—èŠ‚)tex_disablewritetypetreeï¼š47.6 KB (48,775 å­—èŠ‚)tex_disablewritetypetree_and_disablenameï¼š47.6 KB (48,789 å­—èŠ‚)Uncompress:tex_defaultï¼š194 KB (198,880 å­—èŠ‚)tex_disablenameï¼š194 KB (198,896 å­—èŠ‚)tex_disablewritetypetreeï¼š116 KB (119,168 å­—èŠ‚)tex_disablewritetypetree_and_disablenameï¼š116 KB (119,200 å­—èŠ‚)LZ4:tex_defaultï¼š80.2 KB (82,141 å­—èŠ‚)tex_disablenameï¼š80.2 KB (82,148 å­—èŠ‚)tex_disablewritetypetreeï¼š62.1 KB (63,668 å­—èŠ‚)tex_disablewritetypetree_and_disablenameï¼š62.1 KB (63,678 å­—èŠ‚)</code></pre><p>å¯ä»¥å‘ç°å®é™…æµ‹è¯•ä¸‹æ¥ï¼Œåœ¨èµ„æºåŒ…å¤§å°ä¸Š DisableWriteTypeTree å½±å“æ›´å¤§ï¼Œç‰¹åˆ«æ˜¯ Prefab èµ„æºï¼Œä¸å‹ç¼©å‡å°‘äº† 60% å·¦å³ã€LZ4 æ¨¡å¼å‡å°‘äº† 25% å·¦å³å¤§å°ï¼ŒLZMA ä¹Ÿæœ‰ 13%ã€‚<br />è™½ç„¶å¯¹çº¯å›¾ç‰‡èµ„æºè¿™ç§ (å…¶å®ƒéŸ³æ•ˆä¹‹ç±»ä¸€æ ·) å‡å°‘ä¸ä¼šå¾ˆæ˜æ˜¾ â€”â€” å·®ä¸å¤šå°± 1KB çš„æ ·å­ï¼Œæ¯•ç«Ÿå›¾ç‰‡èµ„æºçš„ meta é¡¹æœ¬èº«ä¹Ÿä¸ä¼šå¤ªå¤šã€‚</p><p>ç›¸å¯¹æ¥è¯´ç¦æ­¢åå­—åŠ è½½å¯¹èµ„æºåŒ…çš„å¤§å°åŸºæœ¬å°±æ²¡ä»€ä¹ˆå½±å“äº†ï¼Œé¡¶å¤šå‡ ä¸ªå­—èŠ‚çš„å·®å¼‚ (ç”šè‡³æ˜¯å¢åŠ å¤§å°)ï¼Œä¸è¿‡æ®è¯´ DisableLoadAssetByFileNameã€DisableLoadAssetByFileNameWithExtension<br /> æ›´å¤šæ˜¯å‡å°‘è¿è¡Œæ—¶å†…å­˜ â€”â€” è¿™ä¸€ç‚¹åœ¨ <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5M2QuY29tL1NjcmlwdFJlZmVyZW5jZS9CdWlsZEFzc2V0QnVuZGxlT3B0aW9ucy5EaXNhYmxlTG9hZEFzc2V0QnlGaWxlTmFtZS5odG1s">å®˜æ–¹æ–‡æ¡£</span> ä¹Ÿæœ‰æ˜ç¡®è¯´æ˜ï¼Œæ›´è¯¦ç»†çš„å†…å­˜æ–¹é¢çš„å¯¹æ¯”ï¼Œåç»­æˆ‘ä¼šå†è¿›è¡Œè¯¦ç»†æµ‹è¯•ã€‚</p><h3 id="å…¨æ‰“æ¥å£"><a class="anchor" href="#å…¨æ‰“æ¥å£">#</a> å…¨æ‰“æ¥å£</h3><p>å…³äºå…¨æ‰“æ¥å£ï¼Œå¤§æ¦‚å¯ä»¥æ€»ç»“å¦‚ä¸‹åŸºæœ¬è§„åˆ™ï¼š</p><ol><li><strong>èµ„æºä¸å…¶å¼•ç”¨èµ„æºéƒ½æŒ‡å®šäº†ä¸åŒçš„ AssetBunldeName ï¼Œä¼šåˆ†åˆ«åˆ†ç¦»å•æ‰“</strong></li><li><strong>æ²¡æœ‰æŒ‡å®š AssetBunldeNameï¼Œé‚£ä¹ˆä¼šè·Ÿå¼•ç”¨å®ƒçš„å¯¹è±¡æ‰“ä¸€ä¸ªåŒ…</strong></li><li><strong>æ²¡æœ‰æŒ‡å®š AssetBunldeNameï¼Œå­˜åœ¨å¤šä¸ªå¯¹å®ƒçš„å¼•ç”¨å°±ä¼šæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œé€ æˆå†…å­˜å†—ä½™</strong></li></ol><p>å¯¹äºå…¨æ‰“æ¥å£çš„å·¥ä½œåŸç†ï¼Œä½¿ç”¨ AssetBundles-Browser ä¹Ÿå¯ä»¥æ¯”è¾ƒæ¸…æ™°çœ‹å‡ºå…¶å…³ç³»ã€‚</p><p>è®¾ç½®å¯¹åº”çš„ AseetbundleName ä¹‹åï¼Œå°±ä¼šå±•ç¤ºåœ¨ AssetBundles-Browser ä¸­ã€‚</p><ol><li>Prefab å’Œ å›¾ç‰‡è®¾ç½®ä¸åŒ AseetbundleNameï¼š<br /><img data-src="/blogimages/2022/2022-11-23/m_2bd4afc7e2d136def3d3d0b3c35716bf_r.png" alt="" /></li><li>åªè®¾ç½® Prefab AseetbundleName:<br /><img data-src="/blogimages/2022/2022-11-23/m_06a422a91bf2e0782625afe388a5f7e2_r.png" alt="" /></li><li>ä¸æŒ‡å®š AssetbunldeNameï¼Œè€Œåˆæœ‰å¤šä¸ªå¯¹å®ƒäº§ç”Ÿå¼•ç”¨çš„å¯¹è±¡ï¼ŒAssetBundles-Browser éƒ½ä¼šç›´æ¥è¿›è¡Œæç¤ºï¼š<br /><img data-src="/blogimages/2022/2022-11-23/m_26177c9cb01b7f3e654c5b61cfd11c6b_r.png" alt="" /><br />è‹¥å¿½ç•¥æç¤ºï¼Œæ‰“åŒ…å‡ºæ¥ç»“æœå¦‚ä¸‹ï¼š<br /><img data-src="/blogimages/2022/2022-11-23/m_4b5774781fe0214bc8fa42a0fdae1c72_r.png" alt="" /><br />ä¸¤ä¸ª Assetbunlde åŒ…å°±åˆ†åˆ«åŒ…å«äº†ä¸¤ä»½åŒæ ·çš„å›¾ç‰‡èµ„æºã€‚</li></ol><p>è°ƒç”¨å…¨æ‰“æ¥å£ä»£ç ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"AssetBundleTest/PackALL"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Pack</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    BuildPipeline<span class="token punctuation">.</span><span class="token function">BuildAssetBundles</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"MyBundles"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BuildAssetBundleOptions<span class="token punctuation">.</span>DeterministicAssetBundle<span class="token punctuation">,</span> EditorUserBuildSettings<span class="token punctuation">.</span>activeBuildTarget<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    AssetDatabase<span class="token punctuation">.</span><span class="token function">Refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li>å¯¹äºä¸Šè¿°è®¾ç½®ä¸€ï¼Œä¼šç”Ÿæˆä¸¤ä¸ªåˆ†åˆ«åŒ…å« RawImage (test1) å’Œ Tex (tex) çš„ AssetBundle èµ„æºåŒ…</li><li>å¯¹äºä¸Šè¿°è®¾ç½®äºŒï¼Œä¼šç”Ÿæˆä¸€ä¸ªåŒæ—¶åŒ…å« RawImage å’Œ Tex çš„ AssetBundle èµ„æºåŒ…ï¼Œåå­—ä¸º ã€test1ã€</li><li>å¯¹äºä¸Šè¿°è®¾ç½®ä¸‰ï¼Œä¼šç”Ÿæˆä¸¤ä¸ªåŒæ—¶åŒ…å« Prefab å’Œ å›¾ç‰‡çš„ AssetBundle èµ„æºåŒ…ï¼Œåå­—ä¸º ã€test1ã€ã€ã€test2ã€</li></ul><p>ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1BlcmZhcmUvQXNzZXRTdHVkaW8=">AssetStudio</span> è¿›è¡Œè§‚å¯Ÿæ‰“å‡ºçš„ AssetBundle èµ„æºåŒ…ï¼Œå¯ä»¥éªŒè¯ä¸ä¸Šè¿°å…³ç³»ä¸€è‡´ã€‚</p><h3 id="å•æ‰“æ¥å£"><a class="anchor" href="#å•æ‰“æ¥å£">#</a> å•æ‰“æ¥å£</h3><p>å•æ‰“æ¥å£å®é™…è§„åˆ™ï¼Œè·Ÿå…¨æ‰“æœ‰ä¸€ç‚¹å·®å¼‚ã€‚</p><p>æ€»ç»“è§„åˆ™å¦‚ä¸‹ï¼š</p><ol><li><strong>è‹¥åªæœ‰ä¸»èµ„æºå­˜åœ¨åˆ—è¡¨ï¼Œæ— è®ºå¼•ç”¨èµ„æºæ˜¯å¦æœ‰è®¾ç½®å…¶å®ƒ AssetBundleNameï¼Œå…¶å¼•ç”¨èµ„æºä¼šè‡ªåŠ¨ä¸ä¸»èµ„æºæ‰“æˆä¸€ä¸ªåŒ…</strong></li><li><strong>è‹¥å°†ä¸»èµ„æºåŠå…¶å¼•ç”¨èµ„æºéƒ½ä¼ å…¥ï¼Œä¸”å¼•ç”¨èµ„æºæœ‰è‡ªå·±çš„ AssetBundleName ï¼Œé‚£ä¹ˆä¼šåˆ†åˆ«æ ¹æ®å„è‡ªçš„ AssetBundleName å•æ‰“</strong></li><li><strong><s>è‹¥å°†ä¸»èµ„æºåŠå…¶å¼•ç”¨èµ„æºéƒ½ä¼ å…¥ï¼Œä½†å¼•ç”¨èµ„æºæ²¡æœ‰è®¾ç½®è‡ªå·±çš„ AssetBundleName ï¼Œé‚£ä¹ˆå¼•ç”¨èµ„æºéƒ½æ‰“å…¥ä¸»èµ„æºä¸€ä¸ªåŒ…é‡Œã€‚</s>(æ³¨ï¼šæ­¤å¤„åº”å½“æ˜¯å› ä¸ºè§¦å‘äº†ç¬¬ä¸€é¡¹è§„åˆ™)</strong></li></ol><p>ä¸ã€å…¨æ‰“èµ„æºã€æœ€å¤§çš„åŒºåˆ«ï¼Œå¤§æ¦‚è¦æ•°ç¬¬ä¸€é¡¹ï¼šæ— è®ºè¢«å¼•ç”¨èµ„æºæ˜¯å¦è®¾ç½®è‡ªå·±çš„ AssetBundleNameï¼Œåªè¦è¿™æ¬¡å•æ‰“æ²¡æœ‰ä¼ å…¥å¼•ç”¨èµ„æºï¼Œé‚£ä¹ˆå°±ä¼šè¢«æ‰“å…¥ä¸»èµ„æºåŒ…é‡Œã€‚</p><p>å•æ‰“æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"AssetBundleTest/PackSelect(LZMA)"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PackSelectLZMA</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token function">PackSelect</span><span class="token punctuation">(</span>BuildAssetBundleOptions<span class="token punctuation">.</span>DeterministicAssetBundle<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PackSelect</span><span class="token punctuation">(</span><span class="token class-name">BuildAssetBundleOptions</span> opt<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> extName <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token class-name">Object</span> o <span class="token operator">=</span> Selection<span class="token punctuation">.</span>activeObject<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> AssetDatabase<span class="token punctuation">.</span><span class="token function">GetAssetPath</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token class-name">AssetImporter</span> importer <span class="token operator">=</span> AssetImporter<span class="token punctuation">.</span><span class="token function">GetAtPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>importer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token class-name">AssetBundleBuild</span> build <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssetBundleBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    build<span class="token punctuation">.</span>assetBundleName <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>extName<span class="token punctuation">)</span> <span class="token punctuation">?</span> importer<span class="token punctuation">.</span>assetBundleName <span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>importer<span class="token punctuation">.</span>assetBundleName<span class="token punctuation">,</span> <span class="token string">"_"</span><span class="token punctuation">,</span> extName<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    build<span class="token punctuation">.</span>assetNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">&#123;</span> path <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    BuildPipeline<span class="token punctuation">.</span><span class="token function">BuildAssetBundles</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"MyBundles"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssetBundleBuild<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">&#123;</span> build <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> opt<span class="token punctuation">,</span> EditorUserBuildSettings<span class="token punctuation">.</span>activeBuildTarget<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    AssetDatabase<span class="token punctuation">.</span><span class="token function">Refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ä»¥ä¸Šè¿°ã€PackSelectã€ä»£ç åŠä¸Šè¿°èµ„æºä¸ºä¾‹ï¼Œä¸º ã€RaweImageã€ã€RaweImage2ã€åŠã€Texã€åˆ†åˆ«è®¾ç½®ä¸åŒçš„ AssetBunldeNameï¼Œè°ƒç”¨ PackSelect ä¼ å…¥å„è‡ªçš„ AssetBunldeName åŠèµ„æºè·¯å¾„åˆ†åˆ«è¿›è¡Œå•æ‰“æ“ä½œï¼Œç»“æœï¼š<br /><img data-src="/blogimages/2022/2022-11-23/m_24dd53cc74994ba2914dce5568cb0a08_r.png" alt="" /><br />ä¸»èµ„æºåŠå…¶å¼•ç”¨å›¾ç‰‡è¢«æ‰“è¿›äº†ä¸€ä¸ªåŒ…é‡Œã€‚</p><p>å¯¹æ¯”è°ƒç”¨ ã€PackALLã€ å…¨æ‰“èµ„æºç»“æœï¼š<br /><img data-src="/blogimages/2022/2022-11-23/m_a445e82bab3e8e6d2ae40826775a5bd0_r.png" alt="" /><br />å…¶ä¸­ test1ã€test2 å‡å¼•ç”¨äº† tex èµ„æºï¼Œä»å¤§å°ä¸Šçœ‹å³å¯è¡¨æ˜å•æ‰“æ¥å£èµ„æºæ˜¯è¢«åˆ†åˆ«å•æ‰“çš„äº†ã€‚</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>è‹¥å•æ‰“èµ„æºï¼ŒåŒæ—¶ä¼ å…¥äº†ä¸»èµ„æºå’Œå¼•ç”¨èµ„æºå‘¢ï¼Ÿ</p><p>ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ã€PackSelectã€ä»£ç ï¼Œä½¿å…¶å¯ä»¥å•æ‰“æ‰€æœ‰ã€å½“å‰é€‰ä¸­ã€çš„èµ„æºï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"AssetBundleTest/PackSelectALL"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PackSelectALL</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token class-name">Object<span class="token punctuation">[</span><span class="token punctuation">]</span></span> o <span class="token operator">=</span> Selection<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetFiltered</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Object<span class="token punctuation">></span></span></span><span class="token punctuation">(</span>SelectionMode<span class="token punctuation">.</span>Assets<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token class-name">AssetBundleBuild<span class="token punctuation">[</span><span class="token punctuation">]</span></span> buildArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssetBundleBuild</span><span class="token punctuation">[</span>o<span class="token punctuation">.</span>Length<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token class-name">AssetImporter</span> importer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token class-name">AssetBundleBuild</span> build<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> buildArray<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        importer <span class="token operator">=</span> AssetImporter<span class="token punctuation">.</span><span class="token function">GetAtPath</span><span class="token punctuation">(</span>AssetDatabase<span class="token punctuation">.</span><span class="token function">GetAssetPath</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        build <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssetBundleBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        build<span class="token punctuation">.</span>assetBundleName <span class="token operator">=</span> importer<span class="token punctuation">.</span>assetBundleName<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        build<span class="token punctuation">.</span>assetNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">&#123;</span> importer<span class="token punctuation">.</span>assetPath <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        buildArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> build<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    BuildPipeline<span class="token punctuation">.</span><span class="token function">BuildAssetBundles</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"MyBundles"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> buildArray<span class="token punctuation">,</span> BuildAssetBundleOptions<span class="token punctuation">.</span>DeterministicAssetBundle<span class="token punctuation">,</span> EditorUserBuildSettings<span class="token punctuation">.</span>activeBuildTarget<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    AssetDatabase<span class="token punctuation">.</span><span class="token function">Refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>åˆšå¼€å§‹ç ”ç©¶è¿™ä¸ªå•æ‰“æ¥å£ï¼Œæˆ–è®¸ä¼šå†™å‡ºè¿™ç§å•æ‰“å½“å‰é€‰ä¸­æ‰€æœ‰èµ„æºçš„ä»£ç ï¼Œç„¶åæ€»ç»“å‡ºé”™è¯¯çš„ç»“è®º (æ¯”å¦‚è¯´æˆ‘)ï¼š<s>è‹¥ä¼ å…¥ä¸¤ä¸ªæ²¡æœ‰å¼•ç”¨å…³ç³»çš„èµ„æºï¼Œä½†æ˜¯éƒ½ä¸ºåŒä¸€ä¸ª assetBundleNameï¼Œå•æ‰“ä¼šæŠ¥é”™ï¼Œåªä¼šç”Ÿæˆå…¶ä¸­ä¸€ä¸ªèµ„æºçš„ assetBundle åŒ…ã€‚</s></p><p>ä½†è¦æ˜¯æ·±å…¥ä¸€ç‚¹æµ‹è¯•ã€æ€è€ƒä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°è¿™ç§å†™æ³•æ˜¯æœ‰é—®é¢˜çš„ã€‚</p><p>é—®é¢˜åœ¨å“ªå„¿å‘¢ï¼Ÿ</p><p>é¦–å…ˆå°è¯•ä¸Šè¿°ä»£ç æ‰§è¡Œï¼Œé€‰ä¸­ä¸¤ä¸ªè®¾ç½®äº†åŒä¸€ä¸ª assetBundleName çš„èµ„æºåï¼Œè°ƒç”¨ç»“æœï¼š</p><blockquote><p><font color=red>Trying to add file F:/Study/AssetbundleTest/Assets/MyBundles/tex.manifest to the list of ouptut files in the build report, but a file at that path has already been added.</font></p></blockquote><p>æ„æ€æ˜¯æ·»åŠ çš„æ–‡ä»¶é‡å¤äº†ï¼Œä½†æ˜æ˜¾èµ„æºåå­—æ˜¯ä¸åŒçš„ï¼Œé‚£é—®é¢˜å¯èƒ½å°±æ˜¯åœ¨ assetBundleNameï¼Ÿ</p><p>ç„¶åå¾€å‚æ•°é‚£è¾¹çœ‹ï¼Œæ¯ä¸€ä¸ª AssetBundleBuild ä¸­çš„ assetNames å‚æ•°å®é™…ä¸Šæ˜¯ä¸€ä¸ªã€æ•°ç»„ã€ï¼Œä¹Ÿå°±æ˜¯ä¸€ç³»åˆ—çš„èµ„æºè·¯å¾„ï¼Œæ‰€ä»¥å¯¹äºå•æ‰“æ¥å£ï¼Œæ¯ä¸ª AssetBundleBuild éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒä¸ä¼šè‡ªåŠ¨å»åˆ¤æ–­ä¼ å…¥çš„æ€»åˆ—è¡¨ä¸­æ˜¯å¦æœ‰é‡å¤çš„æ ‡ç­¾ï¼Œå› æ­¤éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»é‡ï¼šæŠŠåŒä¸€ä¸ªæ ‡ç­¾ï¼Œé‡å¤çš„åˆå¹¶åœ¨ä¸€ä¸ªç»“æ„ä¸­ã€‚</p><p>ä¿®æ”¹åä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"AssetBundleTest/PackSelectALL"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PackSelectALL</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token class-name">Object<span class="token punctuation">[</span><span class="token punctuation">]</span></span> o <span class="token operator">=</span> Selection<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetFiltered</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Object<span class="token punctuation">></span></span></span><span class="token punctuation">(</span>SelectionMode<span class="token punctuation">.</span>Assets<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token class-name">List<span class="token punctuation">&lt;</span>AssetBundleBuild<span class="token punctuation">></span></span> assetBundleBuilds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>AssetBundleBuild<span class="token punctuation">></span></span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token class-name">AssetImporter</span> importer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token class-name">AssetBundleBuild</span> build<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token class-name"><span class="token keyword">int</span></span> index<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> o<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        importer <span class="token operator">=</span> AssetImporter<span class="token punctuation">.</span><span class="token function">GetAtPath</span><span class="token punctuation">(</span>AssetDatabase<span class="token punctuation">.</span><span class="token function">GetAssetPath</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‡å¤</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        index <span class="token operator">=</span> assetBundleBuilds<span class="token punctuation">.</span><span class="token function">FindIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=></span> x<span class="token punctuation">.</span>assetBundleName <span class="token operator">==</span> importer<span class="token punctuation">.</span>assetBundleName<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            build <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssetBundleBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            build<span class="token punctuation">.</span>assetBundleName <span class="token operator">=</span> importer<span class="token punctuation">.</span>assetBundleName<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            build<span class="token punctuation">.</span>assetNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">&#123;</span> importer<span class="token punctuation">.</span>assetPath <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            assetBundleBuilds<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>build<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token comment">// é‡å¤ï¼Œåˆ™æ·»åŠ è¿›å»</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            build <span class="token operator">=</span> assetBundleBuilds<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> newAssets <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span>build<span class="token punctuation">.</span>assetNames<span class="token punctuation">.</span>Length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            newAssets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> importer<span class="token punctuation">.</span>assetPath<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            System<span class="token punctuation">.</span>Array<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>build<span class="token punctuation">.</span>assetNames<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> newAssets<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> build<span class="token punctuation">.</span>assetNames<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            build<span class="token punctuation">.</span>assetNames <span class="token operator">=</span> newAssets<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            assetBundleBuilds<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> build<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>    BuildPipeline<span class="token punctuation">.</span><span class="token function">BuildAssetBundles</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"MyBundles"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> assetBundleBuilds<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> BuildAssetBundleOptions<span class="token punctuation">.</span>DeterministicAssetBundle<span class="token punctuation">,</span> EditorUserBuildSettings<span class="token punctuation">.</span>activeBuildTarget<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    AssetDatabase<span class="token punctuation">.</span><span class="token function">Refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å†æ¬¡å°è¯•ï¼ŒåŒä¸€ä¸ª AssetBunldeName æ²¡æœ‰å¼•ç”¨å…³ç³»çš„å‡ ä¸ªèµ„æºï¼Œé¡ºåˆ©è¢«æ‰“å…¥åŒä¸€ä¸ª AssetBundle èµ„æºåŒ…ã€‚</p><h2 id="åŠ¨ç”»èµ„æº"><a class="anchor" href="#åŠ¨ç”»èµ„æº">#</a> åŠ¨ç”»èµ„æº</h2><p>æ˜¨å¤©ä¸»ç¨‹ä¼šæåˆ°äº†åŠ¨ç”»è„±å£³ï¼Œç®€å•è¯•ä¸€ä¸‹èµ„æºåŒ…å¤§å°ï¼š</p><p><img data-src="/blogimages/2022/2022-11-23/m_0fbdab2ab9986238e383a031a9f9af5e_r.png" alt="" /></p><p>ä¸Šè¿°åˆ†åˆ«ä¸ºï¼š</p><p>anim_offï¼šå¸¦ FBX åŠ¨ç”»ï¼Œå…³é—­ Anim.Compression<br />animallï¼šå¸¦ FBX åŠ¨ç”»ï¼ŒAnim.Compression ä¸ºé»˜è®¤çš„ KeyFramReduction<br />animreoptï¼šä¸å¸¦ FBX åŠ¨ç”»ï¼ŒAnim.Compression ä¸ºé»˜è®¤çš„ KeyFramReduction<br />animreduceï¼šä¸å¸¦ FBX åŠ¨ç”»ï¼ŒAnim.Compression ä¸º Optimal</p><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p>è°ƒç”¨å…¨æ‰“èµ„æºæ¥å£æ—¶ï¼š</p><ol><li><strong>èµ„æºä¸å…¶å¼•ç”¨èµ„æºéƒ½æŒ‡å®šäº†ä¸åŒçš„ AssetBunldeName ï¼Œä¼šåˆ†åˆ«åˆ†ç¦»å•æ‰“</strong></li><li><strong>æ²¡æœ‰æŒ‡å®š AssetBunldeNameï¼Œé‚£ä¹ˆä¼šè·Ÿå¼•ç”¨å®ƒçš„å¯¹è±¡æ‰“ä¸€ä¸ªåŒ…</strong></li><li><strong>æ²¡æœ‰æŒ‡å®š AssetBunldeNameï¼Œå­˜åœ¨å¤šä¸ªå¯¹å®ƒçš„å¼•ç”¨å°±ä¼šæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œé€ æˆå†…å­˜å†—ä½™</strong></li></ol><p>è°ƒç”¨å•æ‰“èµ„æºæ¥å£æ—¶ï¼š</p><ol><li><strong>è‹¥åªæœ‰ä¸»èµ„æºå­˜åœ¨åˆ—è¡¨ï¼Œæ— è®ºå¼•ç”¨èµ„æºæ˜¯å¦æœ‰è®¾ç½®å…¶å®ƒ AssetBundleNameï¼Œå…¶å¼•ç”¨èµ„æºä¼šè‡ªåŠ¨ä¸ä¸»èµ„æºæ‰“æˆä¸€ä¸ªåŒ…</strong></li><li><strong>è‹¥å°†ä¸»èµ„æºåŠå…¶å¼•ç”¨èµ„æºéƒ½ä¼ å…¥ï¼Œä¸”å¼•ç”¨èµ„æºæœ‰è‡ªå·±çš„ AssetBundleName ï¼Œé‚£ä¹ˆä¼šåˆ†åˆ«æ ¹æ®å„è‡ªçš„ AssetBundleName å•æ‰“</strong></li></ol><p>å–å†³äºé¡¹ç›®èµ„æºåŠ è½½ç®¡ç†ï¼Œå¯é‡‡ç”¨çš„ä¼˜åŒ–é€‰é¡¹ï¼šDisableWriteTypeTreeã€DisableLoadAssetByFileNameã€DisableLoadAssetByFileNameWithExtension</p><p>ä¾‹å¦‚ï¼Œåƒæˆ‘ä»¬é¡¹ç›®é€šè¿‡ AssetBundle.LoadAllAssets (LoadAllAssetsAsync) åŠ è½½å…¨éƒ¨èµ„æºï¼Œç„¶åç®¡ç†ï¼ŒAssetBundle è‡ªå¸¦çš„ LoadAsset (Name) æ¥å£æ˜¯ä¸ä¼šä½¿ç”¨çš„ï¼Œæ­¤æ—¶å°±å¯ä»¥ç¦ç”¨åå­—åŠ è½½ã€‚(æ­£å¸¸æƒ…å†µä¸‹åŠ è½½ä¸€ä¸ªèµ„æºï¼Œä¸€èˆ¬æ¥è¯´ä¹Ÿæ˜¯ä½¿ç”¨å®Œæ•´è·¯å¾„çš„)</p><p>å¦å¤–ï¼Œé€šå¸¸å‡ºåŒ…ä»¥åŠå‡ºçƒ­æ›´åŒ…å¿…ç„¶ä¹Ÿæ˜¯åŒä¸€ä¸ª Unity ç‰ˆæœ¬ (åº”è¯¥ä¸å¯èƒ½æœ‰ ã€é¡¹ç›®è¿˜åœ¨çº¿ä¸Šå°±å»åŠ¨ release åˆ†æ”¯ Unity ç‰ˆæœ¬ã€çš„æ“ä½œå§)ï¼Œæ­¤æ—¶å¯ä»¥ç¦ç”¨å†™å…¥ç±»å‹æ ‘ä»¥ä¼˜åŒ–å†…å­˜åŠåŠ è½½ã€‚</p><p><font color=red>å…¶å®ƒï¼šDeterministicAssetBundle ç»æµ‹è¯•ä¸å¤šæ–¹å¯¹æ¯”ï¼Œå¯ä»¥è®¤ä¸ºå…¨æ‰“èµ„æºé»˜è®¤å§‹ç»ˆåŒ…å«è¯¥é€‰é¡¹ï¼Œä»…å•æ‰“èµ„æºæ—¶è¯¥é¡¹ä¼šå¯¹èµ„æºäº§ç”Ÿé¢å¤–å½±å“ã€‚(è¿™å¤§æ¦‚ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåŒä¸ºã€å§‹ç»ˆå¯ç”¨ã€çš„ CollectDependencies è¢«æ ‡è®°ä¸ºå¼ƒç”¨ï¼Œä½†å®ƒæ²¡æœ‰ â€”â€” å¤§æ¦‚å°±æ˜¯å› ä¸º DeterministicAssetBundle å¯¹äºå•æ‰“è¯¥é€‰é¡¹è¿˜æœ‰æ•ˆ)</font></p><blockquote><p>å‚è€ƒæ–‡æ¡£ï¼š</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuL2N1cnJlbnQvU2NyaXB0UmVmZXJlbmNlL0J1aWxkUGlwZWxpbmUuQnVpbGRBc3NldEJ1bmRsZXMuaHRtbA==">BuildPipeline.BuildAssetBundles</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuL2N1cnJlbnQvTWFudWFsL0Fzc2V0QnVuZGxlcy1CdWlsZGluZy5odG1s">AssetBundles-Building</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIudW5pdHkuY24vcHJvamVjdHMvNjE1NjYyMjNlZGJjMmEwMDIxNTU3MzY0">Asset çš„ä¸€ç”Ÿ</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWJnYW1lL3AvMzk3MzE3Ny5odG1s">Unity AssetBundle çˆ¬å‘æ‰‹è®°</span></li><li><a href="https://answer.uwa4d.com/question/5a7a8b23847802258a065038">AB å¢é‡æ‰“åŒ…é—®é¢˜<br /></a></li><li><a href="https://forum.unity.com/threads/is-the-deterministic-asset-bundle-option-obsolete.455510/">Is the deterministic asset bundle option obsolete?<br /></a></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuL2N1cnJlbnQvU2NyaXB0UmVmZXJlbmNlL0J1aWxkQXNzZXRCdW5kbGVPcHRpb25zLkRldGVybWluaXN0aWNBc3NldEJ1bmRsZS5odG1s">DeterministicAssetBundle</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5M2QuY29tL1NjcmlwdFJlZmVyZW5jZS9CdWlsZEFzc2V0QnVuZGxlT3B0aW9ucy5EaXNhYmxlTG9hZEFzc2V0QnlGaWxlTmFtZS5odG1s">DisableLoadAssetByFileName</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9mb3J1bS51bml0eS5jb20vdGhyZWFkcy9hc3NldGJ1bmRsZXMtYW5kLWRlcGVuZGVuY2llcy4zNzc3NjAv">assetbundles-and-dependencies</span></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰å…¶å®æœ‰å†™ä¸€ç¯‡ ã€&lt;a href=&quot;&quot;&gt;AssetBundle çš„å®é™…æµ‹è¯•ä¸æ€»ç»“&lt;/a&gt;ã€çš„æ–‡ç« ï¼Œä¸è¿‡ç°åœ¨çœ‹äº†ä¸‹ï¼Œæ„Ÿè§‰æ¼äº†ä¸€äº›ï¼Œè€Œä¸”ä¸å¤Ÿå®Œå–„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="AssetBundle" scheme="https://cwhisme.github.io/categories/Unity3D/AssetBundle/"/>
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/tags/Unity3D/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://cwhisme.github.io/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="AssetBundle" scheme="https://cwhisme.github.io/tags/AssetBundle/"/>
    
  </entry>
  
  <entry>
    <title>StringBuilder æ‰©å®¹è§„åˆ™ç ”ç©¶</title>
    <link href="https://cwhisme.github.io/2022/11/18/StringBuilder%E6%89%A9%E5%AE%B9%E8%A7%84%E5%88%99%E7%A0%94%E7%A9%B6/"/>
    <id>https://cwhisme.github.io/2022/11/18/StringBuilder%E6%89%A9%E5%AE%B9%E8%A7%84%E5%88%99%E7%A0%94%E7%A9%B6/</id>
    <published>2022-11-18T09:37:51.000Z</published>
    <updated>2022-12-22T03:29:48.151Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>åœ¨ä¸Šé¢ <a href="">å¯¹é¡¹ç›®å­—ç¬¦ä¸²æ€§èƒ½ä¼˜åŒ–æ–¹å¼åŠæµ‹è¯•</a> æ–‡ç« ä¸­ï¼Œæˆ‘æŸ¥çœ‹äº† StringBuilder çš„æºç ï¼Œå¹¶æ€»ç»“å‡ºäº† StringBuilder çš„ä¸€èˆ¬åŠè‡ªåŠ¨æ‰©å®¹è§„åˆ™ï¼š</p><p>å®¹é‡è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ unsafe æ–¹æ³•è¿›è¡ŒæŒ‡é’ˆåŠç›´æ¥å†…å­˜æ“ä½œï¼š</p><ol><li>è·å–æ·»åŠ çš„å­—ç¬¦ä¸²æŒ‡é’ˆ</li><li>è·å–å­—ç¬¦æ•°ç»„å¾…æ·»åŠ ä¸‹æ ‡æŒ‡é’ˆ</li><li>è°ƒç”¨ Buffer.Memcpy è¿›è¡Œå†…å­˜æ‹·è´è¿›å­—ç¬¦æ•°ç»„</li></ol><p>å¦‚æœåç»­å®¹é‡ä¸å¤Ÿï¼Œåˆ™è¿›è¡ŒåŠ¨æ€æ‰©å®¹ï¼Œä¸è¿‡åŠ¨æ€æ‰©å®¹ä¸æ˜¯ç›´æ¥æ‰©å®¹å­—ç¬¦æ•°ç»„ï¼Œè€Œæ˜¯é€šè¿‡å•å‘é“¾è¡¨çš„æ–¹å¼ï¼š</p><p><strong>å°†å½“å‰æ•°æ®å…¨éƒ¨è½¬ç§»è‡³ã€ä¸Šä¸€ä¸ªã€èŠ‚ç‚¹ï¼Œç„¶åè‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦æ•°ç»„è¿›è¡Œå¤„ç†ã€‚</strong></p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ StringBuilderï¼ŒæŠŠè‡ªå·±å½“å‰æ‰€æœ‰æ•°æ®è½¬ç§»è¿‡å»ï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ç»§ç»­ç»§ç»­å¤„ç†ä½™ä¸‹çš„ã€‚</p><p>ç„¶åå°±ä¸€ç›´æœ‰ä¸ªç–‘é—®ï¼šå¦‚ä½•åšåˆ°æ¯æ¬¡æ‰©å®¹æ˜¯ä¹‹å‰çš„ 2 å€å¤§å°çš„ï¼Ÿ</p><p>ç„¶åç°åœ¨ç ”ç©¶åŠå¤©å‘ç°ï¼Œéƒ½çŸ¥é“å®ç°æ‰©å®¹çš„å…·ä½“æ–¹æ³•æ˜¯é€šè¿‡å•é“¾è¡¨ï¼Œ2 å€æ‰©å®¹çš„åŸç†å…¶å®å·²ç»æ˜¯æ˜é¢ä¸Šçš„è§„åˆ™äº†ï¼šæ˜¯ä¸ªéå¸¸ç®€å•çš„åŸç†ï¼Œåªæ˜¯æ€ç»´ä¸Šä¸€ç›´æ²¡è€ƒè™‘åˆ°è€Œå·²ï¼Œæ‰€ä»¥ä½œä¸ªè®°å½•ã€‚</p><p>è¿™é‡Œå‰è¨€å…ˆä¸è¯´å…·ä½“åŸç†ï¼Œä»è¯•éªŒå’Œæµ‹è¯•å¼€å§‹ï¼Œå…·ä½“çš„ç•™åˆ°æ–‡åæ€»ç»“å†å†™å§ã€‚</p><h2 id="æ‰©å®¹æµ‹è¯•"><a class="anchor" href="#æ‰©å®¹æµ‹è¯•">#</a> æ‰©å®¹æµ‹è¯•</h2><p>StringBuilder é»˜è®¤å®¹é‡æ˜¯ 16 ä¸ªå­—ç¬¦ï¼Œå¦‚æœæµ‹è¯•æ‰©å®¹çš„è¯ï¼Œæ•°é‡å¤ªå¤§å®¹æ˜“æ··æ·†ã€‚</p><p>å› æ­¤æˆ‘ä¼ è®¾ç½®äº†é»˜è®¤çš„å®¹é‡ 1ï¼Œå¹¶ä¾æ¬¡ä¼ å…¥ 1ã€2ã€3ã€4ã€5ï¼Œå¹¶æ‰“å°æ¯ä¸ªæ•°å€¼ Append ä¹‹åå®¹é‡å¤§å°ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">/// æ‰§è¡Œæµ‹è¯•</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å…¶ç»“æœä¸ºï¼š</p><pre><code>12448</code></pre><p>å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡æ‰©å®¹å®¹é‡éƒ½æ˜¯ä»¥ 2 å€é€’å¢ï¼Œæ‰€ä»¥ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ç”¨åç¼–è¯‘å·¥å…·å¯¹ StringBuilder çš„æºä»£ç çœ‹äº†åˆçœ‹ï¼Œæœ‰ç‚¹æƒ³ä¸æ˜ç™½ã€‚</p><p>æƒ³ä¸æ˜ç™½å°±åƒè¯•ä¸€è¯•ï¼Œç›´æ¥ä¸Šè°ƒè¯•å¤§æ³•ï¼Œæ–­ç‚¹æ‰“åˆ° StringBuilder é‡Œè¾¹å»ï¼š</p><p><img data-src="/blogimages/2022/2022-11-18/m_28c3073b4ee0fe17074da5a4471f73b6_r.png" alt="" /></p><p>ä¸Šè¿°æˆªå›¾æ˜¾ç¤ºçš„æ˜¯ï¼šå½“å‰ StringBuilder å®¹é‡ä¸º 2ï¼Œä¸” Append (3) çš„æƒ…å†µã€‚</p><p>ç›¯ç€è¿™ä¸ªçœ‹äº†ä¸‹ï¼Œè®¡ç®—äº†ä¸€ä¸‹æ•°å€¼ä¸ç»“æœï¼Œä¸€ä¸ªä¸ªåˆ†æä¸‹ï¼š</p><ul><li>minBlockCharCount å½“å‰ä¸º 1</li><li>å½“å‰é•¿åº¦ Length ä¸º 2</li><li>æ‰©å®¹é•¿åº¦ä¸º Max (Length,minBlockCharCount)[8000 æ˜¯ç¿»å€ä¸Šé™ï¼Œåç»­ç¿»å€åˆ°è¿™æ•°é‡çº§åæœ€å¤šæ‰©å®¹ 8000ï¼Œé™¤éä¼ å…¥å­—ç¬¦ä¸²å‰©ä½™å­—ç¬¦å¤§äº 8000]</li><li>å³æ‰©å®¹ Max (2,1)</li></ul><p>è€Œ Length åœ¨è¿™é‡Œæ˜¯ä¸ªå±æ€§ï¼Œç‚¹è¿› Length å»çœ‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// å½“å‰å®é™…å­˜å‚¨å­—ç¬¦é•¿åº¦</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Length</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">get</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkOffset <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkLength<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å…¶ç”± m_ChunkOffset+m_ChunkLength æ„æˆã€‚</p><p>å°†ä»£ç å¾€ä¸Šä¸€å±‚çš„  <code>Append(char* value, int valueCount)</code>  æ–¹æ³•ç§»åŠ¨ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// å½“ç©ºé—´ä¸è¶³èµ°æ‰©å®¹é€»è¾‘æ—¶</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">else</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// å½“å‰å‰©ä½™å®¹é‡</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> num3 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkChars<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkLength<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span>num3 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// å‰©ä½™å®¹é‡å¤§äº 0ï¼Œå°±å…ˆå¤åˆ¶ä¸€éƒ¨åˆ†å¡«æ»¡</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ReadOnlySpan<span class="token punctuation">&lt;</span><span class="token keyword">char</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token keyword">value</span><span class="token punctuation">,</span> num3<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">CopyTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkChars<span class="token punctuation">.</span><span class="token function">AsSpan</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//m_ChunkLength è®¾ç½®ä¸ºå­—ç¬¦æ•°ç»„æ»¡é•¿åº¦</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkLength <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkChars<span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// è‡³å°‘æ‰©å®¹é•¿åº¦ = æ·»åŠ å­—ç¬¦ä¸²é•¿åº¦ - å‰©ä½™å·²æ·»åŠ å­—ç¬¦é•¿åº¦</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> num4 <span class="token operator">=</span> valueCount <span class="token operator">-</span> num3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">// æ‰§è¡Œæ‰©å®¹</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ExpandByABlock</span><span class="token punctuation">(</span>num4<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">// å°†å‰©ä½™å­—ç¬¦å¤åˆ¶è¿›æ‰©å®¹åçš„å­—ç¬¦æ•°ç»„ï¼ˆä»¥å‰çš„å·²ç»å˜æˆé“¾è¡¨çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹äº†ï¼‰</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ReadOnlySpan<span class="token punctuation">&lt;</span><span class="token keyword">char</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">value</span> <span class="token operator">+</span> num3<span class="token punctuation">)</span><span class="token punctuation">,</span> num4<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">CopyTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkChars<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// è®¾ç½®å½“å‰ StringBuilder å·²ä½¿ç”¨é•¿åº¦</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkLength <span class="token operator">=</span> num4<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œæ¯æ¬¡æ‰©å®¹ä¹‹å‰ï¼Œå‰ä¸€ä¸ªæ•°ç»„å¿…ç„¶æ˜¯è¢«å¡«æ»¡çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p><ul><li>m_ChunkLength = ä¸Šä¸€ä¸ªèŠ‚ç‚¹å®é™…ä½¿ç”¨å­—ç¬¦é•¿åº¦</li><li>m_ChunkOffset ç›´æ¥å¯ä»¥åœ¨æ‰©å®¹æ–¹æ³•ä¸­çœ‹åˆ°ï¼Œä¸ºå‰é¢æ‰€æœ‰èŠ‚ç‚¹çš„ m_ChunkLength (é€šè¿‡ += èµ‹å€¼çš„)</li></ul><p>ç”±æ­¤å¯ä»¥å¾—å‡ºç»“æœï¼šåœ¨æ‰©å®¹çš„æ—¶å€™ï¼ŒLength=this.m_ChunkOffset + this.m_ChunkLength = æ‰€æœ‰èŠ‚ç‚¹çš„æ€»é•¿åº¦<br /> (æ³¨ï¼šåªæœ‰åœ¨æ‰©å®¹çš„æ—¶å€™æ‰æ˜¯å¦‚æ­¤ï¼Œå¦åˆ™ Capacity [this.m_ChunkChars.Length + this.m_ChunkOffset] æ‰æ˜¯å°±ç®—æ²¡è£…æ»¡çš„æ‰€æœ‰èŠ‚ç‚¹çš„æ€»å®¹é‡)</p><p>å½“ä¾ç…§ æ‰€æœ‰èŠ‚ç‚¹çš„æ€»é•¿åº¦ åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ–°èŠ‚ç‚¹çš„å­—ç¬¦æ•°ç»„é•¿åº¦å³ä¸ºä¹‹å‰æ‰€æœ‰èŠ‚ç‚¹æ€»å’Œã€‚</p><p>è¿™æ—¶å€™ç»Ÿè®¡çš„å°±æ˜¯æ–°çš„èŠ‚ç‚¹åŠ ä¸Šä»¥å‰æ‰€æœ‰èŠ‚ç‚¹é•¿åº¦ï¼Œä¸¤è€…ç›¸åŠ ï¼šç›¸å½“äºå°±æ‰©å®¹äº†ä¸¤å€ï¼</p><p>ä¾‹å¦‚æ—§çš„æ‰€æœ‰èŠ‚ç‚¹ç›¸åŠ ä¸º 32ï¼Œæ‰©å®¹çš„æ–°èŠ‚ç‚¹ä¸º 32ï¼Œé‚£ä¹ˆæ–°çš„æ€»èŠ‚ç‚¹å®¹é‡å°±æ˜¯ 64..... ä»¥æ­¤ç±»æ¨ã€‚</p><p>ç„¶åå°±ç„•ç„¶å¤§æ‚Ÿäº†ï¼ŒåŸæ¥è¿™ä¹ˆå›äº‹å•Šã€‚</p><h2 id="æ€§èƒ½æµ‹è¯•"><a class="anchor" href="#æ€§èƒ½æµ‹è¯•">#</a> æ€§èƒ½æµ‹è¯•</h2><p>ç°åœ¨çŸ¥é“æ‰©å®¹ä¸ºä»€ä¹ˆæ˜¯ç¿»å€çš„äº†ã€‚</p><p>ç„¶ååœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œçªç„¶æƒ³åˆ°æ’å…¥é—®é¢˜ï¼Œæ’å…¥ä¸è¿½åŠ æ˜¾ç„¶æ˜¯ä¸åŒçš„æ–¹æ³•ï¼šæ¯”è¾ƒå•é“¾è¡¨çš„æ¨¡å¼ï¼Œæ¯ä¸ªé“¾è¡¨èŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬æ•°ç»„ï¼Œæƒ³å¾€å‰é¢çš„æ•°ç»„æ’å…¥å€¼ï¼Ÿ</p><p>æƒ³æƒ³è¿™ç§æ¨¡å¼æ’å…¥å°±ä¸å¤§å¥½åŠï¼Œçœ‹äº†ä¸‹ Insert ä»£ç ï¼Œæ’å…¥ä¸€æ¬¡å°±å¾—åˆ›å»ºä¸€ä¸ª StringBuilder (é™¤éä¹‹å‰çš„èŠ‚ç‚¹æœ‰ç©ºé—²ç©ºé—´ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸å¯èƒ½)</p><p>è€Œä¸”ï¼Œä¸éµå®ˆæ‰©å®¹è§„åˆ™ï¼šæœ€å¤§ä¸ºæ‰©å®¹å­—ç¬¦ä¸²é•¿åº¦ï¼Œæœ€å°ä¸ºé»˜è®¤çš„ 16 ä¸ªå­—ç¬¦ï¼Œç„¶åé‡è¿é“¾è¡¨ç»“æ„ã€‚</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//MakeRoomsï¼šæ¯æ¬¡è°ƒç”¨æ’å…¥ï¼Œéƒ½ä¼šå…ˆåˆ›å»ºä¸€ä¸ª StringBuilder å ä½ï¼Œç„¶åå¡«å……æ•°æ®ï¼Œä¸€ä¸€å¤„ç†é“¾è¡¨èŠ‚ç‚¹</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">StringBuilder</span> stringBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> chunk<span class="token punctuation">.</span>m_MaxCapacity<span class="token punctuation">,</span> chunk<span class="token punctuation">.</span>m_ChunkPrevious<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>å¦‚æœæ’å…¥çš„ä¸‹æ ‡æ­£å¥½è¿˜å¤„äºæŸä¸€ä¸ªèŠ‚ç‚¹å­—ç¬¦æ•°æ®ä¸­é—´ï¼Œè¿˜éœ€è¦éå†é“¾è¡¨é€šè¿‡ CopyTo ç§»åŠ¨æ•°æ®ï¼Œæ‰€ä»¥æ’å…¥æ“ä½œæ˜¯æ¯”è¾ƒè€—æ—¶çš„ã€‚</p><h3 id="æµ‹è¯•ä»£ç "><a class="anchor" href="#æµ‹è¯•ä»£ç ">#</a> æµ‹è¯•ä»£ç </h3><p>ä¸ºæ­¤æˆ‘å°è¯•ä½¿ç”¨ TestRunner è¿›è¡Œæµ‹è¯•ï¼Œåˆ†åˆ«æµ‹è¯• è¿½åŠ ã€æ’å…¥å¼€å§‹ã€æ’å…¥ä¸­é—´ã€æ’å…¥ç»“æŸçš„æ€§èƒ½ã€‚</p><p>æ¯ä¸ªæ“ä½œåˆ†åˆ«è¿›è¡Œ 100000 æ¬¡ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> TestNum <span class="token operator">=</span> <span class="token number">100000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestAppend</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>            builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"TestAppend Capacity"</span> <span class="token operator">+</span> builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestInsertStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            builder<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"TestInsertStart Capacity"</span> <span class="token operator">+</span> builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestInsertMiddle</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            builder<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"TestInsertMiddle Capacity"</span> <span class="token operator">+</span> builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestInsertEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            builder<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Length<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"TestInsertEnd Capacity"</span> <span class="token operator">+</span> builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestAppendNormalParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>            builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>            builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>            builder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token string">"Y"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"TestAppendNormalParams Capacityï¼š"</span> <span class="token operator">+</span> builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Test</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestAppendFormatParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>            builder<span class="token punctuation">.</span><span class="token function">AppendFormat</span><span class="token punctuation">(</span><span class="token string">"X&#123;0&#125;Y"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"TestAppend Capacityï¼š"</span> <span class="token operator">+</span> builder<span class="token punctuation">.</span>Capacity<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><pre><code>TestAppend (0.026s)---TestAppend Capacity104192TestAppendNormalParams (0.030s)---TestAppendNormalParams Capacityï¼š304192TestAppendFormatParams (0.032s)---TestAppend Capacityï¼š304192TestInsertStart (5.795s)---TestInsertStart Capacity100000TestInsertMiddle (2.852s)---TestInsertMiddle Capacity100000TestInsertEnd (0.069s)---TestInsertEnd Capacity100000</code></pre><p>ç”±äºæ’å…¥æ“ä½œå¿…é¡»å¯¹æ’å…¥èŠ‚ç‚¹åç»­çš„èŠ‚ç‚¹ä½œé¢å¤–å¤„ç†ï¼Œå› æ­¤æ’å…¥è¶Šé å‰æ¶ˆè€—è¶Šå¤§ï¼Œå¯ä»¥çœ‹å‡ºå³ä½¿æ˜¯ç›´æ¥æ’å…¥æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯æ¯”è¿½åŠ å­—ç¬¦æ“ä½œæ›´ä¸ºè€—æ—¶çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ StringBuilder æ—¶ï¼Œå°½é‡ä¸è¦é‡‡ç”¨æ’å…¥æ“ä½œã€‚</p><p>å¦å¤– AppendFormat é‡‡ç”¨äº†ä¸ string.Format ç±»ä¼¼çš„å¤„ç†æ–¹å¼ï¼šéå†å­—ç¬¦ä¸²æ‰¾å ä½ç¬¦ï¼Œå› æ­¤ä¹Ÿä¼šé€ æˆå¤šä½™æ¶ˆè€— (è¿™é‡Œå› ä¸ºåªæœ‰ä¸€ä¸ªå ä½ç¬¦ï¼Œå› æ­¤ä¸æ™®é€š 3 æ¬¡è¿½åŠ å·®è·ä¸å¤§ï¼Œä½†æ¶ˆè€—ç¡®å®ä¹Ÿå¤šäº†ï¼Œå ä½ç¬¦è¶Šå¤šæ¶ˆè€—è¶Šå¤§)ã€‚</p><h3 id="ç–‘é—®"><a class="anchor" href="#ç–‘é—®">#</a> ç–‘é—®</h3><p>ä¹‹å‰çœ‹æºç ï¼Œæ’å…¥æ—¶é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„ StringBuilder æ’å…¥é“¾è¡¨ï¼Œä¸”é»˜è®¤æœ€å°å®¹é‡ä¸º 16ã€‚</p><p>ä½†æ˜¯ç°åœ¨ä¸ºä»€ä¹ˆæ‰“å°å‡ºæ¥çš„ Capacity å®¹é‡ï¼Œè¿™é‡Œæ’å…¥æ“ä½œçš„å¢åŠ åè€Œæœ€å°ï¼Ÿéš¾é“ä¹‹å‰åˆ†æé”™äº†ï¼Ÿ</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>äºæ˜¯å¦å¤–å†™äº†ä¸€ä»½æ›´ç®€å•çš„æ’å…¥ä»£ç ï¼ŒæŸ¥çœ‹é“¾è¡¨æ’å…¥èŠ‚ç‚¹ä¿¡æ¯ï¼š</p><p><img data-src="/blogimages/2022/2022-11-18/m_71f1f5a195aab49f88c42ce132b4910e_r.png" alt="" /></p><p><strong>Capacity=this.m_ChunkChars.Length + this.m_ChunkOffset<br />m_ChunkLength = ä¸Šä¸€ä¸ªèŠ‚ç‚¹å®é™…ä½¿ç”¨å­—ç¬¦é•¿åº¦<br /> m_ChunkChars.Length = å­—ç¬¦æ•°ç»„é•¿åº¦<br /> m_ChunkOffset = ä¹‹å‰èŠ‚ç‚¹å®é™…ä½¿ç”¨é•¿åº¦æ€»å’Œ</strong></p><p>è¿™é‡Œæ’å…¥èµ·å§‹çš„è¿™ä¸ªèŠ‚ç‚¹ï¼ŒçœŸå®å®¹é‡ Capacity=16<br /> ä½†æ˜¯åˆ°äº†åç»­èŠ‚ç‚¹ï¼Œç”±äºåè¾¹èŠ‚ç‚¹åªç»Ÿè®¡å®é™…ä½¿ç”¨é•¿åº¦ï¼Œåç»­èŠ‚ç‚¹ Capacity=1 + å½“å‰å­—ç¬¦æ•°ç»„é•¿åº¦ ï¼Œå¯¼è‡´åªç»Ÿè®¡äº†æ’å…¥å­—ç¬¦ä¸²å®é™…é•¿åº¦å¤§å°ï¼Œå®¹é‡å°±å˜å›å»äº†ã€‚</p><p>æ‰€ä»¥å¯¹äºæ’å…¥çš„èŠ‚ç‚¹ï¼Œæµ‹è¯•æ‰“å°å‡ºæ¥çš„ Capacity å¢åŠ å¾ˆå°æ˜¯ä¸ªé”™è§‰ï¼Œæ¯ä¸ªæ’å…¥çš„ StringBuilder ä¾ç„¶è¿˜æ˜¯æœ‰å ç”¨ï¼Œè‡³å°‘ 16 ä¸ªç©ºå­—ç¬¦æ•°ç»„å¤§å°ã€‚</p><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p>æœ€åå‘ç°åŸå› å°±æ˜¯è¿™ä¹ˆç®€å•ï¼šå› ä¸ºæ˜¯é“¾è¡¨ç»“æ„ï¼Œæ‰©å®¹çš„æ–°èŠ‚ç‚¹é•¿åº¦ç­‰äºä»¥å‰èŠ‚ç‚¹æ€»å’Œï¼Œæ‰€ä»¥åŒæ ·æœ‰äº†å€å¢çš„æ•ˆæœã€‚</p><p>ä¸è¿‡æ’å…¥æ“ä½œåˆ™ä¼šæ‰“ä¹±å€å¢è§„å¾‹ï¼šä¾‹å¦‚åŸæœ¬ 4 ä¸ªä¸‹ä¸€æ¬¡å€å¢åº”è¯¥ä¸º 8ï¼Œè‹¥æ­¤æ—¶æ’å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œä¸‹ä¸€æ¬¡åˆ™æ‰©å®¹ä¸º 10ã€‚</p><p>å¦å¤– AppendFormat åŸç†ä¸æ™®é€š string.Format ç±»ä¼¼ï¼šéå†å­—ç¬¦ä¸²æ‰¾å ä½ç¬¦ï¼Œå› æ­¤ä¹Ÿä¼šé€ æˆå¤šä½™æ¶ˆè€—ã€‚</p><p>åŒæ—¶é¡ºä¾¿æµ‹è¯•äº†ä¸‹è¿½åŠ ä¸æ’å…¥ç­‰æ“ä½œçš„æ€§èƒ½ï¼Œæ’å…¥åŸç†æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ã€è‡³å°‘ 16 ä¸ªå­—ç¬¦å®¹é‡çš„ StringBuilderï¼Œæ€§èƒ½æ¶ˆè€—å¾ˆå¤§ï¼Œå› æ­¤å¾—å‡ºå°½é‡ä¸è¦ä½¿ç”¨æ’å…¥æ“ä½œçš„ç»“è®ºã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸Šé¢ &lt;a href=&quot;&quot;&gt;å¯¹é¡¹ç›®å­—ç¬¦ä¸²æ€§èƒ½ä¼˜åŒ–æ–¹å¼åŠæµ‹è¯•&lt;/a&gt; æ–‡ç« ä¸­ï¼Œæˆ‘æŸ¥çœ‹äº† StringBuilder çš„æºç ï¼Œå¹¶æ€»ç»“å‡ºäº† StringBuilder </summary>
      
    
    
    
    <category term="ç†è®ºç ”ç©¶" scheme="https://cwhisme.github.io/categories/%E7%90%86%E8%AE%BA%E7%A0%94%E7%A9%B6/"/>
    
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://cwhisme.github.io/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="C#" scheme="https://cwhisme.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>ç®€å•æµ‹è¯•æ‰‹åŠ¨åƒåœ¾å›æ”¶</title>
    <link href="https://cwhisme.github.io/2022/11/17/%E6%B5%8B%E8%AF%95%E6%89%8B%E5%8A%A8%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/"/>
    <id>https://cwhisme.github.io/2022/11/17/%E6%B5%8B%E8%AF%95%E6%89%8B%E5%8A%A8%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/</id>
    <published>2022-11-17T08:28:06.000Z</published>
    <updated>2022-12-22T03:29:48.150Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>è¿™ä¸¤å¤©åˆå¤ä¹ äº†ä¸‹åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œåœ¨çœ‹åˆ° ææ„å‡½æ•° çš„æ—¶å€™ï¼Œçªç„¶æƒ³åˆ°ï¼šææ„å‡½æ•°æ˜¯åœ¨çœŸæ­£åƒåœ¾å›æ”¶æ—¶æ‰ä¼šæ‰§è¡Œçš„ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥ç”¨è¿™ä¸ªæ¥æµ‹è¯•ä¸€ä¸ªå¯¹è±¡ï¼Œä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥ç«‹å³è¢«åƒåœ¾å›æ”¶ï¼Ÿæˆ–è€…è¯´å˜æˆåƒåœ¾å¯¹è±¡ã€‚</p><p>ä¾‹å¦‚ï¼Œä½¿ç”¨å®Œæ¯•åç«‹å³èµ‹å€¼ä¸ºç©ºï¼Œå®ƒå˜æˆåƒåœ¾å¯¹è±¡äº†å—ï¼Ÿè¿˜æ˜¯å…¶å®ƒä»€ä¹ˆæ—¶æœºæ‰ä¼šã€‚</p><p>æµ‹è¯•æ–¹å¼ä¸ºï¼šåœ¨ä¸åŒåœºæ™¯ä¸‹ï¼Œè°ƒç”¨ GC.Collect ï¼Œå¹¶æŸ¥çœ‹è¿è¡Œç»“æœï¼šææ„å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨ã€‚</p><h2 id="å‡†å¤‡"><a class="anchor" href="#å‡†å¤‡">#</a> å‡†å¤‡</h2><p>å·¥å…·ï¼š</p><ul><li>VS2022</li><li>.Net6.0</li><li>æµ‹è¯•ç±»ï¼š</li></ul><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">TestClass</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Doingï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token operator">~</span><span class="token function">TestClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"è¢«åƒåœ¾è¢«å›æ”¶äº†ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a class="anchor" href="#æµ‹è¯•">#</a> æµ‹è¯•</h2><h3 id="1æƒ…æ™¯ä¸€æ–¹æ³•å†…éƒ¨å®šä¹‰å¯¹è±¡ä½¿ç”¨åèµ‹å€¼ä¸ºç©º"><a class="anchor" href="#1æƒ…æ™¯ä¸€æ–¹æ³•å†…éƒ¨å®šä¹‰å¯¹è±¡ä½¿ç”¨åèµ‹å€¼ä¸ºç©º">#</a> 1ï¼‰æƒ…æ™¯ä¸€ï¼šæ–¹æ³•å†…éƒ¨å®šä¹‰å¯¹è±¡ä½¿ç”¨åèµ‹å€¼ä¸ºç©º</h3><p>æ–¹æ³•å†…ç«‹å³è°ƒç”¨ GC.Collect ()</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MainClass</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">/// æ‰§è¡Œæµ‹è¯•</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token function">TestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token class-name">TestClass</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TestClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        test<span class="token punctuation">.</span><span class="token function">DoSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        test <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>        GC<span class="token punctuation">.</span><span class="token function">Collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p><pre><code>Doingï¼</code></pre><p>ææ„å‡½æ•°æœªè¢«è°ƒç”¨ã€‚</p><p>å°† GC.Collect () æ–¹æ³•è°ƒç”¨ç§»åŠ¨åˆ° DoTest () æ–¹æ³•çš„ TestMethod () è°ƒç”¨ä¹‹åï¼š</p><pre><code>Doingï¼è¢«åƒåœ¾è¢«å›æ”¶äº†ï¼</code></pre><p>ææ„å‡½æ•°è¢«è°ƒç”¨äº†ã€‚</p><p>å°†  <code>test = null</code>  å»æ‰ï¼Œä¾ç„¶æ‰§è¡Œäº†ææ„å‡½æ•°ã€‚</p><blockquote><h4 id="ç»“è®ºæ–¹æ³•å—å†…çš„ä»£ç ä½¿ç”¨å®Œæ¯•åæ— è®ºæ˜¯å¦èµ‹å€¼ä¸ºç©ºéƒ½ä¸ä¼šç«‹å³å˜æˆåƒåœ¾å½“æ–¹æ³•å—ç»“æŸåæ‰ä¼šè‡ªåŠ¨æˆä¸ºåƒåœ¾å¯¹è±¡èƒ½å¤Ÿè¢«åƒåœ¾å›æ”¶å¤„ç†"><a class="anchor" href="#ç»“è®ºæ–¹æ³•å—å†…çš„ä»£ç ä½¿ç”¨å®Œæ¯•åæ— è®ºæ˜¯å¦èµ‹å€¼ä¸ºç©ºéƒ½ä¸ä¼šç«‹å³å˜æˆåƒåœ¾å½“æ–¹æ³•å—ç»“æŸåæ‰ä¼šè‡ªåŠ¨æˆä¸ºåƒåœ¾å¯¹è±¡èƒ½å¤Ÿè¢«åƒåœ¾å›æ”¶å¤„ç†">#</a> ç»“è®ºï¼šæ–¹æ³•å—å†…çš„ä»£ç ï¼Œä½¿ç”¨å®Œæ¯•åæ— è®ºæ˜¯å¦èµ‹å€¼ä¸ºç©ºï¼Œéƒ½ä¸ä¼šç«‹å³å˜æˆåƒåœ¾ï¼Œå½“æ–¹æ³•å—ç»“æŸåæ‰ä¼šè‡ªåŠ¨æˆä¸ºåƒåœ¾å¯¹è±¡ï¼Œèƒ½å¤Ÿè¢«åƒåœ¾å›æ”¶å¤„ç†ã€‚</h4></blockquote><h3 id="2æƒ…æ™¯äºŒå…¨å±€å˜é‡æ–¹æ³•å†…éƒ¨ä½¿ç”¨åèµ‹å€¼ä¸ºç©º"><a class="anchor" href="#2æƒ…æ™¯äºŒå…¨å±€å˜é‡æ–¹æ³•å†…éƒ¨ä½¿ç”¨åèµ‹å€¼ä¸ºç©º">#</a> 2ï¼‰æƒ…æ™¯äºŒï¼šå…¨å±€å˜é‡æ–¹æ³•å†…éƒ¨ä½¿ç”¨åèµ‹å€¼ä¸ºç©º</h3><p>æ–¹æ³•å†…ç«‹å³è°ƒç”¨ GC.Collect ()</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MainClass</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">TestClass</span> _test<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">/// æ‰§è¡Œæµ‹è¯•</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token function">TestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        _test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TestClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        _test<span class="token punctuation">.</span><span class="token function">DoSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        _test <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>        GC<span class="token punctuation">.</span><span class="token function">Collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p><pre><code>Doingï¼</code></pre><p>ææ„å‡½æ•°æœªè¢«è°ƒç”¨ã€‚</p><p>å°† GC.Collect () æ–¹æ³•è°ƒç”¨ç§»åŠ¨åˆ° DoTest () æ–¹æ³•çš„ TestMethod () è°ƒç”¨ä¹‹åï¼š</p><pre><code>Doingï¼è¢«åƒåœ¾è¢«å›æ”¶äº†ï¼</code></pre><p>ææ„å‡½æ•°è¢«è°ƒç”¨äº†ã€‚</p><blockquote><h4 id="ç»“è®ºå…¨å±€å˜é‡æ–¹æ³•å†…éƒ¨ä½¿ç”¨åèµ‹å€¼ä¸ºç©ºåœ¨è¯¥æ–¹æ³•ç»“æŸåæ‰ä¼šå˜æˆåƒåœ¾å¯¹è±¡"><a class="anchor" href="#ç»“è®ºå…¨å±€å˜é‡æ–¹æ³•å†…éƒ¨ä½¿ç”¨åèµ‹å€¼ä¸ºç©ºåœ¨è¯¥æ–¹æ³•ç»“æŸåæ‰ä¼šå˜æˆåƒåœ¾å¯¹è±¡">#</a> ç»“è®ºï¼šå…¨å±€å˜é‡æ–¹æ³•å†…éƒ¨ä½¿ç”¨åèµ‹å€¼ä¸ºç©ºï¼Œåœ¨è¯¥æ–¹æ³•ç»“æŸåï¼Œæ‰ä¼šå˜æˆåƒåœ¾å¯¹è±¡ã€‚</h4></blockquote><h3 id="3æƒ…æ™¯ä¸‰å§”æ‰˜æ–¹æ³•ä¸­åŒ…å«å¯¹è±¡"><a class="anchor" href="#3æƒ…æ™¯ä¸‰å§”æ‰˜æ–¹æ³•ä¸­åŒ…å«å¯¹è±¡">#</a> 3ï¼‰æƒ…æ™¯ä¸‰ï¼šå§”æ‰˜æ–¹æ³•ä¸­åŒ…å«å¯¹è±¡</h3><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MainClass</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment">/// æ‰§è¡Œæµ‹è¯•</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token class-name">Action</span> callback <span class="token operator">=</span> TestMethod<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        callback<span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        GC<span class="token punctuation">.</span><span class="token function">Collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        GC<span class="token punctuation">.</span><span class="token function">WaitForPendingFinalizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token class-name">TestClass</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TestClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        test<span class="token punctuation">.</span><span class="token function">DoSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p><pre><code>Doingï¼è¢«åƒåœ¾è¢«å›æ”¶äº†ï¼</code></pre><p>ææ„å‡½æ•°è¢«è°ƒç”¨äº†ã€‚</p><p>æ­¤å¤„æ”¹æˆï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">Action</span> callback <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token class-name">TestClass</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TestClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    test<span class="token punctuation">.</span><span class="token function">DoSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ç»“æœä¸€è‡´ã€‚</p><blockquote><h4 id="ç»“è®ºå§”æ‰˜-åŒ¿åæ–¹æ³•æœ¬èº«æ–°å»ºçš„å±€éƒ¨å˜é‡ä¼šæŒ‰ç…§æ­£å¸¸çš„æ–¹æ³•è°ƒç”¨è§„åˆ™åœ¨è°ƒç”¨ç»“æŸåé‡Šæ”¾"><a class="anchor" href="#ç»“è®ºå§”æ‰˜-åŒ¿åæ–¹æ³•æœ¬èº«æ–°å»ºçš„å±€éƒ¨å˜é‡ä¼šæŒ‰ç…§æ­£å¸¸çš„æ–¹æ³•è°ƒç”¨è§„åˆ™åœ¨è°ƒç”¨ç»“æŸåé‡Šæ”¾">#</a> ç»“è®ºï¼šå§”æ‰˜ã€åŒ¿åæ–¹æ³•æœ¬èº«æ–°å»ºçš„å±€éƒ¨å˜é‡ï¼Œä¼šæŒ‰ç…§æ­£å¸¸çš„æ–¹æ³•è°ƒç”¨è§„åˆ™åœ¨è°ƒç”¨ç»“æŸåé‡Šæ”¾ã€‚</h4></blockquote><h3 id="4æƒ…æ™¯å››åŒ¿åæ–¹æ³•ä¸­åŒ…å«å¯¹è±¡"><a class="anchor" href="#4æƒ…æ™¯å››åŒ¿åæ–¹æ³•ä¸­åŒ…å«å¯¹è±¡">#</a> 4ï¼‰æƒ…æ™¯å››ï¼šåŒ¿åæ–¹æ³•ä¸­åŒ…å«å¯¹è±¡</h3><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MainClass</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment">/// æ‰§è¡Œæµ‹è¯•</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token function">TestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        GC<span class="token punctuation">.</span><span class="token function">Collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        GC<span class="token punctuation">.</span><span class="token function">WaitForPendingFinalizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token return-type class-name">Action</span> <span class="token function">TestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token class-name">TestClass</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TestClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment">//test.DoSomething();</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> test<span class="token punctuation">.</span><span class="token function">DoSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p><pre><code>Doingï¼</code></pre><p>ææ„å‡½æ•°æœªè¢«è°ƒç”¨ï¼Œå¯¹è±¡ç”Ÿå‘½å‘¨æœŸåº”è¯¥å˜æˆ DoTest çš„äº†ã€‚</p><p>æµ‹è¯•æ–¹æ³•å¦‚ä¸‹ï¼Œåœ¨è°ƒç”¨ DoTest æ–¹æ³•å¤„å†è¿›è¡Œ GC.Collect è°ƒç”¨ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">MainClass</span> main <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MainClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>main<span class="token punctuation">.</span><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>GC<span class="token punctuation">.</span><span class="token function">Collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>GC<span class="token punctuation">.</span><span class="token function">WaitForPendingFinalizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>åˆ™æ‰§è¡Œäº†ææ„å‡½æ•°ã€‚</p><p>ç¼“å­˜ä¸ºç±»çš„å…¨å±€å˜é‡ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">Action</span> callback<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">/// æ‰§è¡Œæµ‹è¯•</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        callback <span class="token operator">=</span> <span class="token function">TestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        callback<span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        callback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        GC<span class="token punctuation">.</span><span class="token function">Collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        GC<span class="token punctuation">.</span><span class="token function">WaitForPendingFinalizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æœªæ‰§è¡Œææ„å‡½æ•°ï¼Œé™¤éä¸ä¸Šè¿°ä¸€æ ·åœ¨ DoTest æ‰§è¡Œå®Œæ¯•åè°ƒç”¨ GC.Collectã€‚</p><blockquote><h4 id="ç»“è®ºåŒ¿åæ–¹æ³•ä¸­å¼•ç”¨äº†å±€éƒ¨å˜é‡ä¼šå¢åŠ å±€éƒ¨å˜é‡å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæå‡è‡³å§”æ‰˜çš„è°ƒç”¨å­˜æ”¾çº§åˆ«è§„åˆ™ä¸æ™®é€šå¯¹è±¡ä¸€è‡´å§”æ‰˜ä¸è¢«ç½®ä¸ºç©ºå˜é‡ä¹Ÿä¼šä¸€ç›´å­˜æ´»"><a class="anchor" href="#ç»“è®ºåŒ¿åæ–¹æ³•ä¸­å¼•ç”¨äº†å±€éƒ¨å˜é‡ä¼šå¢åŠ å±€éƒ¨å˜é‡å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæå‡è‡³å§”æ‰˜çš„è°ƒç”¨å­˜æ”¾çº§åˆ«è§„åˆ™ä¸æ™®é€šå¯¹è±¡ä¸€è‡´å§”æ‰˜ä¸è¢«ç½®ä¸ºç©ºå˜é‡ä¹Ÿä¼šä¸€ç›´å­˜æ´»">#</a> ç»“è®ºï¼šåŒ¿åæ–¹æ³•ä¸­å¼•ç”¨äº†å±€éƒ¨å˜é‡ï¼Œä¼šå¢åŠ å±€éƒ¨å˜é‡å¯¹è±¡ç”Ÿå‘½å‘¨æœŸï¼Œæå‡è‡³å§”æ‰˜çš„è°ƒç”¨ (å­˜æ”¾) çº§åˆ«ï¼Œè§„åˆ™ä¸æ™®é€šå¯¹è±¡ä¸€è‡´ â€”â€” å§”æ‰˜ä¸è¢«ç½®ä¸ºç©ºï¼Œå˜é‡ä¹Ÿä¼šä¸€ç›´å­˜æ´»ã€‚</h4></blockquote><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p>åœ¨æ–¹æ³•å—å†…å¯¹æŸä¸ªå¯¹è±¡èµ‹å€¼ä¸ºç©ºï¼Œä¸ç®¡æ˜¯å…¨å±€è¿˜æ˜¯å±€éƒ¨å˜é‡ï¼Œè¯¥å¯¹è±¡å¹¶ä¸èƒ½ç«‹åˆ»æˆä¸ºã€åƒåœ¾ã€ï¼Œè‡³å°‘ç­‰è¯¥æ–¹æ³•å—æ‰§è¡Œå®Œæ¯•åï¼Œæ‰å¯èƒ½èƒ½å¤Ÿè¢«å›æ”¶ã€‚</p><p>è‹¥å­˜åœ¨åŒ¿åæ–¹æ³•ä½¿ç”¨äº†å±€éƒ¨å˜é‡ï¼Œå…¶ç”Ÿå­˜å‘¨æœŸä¸å§”æ‰˜ç»‘å®šã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;è¿™ä¸¤å¤©åˆå¤ä¹ äº†ä¸‹åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œåœ¨çœ‹åˆ° ææ„å‡½æ•° çš„æ—¶å€™ï¼Œçªç„¶æƒ³åˆ°ï¼šææ„å‡½æ•°æ˜¯åœ¨çœŸæ­£åƒåœ¾å›æ”¶æ—¶æ‰ä¼šæ‰§è¡Œçš„ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥ç”¨è¿™ä¸ªæ¥æµ‹è¯•ä¸€ä¸ªå¯¹è±¡ï¼Œä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥ç«‹å³è¢«åƒåœ¾å›</summary>
      
    
    
    
    <category term="ç†è®ºç ”ç©¶" scheme="https://cwhisme.github.io/categories/%E7%90%86%E8%AE%BA%E7%A0%94%E7%A9%B6/"/>
    
    
    <category term="C#" scheme="https://cwhisme.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>éŸ³æ•ˆèµ„æºè®¾ç½®æµ‹è¯•ä¸æ€»ç»“</title>
    <link href="https://cwhisme.github.io/2022/11/08/%E9%9F%B3%E6%95%88%E8%B5%84%E6%BA%90%E8%AE%BE%E7%BD%AE%E6%B5%8B%E8%AF%95%E4%B8%8E%E6%80%BB%E7%BB%93/"/>
    <id>https://cwhisme.github.io/2022/11/08/%E9%9F%B3%E6%95%88%E8%B5%84%E6%BA%90%E8%AE%BE%E7%BD%AE%E6%B5%8B%E8%AF%95%E4%B8%8E%E6%80%BB%E7%BB%93/</id>
    <published>2022-11-08T09:25:53.000Z</published>
    <updated>2022-12-22T03:29:48.150Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-å‰è¨€"><a class="anchor" href="#0x01-å‰è¨€">#</a> 0x01 å‰è¨€</h2><p>ä¹‹å‰è™½ç„¶æœ‰ç”¨è¿‡ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¯¹å…¶åšä¸ªäººçš„æ•´ç†ä¸æ€»ç»“ï¼Œåªå¤§æ¦‚çŸ¥é“å“ªä¸ªé€‰é¡¹ä¼šé€ æˆä»€ä¹ˆæƒ…å†µï¼Œæ­¤å¤„è¿›è¡Œä¸€æ¬¡è¯¦å°½çš„å®é™…æµ‹è¯•å¹¶æ€»ç»“ã€‚</p><h2 id="0x02-å·¥å…·"><a class="anchor" href="#0x02-å·¥å…·">#</a> 0x02 å·¥å…·</h2><ul><li>Unity2021.3.6f1</li><li>UnityProfiler</li><li>éŸ³æ•ˆï¼š<img data-src="/blogimages/2022/2022-11-08/m_2c999f422afd7de75758f0b6ae7a97c5_r.png" alt="" /></li></ul><h2 id="0x03-è®¾ç½®é€‰é¡¹"><a class="anchor" href="#0x03-è®¾ç½®é€‰é¡¹">#</a> 0x03 è®¾ç½®é€‰é¡¹</h2><h3 id="1-loadtype"><a class="anchor" href="#1-loadtype">#</a> 1. LoadType</h3><p>åˆ†ä¸ºä¸‰ä¸ªé€‰é¡¹ï¼Œè¿™ä¸ªé€‰æ‹©æ¯”è¾ƒé‡è¦ï¼šç›´æ¥å†³å®šéŸ³æ•ˆåœ¨å†…å­˜ä¸­çš„å¤§å°ã€‚</p><h4 id="1-åŠ è½½å³è§£å‹decompress-on-load"><a class="anchor" href="#1-åŠ è½½å³è§£å‹decompress-on-load">#</a> 1). åŠ è½½å³è§£å‹ (Decompress On Load)</h4><p>æ€§èƒ½æœ€å¥½ï¼Œä¸è¿‡ä¼šå ç”¨æ›´å¤šå†…å­˜ã€‚</p><p>åœ¨å†…å­˜ä¸­çš„å¤§å°è‡³å°‘æ˜¯é€‰æ‹© PCM å‹ç¼©æ ¼å¼åœ¨ ImportedSize çš„é¢„è§ˆå¤§å° â€”â€” å› ä¸ºåœ¨é€‰æ‹© Vorbis åï¼Œå†é€‰æ‹©è§£å‹åˆ°å†…å­˜ä¼šå¤šä¸€äº›ã€‚</p><p>åˆ†åˆ«æŸ¥çœ‹è®¾ç½®å¯¹åº”å‹ç¼©æ ¼å¼åï¼ŒImported Size ä»¥åŠåˆ©ç”¨ Profiler æŸ¥çœ‹è¿è¡Œæ—¶å†…å­˜å¤§å°ã€‚<br />å¯¹æ¯”å¦‚ä¸‹ï¼š</p><ul><li>PCMï¼š<br />Imported Sizeï¼š306KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š309.6KB (+3.6KB)</li><li>ADPCMï¼š<br />Imported Sizeï¼š86.2KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š310.1KB (+4KB)</li><li>Vorbis (1% è´¨é‡)ï¼š<br />Imported Sizeï¼š13.9KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š343.2KB (+37.2KB)</li><li>Vorbis (70% è´¨é‡)ï¼š<br />Imported Sizeï¼š16.6KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š345.7KB (+39.7KB)</li><li>Vorbis (100% è´¨é‡)ï¼š<br />Imported Sizeï¼š22.9KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š348.1KB (+42KB)</li></ul><p>é‡‡æ ·ç‡è®¾ç½®ä¸º <strong>22050Hz</strong>ï¼š</p><ul><li>PCMï¼š<br />Imported Sizeï¼š153.1KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š156.7KB (+3.6KB)</li><li>ADPCMï¼š<br />Imported Sizeï¼š43.1KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š157.1KB (+4KB)</li><li>Vorbis (1% è´¨é‡)ï¼š<br />Imported Sizeï¼š7.6KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š192.9KB (+40KB)</li><li>Vorbis (70% è´¨é‡)ï¼š<br />Imported Sizeï¼š9.5KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š192.9KB (+40KB)</li><li>Vorbis (100% è´¨é‡)ï¼š<br />Imported Sizeï¼š12KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š192.9KB (+40KB)</li></ul><p>Decompress On Load æ¨¡å¼ä¸‹ï¼Œåœ¨å†…å­˜ä¸­çš„éŸ³æ•ˆå¤§å°ä¸ PCM çš„ ImportedSize æ˜¾ç¤ºçš„å¤§å°å·®ä¸å¤šï¼Œå…¶ä¸­ PCM å’Œ ADPCM åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå¤šäº†å‡  KBï¼Œå¯èƒ½æ˜¯å…¶å®ƒæ•°æ®ã€‚</p><p>è€Œå½“ Vorbis å‹ç¼©æ ¼å¼é‡‡ç”¨ Decompress On Load åˆ™ä¼šå¯¼è‡´æ›´å¤šçš„é¢å¤–å†…å­˜æ¶ˆè€—ï¼Œå¹³å‡ 40KB å·¦å³ã€‚<br /><s>ä¸”ä¼šéšç€è´¨é‡è®¾ç½®è¶Šé«˜è€Œå¢åŠ ã€‚</s>ï¼Œè§ä¸‹æ–¹ã€æ³¨ 1ã€ï¼Œæ¨æµ‹ä¸ºéŸ³æ•ˆæºæ–‡ä»¶ 44100Hz æœ‰ä¸ä¸€è‡´çš„åœ°æ–¹ï¼Œæ‰‹åŠ¨è®¾ç½®ä¸ºæ›´ä½é‡‡æ ·ç‡åä¿å­˜ä¸€è‡´ã€‚</p><h4 id="2-å‹ç¼©æ ¼å¼å­˜æ”¾åœ¨å†…å­˜compressed-in-memory"><a class="anchor" href="#2-å‹ç¼©æ ¼å¼å­˜æ”¾åœ¨å†…å­˜compressed-in-memory">#</a> 2). å‹ç¼©æ ¼å¼å­˜æ”¾åœ¨å†…å­˜ (Compressed In Memory)</h4><p>æ’­æ”¾æ—¶ä¼šé¢å¤–æ¶ˆè€— CPU è§£å‹ï¼Œå†…å­˜æƒ…å†µæµ‹è¯•å¦‚ä¸‹ï¼š</p><p>Original Sizeï¼š<strong>32.8KB</strong></p><ul><li>PCMï¼š<br />Imported Sizeï¼š306KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š309.7KB (+3.7KB)</li><li>ADPCMï¼š<br />Imported Sizeï¼š86.2KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š90.7KB (+4.5KB)</li><li>Vorbis (1% è´¨é‡)ï¼š<br />Imported Sizeï¼š13.9KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š39.1KB (+25.2KB)</li><li>Vorbis (70% è´¨é‡)ï¼š<br />Imported Sizeï¼š16.6KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š44.1KB (+27.5KB)</li><li>Vorbis (100% è´¨é‡)ï¼š<br />Imported Sizeï¼š22.9KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š52.9KB (+30KB)</li></ul><p>é‡‡æ ·ç‡è®¾ç½®ä¸º <strong>22050Hz</strong>ï¼š</p><ul><li>PCMï¼š<br />Imported Sizeï¼š306KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š309.7KB (+3.7KB)</li><li>ADPCMï¼š<br />Imported Sizeï¼š86.2KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š90.7KB (+4.5KB)</li><li>Vorbis (1% è´¨é‡)ï¼š<br />Imported Sizeï¼š7.6KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š35.3KB (+27.7KB)</li><li>Vorbis (70% è´¨é‡)ï¼š<br />Imported Sizeï¼š9.5KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š37.3KB (+27.7KB)</li><li>Vorbis (100% è´¨é‡)ï¼š<br />Imported Sizeï¼š12KB<br /> è¿è¡Œæ—¶å†…å­˜ï¼š39.8KB (+27.7KB)</li></ul><p>é€šè¿‡æµ‹è¯•å¯ä»¥çœ‹å‡ºï¼š</p><p>Compressed In Memory æ¨¡å¼ä¸‹ï¼ŒPCM å’Œ ADPCM ä¸‹å†…å­˜å ç”¨æƒ…å†µä¸ºé¢„è§ˆé¢æ¿çš„ ImportedSize + å‡  KBï¼Œæ€»ä½“ä¸Šå·®ä¸å¤šã€‚</p><p>Vorbis å‹ç¼©æ¨¡å¼ä¼šé¢å¤–å ç”¨æ›´å¤šå†…å­˜ (å¤§æ¦‚å¤šäº† 30KB å·¦å³)ã€‚<br /><s>ä¸”ä¼šéšç€è´¨é‡è®¾ç½®è¶Šé«˜è€Œå¢åŠ ã€‚</s>ï¼Œè§ä¸‹æ–¹ã€æ³¨ 1ã€ï¼Œæ¨æµ‹ä¸ºéŸ³æ•ˆæºæ–‡ä»¶ 44100Hz æœ‰ä¸ä¸€è‡´çš„åœ°æ–¹ï¼Œæ‰‹åŠ¨è®¾ç½®ä¸ºæ›´ä½é‡‡æ ·ç‡åä¿å­˜ä¸€è‡´ã€‚</p><h4 id="3-æµå¼æ’­æ”¾streaming"><a class="anchor" href="#3-æµå¼æ’­æ”¾streaming">#</a> 3). æµå¼æ’­æ”¾ (Streaming)</h4><p>æµå¼æ’­æ”¾å ç”¨å†…å­˜ç›¸å¯¹æ•´ä¸ªæ–‡ä»¶æ¥è¯´æ¯”è¾ƒå°‘ â€”â€” å‰ææ˜¯éŸ³æ•ˆæ–‡ä»¶æœ¬èº«å¤§äº 200KBï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£ä»‹ç»ï¼Œå°±ç®—å°äº 200KB çš„éŸ³æ•ˆï¼Œé‡‡ç”¨æµå¼æ’­æ”¾ä¹Ÿä¼šäº§ç”Ÿ 200KB å·¦å³çš„ç¼“å­˜æ¶ˆè€—ã€‚</p><p>åå¤„æ˜¯æ’­æ”¾çš„æ—¶å€™å¯¹ IOã€CPU éƒ½ä¼šæœ‰é¢å¤–å¼€é”€ã€‚</p><p><img data-src="/blogimages/2022/2022-11-08/m_8a5a8185e25aa508822013b2229e98e0_r.png" alt="" /></p><p>ä»¥ä¸Šè¿°ä¸¤ä¸ªéŸ³æ•ˆæ–‡ä»¶ä¸ºä¾‹ï¼Œå½“è®¾ç½®ä¸€è‡´ (SampleRateSetting ä¸º PreserveSampleRate [44100Hz])ï¼Œå¹¶é‡‡ç”¨æµå¼æ’­æ”¾æ—¶ç»“æœå¦‚ä¸‹ï¼š</p><ul><li>PCMï¼š197.7KB</li><li>ADPCMï¼š198KB</li><li>Vorbis (1% è´¨é‡)ï¼š231.3KB</li><li>Vorbis (70% è´¨é‡)ï¼š233.8KB</li><li>Vorbis (100% è´¨é‡)ï¼š236.2KB</li></ul><p>Vorbis ä¸‹ä¼šå¤š 30KB å·¦å³ï¼Œä¸”å—è´¨é‡è®¾ç½®å½±å“ (æ¯”è¾ƒå°)</p><p>è´¨é‡å½±å“é‡å¤ªå°äº†ï¼Œå°è¯•æ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹ Sample Rate ä¸º <strong>44100Hz</strong>ï¼š</p><ul><li>PCMï¼š197.7KB</li><li>ADPCMï¼š198KB</li><li>Vorbis (1% è´¨é‡)ï¼š231.3KB</li><li>Vorbis (70% è´¨é‡)ï¼š233.8KB</li><li>Vorbis (100% è´¨é‡)ï¼š236.2KB</li></ul><p>å‘ç°åŒä¸€é‡‡æ ·ç‡ä¸‹ï¼Œç¼“å­˜å†…å­˜å ç”¨é‡æ²¡æœ‰å˜åŒ–ï¼Œå¦å¤–é€‰æ‹© <strong>Optimiz SampleRate</strong> ä¹Ÿæ˜¯åŒæ ·çš„å†…å­˜å ç”¨ç»“æœã€‚</p><p>ä¾ç„¶ä»¥ä¸Šè¿°ä¸¤ä¸ªéŸ³æ•ˆä¸ºä¾‹ï¼Œå°† Sample Rate æ‰‹åŠ¨è®¾ç½®ä¸º <strong>22050Hz</strong>ï¼š</p><ul><li>PCMï¼š163.7KB</li><li>ADPCMï¼š164KB</li><li>Vorbis (1% è´¨é‡)ï¼š199.9KB</li><li>Vorbis (70% è´¨é‡)ï¼š199.9KB</li><li>Vorbis (100% è´¨é‡)ï¼š199.9KB</li></ul><p>å¯ä»¥çœ‹åˆ°ï¼ŒVorbis ä¸‹ä¾ç„¶ä¼šå¤š 30KB å·¦å³ï¼Œä½†æ˜¯è´¨é‡é€‰æ‹©å·²ç»æ²¡æœ‰å½±å“äº†ã€‚</p><p>æ¥ç€ç¼“å­˜ <strong>8000Hz</strong> çš„ Sample Rateï¼š</p><ul><li>PCMï¼š141.7KB</li><li>ADPCMï¼š142KB</li><li>Vorbis (1% è´¨é‡)ï¼š167.9KB</li><li>Vorbis (70% è´¨é‡)ï¼š167.9KB</li><li>Vorbis (100% è´¨é‡)ï¼š167.9KB</li></ul><p>å¯ä»¥å¾—å‡ºç»“è®ºï¼šStreaming æ’­æ”¾éŸ³æ•ˆæ—¶ï¼Œè‡³å°‘ä¼šäº§ç”Ÿ 140KB (æœ€ä½ 8000Hz é‡‡æ ·ç‡) å·¦å³çš„å†…å­˜ç¼“å­˜ï¼ŒVorbis å‹ç¼©æ ¼å¼ä¸‹ä¼šé¢å¤–å¢åŠ  30KB å·¦å³çš„æ¶ˆè€—ã€‚</p><p>é‡‡æ ·ç‡ (è¶Šä½å†…å­˜å ç”¨è¶Šä½)ã€å¼ºåˆ¶å•å£°é“ä¹Ÿä¼šç»Ÿä¸€å½±å“åˆ°ä¸‰ç§è®¾ç½®åœ¨æµå¼çš„ç¼“å­˜å ç”¨)ï¼Œ</p><p><font color=red>æ³¨ 1ï¼šä¸Šè¿° <strong>44100Hz</strong> é‡‡æ ·ç‡æ—¶ï¼ŒVorbis å‹ç¼©ä¸‹å†…å­˜å ç”¨ä¼šæœ‰å¾®å°å·®å¼‚ï¼ŒåŒæ ·é€‚ç”¨äº  Decompress On Loadã€Compressed In Memoryï¼Œæ¨æµ‹æ˜¯éŸ³æ•ˆæºæ–‡ä»¶çš„é‡‡æ ·ç‡éƒ¨åˆ†ä¸ä¸€è‡´å¯¼è‡´ï¼Œå› ä¸ºæ‰‹åŠ¨è®¾ç½®ä¸ºæ›´ä½é‡‡æ ·ç‡åå°±ä¿æŒä¸€è‡´äº†ã€‚</font></p><h3 id="2-compression-formatå‹ç¼©æ ¼å¼"><a class="anchor" href="#2-compression-formatå‹ç¼©æ ¼å¼">#</a> 2. Compression Format (å‹ç¼©æ ¼å¼)</h3><ul><li>PCMï¼šä¸å‹ç¼©ï¼Œæ•ˆæœæœ€å¥½æ–‡ä»¶æœ€å¤§ï¼Œè¯•è¿‡ç”šè‡³æ¯”å¯¼å…¥éŸ³æ•ˆæœ¬èº«æ–‡ä»¶éƒ½è¿˜å¤§<br /><img data-src="/blogimages/2022/2022-11-08/m_53f9ea44065a5a44a00872836c0c4db6_r.png" alt="" /></li><li>ADPCMï¼šæœ‰ä¸€å®šå‹ç¼©æ•ˆæœï¼Œå‹ç¼©ç‡è§†æƒ…å†µéŸ³æ•ˆæºæ–‡ä»¶è€Œå®šï¼Œç»è¿‡æµ‹è¯•ä¸€èˆ¬åœ¨ 50%~80% æµ®åŠ¨ï¼Œä¹Ÿå¯èƒ½æ¯”æºæ–‡ä»¶å¤§å°æ›´å¤§ã€‚<br /><img data-src="/blogimages/2022/2022-11-08/m_d5e6f3117362ddf0191c81fc14ff473d_r.png" alt="" /></li><li>Vorbis/Mp3ï¼šå‹ç¼©ç‡æœ€é«˜çš„æ–¹å¼ï¼Œå”¯ä¸€ç¡®å®šä¸€å®šèƒ½å‹ç¼©å¤§å°çš„é€‰é¡¹ï¼Œè¯¥é€‰é¡¹è¿˜å¯ä»¥é¢å¤–è®¾ç½® Qualityï¼Œå€¼è¶Šå°ï¼Œå‹ç¼©è¶Šå‰å®³ï¼Œå¤§å°ä¹Ÿè¶Šå°<br /><img data-src="/blogimages/2022/2022-11-08/m_b9d67a27160a7a123e41e7187626c837_r.png" alt="" /></li></ul><h3 id="3-force-to-mono"><a class="anchor" href="#3-force-to-mono">#</a> 3. Force To Mono</h3><p>å¼ºåˆ¶å•å£°é“ï¼Œä¾‹å¦‚ä¸‹å›¾ï¼š</p><p><img data-src="/blogimages/2022/2022-11-08/m_6b48857f690b8f651eb8298e484f2393_r.png" alt="" /></p><p>è¿™ä¸ªéŸ³æ•ˆå°±åŒ…å«äº† ch1ã€ch2 ä¸¤ä¸ªå£°é“ï¼Œè‹¥å‹¾é€‰è¯¥é¡¹ï¼Œä¸¤ä¸ªå£°é“å°†ä¼šåˆå¹¶ä¸ºä¸€ä¸ªï¼Œå¹¶å‡å°‘ä¸€éƒ¨åˆ†å¤§å°ã€‚</p><p><img data-src="/blogimages/2022/2022-11-08/m_e5634eac0a5337c2917083632be16d38_r.png" alt="" /></p><p>æµ‹è¯•ç»“æœï¼š</p><p><strong>æ–‡ä»¶ 1ï¼š</strong></p><ul><li>PCMï¼š153.1KB-&gt;76.6KB(50%)</li><li>ADPCMï¼š43.1KB-&gt;21.6KB(50%)</li><li>Vorbis(1%)ï¼š7.6KB-&gt;6.4KB(15%)</li><li>Vorbis(100%)ï¼š12KB-&gt;9.8KB(18%)</li></ul><p><strong>æ–‡ä»¶ 2ï¼š</strong></p><ul><li>PCMï¼š9.6MB-&gt;4.8MB(50%)</li><li>ADPCMï¼š2.7MB-&gt;1.4MB(50%)</li><li>Vorbis(1%)ï¼š0.6MB-&gt;426.3KB(30%)</li><li>Vorbis(100%)ï¼š2.8MB-&gt;0.6MB(80%)</li></ul><p>é€šè¿‡å¯¹ä¸¤ä¸ªéŸ³æ•ˆæ–‡ä»¶ï¼šä¸€ä¸ªå¤§æ–‡ä»¶åŠä¸€ä¸ªå°æ–‡ä»¶å¯¹æ¯”ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼š</p><p>å¼ºåˆ¶å•å£°é“é€‰é¡¹ä¸­ï¼ŒPCM å’Œ ADPCM çš„æ ¼å¼å¯ä»¥å‡å°‘ 50% å¤§å°ï¼ŒVorbis è§†å‹ç¼©è´¨é‡åŠéŸ³æ•ˆæœ¬èº«å¤§å°è€Œå®š â€”â€” è¿™ä¸ªåº”è¯¥è·ŸéŸ³æ•ˆæœ¬èº«ä¸¤ä¸ªé€šé“æ•°æ®é‡æœ‰å…³ï¼Œæ–‡ä»¶ 2 å®æµ‹åŒé€šé“å£°éŸ³ä¼šæœ‰æ›´å¤§çš„å·®å¼‚ã€‚</p><p>æ³¨ï¼šå•å£°é“å¹¶ä¸æ˜¯è¯´åªæœ‰ä¸€ä¸ªå–‡å­ä¼šæ’­æ”¾å£°éŸ³ï¼Œè€Œæ˜¯ä¸¤ä¸ªå–‡å­æ’­æ”¾åŒæ ·çš„å£°éŸ³ã€‚</p><h3 id="4-sample-rate"><a class="anchor" href="#4-sample-rate">#</a> 4. Sample Rate</h3><p>é‡‡æ ·ç‡ï¼Œåœ¨ä¸å½±å“æ•ˆæœçš„æƒ…å†µï¼Œè¿˜å¯ä»¥è€ƒè™‘è®¾ç½®ç»Ÿä¸€çš„æ›´ä½çš„é‡‡æ ·ç‡ï¼Œä¹Ÿä¼šå½±å“å¤§å°ã€‚</p><p>å¯¹äºå½±å“æ•ˆæœï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><ul><li>PCM(44100Hz)ï¼š306KB-&gt;153.1KB(22050Hz)-&gt;76.6KB(11025Hz)-&gt;55.6KB(8000Hz)</li><li>ADPCM(44100Hz)ï¼š86.2KB-&gt;43.1KB(22050Hz)-&gt;21.6KB(11025Hz)-&gt;15.7KB(8000Hz)</li><li>Vorbis(1%)(44100Hz)ï¼š13.9KB-&gt;7.6KB(22050Hz)-&gt;8.7KB(11025Hz)-&gt;6.1KB(8000Hz)</li><li>Vorbis(100%)(44100Hz)ï¼š22.9KB-&gt;12KB(22050Hz)-&gt;11.8KB(11025Hz)-&gt;8.8KB(8000Hz)</li></ul><p>ä»ä¸Šè¿°æµ‹è¯•ç»“æœå¯ä»¥çœ‹å‡ºï¼Œé‡‡æ ·ç‡å¯¹å†…å­˜å ç”¨å½±å“æˆæ¯”ä¾‹å…³ç³»ï¼šå‡å°‘å¤šå°‘é‡‡æ ·ç‡ï¼Œç›¸å¯¹å°±å‡å°‘å¤šå°‘ç©ºé—´ã€‚</p><p>æˆ‘ä»¬æ¸¸æˆéŸ³æ•ˆå¯¼å…¥é»˜è®¤æ˜¯ 44100Hz ï¼Œå°±æ˜¯ç»Ÿä¸€å°†å…¶è®¾ç½®ä¸º 22050Hzï¼Œç›¸æ¯”åˆå§‹é»˜è®¤çš„ 44100Hzï¼Œå‡å°‘ä¸€åŠå ç”¨ï¼ŒVorbis å‹ç¼©æœ‰éƒ¨åˆ†æµ®åŠ¨ï¼Œä¸è¿‡ä¹Ÿå¤§ä½“ç¬¦åˆè§„åˆ™ã€‚</p><h3 id="5-preload-audio-data"><a class="anchor" href="#5-preload-audio-data">#</a> 5. Preload Audio Data</h3><p>æ ¹æ®è¯´æ˜ï¼Œæ˜¯ä¼šåœ¨åœºæ™¯åŠ è½½æ—¶é¢„å…ˆåŠ è½½ï¼Œé»˜è®¤å¼€å¯çš„ï¼Œé€‚ç”¨äºé‚£ç§ç›´æ¥æ‹–åˆ° GameObject ä¸Šçš„éŸ³æ•ˆï¼Œè¿‡å¤šä¼°è®¡ä¼šå½±å“åœºæ™¯åŠ è½½é€Ÿåº¦ã€‚</p><p>ä¸€èˆ¬æœ€å¥½å…³äº†ï¼Œå› ä¸ºæˆ‘ä»¬éƒ½æ˜¯ä»£ç åŠ¨æ€åŠ è½½æ’­æ”¾ï¼Œåœºæ™¯ä¸ä¼šç›´æ¥æŒ‚ã€‚æ‰€ä»¥è¿™ä¸ªé€‰é¡¹å®é™…ä¸Šæ²¡ç”¨ã€‚</p><h3 id="6-load-in-background"><a class="anchor" href="#6-load-in-background">#</a> 6. Load In Background</h3><p>åœ¨å•ç‹¬çº¿ç¨‹å»¶è¿ŸåŠ è½½ï¼Œä¸å¡ä¸»çº¿ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ªé€‰é¡¹æˆ–è®¸ä¼šé€ æˆéŸ³ç”»ä¸åŒæ­¥ã€‚</p><h2 id="0x04-æ€»ä½“èµ„æºæ¶ˆè€—æµ‹è¯•"><a class="anchor" href="#0x04-æ€»ä½“èµ„æºæ¶ˆè€—æµ‹è¯•">#</a> 0x04 æ€»ä½“èµ„æºæ¶ˆè€—æµ‹è¯•</h2><p>ä¸Šé¢åœ¨å•é¡¹è®¾ç½®ä¸­ï¼Œåˆ†åˆ«å¯¹æ¯”è¿‡å„è‡ªä¼šåœ¨å†…å­˜ä¸­çš„å ç”¨é‡ï¼Œæ­¤å¤„å°†å¯¹ å†…å­˜ã€CPU æ¶ˆè€—ä½œä¸€ä¸ªæ€»ä½“å¯¹æ¯”ã€‚</p><p>å¯¹äºå¦‚ä½•æµ‹è¯• CPU æ€§èƒ½çš„æ¶ˆè€—ï¼Œç”±äºå•ä¸ªéŸ³æ•ˆçš„æ’­æ”¾æ—¶å¾ˆä¸æ˜æ˜¾ï¼Œå› æ­¤æˆ‘åœ¨æµ‹è¯•æ—¶é‡‡ç”¨ 20 ä»½æ’­æ”¾åŒä¸€ä¸ªéŸ³æ•ˆçš„ AudioSourceï¼Œå¹¶å¯¹æ¯”æ€»æ¶ˆè€—ã€ä½¿ç”¨ Profiler æ£€æŸ¥æ¯ä¸ªè®¾ç½®å¯¹ CPU æ¶ˆè€—é€ æˆçš„å½±å“ï¼Œå–å¹³å‡å‡ºç°æœ€å¤šçš„å€¼ã€‚</p><p>åŒæ—¶ä¸ºäº†å‡å°‘å†…å­˜è¯¯å·®ï¼Œæµ‹è¯•æ–‡ä»¶æ›´æ¢äº†ä¸€ä¸ªæ›´å¤§çš„éŸ³æ•ˆï¼ŒOriginalSize ä¸º 2.8MBã€‚</p><p>å…¶é»˜è®¤æµ‹è¯•è®¾ç½®å¦‚ä¸‹ï¼š<br /><img data-src="/blogimages/2022/2022-11-08/m_8ffecf7064f644e1473a9626eb88d393_r.png" alt="" /></p><h4 id="1-å‹ç¼©æ ¼å¼vorbis1è´¨é‡"><a class="anchor" href="#1-å‹ç¼©æ ¼å¼vorbis1è´¨é‡">#</a> 1) å‹ç¼©æ ¼å¼ï¼šVorbis (1% è´¨é‡)</h4><p><img data-src="/blogimages/2022/2022-11-08/m_e427525c6a80e39dc0ecddc990751942_r.png" alt="" /></p><p>ä»å·¦è‡ªå³ LoadType åˆ†åˆ«ä¸ºï¼š Decompress On Loadã€Compress In Memeryã€Streaming</p><p>CPU æ¶ˆè€—ï¼š1%-&gt;2.5%-&gt;2.8%<br /> å†…å­˜æ¶ˆè€—ï¼š7.3MB-&gt;2.8MB-&gt;5.9MB</p><h4 id="2-å‹ç¼©æ ¼å¼vorbis100è´¨é‡"><a class="anchor" href="#2-å‹ç¼©æ ¼å¼vorbis100è´¨é‡">#</a> 2) å‹ç¼©æ ¼å¼ï¼šVorbis (100% è´¨é‡)</h4><p><img data-src="/blogimages/2022/2022-11-08/m_fcd8822723b729b78904dfc82246b15c_r.png" alt="" /></p><p>ä»å·¦è‡ªå³ LoadType åˆ†åˆ«ä¸ºï¼š Decompress On Loadã€Compress In Memeryã€Streaming</p><p>CPU æ¶ˆè€—ï¼š1%-&gt;4.9%-&gt;5%<br /> å†…å­˜æ¶ˆè€—ï¼š7.3MB-&gt;3.7MB-&gt;5.9MB</p><h4 id="3-å‹ç¼©æ ¼å¼adpcm"><a class="anchor" href="#3-å‹ç¼©æ ¼å¼adpcm">#</a> 3) å‹ç¼©æ ¼å¼ï¼šADPCM</h4><p><img data-src="/blogimages/2022/2022-11-08/m_2c08a89d388540ae8df5de75acd03a33_r.png" alt="" /></p><p>ä»å·¦è‡ªå³ LoadType åˆ†åˆ«ä¸ºï¼š Decompress On Loadã€Compress In Memeryã€Streaming</p><p>CPU æ¶ˆè€—ï¼š1%-&gt;1.8%-&gt;2.1%<br /> å†…å­˜æ¶ˆè€—ï¼š7.2MB-&gt;3.8MB-&gt;5.6MB</p><h4 id="4-å‹ç¼©æ ¼å¼pcm"><a class="anchor" href="#4-å‹ç¼©æ ¼å¼pcm">#</a> 4) å‹ç¼©æ ¼å¼ï¼šPCM</h4><p><img data-src="/blogimages/2022/2022-11-08/m_531b2b0591cf77c7e75377e99be059ec_r.png" alt="" /></p><p>ä»å·¦è‡ªå³ LoadType åˆ†åˆ«ä¸ºï¼š Decompress On Loadã€Compress In Memeryã€Streaming</p><p>CPU æ¶ˆè€—ï¼š1%-&gt;1.1%-&gt;1.4%<br /> å†…å­˜æ¶ˆè€—ï¼š7.2MB-&gt;7.2MB-&gt;5.6MB</p><h4 id="5-æ€»ç»“"><a class="anchor" href="#5-æ€»ç»“">#</a> 5) æ€»ç»“</h4><p>ä¸Šè¿°æµ‹è¯•ç»“æœä¸­ï¼Œæ„Ÿè§‰å…¶ä¸­ Streaming Vorbis å†…å­˜å ç”¨ä¸é¢„è®¡çš„æœ‰ç‚¹ä¸ç¬¦ï¼Œäºæ˜¯ä½¿ç”¨å• AudioSource é¢å¤–è¿›è¡Œæµ‹è¯•ï¼š</p><p><img data-src="/blogimages/2022/2022-11-08/m_8ea6c5c446af60829b7e9b32c492c26b_r.png" alt="" /></p><p>Streaming æ’­æ”¾æ¨¡å¼ï¼Œä»å·¦è‡ªå³åˆ†åˆ«ä¸ºï¼šVorbis (100% è´¨é‡)-&gt;Vorbis (1% è´¨é‡)-&gt;ADPCM-&gt;PCM</p><p>CPU æ¶ˆè€—ï¼š0.5%-&gt;0.5%-&gt;0.4%-&gt;0.3%<br /> å†…å­˜æ¶ˆè€—ï¼š2.6MB-&gt;2.6MB-&gt;2.5MB-&gt;2.5MB</p><p>Vorbis å‹ç¼©æ ¼å¼ï¼Œåœ¨ Streaming ä¸‹ Taotal Audio Memery æ¶ˆè€—å¤šäº† 100KB çš„æ ·å­ï¼Œè€Œåœ¨ä¸Šé¢ä½¿ç”¨ Take Sample å•ä¸ªæŸ¥çœ‹æ—¶åªé¢å¤–å¤šäº† 30KB å†…å­˜å ç”¨ã€‚</p><p>è¿™é‡Œåªèƒ½æ¨æµ‹ä¸¤ä¸ªåŸå› ï¼š</p><ul><li>è¦ä¹ˆ Taotal Audio Memery è¿˜è®¡ç®—äº†å…¶å®ƒæ•°æ®</li><li>è¦ä¹ˆç”±äºç»Ÿè®¡æ²¡æœ‰æ˜¾ç¤ºå…·ä½“ KB æ¶ˆè€—å€¼å¯¼è‡´çš„è¯¯è®¤ (ä¾‹å¦‚ PCM åŸæœ¬ä¸º 2.57MB ä¸€ç±»ï¼ŒåŠ ä¸Š 30KB å·¦å³å°±åˆ° 2.6MB äº†)ã€‚</li></ul><p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒStreaming æ’­æ”¾æ¨¡å¼ä¸‹ï¼Œä¼šéšç€é€šåŒä¸€ä¸ªæ–‡ä»¶çš„åå¤åŠ è½½ï¼Œè€Œå åŠ æ–‡ä»¶æµåŠè§£ç å†…å­˜æ¶ˆè€— â€”â€” ä¾‹å¦‚ä¸Šè¿°å•ä¸ªæ’­æ”¾ä¸º 124KB-&gt;20 ä¸ª = 124KBx20=2.4MB</p><h5 id="æ€»ä½“å†…å­˜æ¶ˆè€—"><a class="anchor" href="#æ€»ä½“å†…å­˜æ¶ˆè€—">#</a> æ€»ä½“å†…å­˜æ¶ˆè€—ï¼š</h5><p>Decompress On Loadï¼šVorbis é¢å¤– 30KB å·¦å³å†…å­˜æ¶ˆè€—ï¼Œæ€»ä½“å·®ä¸å¤š<br /> Compress In Memeryï¼šPCM-&gt;ADPCM-&gt;Vorbis (100% è´¨é‡)-&gt;Vorbis (1% è´¨é‡)<br /> Streamingï¼šVorbis é¢å¤–å‡ å KB å†…å­˜æ¶ˆè€—ï¼Œæ€»ä½“å·®ä¸å¤š</p><h5 id="æ€»ä½“cpuæ¶ˆè€—"><a class="anchor" href="#æ€»ä½“cpuæ¶ˆè€—">#</a> æ€»ä½“ CPU æ¶ˆè€—ï¼š</h5><p>Decompress On Loadï¼šCPU æ¶ˆè€—åŸºæœ¬ä¸€è‡´<br /> Compress In Memeryï¼šVorbis (100% è´¨é‡)-&gt;Vorbis (1% è´¨é‡)-&gt;ADPCM-&gt;PCM<br />Streamingï¼šVorbis (100% è´¨é‡)-&gt;Vorbis (1% è´¨é‡)-&gt;ADPCM-&gt;PCM</p><h4 id="ç–‘é—®"><a class="anchor" href="#ç–‘é—®">#</a> ç–‘é—®</h4><blockquote><p>å¯¹äºæ€»ä½“å†…å­˜æ¶ˆè€—ï¼Œæˆ–è®¸ä¼šæœ‰ç–‘é—®ï¼ˆæ¯”å¦‚è¯´æˆ‘è‡ªå·±ï¼‰ï¼šåœ¨æµ‹è¯•å•ä¸ªéŸ³æ•ˆæ’­æ”¾æ—¶ï¼ŒProfiler Audio é¢æ¿ä¸­çš„ Total Audio Memery çš„å†…å­˜æ•°å€¼ï¼Œæ¯” Profiler Memery é¢æ¿ä¸­ Take Sample è·å–åˆ°çš„å•ä¸ªéŸ³æ•ˆå†…å­˜å ç”¨æ›´å¤§ï¼Œè¿™ä¸ªæ˜¯æ¯ä¸ªéŸ³æ•ˆå®é™…éƒ½æ¯” TakeSample å¤§äº›ï¼Œè¿˜æ˜¯è¯´ä»…ä»…å› ä¸º Total Audio Memery è®¡ç®—äº†å…¶å®ƒé¢å¤–å†…å­˜ï¼Ÿ</p></blockquote><p>äºæ˜¯è¿›è¡Œæµ‹è¯•ï¼Œé¦–å…ˆæ˜¯ç©ºåœºæ™¯ Audio ä¿¡æ¯ç»Ÿè®¡ï¼š<br /><img data-src="/blogimages/2022/2022-11-08/m_c1482d2c86711e3b82d23fed6e922ae3_r.png" alt="" /></p><p>æ¥ç€ä½¿ç”¨ä¸‰ä¸ªä¸åŒå¤§å°çš„éŸ³æ•ˆï¼Œä½¿ç”¨ PCM (Decompress On Load) æ ¼å¼è¿›è¡Œæ’­æ”¾ï¼ŒæŸ¥çœ‹ Total Audio Memery æ•°å€¼ï¼š<br /><img data-src="/blogimages/2022/2022-11-08/m_62f502a630dccf7903d280cd34439677_r.png" alt="" /></p><p>å¯ä»¥å‘ç° Total Audio Memery æ•°å€¼æ˜¯æ ¹æ® PCM Imported Size å¤§å°å¢åŠ çš„ï¼ŒSample Sound Memery (Decompress On Load è§£å‹å†…å­˜å ç”¨é‡) äº¦æ˜¯æŒ‰ç…§å®é™…å¤§å°è·Ÿéšé€’å¢ã€‚</p><h5 id="è¡¥å……-pcmcompressed-in-memory-æ¨¡å¼"><a class="anchor" href="#è¡¥å……-pcmcompressed-in-memory-æ¨¡å¼">#</a> è¡¥å…… PCM (Compressed In Memory) æ¨¡å¼ï¼š</h5><p><img data-src="/blogimages/2022/2022-11-08/m_93c42e0ec47651dd4433f781999ed190_r.png" alt="" /><br />DSP CPUï¼šé¡¹ç›®åœ¨åŠ è½½ç±»å‹ä¸º Compressed In Memory çš„éæµå¼å£°éŸ³çš„æ··éŸ³ã€éŸ³é¢‘æ•ˆæœå’Œè§£å‹ç¼©ä¸­ä½¿ç”¨çš„ CPU é‡ã€‚<br />Sample Sound Memoryï¼šåŠ è½½ç±»å‹ä¸º Decompress On Load çš„éŸ³é¢‘æ–‡ä»¶ç”¨äºæ‰€æœ‰å·²è§£å‹ç¼©æ ·æœ¬æ•°æ®çš„å†…å­˜é‡ã€‚</p><p>ä¹Ÿå°±æ˜¯å¯ä»¥å¾—å‡ºç»“è®ºï¼š</p><ul><li>Total Audio Memery æ˜¯æ‰€æœ‰å†…å­˜æ€»é‡ï¼Œç¡®å®æ˜¯è®¡ç®—äº†é¢å¤–æ¶ˆè€—å†…å­˜çš„ã€‚</li><li>Profiler Memery é¢æ¿ä¸­ Take Sample è·å–åˆ°çš„å•ä¸ªéŸ³æ•ˆå†…å­˜å°±æ˜¯å®é™…å ç”¨é‡ï¼Œä¸æ€»æ¶ˆè€—å†…å­˜å¯ä»¥è¡¨ç°å‡ºä¸€ç§é€’å¢çš„å¯¹åº”å…³ç³»ã€‚</li><li>PCM è™½ç„¶æ˜¯æ— å‹ç¼©æ ¼å¼ï¼Œä½†è‹¥æ˜¯é€‰æ‹© Compressed In Memory ï¼Œè™½ç„¶å•ä¸ªéŸ³æ•ˆå†…å­˜è·Ÿé€‰æ‹©ä¸å¦æ²¡æœ‰å˜åŒ–ï¼Œä½†å¯¹æ€»ä½“å†…å­˜ä¹Ÿä¼šæœ‰ä¸€å®šå½±å“ (æµ‹è¯•è¡¨ç°æ˜¯å¢åŠ äº†ä¸€ç‚¹)ã€‚</li></ul><h2 id="0x05-å‹ç¼©æ ¼å¼å¯¹æœ€ç»ˆ-assetbunle-èµ„æºå½±å“"><a class="anchor" href="#0x05-å‹ç¼©æ ¼å¼å¯¹æœ€ç»ˆ-assetbunle-èµ„æºå½±å“">#</a> 0x05 å‹ç¼©æ ¼å¼å¯¹æœ€ç»ˆ AssetBunle èµ„æºå½±å“</h2><h4 id="1-é»˜è®¤è®¾ç½®-samplerate-22050hz-pcm-æ ¼å¼"><a class="anchor" href="#1-é»˜è®¤è®¾ç½®-samplerate-22050hz-pcm-æ ¼å¼">#</a> 1) é»˜è®¤è®¾ç½®ã€SampleRate 22050Hzã€PCM æ ¼å¼ï¼š</h4><p><img data-src="/blogimages/2022/2022-11-08/m_0d325cddd386fb945373c5d125e95248_r.png" alt="" /><br /><img data-src="/blogimages/2022/2022-11-08/m_0d75a39f780213b3007ecbd23f996ac8_r.png" alt="" /></p><h4 id="2-é»˜è®¤è®¾ç½®-samplerate-22050hz-adpcm-æ ¼å¼"><a class="anchor" href="#2-é»˜è®¤è®¾ç½®-samplerate-22050hz-adpcm-æ ¼å¼">#</a> 2) é»˜è®¤è®¾ç½®ã€SampleRate 22050Hzã€ADPCM æ ¼å¼ï¼š</h4><p><img data-src="/blogimages/2022/2022-11-08/m_de861340a651647f686105eb35f7fb16_r.png" alt="" /><br /><img data-src="/blogimages/2022/2022-11-08/m_16d83cb95231207d45e0362af6914021_r.png" alt="" /></p><h4 id="3-é»˜è®¤è®¾ç½®-samplerate-22050hz-vorbis-å‹ç¼©è´¨é‡-70"><a class="anchor" href="#3-é»˜è®¤è®¾ç½®-samplerate-22050hz-vorbis-å‹ç¼©è´¨é‡-70">#</a> 3) é»˜è®¤è®¾ç½®ã€SampleRate 22050Hzã€Vorbis å‹ç¼©ï¼Œè´¨é‡ 70%ï¼š</h4><p><img data-src="/blogimages/2022/2022-11-08/m_7eea0eda7f26befe6ca6567c999d3493_r.png" alt="" /><br /><img data-src="/blogimages/2022/2022-11-08/m_a22fc28a39eb76fc140d69a392fd0928_r.png" alt="" /></p><p>å¯ä»¥çœ‹å‡ºï¼Œè·Ÿå›¾ç‰‡å‹ç¼©ä¸€æ ·ï¼Œå‹ç¼©æ ¼å¼å¯¹æœ€ç»ˆå‡ºåŒ…çš„ AssetBunle èµ„æºå¤§å°ä¹Ÿä¼šæœ‰å½±å“ï¼Œé™¤å‹ç¼©æ–¹å¼é€‰æ‹©å¤–ï¼ŒVorbis å‹ç¼©è´¨é‡æ•°å€¼ä¹Ÿä¼šå½±å“ã€‚</p><p>æœ€ç»ˆ AssetBundle åŒ…å¤§å°åŸºæœ¬ä¸éŸ³æ•ˆé¢æ¿ä¸Šçš„ ImportedSize å·®ä¸å¤š (+ éƒ¨åˆ† AssetBundle é¢å¤–æ•°æ®)ã€‚</p><h2 id="0x06-æ€»ç»“"><a class="anchor" href="#0x06-æ€»ç»“">#</a> 0x06 æ€»ç»“</h2><p>æµ‹è¯•ç»“æœæœ‰äº›ä¸ä¹‹å‰é¢„æƒ³çš„ä¸€è‡´ï¼Œä¹Ÿæœ‰éƒ¨åˆ†é¢„æƒ³è¢«ã€æ¨ç¿»ã€ã€‚</p><p>åœ¨<font color=blue>å†…å­˜å ç”¨é‡</font>ä¸Šï¼Œå¯¹äº Decompress On Loadã€Compressed In Memoryã€Streaming ä¸‰ç§ LoadType æ–¹å¼ï¼š</p><ul><li>Decompress On Load æ˜¯ä»¥ <font color=red>PCM æ ¼å¼ä¸‹ ImportedSize å¤§å°</font>ä¸ºåŸºå‡†ï¼ŒPCMã€ADPCM æ ¼å¼ä¸‹åœ¨å†…å­˜è§£å‹åå ç”¨é‡åŸºæœ¬ä¸€è‡´ï¼ŒVorbis å¤šå ç”¨ 40KB å·¦å³</li><li>Compressed In Memoryï¼šå‹ç¼©æ¨¡å¼å­˜æ”¾å†…å­˜ï¼ŒVorbis å‹ç¼©ä¼šæ¯” <font color=red>è‡ªèº« ImportedSize</font> å¤§ 30KB å·¦å³</li><li>Streaming ä»¥ 200KB ç¼“å­˜ä¸ºåŸºå‡†ï¼ŒVorbis å‹ç¼©ååŠ è½½ç›¸æ¯”å¦å¤–ä¸¤ç§ä¼šé¢å¤–å ç”¨ 30KB å·¦å³çš„å†…å­˜ã€‚<br /><font color=red>æ³¨ 1ï¼šå…³äºå†…å­˜å ç”¨æ¯”è¾ƒåŸºå‡†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ¯”è¾ƒåŸºå‡†å¯¹è±¡æ˜¯ä¸åŒçš„ï¼Œè¿™ç¯‡æ–‡ç« å†™å®Œäº†ï¼Œæˆ‘è„‘è¢‹å°±æ··ä¹±äº†å‡ å¤©æ‰ååº”è¿‡æ¥</font><br /><font color=red>æ³¨ 2ï¼šå¤§çš„éŸ³æ•ˆä¹Ÿæ»¡è¶³è¯¥æ ‡å‡†ï¼Œä¸Šè¿° OriginalSize ä¸º 2.8MBã€32.8KB çš„éŸ³æ•ˆ Profiler è¡¨ç°åŸºæœ¬ä¸€è‡´</font></li></ul><p>åœ¨ <font color=blue>CPU èµ„æºæ¶ˆè€—</font>ä¸Šï¼Œå¯¹äº Decompress On Loadã€Compressed In Memoryã€Streaming ä¸‰ç§ LoadType æ–¹å¼ï¼š</p><ul><li>Decompress On Loadï¼šCPU æ¶ˆè€—å·®ä¸å¤š</li><li>Compressed In Memoryï¼šå‹ç¼©å­˜æ”¾å†…å­˜æ—¶ï¼Œä»¥ PCM-&gt;ADPCM-&gt;Vorbis (è´¨é‡è¶Šé«˜æ¶ˆè€—è¶Šå¤š)</li><li>Streamingï¼šæµå¼æ’­æ”¾æ—¶ï¼Œä»¥ PCM-&gt;ADPCM-&gt;Vorbis (è´¨é‡è¶Šé«˜æ¶ˆè€—è¶Šå¤š)</li></ul><p>åœ¨<font color=blue>éŸ³æ•ˆè´¨é‡</font>ä¸Šï¼š</p><ul><li>ä¸»è¦å—å‹ç¼©æ ¼å¼å½±å“ã€‚PCM ä¸å‹ç¼©æ•ˆæœæœ€å¥½ï¼ŒADPCM å…¶æ¬¡ï¼ŒVorbis æœ€åã€‚</li><li>å¯¹æ­¤å¯ä»¥åœ¨é¢„è§ˆé¢æ¿çœ‹å‡ºï¼Œæ›´æ¢å‹ç¼©æ ¼å¼åï¼ŒæŒ¯å¹…ä¼šæœ‰è½»å¾®å˜åŠ¨ â€”â€” ä¸è¿‡ä»å®é™…å¬èµ·æ¥çš„æ•ˆæœçœ‹ï¼ŒPCMã€ADPCM å’Œ Vorbis é«˜è´¨é‡å‹ç¼©ä¸‹çš„æ•ˆæœå·®ä¸å¤šï¼Œè‡³å°‘ä¸ªäººæ²¡å¬å‡ºå¤ªå¤§å·®åˆ«ã€‚</li><li>ç»è¿‡æµ‹è¯•ï¼Œå¦‚æœæºéŸ³æ•ˆè´¨é‡å°±ä¸å¤§è¡Œï¼ŒPCM å’Œ Vorbis æ•ˆæœæ˜¯ä¸€æ ·ï¼Œä¿®æ”¹è¯¥é¡¹éŸ³æ•ˆæŒ¯å¹…ä¸ä¼šå‘ç”Ÿä»»ä½•æ”¹åŠ¨ â€”â€” ç”šè‡³ Vorbis 1%~100% è´¨é‡éƒ½æ²¡æœ‰å·®åˆ«ï¼Œæ¯”å¦‚æµ‹è¯•æ‰€ç”¨çš„ ã€lvbuã€ éŸ³æ•ˆã€‚</li></ul><p>å¦å¤– Force To Monoã€Sample Rate ç»Ÿä¸€å½±å“ä¸Šè¿°è¡¨ç° (CPUã€å†…å­˜æ¶ˆè€—ã€è¡¨ç°è´¨é‡)</p><p>ç»è¿‡ä¸Šé¢çš„æµ‹è¯•ï¼Œå¯ä»¥å‘ç°éŸ³æ•ˆè®¾ç½®ä¸»è¦æ˜¯è´¨é‡æ¢æ•ˆç‡ã€æˆ–è€…ç©ºé—´æ¢æ—¶é—´ã€æˆ–è€…æ—¶é—´æ¢ç©ºé—´ï¼Œæ€»æœ‰ä¸€å®šå–èˆã€‚</p><p>å› æ­¤æœ€åå†è¯´ä¸€ä¸‹ä¸ªäººæ€»ç»“ï¼š</p><ul><li>å¯ä»¥ä½¿ç”¨ PCM æ¨¡å¼ä¸‹çš„ Imported Size é¢„ä¼°å®é™…è§£å‹æ¶ˆè€—å†…å­˜é‡</li><li>æ²¡æœ‰ç»å¯¹çš„æœ€å¥½è®¾ç½®ï¼Œè¿™ä¸ªè®¾ç½®å¯èƒ½éœ€è¦å¹³è¡¡ åŒ…ä½“ã€å†…å­˜ã€CPU æ¶ˆè€—å¾—å‡ºç»“è®ºï¼Œå‰æœŸå¯ä»¥é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ ¼å¼ç»Ÿä¸€è®¾ç½®ï¼Œåç»­å®Œæ•´äº†å†è¿›è¡Œå…·ä½“ä¼˜åŒ–</li><li>ä»¥ PCM ImportedSize ä¸ºåŸºå‡†ï¼Œä¸€ä¸¤ç™¾ KBã€æ¯”è¾ƒé¢‘ç¹ä½¿ç”¨çš„å°éŸ³æ•ˆï¼Œä¾‹å¦‚æŒ‰é’®å£°éŸ³ã€æˆ˜æ–—ä¸­çš„æŠ€èƒ½éŸ³æ•ˆï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ ADPCM å‹ç¼©æ ¼å¼<br />æ™®é€šå°éŸ³æ•ˆé€‰æ‹© Compress In Memeryã€éå¸¸é¢‘ç¹çš„éŸ³æ•ˆé€‰æ‹© Decompress On Load</li><li>å¤§ä¸€ç‚¹æˆ–è€…æ¯”è¾ƒå°‘ç”¨çš„éŸ³æ•ˆï¼Œä¸è‡³äºå¸¸å½±å“åˆ° CPUï¼Œé‡‡ç”¨ Vorbis å‹ç¼©ï¼ŒLoadType é‡‡ç”¨ Compress In Memeryã€‚</li><li>é‡‡ç”¨ Vorbis å‹ç¼©å¯ä»¥è°ƒèŠ‚è´¨é‡æ»‘å—å‡å°‘å†…å­˜åŠ CPU æ¶ˆè€— (å½“ç„¶è¿™æ ·éŸ³æ•ˆè´¨é‡ä¹Ÿä¼šå—åˆ°å½±å“)</li><li>åå‡ å…†æˆ–è€…å‡ åå…†çš„ï¼Œå¦‚æœç›´æ¥æ”¾åœ¨å†…å­˜ä¼šå¾ˆå½±å“çš„æƒ…å†µä¸‹å†è€ƒè™‘æ˜¯å¦ç”¨æµå¼æ’­æ”¾ (æ„Ÿè§‰æ‰‹æ¸¸åº”è¯¥ä¹Ÿä¸è‡³äºï¼Œå¯¹äºæ‰‹æ¸¸æ¥è¯´è¿˜æ˜¯æœ‰ç‚¹å¥¢ä¾ˆäº†)ï¼Œé‡‡ç”¨æµå¼æ’­æ”¾æœ€å¥½é‡‡ç”¨ ADPCM æˆ– PCM æ ¼å¼äº†ï¼Œçœä¸€äº›æ’­æ”¾æ—¶çš„ CPU è§£å‹æ¶ˆè€—ã€‚</li><li>å¦å¤–åœ¨å¯ä»¥æ¥å—çš„æƒ…å†µä¸‹ï¼Œ Sample Rate å¯ä»¥è®¾ç½®ä¸º 22050Hzï¼Œæ¯”é»˜è®¤ 44100Hz å‡å°‘ä¸€åŠçš„å ç”¨</li><li>Force To Mono åœ¨å°éŸ³æ•ˆä¸Šåº”è¯¥ä¹Ÿå¯ä»¥å‹¾ä¸Šï¼Œä¾‹å¦‚æŒ‰é’®ç‚¹å‡»éŸ³æ•ˆæ€»ä¸èƒ½ä¹Ÿæ˜¯çœŸçš„ç«‹ä½“å£°å§ï¼Œä¹Ÿå¯ä»¥çœä¸‹ä¸€åŠèµ„æºã€‚ä¸è¿‡åœ¨éŸ³æ•ˆæºæ–‡ä»¶æœ¬èº«å°±æ˜¯çº¯å•é€šé“çš„æ—¶å€™ï¼Œå‹¾é€‰ä¸å¦éƒ½æ²¡æœ‰å½±å“</li></ul><p>åœ¨æˆ‘ä»¬æ¸¸æˆä¸­ï¼Œéƒ½æ˜¯é‡‡ç”¨å‰ä¸¤ç§ LoadType+Vorbis å‹ç¼©æ–¹å¼ï¼Œè´¨é‡ 70%ã€å‹ç¼©æ¨¡å¼å­˜æ”¾ (Compressed In Memory)ã€SampleRate 22050Hzã€‚</p><p>æ³¨ï¼šé€‰æ‹©å‹ç¼©åŒæ—¶ä¹Ÿä¼šå½±å“æ‰“åŒ…èµ„æºå¤§å°ï¼Œæœ€ç»ˆ AssetBundle åŒ…å¤§å°åŸºæœ¬ä¸éŸ³æ•ˆé¢æ¿ä¸Šçš„ ImportedSize å·®ä¸å¤š (+ éƒ¨åˆ† AssetBundle é¢å¤–æ•°æ®)ã€‚æœ€ç»ˆè®¾ç½®å¾—æƒè¡¡è´¨é‡ã€åŒ…ä½“å’Œå†…å­˜åŠæ€§èƒ½ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0x01-å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#0x01-å‰è¨€&quot;&gt;#&lt;/a&gt; 0x01 å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰è™½ç„¶æœ‰ç”¨è¿‡ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¯¹å…¶åšä¸ªäººçš„æ•´ç†ä¸æ€»ç»“ï¼Œåªå¤§æ¦‚çŸ¥é“å“ªä¸ªé€‰é¡¹ä¼šé€ æˆä»€ä¹ˆæƒ…å†µï¼Œæ­¤å¤„è¿›è¡Œä¸€æ¬¡è¯¦å°½çš„å®é™…æµ‹è¯•å¹¶æ€»ç»“ã€‚&lt;/p&gt;
&lt;h2</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="èµ„æºè®¾ç½®" scheme="https://cwhisme.github.io/categories/Unity3D/%E8%B5%84%E6%BA%90%E8%AE%BE%E7%BD%AE/"/>
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/tags/Unity3D/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://cwhisme.github.io/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºäºŒè¿›åˆ¶åå…­è¿›åˆ¶è½¬åè¿›åˆ¶ä¸ARGBå›¾ç‰‡å­˜å‚¨æ ¼å¼</title>
    <link href="https://cwhisme.github.io/2022/11/03/%E5%85%B3%E4%BA%8E%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E8%BD%AC%E5%8D%81%E8%BF%9B%E5%88%B6/"/>
    <id>https://cwhisme.github.io/2022/11/03/%E5%85%B3%E4%BA%8E%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E8%BD%AC%E5%8D%81%E8%BF%9B%E5%88%B6/</id>
    <published>2022-11-03T02:38:36.000Z</published>
    <updated>2022-12-22T03:29:48.150Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-å‰è¨€"><a class="anchor" href="#0x01-å‰è¨€">#</a> 0x01 å‰è¨€</h2><p>ä»Šå¤©å†™æ–‡ç« çš„æ—¶å€™ï¼Œçªç„¶æƒ³èµ·ç”¨åå…­è¿›åˆ¶å½“åšæ ‡é¢˜åºå·ï¼Œäºæ˜¯å†è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="0x02-åå…­è¿›åˆ¶ä¸åè¿›åˆ¶è½¬æ¢"><a class="anchor" href="#0x02-åå…­è¿›åˆ¶ä¸åè¿›åˆ¶è½¬æ¢">#</a> 0x02 åå…­è¿›åˆ¶ä¸åè¿›åˆ¶è½¬æ¢</h2><p>é¦–å…ˆï¼Œåœ¨åå…­è¿›åˆ¶ä¸­ 1~16 æ•°å­—ä»£è¡¨æœ‰ï¼š0,1,2,3,4,56,7,8,9,A (10),B (11),C (12),D (13),E (14),F (15)</p><p>å‰ä½ä¸º 0 å¯ä»¥è¢«å¿½ç•¥ï¼Œä¾‹å¦‚ï¼š</p><p>0x1<mark>0x01</mark>1<br />0x0A<mark>0xA</mark>10</p><p>åªæœ‰å‰ä¸€ä½æœ‰å¤§äº 1 çš„æƒ…å†µæ‰ä¼šä½œè®¡ç®—ï¼Œå¦‚ï¼š</p><p>0x1A<mark>26</mark>1*16+10</p><p>åä½ä¸º 0 åˆ™ä¼šä½¿å‰ä¸€ä½æˆä¸ºè¿›ä½æ•°ï¼š</p><p>0xA00==10<em>16</em>16+0+0=2560</p><p>å¯¹äºè¿›ä½æ¥è¯´ï¼Œå½“å‰å¤„äºå“ªä½ï¼Œè®¡ç®—æ—¶å°±éœ€è¦è‡ªèº«æ•°å€¼ä¹˜å¯¹åº”æ•°é‡ N çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>6</mn><mi>N</mi></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">16^N-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.924661em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> æ¬¡æ–¹</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mi>x</mi><mi>A</mi><mi>A</mi><mi>A</mi><mo>=</mo><mo>=</mo><mn>10</mn><mo>âˆ—</mo><mn>1</mn><msup><mn>6</mn><mn>2</mn></msup><mo>+</mo><mn>10</mn><mo>âˆ—</mo><mn>1</mn><msup><mn>6</mn><mn>1</mn></msup><mo>+</mo><mn>10</mn><mo>âˆ—</mo><mn>1</mn><msup><mn>6</mn><mn>0</mn></msup><mo>=</mo><mo>=</mo><mn>2730</mn></mrow><annotation encoding="application/x-tex">0xAAA==10*16^2+10*16^1+10*16^0==2730</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord mathnormal">x</span><span class="mord mathnormal">A</span><span class="mord mathnormal">A</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">7</span><span class="mord">3</span><span class="mord">0</span></span></span></span></p><p>åŒç†ï¼Œç»å¸¸è§åˆ°çš„é¢œè‰²å€¼ï¼š0xFFFF ç±»ä¼¼</p><p>0xFFFF<mark>15<em>16</em>16<em>16+15</em>16<em>16+15</em>16+15</mark>65535</p><p>è¿™ä¸­æœ€å¤§å€¼çš„æƒ…å†µï¼Œè®¡ç®—å…¶å®å¯ä»¥ç®€åŒ–ä¸€ä¸‹ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>6</mn><mn>4</mn></msup><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mo>=</mo><mn>16</mn><mo>âˆ—</mo><mn>16</mn><mo>âˆ—</mo><mn>16</mn><mo>âˆ—</mo><mn>16</mn><mo>âˆ’</mo><mn>1</mn><mo>=</mo><mo>=</mo><mn>65535</mn></mrow><annotation encoding="application/x-tex">16^4-1==16*16*16*16-1==65535</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span><span class="mord">5</span><span class="mord">5</span><span class="mord">3</span><span class="mord">5</span></span></span></span></p><h2 id="0x03-äºŒè¿›åˆ¶ä¸åè¿›åˆ¶è½¬æ¢"><a class="anchor" href="#0x03-äºŒè¿›åˆ¶ä¸åè¿›åˆ¶è½¬æ¢">#</a> 0x03 äºŒè¿›åˆ¶ä¸åè¿›åˆ¶è½¬æ¢</h2><p>å¯¹äºäºŒè¿›åˆ¶è½¬åè¿›åˆ¶ï¼Œå¸¸ç”¨çš„è¿˜æ˜¯æ•°æ•°ã€‚</p><p>æ•°äºŒè¿›åˆ¶ä¸­æœ‰å¤šå°‘ä¸ª 1 ï¼Œè¿™ä¸ª 1 æ‰€å ç”¨çš„ä½ç½® N ä½œä¸º 2 (N-1) æ¬¡æ–¹ï¼Œç„¶åç´¯åŠ èµ·æ¥ã€‚</p><p>ä¾‹å¦‚ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1011</mn><mo>=</mo><msup><mn>2</mn><mn>3</mn></msup><mo>+</mo><msup><mn>2</mn><mn>1</mn></msup><mo>+</mo><msup><mn>2</mn><mn>0</mn></msup><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">1011=2^3+2^1+2^0=15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">5</span></span></span></span></p><p>ä¾‹å¦‚ 4 ä¸ªå­—èŠ‚ å®¹é‡æœ‰å¤šå¤§ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“ï¼š</p><p>1 ä¸ªå­—èŠ‚æœ‰ 8 ä½<mark> 0b11111111</mark>255<br />2 ä¸ªå­—èŠ‚æœ‰ 16 ä½<mark> 0b1111111111111111</mark>256<em>256-1=65535<br />3 ä¸ªå­—èŠ‚æœ‰ 24 ä½<mark> 0b111111111111111111111111</mark>256</em>256<em>256-1=16777215<br />4 ä¸ªå­—èŠ‚æœ‰ 32 ä½<mark> 0b11111111111111111111111111111111</mark>256</em>256<em>256</em>256-1=4294967295</p><p>ä¸€å¼  ARGB32 çš„å›¾ç‰‡æ ¼å¼å°±æ˜¯ï¼š</p><p>æ¯ä¸ªé€šé“ 8 ä½ ==255 è¡¨ç¤ºä¸€ä¸ªé¢œè‰²ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è§çš„ (255,255,255,255) é¢œè‰²ç»„åˆï¼Œä¹Ÿå³æ˜¯ã€åŸå›¾ã€ã€‚</p><p>ä¸Šæ¬¡è¯„å®¡ä¹Ÿé—®åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼šæ²¡ç­”ä¸Šã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0x01-å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#0x01-å‰è¨€&quot;&gt;#&lt;/a&gt; 0x01 å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©å†™æ–‡ç« çš„æ—¶å€™ï¼Œçªç„¶æƒ³èµ·ç”¨åå…­è¿›åˆ¶å½“åšæ ‡é¢˜åºå·ï¼Œäºæ˜¯å†è®°å½•ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;0x02-åå…­è¿›åˆ¶ä¸åè¿›åˆ¶è½¬æ¢&quot;&gt;&lt;a c</summary>
      
    
    
    
    <category term="ç†è®ºç ”ç©¶" scheme="https://cwhisme.github.io/categories/%E7%90%86%E8%AE%BA%E7%A0%94%E7%A9%B6/"/>
    
    
    <category term="æ•°å­¦" scheme="https://cwhisme.github.io/tags/%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºå¯¹é¡¹ç›®å­—ç¬¦ä¸²æ‹¼æ¥çš„ä¼˜åŒ–ç ”ç©¶</title>
    <link href="https://cwhisme.github.io/2022/10/31/%E5%85%B3%E4%BA%8E%E5%AF%B9%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E7%9A%84%E4%BC%98%E5%8C%96/"/>
    <id>https://cwhisme.github.io/2022/10/31/%E5%85%B3%E4%BA%8E%E5%AF%B9%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E7%9A%84%E4%BC%98%E5%8C%96/</id>
    <published>2022-10-31T02:17:26.000Z</published>
    <updated>2022-12-22T03:29:48.149Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-å‰è¨€"><a class="anchor" href="#1-å‰è¨€">#</a> 1. å‰è¨€</h2><p>åœ¨å¯¹ç»„å‘˜ä»£ç è¿›è¡Œå®¡æŸ¥æ—¶ï¼Œç»å¸¸ç¢°åˆ°çœ‹ç€å¾ˆä¸åˆç†çš„å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œï¼Œç‰¹åˆ«æ˜¯å¯¹æ•°ç»„æ•°æ®æ“ä½œï¼Œä¹Ÿç›´æ¥ä¸€ä¸ª for å¾ªç¯ï¼Œä½¿ç”¨ + å·è¿›è¡Œã€‚</p><p>ç”šè‡³æœ‰æ—¶å€™è¿˜æ˜¯ç›´æ¥ä»¥ Text ä½œä¸ºä¸»ä½“ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> soldierData<span class="token punctuation">.</span>Skills<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>m_soldiersDesc<span class="token punctuation">.</span>text <span class="token operator">+=</span> soldierData<span class="token punctuation">.</span>Skills<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">GetLvDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªåœ°æ–¹ï¼Œé¦–å…ˆ m_soldiersDesc.text æ˜¯ä¸€ä¸ªä¸»ä½“ï¼Œã€+=ã€æ“ä½œç›¸å½“äº å–å€¼ + å­—ç¬¦ä¸²æ‹¼æ¥ + èµ‹å€¼ + é‡æ„ Text æ•°æ®ï¼Œè¿˜æ˜¯åœ¨å¾ªç¯ä¸­è¿›è¡Œ â€”â€” æœ‰å¤šè´¹å°±ä¸ç”¨å¤šè¯´äº†ã€‚</p><p>å†æ¬¡å¯¹ç»„å‘˜è¿›è¡Œå¼ºè°ƒï¼šä½¿ç”¨å¯¹åº”æŒ‡å®šæ–¹å¼æ‹¼æ¥å­—ç¬¦ä¸²ã€‚</p><p>é¡¹ç›®ä¸­å…¶å®å·²æœ‰å…¬å…±çš„é‡‡å– StringBuilder æ‹¼æ¥ç›¸å…³æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">/// çµ„åˆæ•°ç»„</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> split <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>list<span class="token punctuation">.</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token class-name">StringBuilder</span> sbd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> sbd<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">?</span> split <span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">return</span> sbd<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ³¨ï¼šè™½ç„¶è¯¥æ–¹æ³•æ˜¯å·²æœ‰çš„ï¼Œä½†æ˜¯ä½¿ç”¨çš„ä¸å¤š (è€Œä¸”è¯¥æ–¹æ³•ä½¿ç”¨ StringBuilder æ–¹å¼ä¹Ÿä¸å¤§å¥½ï¼Œä¾‹å¦‚è°ƒç”¨äº† StringBuilder Append è¿˜åœ¨ç”¨ + å·æ‹¼æ¥å°çš„)ï¼Œå¤§å¤šéƒ½æ˜¯åœ¨æè‡ªæˆ‘æ‹¼æ¥ã€‚</p><p>æ‰€ä»¥è™½ç„¶è¦æ±‚å¤§å®¶ä½¿ç”¨é¡¹ç›®è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²æ‹¼æ¥ç›¸å…³æ‰©å±•æ–¹æ³•ï¼Œä¸è¿‡è¿™è¾¹è¿™å—ææ€•éœ€è¦è¿›è¡Œä¼˜åŒ–ä¸€ä¸‹ã€‚</p><h2 id="2-ç¬¬ä¸€ç‰ˆä¼˜åŒ–"><a class="anchor" href="#2-ç¬¬ä¸€ç‰ˆä¼˜åŒ–">#</a> 2. ç¬¬ä¸€ç‰ˆä¼˜åŒ–</h2><p>ä¸ºæ­¤æˆ‘åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå¢åŠ äº†ä¸€ä»½æ‰©å±•ï¼Œä¼˜åŒ–ä¸»è¦æœ‰ä¸¤ç‚¹ï¼šä½¿ç”¨ StringBuilder æ‹¼æ¥ï¼Œä¸”å¯¹å…¶è¿›è¡Œç¼“å­˜ï¼Œæ¯æ¬¡å›æ”¶åˆ©ç”¨ã€‚</p><p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">StringBuilder</span> _stringBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">int</span></span> _stringCacheLength<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">int</span></span> _stringCacheTopIndex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">/// å°†æ•°ç»„ç»„åˆä¸ºå­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> split <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>list<span class="token punctuation">.</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        _stringBuilder<span class="token punctuation">.</span>Length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        _stringCacheLength <span class="token operator">=</span> list<span class="token punctuation">.</span>Count<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        _stringCacheTopIndex <span class="token operator">=</span> _stringCacheLength <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _stringCacheLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> _stringCacheTopIndex<span class="token punctuation">)</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>split<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">return</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token comment">/// å°†åˆ—è¡¨ç»„åˆä¸ºå­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name">RCallback<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> T<span class="token punctuation">></span></span> getStr<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> split <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>list<span class="token punctuation">.</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        _stringBuilder<span class="token punctuation">.</span>Length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        _stringCacheLength <span class="token operator">=</span> list<span class="token punctuation">.</span>Count<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        _stringCacheTopIndex <span class="token operator">=</span> _stringCacheLength <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _stringCacheLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token function">getStr</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> _stringCacheTopIndex<span class="token punctuation">)</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>split<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">return</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token comment">/// å°†å­—å…¸ç»„åˆä¸ºå­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span> dic<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> split <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dic<span class="token punctuation">.</span>Count <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        _stringBuilder<span class="token punctuation">.</span>Length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> item <span class="token keyword">in</span> dic<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>getStrCallback <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>                _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>            <span class="token keyword">else</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token function">getStrCallback</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> item<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>            _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>split<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        _stringBuilder<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>_stringBuilder<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token keyword">return</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token comment">/// å°†æ•°ç»„ç»„åˆä¸ºå­—ç¬¦ä¸²ï¼Œæ¢è¡Œåˆ†å‰²</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toStringLine</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">T<span class="token punctuation">[</span><span class="token punctuation">]</span></span> arr<span class="token punctuation">,</span> <span class="token class-name">RCallback<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> T<span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">,</span> getStrCallback<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token comment">/// å°†åˆ—è¡¨ç»„åˆä¸ºå­—ç¬¦ä¸²ï¼Œæ¢è¡Œåˆ†å‰²</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toStringLine</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name">RCallback<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> T<span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>        <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">,</span> getStrCallback<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token comment">/// å°†å­—å…¸ç»„åˆä¸ºå­—ç¬¦ä¸²ï¼Œæ¢è¡Œåˆ†å‰²</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="76"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toStringLine</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span> dic<span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token keyword">return</span> dic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">,</span> getStrCallback<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ä¸»è¦æä¾›æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼šä¸€ç§ç›´æ¥å°†æ•°ç»„æ¯ä¸ªæ•°æ®æ‹¼æ¥ï¼Œå¦ä¸€ç§ä¼šç»è¿‡å›è°ƒå¤„ç†åå†æ‹¼æ¥ã€‚<br />å¹¶æ”¯æŒæ•°ç»„ã€åˆ—è¡¨ã€å­—å…¸ä¸‰ä¸ªå¸¸ç”¨æ•°æ®ç»“æ„å†…å®¹çš„æ‹¼æ¥ã€‚</p><p>è¿™é‡Œåªä½¿ç”¨ä¸€ä»½ StringBuilder ç¼“å­˜ï¼Œæ˜¯å› ä¸ºè€ƒè™‘åˆ°æ¸¸æˆä¸­å•çº¿ç¨‹æ¨¡å¼å³ç”¨å°±å³æ—¶è¿”å›ç»“æœäº†ï¼Œæ²¡æœ‰å¿…è¦é‡‡ç”¨å¯¹è±¡æ± æ¨¡å¼å»ç¼“å­˜å¤šä¸ªã€‚</p><h2 id="3-æ€§èƒ½æµ‹è¯•ä¸ä¼˜åŒ–"><a class="anchor" href="#3-æ€§èƒ½æµ‹è¯•ä¸ä¼˜åŒ–">#</a> 3. æ€§èƒ½æµ‹è¯•ä¸ä¼˜åŒ–</h2><h3 id="å››ç§æ‹¼æ¥æ–¹å¼æ€§èƒ½æµ‹è¯•"><a class="anchor" href="#å››ç§æ‹¼æ¥æ–¹å¼æ€§èƒ½æµ‹è¯•">#</a> å››ç§æ‹¼æ¥æ–¹å¼æ€§èƒ½æµ‹è¯•</h3><p>å¯¹äºæ€§èƒ½æµ‹è¯•ï¼Œè¿™é‡Œé¦–å…ˆä»¥ 100000 ä¸ªæ”¾ç½®äºä¸€ä¸ªæ•°ç»„ä¸­çš„éšæœºå­—ç¬¦ä¸²çš„æ‹¼æ¥ä¸ºä¾‹ï¼Œåˆ†åˆ«é‡‡ç”¨ + å·æ‹¼æ¥ã€string.Joinã€è‡ªå®šä¹‰ StringBuilderã€å¸¦å›è°ƒè‡ªå®šä¹‰ StringBuilder å››ç§æ–¹å¼ï¼Œæµ‹è¯•å…¶æ¶ˆè€—æ—¶é•¿ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> TestCount <span class="token operator">=</span> <span class="token number">100000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">// çº¯å­—ç¬¦ä¸²æ•°ç»„</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> _strArray<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token comment">// åˆå§‹åŒ–æµ‹è¯•æ•°æ®</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        _strArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span>TestCount<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            _strArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">GetRandomStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">// æµ‹è¯•æ•°æ®å¡«å……å®Œæ¯•</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token comment">//==========</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token class-name">Stopwatch</span> stopwatch <span class="token operator">=</span> Stopwatch<span class="token punctuation">.</span><span class="token function">StartNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token comment">//1. æµ‹è¯•ç›´æ¥æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token class-name"><span class="token keyword">string</span></span> finalStr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _strArray<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            finalStr <span class="token operator">+=</span> <span class="token string">","</span> <span class="token operator">+</span> _strArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>finalStr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">LogWarning</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"ç›´æ¥æ‹¼æ¥æ•°ç»„ï¼š&#123;0&#125;"</span><span class="token punctuation">,</span> stopwatch<span class="token punctuation">.</span>Elapsed<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token comment">//2. æµ‹è¯•å†…éƒ¨å‡½æ•° join æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        finalStr <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> _strArray<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>finalStr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">LogWarning</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"string.Join æ‹¼æ¥æ•°ç»„ï¼š&#123;0&#125;"</span><span class="token punctuation">,</span> stopwatch<span class="token punctuation">.</span>Elapsed<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token comment">//3. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        finalStr <span class="token operator">=</span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>finalStr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">LogWarning</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„ï¼š&#123;0&#125;"</span><span class="token punctuation">,</span> stopwatch<span class="token punctuation">.</span>Elapsed<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token comment">//4. æµ‹è¯•å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        finalStr <span class="token operator">=</span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> str <span class="token operator">=></span> str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>finalStr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">LogWarning</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„ï¼š&#123;0&#125;"</span><span class="token punctuation">,</span> stopwatch<span class="token punctuation">.</span>Elapsed<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment">/// è¿”å›ä¸€ä¸ªéšæœºå€¼å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetRandomStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Intern</span><span class="token punctuation">(</span>Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2022/2022-10-31/m_58a128e53038c421467e1deabe1943b5_r.png" alt="" /></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹è§ç›´æ¥ä½¿ç”¨ + å·è¿›è¡Œæ‹¼æ¥çš„æ–¹å¼ï¼Œç›¸æ¯”å¦å¤–å‡ ç§æ–¹å¼å…¶æ¶ˆè€—æ—¶é—´å¯ä»¥è¯´æ˜¯ä¸€éª‘ç»å°˜ï¼šå¯ä»¥ç¡®å®šå†…éƒ¨åŸºæœ¬ä¸Šæ²¡æœ‰ä»€ä¹ˆä¼˜åŒ–çš„ã€‚</p><p>ä¸¥æ ¼æ¥è¯´ï¼Œä¸Šè¿°æµ‹è¯•æ–¹å¼å¹¶ä¸å‡†ç¡®ï¼Œä¸è¿‡è¿™é‡Œä¸»è¦æ˜¯å› ä¸º + å·æ‹¼æ¥å¤ªè¿‡äºæ¶ˆè€—æ—¶é—´ï¼Œæ•°æ®å¤§äº†ç”µè„‘è·‘ä¸åŠ¨ã€‚å› æ­¤æˆ‘å°±ä»…æ‰§è¡Œä¸€æ¬¡å¤§æ‰¹é‡æµ‹è¯•äº† â€”â€” ç¡®å®šè¿™æ–¹å¼çœŸå¯ä»¥ä¸¢ä¸€è¾¹äº†ã€‚</p><h3 id="å¹³å‡æ€§èƒ½æµ‹è¯•"><a class="anchor" href="#å¹³å‡æ€§èƒ½æµ‹è¯•">#</a> å¹³å‡æ€§èƒ½æµ‹è¯•</h3><p>æ¥ä¸‹æ¥ï¼Œå‰”é™¤ + å·æ‹¼æ¥æ–¹å¼ï¼Œå¯¹æ¯”ä½™ä¸‹æ–¹å¼å»å–å¹³å‡æ¶ˆè€—æ—¶é—´ã€‚</p><p>joinã€concatã€è‡ªå®šä¹‰å‡½æ•°ã€å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°åˆ†åˆ«æ‰§è¡Œ 100 æ¬¡ï¼Œå–å¹³å‡æ—¶é—´ã€‚<br />é™¤æ­¤ä¹‹å¤–ï¼Œå¢åŠ å¯¹ åˆ—è¡¨ã€å­—å…¸ã€ç±»ç±»å‹ç»“æ„æµ‹è¯•ã€‚</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">StrClass</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span></span> _desStr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">public</span> <span class="token function">StrClass</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> str<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        _desStr <span class="token operator">=</span> str<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">return</span> <span class="token function">GetHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> _desStr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// æ•°æ®é•¿åº¦</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> TestValueCount <span class="token operator">=</span> <span class="token number">100000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// æ¯ä¸€è½®æµ‹è¯•æ¬¡æ•°ï¼Œå–å¹³å‡æ¶ˆè€—æ—¶é—´</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> TestNum <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// ä¿å­˜ä¸€ä¸‹ç»“æœ</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span></span> _logPath<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">// çº¯å­—ç¬¦ä¸²æ•°ç»„</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> _strArray<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">// çº¯å­—ç¬¦ä¸²åˆ—è¡¨</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span> _strList<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">// å­—å…¸</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> _strDic<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// è¿”å›å­—ç¬¦ä¸²çš„ç±»ç»“æ„</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">private</span> <span class="token class-name">StrClass<span class="token punctuation">[</span><span class="token punctuation">]</span></span> _strClassArray<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token comment">// åˆå§‹åŒ–æµ‹è¯•æ•°æ®</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    _strArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">[</span>TestValueCount<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    _strList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>TestValueCount<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    _strClassArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StrClass</span><span class="token punctuation">[</span>TestValueCount<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    _strDic <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>TestValueCount<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestValueCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        _strArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">GetRandomStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        _strList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token function">GetRandomStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        _strClassArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StrClass</span><span class="token punctuation">(</span><span class="token function">GetRandomStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        _strDic<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">GetRandomStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token comment">// æµ‹è¯•æ•°æ®å¡«å……å®Œæ¯•</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token comment">//==========</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token comment">//Stopwatch stopwatch = Stopwatch.StartNew();</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token comment">//1. æµ‹è¯•ç›´æ¥æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token comment">//stopwatch.Start();</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token comment">//string finalStr = "";</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token comment">//for (int i = 0; i &lt; _strArray.Length; i++)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token comment">//&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token comment">//    finalStr += "," + _strArray[i];</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment">//&#125;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token comment">//stopwatch.Stop();</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token comment">//UnityEngine.Debug.Log(finalStr);</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token comment">//UnityEngine.Debug.LogWarning (string.Format ("ç›´æ¥æ‹¼æ¥æ•°ç»„ï¼š&#123;0&#125;", stopwatch.Elapsed.ToString ()));</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token comment">// æ¸…ç©ºæ—¥å¿—</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    _logPath <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"TestLog.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    File<span class="token punctuation">.</span><span class="token function">WriteAllText</span><span class="token punctuation">(</span>_logPath<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token comment">// æµ‹è¯•å†…éƒ¨å‡½æ•° concat æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"string.concat æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>_strArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token comment">//2. æµ‹è¯•å†…éƒ¨å‡½æ•° join æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"string.Join æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> _strArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token comment">//3. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>    <span class="token comment">//4. æµ‹è¯•å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> str <span class="token operator">=></span> str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token comment">//5. æµ‹è¯• join å‡½æ•°æ‹¼æ¥åˆ—è¡¨</span></pre></td></tr><tr><td data-num="76"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"string.Join æ‹¼æ¥åˆ—è¡¨"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strList<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token comment">//6. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨</span></pre></td></tr><tr><td data-num="78"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strList<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token comment">//7. æµ‹è¯•å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strList<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token comment">//8. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥ç±»ç±»å‹</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥ç±»ç±»å‹"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strClassArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> data <span class="token operator">=></span> data<span class="token punctuation">.</span><span class="token function">GetDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre>    <span class="token comment">//9. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token comment">//10. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸(å¸¦å›è°ƒæ“ä½œ)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">=></span> k <span class="token operator">+</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre></pre></td></tr><tr><td data-num="90"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="91"></td><td><pre></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token comment">/// æ‰§è¡Œä¸€è½®å¯¹ callback è¿è¡Œæµ‹è¯•</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> title<span class="token punctuation">,</span> <span class="token class-name">Action</span> callback<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="96"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token class-name">Stopwatch</span> stopwatch <span class="token operator">=</span> Stopwatch<span class="token punctuation">.</span><span class="token function">StartNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>    <span class="token class-name"><span class="token keyword">long</span></span> totalTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> TestNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>        stopwatch<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>        totalTime <span class="token operator">+=</span> stopwatch<span class="token punctuation">.</span>ElapsedTicks<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token class-name">TimeSpan</span> span <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TimeSpan</span><span class="token punctuation">(</span>totalTime<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>    <span class="token class-name"><span class="token keyword">string</span></span> log <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"* &#123;0&#125;ï¼š&#123;1&#125;ç§’&#123;2&#125;æ¯«ç§’\n"</span><span class="token punctuation">,</span> title<span class="token punctuation">,</span> span<span class="token punctuation">.</span>Seconds<span class="token punctuation">,</span> span<span class="token punctuation">.</span>Milliseconds<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>    File<span class="token punctuation">.</span><span class="token function">AppendAllText</span><span class="token punctuation">(</span>_logPath<span class="token punctuation">,</span> log<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>    UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">LogWarning</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="111"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="112"></td><td><pre></pre></td></tr><tr><td data-num="113"></td><td><pre><span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="114"></td><td><pre><span class="token comment">/// è¿”å›ä¸€ä¸ªéšæœºå€¼å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="115"></td><td><pre><span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="116"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetRandomStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="117"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="118"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Intern</span><span class="token punctuation">(</span>UnityEngine<span class="token punctuation">.</span>Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="119"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><ul><li>string.concat æ‹¼æ¥æ•°ç»„ï¼š00:00:00.0099083</li><li>string.Join æ‹¼æ¥æ•°ç»„ï¼š00:00:00.0132115</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„ï¼š00:00:00.0179701</li><li>å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„ï¼š00:00:00.0175816</li><li>string.Join æ‹¼æ¥åˆ—è¡¨ï¼š00:00:00.0184016</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨ï¼š00:00:00.0185559</li><li>å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨ï¼š00:00:00.0180418</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥ç±»ç±»å‹ï¼š00:00:00.1013892</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸ï¼š00:00:00.0224806</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸ (å¸¦å›è°ƒæ“ä½œ)ï¼š00:00:00.0983786</li></ul><p>æœ‰ç‚¹å¥‡æ€ªçš„æ˜¯ï¼Œåœ¨æ•°ç»„ç»“æ„ä¸Šï¼Œå¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ—¶é—´æ¶ˆè€—åè€Œæ¯”ä¸å¸¦å›è°ƒçš„ä½ä¸€ç‚¹ï¼Ÿ</p><p>æ‰€ä»¥å¯ä»¥ç¡®å®šä¸€ä¸‹æ€§èƒ½æ’åºåˆ†åˆ«ä¸ºï¼š</p><blockquote><p>string.concat-&gt;string.Join-&gt;StringBuilder è‡ªå®šä¹‰æ‹¼æ¥ -&gt;+ å·æ‹¼æ¥</p></blockquote><p>(å…¶ä¸­ concat ä¹‹æ‰€ä»¥æ€§èƒ½æ›´é«˜ï¼Œé™¤äº†å› ä¸ºå°‘äº†ä¸€ä½ã€åˆ†éš”ç¬¦ã€çš„æ’å…¥ï¼Œçœ‹æºç ä¼¼ä¹è¿˜åˆ©ç”¨äº†åˆ›å»ºä¸€ä¸ªæœ€ç»ˆå¤§å°å­—ç¬¦ä¸²ï¼Œé€šè¿‡å†…å­˜æ‹·è´æ–¹å¼å¤åˆ¶è¿›å»å®ç°)</p><p>è¿™ä¹ˆçœ‹èµ·æ¥ï¼Œè¿˜æ˜¯å†…ç½®æ‹¼æ¥å‡½æ•°æ€§èƒ½æ¯”è¾ƒé«˜ã€‚</p><p>ä¸è¿‡ concatã€Join çš„å±€é™æ€§åœ¨äºï¼šåªèƒ½ç”¨äºæ•°ç»„ç±»å‹ï¼Œä¸”åªå¤„ç†å­—ç¬¦ä¸² â€”â€” å¦‚æœå¯¹è±¡ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ç›´æ¥é€šè¿‡ ToString å¼ºè½¬ä¸ºå­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥ã€‚(è¦æ˜¯æœ‰æŸä¸ªéå­—ç¬¦ä¸²æ•°ç»„ç±»å‹å¯¹è±¡é‡è½½è¿‡ ToString è¾“å‡ºæ­£ç¡®å€¼ä¹Ÿä¸æ˜¯ä¸èƒ½ç”¨)</p><h2 id="4-ç¬¬äºŒç‰ˆä¼˜åŒ–"><a class="anchor" href="#4-ç¬¬äºŒç‰ˆä¼˜åŒ–">#</a> 4. ç¬¬äºŒç‰ˆä¼˜åŒ–</h2><p>ç»è¿‡æµ‹è¯•ä¹‹åï¼Œå¤§æ¦‚æ€§èƒ½ä¹Ÿæœ‰ç‚¹æ•°äº†ã€‚</p><p>äºæ˜¯å°±æœ‰ä¸€äº›æ–°çš„æƒ³æ³•ï¼šä¾‹å¦‚æ— å›è°ƒéœ€æ±‚æ—¶ä½¿ç”¨ join æ‹¼æ¥ã€åˆ†éš”ç¬¦ä¸ºç©ºåˆ™é‡‡ç”¨ concat æ‹¼æ¥ â€”â€” è™½ç„¶ä¼šå¢åŠ ä¸€ç‚¹åˆ¤æ–­ï¼Œä½†æ˜¯æ€§èƒ½è¯¥æ˜¯å¯ä»¥æå‡ä¸€ç‚¹çš„ã€‚</p><p>å¦å¤–åœ¨ç›®å‰è‡ªå®šä¹‰æ‰©å±•å‡½æ•°çš„ä½¿ç”¨æ–¹å¼ä¸Šï¼Œæ„Ÿè§‰ä¹Ÿè¿˜æœ‰ç‚¹ç¼ºç‚¹ï¼šæ¯”å¦‚å­—å…¸ç±»å‹ï¼Œå¦‚æœåˆ«äººæƒ³æŠŠ kã€v ç»“æ„ä¹Ÿæ‹¼æ¥åœ¨ä¸€å—ï¼Œé‚£ä¹ˆè¿™é‡Œå°±ä¸å¤§å¥½åŠäº†ï¼Œè®©è°ƒç”¨è€…åœ¨å›è°ƒæ–¹æ³•ç”¨ + å·æ‹¼æ¥ä¸€æ¬¡ï¼Ÿè¿™æ ·å¯å°±åˆå†—ä½™äº†ã€‚æ‰€ä»¥æœ€å¥½ä¹Ÿæä¾›ä¸€ä¸ªé‡è½½ä½¿å…¶ä½œä¸ºå¯é€‰é¡¹ã€‚</p><p>æœ€ç»ˆå½¢æˆä»¥ä¸‹æ–¹æ³•ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">StringBuilder</span> _stringBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">int</span></span> _stringCacheLength<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">int</span></span> _stringCacheTopIndex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">/// å°†æ•°ç»„ç»„åˆä¸ºå­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">T<span class="token punctuation">[</span><span class="token punctuation">]</span></span> arr<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> separator <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>separator<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> getStrCallback <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token comment">//if (getStrCallback == null) return string.Join(separator, arr);</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>arr <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> arr<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        _stringBuilder<span class="token punctuation">.</span>Length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        _stringCacheLength <span class="token operator">=</span> arr<span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        _stringCacheTopIndex <span class="token operator">=</span> _stringCacheLength <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _stringCacheLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token function">CheckDeliverValue</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> getStrCallback<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> _stringCacheTopIndex<span class="token punctuation">)</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>separator<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">return</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">/// å°†åˆ—è¡¨ç»„åˆä¸ºå­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> separator <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>separator<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> getStrCallback <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token comment">//if (getStrCallback == null) return string.Join(separator, list);</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>list <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> list<span class="token punctuation">.</span>Count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        _stringBuilder<span class="token punctuation">.</span>Length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        _stringCacheLength <span class="token operator">=</span> list<span class="token punctuation">.</span>Count<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        _stringCacheTopIndex <span class="token operator">=</span> _stringCacheLength <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _stringCacheLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>            _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token function">CheckDeliverValue</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> getStrCallback<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> _stringCacheTopIndex<span class="token punctuation">)</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>separator<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token keyword">return</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token comment">/// å°†å­—å…¸çš„æ‰€æœ‰ value ç»„åˆä¸ºå­—ç¬¦ä¸²ï¼Œå¿½ç•¥å­—å…¸çš„ Key å€¼</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token comment">/// &lt;param name="separator"> åˆ†éš”ç¬¦ & lt;/param></span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token comment">/// &lt;param name="getValueStrCallback"> å¦‚æœ value è½¬åŒ–ä¸ºå­—ç¬¦ä¸²éœ€è¦å…¶å®ƒæ¥å£ï¼Œå¯ä½¿ç”¨å›è°ƒè¿”å›è°ƒç”¨åçš„å€¼ & lt;/param></span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token comment">/// &lt;returns>value,value,value,value,value......&lt;/returns></span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span> dic<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> separator <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>V<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getValueStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token keyword">return</span> <span class="token function">toString</span><span class="token punctuation">(</span>dic<span class="token punctuation">,</span> separator<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> getValueStrCallback<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token comment">/// å°†å­—å…¸ key å’Œ value æˆå¯¹ç»„åˆä¸ºå­—ç¬¦ä¸²ï¼Œéœ€è¦ä¼ å…¥å¯¹åº”çš„åˆ†éš”ç¬¦</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment">/// &lt;param name="separator"> æ¯ä¸ªå¯¹è±¡ä¹‹é—´åˆ†å‰²ç¬¦ & lt;/param></span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token comment">/// &lt;param name="separatorKV">key å’Œ value åˆ†éš”ç¬¦ï¼Œä¼ å…¥ç©ºå€¼æ‹¼æ¥æ—¶å°†å¿½ç•¥ key å€¼ & lt;/param></span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token comment">/// &lt;param name="getKeyStrCallback"> å¦‚æœ key è½¬åŒ–ä¸ºå­—ç¬¦ä¸²éœ€è¦å…¶å®ƒæ¥å£ï¼Œå¯ä½¿ç”¨å›è°ƒè¿”å›è°ƒç”¨åçš„å€¼ & lt;/param></span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token comment">/// &lt;param name="getValueStrCallback"> å¦‚æœ value è½¬åŒ–ä¸ºå­—ç¬¦ä¸²éœ€è¦å…¶å®ƒæ¥å£ï¼Œå¯ä½¿ç”¨å›è°ƒè¿”å›è°ƒç”¨åçš„å€¼ & lt;/param></span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token comment">/// &lt;returns > é»˜è®¤ï¼škey:value,key:value,key:value......&lt;/returns></span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span> dic<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> separator<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> separatorKV<span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getKeyStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>V<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getValueStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dic <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> dic<span class="token punctuation">.</span>Count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        _stringBuilder<span class="token punctuation">.</span>Length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token comment">//kv åˆ†éš”ç¬¦ä¸ºç©ºï¼Œåˆ™å½“åšè¡¨ç¤ºä¸æ‹¼æ¥ key</span></pre></td></tr><tr><td data-num="67"></td><td><pre>        <span class="token class-name"><span class="token keyword">bool</span></span> appendKey <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>separatorKV<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> item <span class="token keyword">in</span> dic<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>            <span class="token comment">// é™„åŠ å­—å…¸ key</span></pre></td></tr><tr><td data-num="71"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>appendKey<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre>            <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>                _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token function">CheckDeliverValue</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> getKeyStrCallback<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>                _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>separatorKV<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>            <span class="token comment">// é™„åŠ å­—å…¸å€¼</span></pre></td></tr><tr><td data-num="77"></td><td><pre>            _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token function">CheckDeliverValue</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>Value<span class="token punctuation">,</span> getValueStrCallback<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>            <span class="token comment">// åˆ†éš”ç¬¦</span></pre></td></tr><tr><td data-num="79"></td><td><pre>            _stringBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>separator<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>        _stringBuilder<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>_stringBuilder<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        <span class="token keyword">return</span> _stringBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token comment">/// å°†æ•°ç»„ç»„åˆä¸ºå­—ç¬¦ä¸²ï¼Œæ¢è¡Œåˆ†å‰²</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="88"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toStringLine</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">T<span class="token punctuation">[</span><span class="token punctuation">]</span></span> arr<span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>        <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">,</span> getStrCallback<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="92"></td><td><pre></pre></td></tr><tr><td data-num="93"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token comment">/// å°†åˆ—è¡¨ç»„åˆä¸ºå­—ç¬¦ä¸²ï¼Œæ¢è¡Œåˆ†å‰²</span></pre></td></tr><tr><td data-num="95"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="96"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toStringLine</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> list<span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>        <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">,</span> getStrCallback<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="100"></td><td><pre></pre></td></tr><tr><td data-num="101"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token comment">/// å°†å­—å…¸ç»„åˆä¸ºå­—ç¬¦ä¸²ï¼Œæ¢è¡Œåˆ†å‰² (å¿½ç•¥ key å€¼)</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="104"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">toStringLine</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">></span></span> dic<span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>V<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getStrCallback <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>        <span class="token keyword">return</span> dic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">,</span> getStrCallback<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="108"></td><td><pre></pre></td></tr><tr><td data-num="109"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="110"></td><td><pre>    <span class="token comment">/// æ£€æŸ¥æ˜¯å¦å¯¹å€¼è¿›è¡Œå›è°ƒå¤„ç†ï¼ˆè‹¥ getValueStrCallback ä¸ä¸ºç©ºåˆ™è¿”å›è°ƒç”¨åç»“æœï¼Œå‚æ•°ä¸º valueï¼‰</span></pre></td></tr><tr><td data-num="111"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="112"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">CheckDeliverValue</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token class-name">T</span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">></span></span> getValueStrCallback<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="113"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>getValueStrCallback <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">value</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>        <span class="token keyword">return</span> <span class="token function">getValueStrCallback</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id="æ€§èƒ½æµ‹è¯•"><a class="anchor" href="#æ€§èƒ½æµ‹è¯•">#</a> æ€§èƒ½æµ‹è¯•ï¼š</h4><p>ä¾ç„¶æ˜¯ 100000 ä¸ªéšæœºå­—ç¬¦ä¸²ï¼Œå¾ªç¯ä¸€ç™¾æ¬¡æ‹¼æ¥ã€‚</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// æµ‹è¯•å†…éƒ¨å‡½æ•° concat æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"string.concat æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>_strArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//2. æµ‹è¯•å†…éƒ¨å‡½æ•° join æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"string.Join æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> _strArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//3. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">//4. æµ‹è¯•å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> str <span class="token operator">=></span> str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//5. æµ‹è¯• join å‡½æ•°æ‹¼æ¥åˆ—è¡¨</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"string.Join æ‹¼æ¥åˆ—è¡¨"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strList<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">//6. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strList<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">//7. æµ‹è¯•å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strList<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">//8. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥ç±»ç±»å‹</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥ç±»ç±»å‹"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strClassArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> data <span class="token operator">=></span> data<span class="token punctuation">.</span><span class="token function">GetDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">//9. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">//10. æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">//DoTest ("è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸ (å¸¦å›è°ƒæ“ä½œ)", () => _strDic.toString (",");</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"string.concat æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>_strArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"string.join æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> _strArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥æ•°ç»„(æ— åˆ†éš”ç¬¦)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥æ•°ç»„"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥æ•°ç»„(å¸¦å›è°ƒ)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> str <span class="token operator">=></span> str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥å­—å…¸ Value"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥å­—å…¸(å¸¦ Value å›è°ƒ)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> v <span class="token operator">=></span> v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥å­—å…¸ Kã€V"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥å­—å…¸ Kã€V(å¸¦ Key å›è°ƒ)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">,</span> k <span class="token operator">=></span> k<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥å­—å…¸ Kã€V(å¸¦ Keyã€Value å›è°ƒ)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">,</span> k <span class="token operator">=></span> k<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v <span class="token operator">=></span> v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥å­—å…¸(å­—å…¸è½¬æ•°ç»„æ‹¼æ¥)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token function">DoTest</span><span class="token punctuation">(</span><span class="token string">"æ‹¼æ¥å­—å…¸(å­—å…¸è½¬åˆ—è¡¨æ‹¼æ¥)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> _strDic<span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>string.concat æ‹¼æ¥æ•°ç»„ï¼š0 ç§’ 937 æ¯«ç§’</li><li>string.Join æ‹¼æ¥æ•°ç»„ï¼š1 ç§’ 282 æ¯«ç§’</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„ï¼š1 ç§’ 837 æ¯«ç§’</li><li>å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥æ•°ç»„ï¼š1 ç§’ 809 æ¯«ç§’</li><li>string.Join æ‹¼æ¥åˆ—è¡¨ï¼š1 ç§’ 858 æ¯«ç§’</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨ï¼š1 ç§’ 916 æ¯«ç§’</li><li>å¸¦å›è°ƒè‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥åˆ—è¡¨ï¼š1 ç§’ 847 æ¯«ç§’</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥ç±»ç±»å‹ï¼š10 ç§’ 400 æ¯«ç§’</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥ç±»ç±»å‹ (GetDes () æ— è®¡ç®—)ï¼š1 ç§’ 870 æ¯«ç§’</li><li>è‡ªå®šä¹‰å‡½æ•°æ‹¼æ¥å­—å…¸ï¼š2 ç§’ 316 æ¯«ç§’</li><li>string.concat æ‹¼æ¥æ•°ç»„ï¼š0 ç§’ 910 æ¯«ç§’</li><li>string.join æ‹¼æ¥æ•°ç»„ï¼š1 ç§’ 253 æ¯«ç§’</li><li>æ‹¼æ¥æ•°ç»„ (æ— åˆ†éš”ç¬¦)ï¼š1 ç§’ 638 æ¯«ç§’</li><li>æ‹¼æ¥æ•°ç»„ï¼š1 ç§’ 764 æ¯«ç§’</li><li>æ‹¼æ¥æ•°ç»„ (å¸¦å›è°ƒ)ï¼š1 ç§’ 794 æ¯«ç§’</li><li>æ‹¼æ¥å­—å…¸ Valueï¼š2 ç§’ 332 æ¯«ç§’</li><li>æ‹¼æ¥å­—å…¸ (å¸¦ Value å›è°ƒ)ï¼š2 ç§’ 356 æ¯«ç§’</li><li>æ‹¼æ¥å­—å…¸ Kã€Vï¼š8 ç§’ 121 æ¯«ç§’</li><li>æ‹¼æ¥å­—å…¸ Kã€V (å¸¦ Key å›è°ƒ)ï¼š8 ç§’ 111 æ¯«ç§’</li><li>æ‹¼æ¥å­—å…¸ Kã€V (å¸¦ Keyã€Value å›è°ƒ)ï¼š8 ç§’ 335 æ¯«ç§’</li><li>æ‹¼æ¥å­—å…¸ (å­—å…¸è½¬æ•°ç»„æ‹¼æ¥)ï¼š14 ç§’ 391 æ¯«ç§’</li><li>æ‹¼æ¥å­—å…¸ (å­—å…¸è½¬åˆ—è¡¨æ‹¼æ¥)ï¼š15 ç§’ 655 æ¯«ç§’</li></ul><p>(ä½ç‰ˆæœ¬ C# çš„ string.concatã€string.Join è¿åˆ—è¡¨éƒ½ä¸æ”¯æŒï¼Œç”šè‡³åªèƒ½ç”¨åœ¨å­—ç¬¦ä¸²æ•°ç»„ä¸Šï¼Œæ‰€ä»¥ä¸Šè¾¹è¯´æ£€æµ‹åˆ°å¯¹åº”æƒ…å†µ (æ²¡æœ‰åˆ†éš”ç¬¦æˆ–çº¯å­—ç¬¦ä¸²æ•°ç»„) åæ‰§è¡Œç³»ç»Ÿæ‹¼æ¥å‡½æ•°åªèƒ½åœ¨é«˜ç‰ˆæœ¬ä¸‹ä½¿ç”¨)</p><blockquote><p>[concat ç”±äºä½ç‰ˆæœ¬ C# ä¸æ”¯æŒé™¤çº¯å­—ç¬¦ä¸²æ•°ç»„ä¹‹å¤–çš„å¯¹è±¡ä¸”æœ‰ object é‡è½½ï¼Œæ³›å‹æ•°ç»„ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥ä¸¢è¿›å»çš„ï¼Œç„¶è€Œç›´æ¥å½“åš object.ToString è¿”å›äº†ï¼Œæµ‹è¯•æ—¶å‘ç°æ¶ˆè€—æ—¶é—´çŸ­å¾—ä¸å¯æ€è®®ï¼Œä»”ç»†çœ‹æ‰å‘ç°ä¸å¯¹ï¼Œä¾‹å¦‚ä¸Šè¿°ã€æ‹¼æ¥åˆ—è¡¨ (æ— åˆ†éš”ç¬¦)ã€å°±æ˜¯èµ°è¿›è¿™ä¸ªåˆ†æ”¯åˆ¤æ–­çš„æƒ…å†µï¼Œåªèƒ½å…ˆæ³¨é‡Šæ‰]</p></blockquote><h2 id="5-stringbuilder-æºç "><a class="anchor" href="#5-stringbuilder-æºç ">#</a> 5. StringBuilder æºç </h2><p>å¦å¤–ç¨å¾®çœ‹äº†ä¸‹æºç ï¼ŒStringBuilder é»˜è®¤åˆå§‹åŒ– 16 ä¸ªå­—ç¬¦å¤§å°çš„æ•°ç»„ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// Token: 0x060065BB RID: 26043 RVA: 0x00155704 File Offset: 0x00153904</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>__DynamicallyInvokable<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span> <span class="token function">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// Token: 0x060065BC RID: 26044 RVA: 0x0015570E File Offset: 0x0015390E</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">[</span>__DynamicallyInvokable<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">public</span> <span class="token function">StringBuilder</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> capacity<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// Token: 0x060065D7 RID: 26071 RVA: 0x001561B8 File Offset: 0x001543B8</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">[</span><span class="token function">ComVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">__DynamicallyInvokable</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">public</span> <span class="token return-type class-name">StringBuilder</span> <span class="token function">AppendLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å®¹é‡è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ unsafe æ–¹æ³•è¿›è¡ŒæŒ‡é’ˆåŠç›´æ¥å†…å­˜æ“ä½œï¼š</p><ol><li>è·å–æ·»åŠ çš„å­—ç¬¦ä¸²æŒ‡é’ˆ</li><li>è·å–å­—ç¬¦æ•°ç»„å¾…æ·»åŠ ä¸‹æ ‡æŒ‡é’ˆ</li><li>è°ƒç”¨ Buffer.Memcpy è¿›è¡Œå†…å­˜æ‹·è´è¿›å­—ç¬¦æ•°ç»„</li></ol><p>å¦‚æœåç»­å®¹é‡ä¸å¤Ÿï¼Œåˆ™è¿›è¡ŒåŠ¨æ€æ‰©å®¹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// Token: 0x060065D1 RID: 26065 RVA: 0x0015603C File Offset: 0x0015423C</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>SecuritySafeCritical<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">__DynamicallyInvokable</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">unsafe</span> <span class="token return-type class-name">StringBuilder</span> <span class="token function">Append</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">value</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token class-name"><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> chunkChars <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkChars<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token class-name"><span class="token keyword">int</span></span> chunkLength <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkLength<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token class-name"><span class="token keyword">int</span></span> length <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token class-name"><span class="token keyword">int</span></span> num <span class="token operator">=</span> chunkLength <span class="token operator">+</span> length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;</span> chunkChars<span class="token punctuation">.</span>Length<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// å®¹é‡è¶³å¤Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// èµ°æ‰©å®¹</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">AppendHelper</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ä¸è¿‡åŠ¨æ€æ‰©å®¹ä¸æ˜¯ç›´æ¥æ‰©å®¹å­—ç¬¦æ•°ç»„ï¼Œè€Œæ˜¯é€šè¿‡å•å‘é“¾è¡¨çš„æ–¹å¼ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// Token: 0x06006615 RID: 26133 RVA: 0x0015730C File Offset: 0x0015550C</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ExpandByABlock</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> minBlockCharCount<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>minBlockCharCount <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Length <span class="token operator">&lt;</span> minBlockCharCount <span class="token operator">||</span> minBlockCharCount <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Length <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_MaxCapacity<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArgumentOutOfRangeException</span><span class="token punctuation">(</span><span class="token string">"requiredLength"</span><span class="token punctuation">,</span> Environment<span class="token punctuation">.</span><span class="token function">GetResourceString</span><span class="token punctuation">(</span><span class="token string">"ArgumentOutOfRange_SmallCapacity"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token class-name"><span class="token keyword">int</span></span> num <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>minBlockCharCount<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">Min</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Length<span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkPrevious <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkOffset <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkLength<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkOffset <span class="token operator">+</span> num <span class="token operator">&lt;</span> num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkChars <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OutOfMemoryException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>m_ChunkChars <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">char</span></span><span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å°†å½“å‰æ•°æ®å…¨éƒ¨è½¬ç§»è‡³ã€ä¸Šä¸€ä¸ªã€èŠ‚ç‚¹ï¼Œç„¶åè‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦æ•°ç»„è¿›è¡Œå¤„ç†ã€‚</p><p>é™¤ StringBuilder æœ¬èº«å¤–ï¼Œstring ç±»æä¾›çš„ä¸€äº›é™æ€æ“ä½œæ–¹æ³•ä¹Ÿå†æ¬¡åˆ©ç”¨ StringBuilder å¯¹æ€§èƒ½è¿›è¡Œä¼˜åŒ–ï¼Œå¦‚ joinã€format åº•å±‚éƒ½ä¼šè°ƒåˆ°é‚£è¾¹å»ï¼Œè¿˜é‡‡ç”¨äº† StringBuilderCache å¯¹è±¡æ± ã€‚</p><h2 id="6-join-éƒ¨åˆ†æºç "><a class="anchor" href="#6-join-éƒ¨åˆ†æºç ">#</a> 6. Join éƒ¨åˆ†æºç </h2><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// Token: 0x060004B8 RID: 1208 RVA: 0x00010B4C File Offset: 0x0000ED4C</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>SecuritySafeCritical<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">__DynamicallyInvokable</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">unsafe</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Join</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> separator<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> startIndex<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> count<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">//======= çœç•¥åˆ¤æ–­ ================</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// å­—ç¬¦ä¸²ç±»å‹æ•°ç»„ï¼Œç›´æ¥é€šè¿‡åˆ†é…ä¸€å¤§å—å­—ç¬¦ä¸²å†…å­˜ï¼Œé€šè¿‡ unsafe å†…å­˜æ‹·è´å®ç°</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token class-name"><span class="token keyword">string</span></span> text <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">FastAllocateString</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">fixed</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>text<span class="token punctuation">.</span>m_firstChar<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token class-name">UnSafeCharBuffer</span> unSafeCharBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">UnSafeCharBuffer</span><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        unSafeCharBuffer<span class="token punctuation">.</span><span class="token function">AppendString</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">[</span>startIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> startIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> num2<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            unSafeCharBuffer<span class="token punctuation">.</span><span class="token function">AppendString</span><span class="token punctuation">(</span>separator<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            unSafeCharBuffer<span class="token punctuation">.</span><span class="token function">AppendString</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">return</span> text<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// è¿æ¥è¿­ä»£å™¨ (åˆ—è¡¨ç±»å‹) é€šè¿‡ StringBuilder è¿›è¡Œ</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">// Token: 0x060004B5 RID: 1205 RVA: 0x000109C4 File Offset: 0x0000EBC4</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">[</span><span class="token function">ComVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">__DynamicallyInvokable</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">Join</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> separator<span class="token punctuation">,</span> <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> values<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// çœç•¥éƒ¨åˆ†å¤„ç†ä»£ç </span></pre></td></tr><tr><td data-num="30"></td><td><pre>result <span class="token operator">=</span> StringBuilderCache<span class="token punctuation">.</span><span class="token function">GetStringAndRelease</span><span class="token punctuation">(</span>stringBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">return</span> result<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">// è¿æ¥ object æ•°ç»„ç±»å‹ï¼Œé€šè¿‡ StringBuilderCache å¯¹è±¡æ± å– StringBuilder è¿›è¡Œæ‹¼æ¥</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">// Token: 0x060004B4 RID: 1204 RVA: 0x0001093C File Offset: 0x0000EB3C</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">[</span><span class="token function">ComVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">__DynamicallyInvokable</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Join</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> separator<span class="token punctuation">,</span> <span class="token keyword">params</span> <span class="token class-name"><span class="token keyword">object</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> values<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">// çœç•¥</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">return</span> StringBuilderCache<span class="token punctuation">.</span><span class="token function">GetStringAndRelease</span><span class="token punctuation">(</span>stringBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="7-stringconcat"><a class="anchor" href="#7-stringconcat">#</a> 7. string.Concat</h2><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// å½“è¿æ¥æ•°é‡çº§æ¯”è¾ƒä½æ—¶ï¼Œå‚æ•°ä¸º string åˆ™ç›´æ¥é€šè¿‡åˆ›å»ºæœ€ç»ˆå­—ç¬¦ä¸²å†…å­˜è¿æ¥</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// Token: 0x06000556 RID: 1366 RVA: 0x00013524 File Offset: 0x00011724</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>SecuritySafeCritical<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">__DynamicallyInvokable</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Concat</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> str0<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> str1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// éƒ¨åˆ†åˆ¤æ–­ä»£ç çœç•¥ ===============</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> length <span class="token operator">=</span> str0<span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> text <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">FastAllocateString</span><span class="token punctuation">(</span>length <span class="token operator">+</span> str1<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">FillStringChecked</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> str0<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">FillStringChecked</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> length<span class="token punctuation">,</span> str1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">return</span> text<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">// è¿æ¥è¿­ä»£å™¨ (åˆ—è¡¨ç±»å‹) é€šè¿‡ StringBuilder è¿›è¡Œ</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// Token: 0x06000555 RID: 1365 RVA: 0x000134B8 File Offset: 0x000116B8</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">[</span><span class="token function">ComVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">__DynamicallyInvokable</span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Concat</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span> values<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">// çœç•¥</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">return</span> StringBuilderCache<span class="token punctuation">.</span><span class="token function">GetStringAndRelease</span><span class="token punctuation">(</span>stringBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">// å½“è¿æ¥æ•°é‡çº§æ¯”è¾ƒä½æ—¶ï¼Œå‚æ•°ä¸º object åˆ™ç›´æ¥é€šè¿‡ç¬¦å·è¿æ¥</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">// Token: 0x06000551 RID: 1361 RVA: 0x00013330 File Offset: 0x00011530</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">[</span>__DynamicallyInvokable<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Concat</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> arg0<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> arg1<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> arg2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">// åˆ¤æ–­çœç•¥ ==========</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">return</span> arg0<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> arg1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> arg2<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">//ConcatArray (å½“ string.Concat è¶…è¿‡ä¸‰ä¸ª object å¯¹è±¡æ—¶è°ƒç”¨)</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">// è¶…å‡ºè¿™ä¸ªæ•°é‡åˆ™é€šè¿‡å†…å­˜åˆ†é…è¿›è¡Œ</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">// Token: 0x06000559 RID: 1369 RVA: 0x000136AC File Offset: 0x000118AC</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">[</span>SecuritySafeCritical<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ConcatArray</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> values<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> totalLength<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token class-name"><span class="token keyword">string</span></span> text <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">FastAllocateString</span><span class="token punctuation">(</span>totalLength<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token class-name"><span class="token keyword">int</span></span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">FillStringChecked</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> num<span class="token punctuation">,</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        num <span class="token operator">+=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">return</span> text<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ç›´æ¥åˆ†é…æŒ‡å®šå­—ç¬¦ä¸²æ•°ç»„æ‰€æœ‰å­—ç¬¦ä¸²é•¿åº¦å¤§å°çš„å¤§å—å­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡ wstrcpy-&gt;Buffer.Memcpy å¯¹å†…å­˜ç›´æ¥è¿›è¡Œæ‹·è´æ“ä½œã€‚</p><h2 id="8-format"><a class="anchor" href="#8-format">#</a> 8. Format</h2><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">FormatHelper</span><span class="token punctuation">(</span><span class="token class-name">IFormatProvider</span> provider<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> format<span class="token punctuation">,</span> <span class="token class-name">ParamsArray</span> args<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>format <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArgumentNullException</span><span class="token punctuation">(</span><span class="token string">"format"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> StringBuilderCache<span class="token punctuation">.</span><span class="token function">GetStringAndRelease</span><span class="token punctuation">(</span>StringBuilderCache<span class="token punctuation">.</span><span class="token function">Acquire</span><span class="token punctuation">(</span>format<span class="token punctuation">.</span>Length <span class="token operator">+</span> args<span class="token punctuation">.</span>Length <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AppendFormatHelper</span><span class="token punctuation">(</span>provider<span class="token punctuation">,</span> format<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="å¯¹-stringformat-ä¸æ™®é€šæ‹¼æ¥çš„æ€§èƒ½æµ‹è¯•"><a class="anchor" href="#å¯¹-stringformat-ä¸æ™®é€šæ‹¼æ¥çš„æ€§èƒ½æµ‹è¯•">#</a> å¯¹ string.Format ä¸æ™®é€šæ‹¼æ¥çš„æ€§èƒ½æµ‹è¯•</h3><p>é™¤äº†å¯¹æ•°ç»„ä¸€ç±»æ•°æ®ç»“æ„ç±»å‹çš„æ‹¼æ¥ä¹‹å¤–ï¼Œå¸¸ç”¨çš„ä¼°è®¡å°± 2~3 ä¸ªå¸¦å‚æ•°çš„ç®€å•å­—ç¬¦ä¸²æ‹¼æ¥äº†ã€‚</p><p>è¿™ç§é€šå¸¸è§åˆ°çš„è¿˜æ˜¯ç›´æ¥ + å·è¿›è¡Œï¼Œä¹Ÿæœ‰ä½¿ç”¨ string.Format çš„ã€‚</p><p>ä¸ºäº†è¯„ä¼°ä»¥åç©¶ç«Ÿä»¥ä½¿ç”¨å“ªç§æ–¹å¼ä¸ºå‡†ï¼Œæˆ‘æƒ³å†åŠ ä¸€ç‚¹æµ‹è¯•ï¼Œæµ‹ä¸€æµ‹ä½¿ç”¨ + å·ä¸ string.Format æ‹¼æ¥ç®€å•å­—ç¬¦ä¸²ä¸¤è€…çš„æ€§èƒ½ã€‚</p><p>æ¯ä¸€é¡¹è¿›è¡Œ 10000 æ¬¡æ“ä½œï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><ul><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1ï¼‰ï¼š0 ç§’ 3 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆ1+Xï¼‰ï¼š0 ç§’ 3 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Yï¼‰ï¼š0 ç§’ 4 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2ï¼‰ï¼š0 ç§’ 6 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2+Z+3ï¼‰ï¼š0 ç§’ 11 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2+Z+3+W+4ï¼‰ï¼š0 ç§’ 14 æ¯«ç§’</li><li>string.concatï¼ˆX+1ï¼‰ï¼š0 ç§’ 3 æ¯«ç§’</li><li>string.concatï¼ˆ1+Xï¼‰ï¼š0 ç§’ 3 æ¯«ç§’</li><li>string.concatï¼ˆX+1+Yï¼‰ï¼š0 ç§’ 4 æ¯«ç§’</li><li>string.concatï¼ˆX+1+Y+2ï¼‰ï¼š0 ç§’ 6 æ¯«ç§’</li><li>string.concatï¼ˆX+1+Y+2+Z+3ï¼‰ï¼š0 ç§’ 26 æ¯«ç§’</li><li>string.concatï¼ˆX+1+Y+2+Z+3+W+4ï¼‰ï¼š0 ç§’ 14 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0}ï¼‰ï¼š0 ç§’ 7 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆ{0} Xï¼‰ï¼š0 ç§’ 7 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0} Yï¼‰ï¼š0 ç§’ 7 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0} Y {1}ï¼‰ï¼š0 ç§’ 11 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0} Y {1} Z {2}ï¼‰ï¼š0 ç§’ 16 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0} Y {1} Z {2} W {3}ï¼‰ï¼š0 ç§’ 35 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1ï¼‰ï¼š0 ç§’ 4 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆ1+Xï¼‰ï¼š0 ç§’ 4 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Yï¼‰ï¼š0 ç§’ 5 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2ï¼‰ï¼š0 ç§’ 8 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2+Z+3ï¼‰ï¼š0 ç§’ 11 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2+Z+3+W+4ï¼‰ï¼š0 ç§’ 14 æ¯«ç§’</li></ul><p>æ¯ä¸€é¡¹è¿›è¡Œ 100000 æ¬¡æ“ä½œï¼Œå»é™¤éšæœºå‚æ•°ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><ul><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1ï¼‰ï¼š0 ç§’ 16 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆ1+Xï¼‰ï¼š0 ç§’ 15 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Yï¼‰ï¼š0 ç§’ 20 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2ï¼‰ï¼š0 ç§’ 25 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2+Z+3ï¼‰ï¼š0 ç§’ 66 æ¯«ç§’</li><li>ç®€å•æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2+Z+3+W+4ï¼‰ï¼š0 ç§’ 77 æ¯«ç§’</li><li>string.concatï¼ˆX+1ï¼‰ï¼š0 ç§’ 17 æ¯«ç§’</li><li>string.concatï¼ˆ1+Xï¼‰ï¼š0 ç§’ 16 æ¯«ç§’</li><li>string.concatï¼ˆX+1+Yï¼‰ï¼š0 ç§’ 35 æ¯«ç§’</li><li>string.concatï¼ˆX+1+Y+2ï¼‰ï¼š0 ç§’ 24 æ¯«ç§’</li><li>string.concatï¼ˆX+1+Y+2+Z+3ï¼‰ï¼š0 ç§’ 65 æ¯«ç§’</li><li>string.concatï¼ˆX+1+Y+2+Z+3+W+4ï¼‰ï¼š0 ç§’ 64 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0}ï¼‰ï¼š0 ç§’ 60 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆ{0} Xï¼‰ï¼š0 ç§’ 66 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0} Yï¼‰ï¼š0 ç§’ 68 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0} Y {1}ï¼‰ï¼š0 ç§’ 71 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0} Y {1} Z {2}ï¼‰ï¼š0 ç§’ 106 æ¯«ç§’</li><li>string.format æ‹¼æ¥æµ‹è¯•ï¼ˆX {0} Y {1} Z {2} W {3}ï¼‰ï¼š0 ç§’ 145 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1ï¼‰ï¼š0 ç§’ 28 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆ1+Xï¼‰ï¼š0 ç§’ 27 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Yï¼‰ï¼š0 ç§’ 33 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2ï¼‰ï¼š0 ç§’ 38 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2+Z+3ï¼‰ï¼š0 ç§’ 67 æ¯«ç§’</li><li>StringBuilder æ‹¼æ¥æµ‹è¯•ï¼ˆX+1+Y+2+Z+3+W+4ï¼‰ï¼š0 ç§’ 62 æ¯«ç§’</li></ul><p>ç»“æœéå¸¸å‡ºä¹æ„æ–™ï¼ŒåŸä»¥ä¸º string.format æ€§èƒ½åº”è¯¥æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œæ²¡æˆæƒ³ç«Ÿç„¶æ˜¯æœ€è´¹çš„... ä¹Ÿè®¸ç”±äºå­—ç¬¦ä¸²å†…éƒ¨å ä½ç¬¦éœ€è¦å•ç‹¬åšè§£æï¼Œå¯¼è‡´äº†å¤§é‡æ¶ˆè€—ï¼Ÿ</p><p>äºæ˜¯çœ‹äº†ä¸‹æºç ï¼Œå‘ç°åœ¨ AppendFormatHelper æ–¹æ³•ä¸­ï¼Œå¯¹æ•´ä¸ªå­—ç¬¦ä¸²éƒ½åšäº†ä¸€æ¬¡éå†ï¼Œå»åˆ†ææ˜¯å¦æœ‰ {} è¿™ç§å ä½ç¬¦ï¼Œè¿™ä¸ªç¡®å®æ˜¯ä¸ªä¼šéšå­—ç¬¦ä¸²é‡çº§å¢åŠ è€Œå¢åŠ æ¶ˆè€—çš„ä¸€ä¸ªæ“ä½œ â€”â€”string.format å¯¹äºè¿æ¥å­—ç¬¦ä¸²å­˜åœ¨å¤šä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼Œè€—è´¹æ—¶é—´ä¹ŸåŒæ ·ä¼šéšç€å‚æ•°å¢é•¿è€Œå¢åŠ ã€‚</p><p>å› æ­¤é™¤äº†å­—ç¬¦ä¸²æ•°ç»„ç±»å‹æ‹¼æ¥æ–¹æ³•å¤–ï¼Œå¯ä»¥è‡ªå·±ä¸“é—¨å®šä¹‰ä¸€ä¸ªæ–¹æ³•ç”¨äºè¿æ¥ã€æ•£ã€å­—ç¬¦ä¸²ï¼Œä»¥é€‰æ‹©æ€§èƒ½æ›´å¥½çš„æ‹¼æ¥æ–¹å¼ã€‚</p><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p>æ ¹æ®ä¸Šé¢çš„æµ‹è¯• â€”â€” è™½ç„¶è¿™ç§æµ‹è¯•ä¸ä¸€å®šå¾ˆå‡†ç¡® (æ¯•ç«Ÿ Unity ä¸­ .Net ç‰ˆæœ¬æ¯”è¾ƒä½)ï¼Œä»¥åŠå¯¹ string æºç æœ¬èº«çš„æŸ¥çœ‹ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥æ€»ç»“ä»¥ä¸‹å‡ ä¸ªæ³¨æ„ç‚¹ï¼š</p><p>è¿æ¥çº¯å­—ç¬¦ä¸²è¶…è¿‡ 3 ä¸ªæ—¶ï¼Œæœ‰åˆ†éš”ç¬¦å¯ä»¥é€‰æ‹© StringBuilderã€string.join (æ•°ç»„)ï¼Œå¦åˆ™ä½¿ç”¨ string.concat (æ•°ç»„)ï¼Œè‡³äº string.formatâ€”â€” é™¤äº†å¥½çœ‹ä¸€ç‚¹ï¼Œèƒ½ä¸ç”¨å°±ä¸è¦ç”¨äº†ï¼Œæ€§èƒ½ä¸Šå®Œå…¨æ²¡æœ‰ä¼˜åŠ¿ã€‚</p><p>å…¶ä¸­ string.concat åŠ string.join çš„æºç æ˜¾ç¤ºï¼Œå…¶å¯¹ä¸åŒç±»å‹é€‰æ‹©äº†ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚</p><p>å…±åŒç‚¹æœ‰ï¼š</p><ul><li>å­—ç¬¦ä¸²ç±»å‹æ•°ç»„ï¼Œç›´æ¥é€šè¿‡åˆ†é…ä¸€å¤§å—å­—ç¬¦ä¸²å†…å­˜ï¼Œé€šè¿‡ unsafe å†…å­˜æ‹·è´å®ç°</li><li>è¿æ¥è¿­ä»£å™¨ (åˆ—è¡¨ç±»å‹) æˆ–è€…è¿æ¥ object æ•°ç»„å‡é€šè¿‡ StringBuilderCache å– StringBuilder è¿›è¡Œ</li></ul><p>string.Concat ç‰¹æœ‰ï¼š</p><ul><li>å‚æ•°ä¸º stringï¼Œå½“è¿æ¥æ•°é‡çº§æ¯”è¾ƒä½æ—¶ï¼Œç›´æ¥é€šè¿‡åˆ†é…ä¸€å—æœ€ç»ˆå­—ç¬¦ä¸²å¤§å°å†…å­˜ï¼Œé€šè¿‡ unsafe å†…å­˜æ‹·è´å®ç°</li><li>å‚æ•°ä¸º objectï¼Œå½“è¿æ¥æ•°é‡çº§æ¯”è¾ƒä½æ—¶ (3 ä¸ªä»¥ä¸‹)ï¼Œ åˆ™ç›´æ¥é€šè¿‡ç¬¦å·è¿æ¥ï¼Œè¶…è¿‡ä¸‰ä¸ªåˆ™åˆ›å»ºä¸´æ—¶æ•°ç»„å˜é‡å°† object è½¬å­—ç¬¦ä¸²ï¼Œå†èµ°æ­£å¸¸å­—ç¬¦ä¸²æ•°ç»„è¿æ¥æ–¹æ³•</li></ul><h4 id="æœ€ç»ˆå¯ä»¥å¾—å‡ºç»“è®º"><a class="anchor" href="#æœ€ç»ˆå¯ä»¥å¾—å‡ºç»“è®º">#</a> æœ€ç»ˆå¯ä»¥å¾—å‡ºç»“è®ºï¼š</h4><p>æ‹¼æ¥æ•°é‡åœ¨ 2 ä¸ªï¼šå¯ä»¥ä½¿ç”¨ + å·<br />æ‹¼æ¥æ•°é‡åœ¨ 4 ä¸ªåŠä»¥ä¸‹ï¼šå­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ string.concat (éå­—ç¬¦ä¸² 3 ä¸ªæˆ–ä»¥ä¸‹æ—¶ç›´æ¥ + å·æ‹¼æ¥ï¼Œ4 ä¸ªæˆ–ä»¥ä¸Šæ—¶ä¼šç”Ÿæˆä¸´æ—¶æ•°ç»„å˜é‡å°† object.tostringï¼Œç„¶åè°ƒç”¨å­—ç¬¦ä¸²æ•°ç»„æ‹¼æ¥å‡½æ•°å¤„ç† â€”â€” è°ƒç”¨ä¸å®šå‚æ•°æ–¹æ³•æ—¶ä¹Ÿæ˜¯å¦‚æ­¤å¤„ç†)ï¼Œå¦åˆ™æœ€å¥½ StringBuilder<br /> æ‹¼æ¥æ•°é‡åœ¨è¶…è¿‡ 4 ä¸ªï¼šStringBuilder (ä¸æ¨è string.concat æ˜¯å› ä¸ºé€šè¿‡å¯å˜å‚æ•°ä¼ å‚å®ƒä¼šç”Ÿæˆé¢å¤–ä¸´æ—¶å­—ç¬¦ä¸²æ•°ç»„ï¼Œç›´æ¥æ‹¼æ¥æ•°ç»„æ—¶æ›´æœ‰ä¼˜åŠ¿)<br /> è¿æ¥å­—ç¬¦ä¸²æ•°ç»„ã€å­—ç¬¦ä¸²åˆ—è¡¨ç±»å‹ï¼šå¯ä»¥ç”¨ string.join æˆ– string.concat (æ— åˆ†éš”ç¬¦)ï¼Œæœ‰ç‰¹æ®Šå›è°ƒéœ€æ±‚åˆ™è‡ªå®šä¹‰ StringBuilder (æ³¨ï¼šå†…éƒ¨å®é™…ä¸Šä¹Ÿæ˜¯ç”¨ StringBuilder æ‹¼æ¥çš„ï¼Œä¸è¿‡çœ‹ DotNetCore çš„æºç å®ç°ä¸ä¸€æ ·ï¼Œæ˜¯åˆ›å»ºä¸€ä¸ªç»“æ„ä½“ ValueStringBuilderï¼Œé€šè¿‡ stackalloc åœ¨æ ˆä¸Šåˆ†é… char æ•°ç»„ (Span) ç»“æ„è¿›è¡Œæ‹¼æ¥)<br /> è¿æ¥å…¶å®ƒå®¹å™¨ (æ¯”å¦‚å­—å…¸)ï¼šStringBuilder</p><p>å†è§£é‡Šä¸€ä¸‹ï¼š</p><p>è¿æ¥å­—ç¬¦ä¸²åœ¨ 4 ä¸ªåŠä»¥ä¸‹æ—¶ï¼Œå¯ä»¥é€šè¿‡ string.concat (å¼ºè°ƒï¼šå­—ç¬¦ä¸²ç±»å‹ï¼Œéå­—ç¬¦ä¸²å¯ä»¥ toString ä¼ å…¥)<br /> å­—ç¬¦ä¸²æ•°ç»„å’Œå­—ç¬¦ä¸²åˆ—è¡¨éƒ½å¯ä»¥ç”¨ string.join æˆ– string.concat (å†…éƒ¨ StringBuilder ï¼Œæœ‰å¯¹è±¡æ± )<br /> å…¶å®ƒç±»å‹çš„æ•°ç»„ã€åˆ—è¡¨æˆ–å­—å…¸å®¹å™¨ä»¥åŠè¶…å‡º 4 ä¸ªå•å­—ç¬¦ä¸²çš„è¿æ¥ï¼Œé‡‡ç”¨è‡ªå·± StringBuilder è¿›è¡Œï¼Œå¹¶ä¸”å¯ä»¥ç¼“å­˜è¿™ä¸ª StringBuilder è¿›è¡Œé‡å¤ä½¿ç”¨ã€‚<br />åªæœ‰ä¸¤ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ‰å…è®¸ä½¿ç”¨ç¬¦å· +</p><p>(æ³¨ï¼šä¸Šè¿°å‡è¡¨ç¤ºä¸€æ¬¡æ€§æ‹¼æ¥çš„å‰æï¼Œè‹¥è¿ç»­å¤šæ¬¡è¿æ¥ï¼Œåˆ™ StringBuilder æ— ç–‘æ˜¯æœ€å¥½é€‰æ‹©)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#1-å‰è¨€&quot;&gt;#&lt;/a&gt; 1. å‰è¨€&lt;/h2&gt;
&lt;p&gt;åœ¨å¯¹ç»„å‘˜ä»£ç è¿›è¡Œå®¡æŸ¥æ—¶ï¼Œç»å¸¸ç¢°åˆ°çœ‹ç€å¾ˆä¸åˆç†çš„å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œï¼Œç‰¹åˆ«æ˜¯å¯¹æ•°ç»„æ•°æ®æ“ä½œï¼Œä¹Ÿç›´æ¥ä¸€ä¸ª for å¾ªç¯ï¼Œä½¿ç”¨ + å·è¿›è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ç”šè‡³æœ‰</summary>
      
    
    
    
    <category term="ç†è®ºç ”ç©¶" scheme="https://cwhisme.github.io/categories/%E7%90%86%E8%AE%BA%E7%A0%94%E7%A9%B6/"/>
    
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://cwhisme.github.io/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
    <category term="C#" scheme="https://cwhisme.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>å›¾ç‰‡èµ„æºæ ¼å¼è®¾ç½®æµ‹è¯•ä¸æ€»ç»“</title>
    <link href="https://cwhisme.github.io/2022/10/26/%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E6%A0%BC%E5%BC%8F%E8%AE%BE%E7%BD%AE%E6%B5%8B%E8%AF%95%E4%B8%8E%E6%80%BB%E7%BB%93/"/>
    <id>https://cwhisme.github.io/2022/10/26/%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90%E6%A0%BC%E5%BC%8F%E8%AE%BE%E7%BD%AE%E6%B5%8B%E8%AF%95%E4%B8%8E%E6%80%BB%E7%BB%93/</id>
    <published>2022-10-26T03:57:38.000Z</published>
    <updated>2022-12-22T03:29:48.149Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>åœ¨ä»Šå¹´ 10 æœˆä»½è¿™æ¬¡è¯„å®¡çš„æ—¶å€™ï¼Œæœ‰é—®åˆ°å›¾ç‰‡è®¾ç½®ç›¸å…³çš„å†…å®¹ï¼Œå½“æ—¶æ„Ÿè§‰ä¹Ÿæ˜¯æ²¡å›ç­”å¤šå¥½ã€‚</p><p>ä¾‹å¦‚ï¼ŒETC1 ä¸ ETC2 ç›¸æ¯”æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ</p><p>å›ç­”çš„æ˜¯ ETC1 ä¸å¸¦ Alpha é€šé“ï¼ŒETC2 å¸¦ Alpha é€šé“ï¼Œå…¶å®ƒå°±å·®ä¸å¤š (å®é™…ä¸Šå‹ç¼©è´¨é‡ä¹Ÿä¼šé«˜ä¸€ç‚¹)</p><p>æœ‰é—®åˆ°å¦‚æœ ETC è´¨é‡ä¸ä½³æ€ä¹ˆåŠï¼Ÿå›ç­”çš„æ˜¯ç”¨ RGBA è®¾ç½®çœ‹æ•ˆæœï¼Œè€Œä¸”è¿˜è¢«è¿½é—®é™¤æ­¤ä¹‹å¤–å‘¢ï¼Ÿæ˜¯å¦ç›´æ¥å°±ç”¨ RGBA äº†ï¼Ÿ</p><p>ä¸‹æ¥åæ‰æƒ³æ˜ç™½ï¼Œæ„æ€åº”è¯¥æ˜¯æƒ³é—® ASTC çš„ï¼Œç„¶è€Œå½“æ—¶ä¸çŸ¥æ˜¯è§‰å¾—è¿™ä¸ªæ ¼å¼é¡¹ç›®æ²¡æœ‰å®é™…æ™®åŠè¿˜æ˜¯ä»€ä¹ˆï¼Œæ ¹æœ¬æ²¡å›ç­”è¿™ä¸ªç‚¹... ç”šè‡³å›ç­”ä¸Šéƒ½æ²¡æåˆ° ASTCï¼Œè™½ç„¶ ASTC è¿™æ ¼å¼è‚¯å®šæ˜¯çŸ¥é“ï¼Œiosã€android æ–°æœºå‹é€šç”¨çš„ä¸€ç§å›¾ç‰‡å‹ç¼©æ ¼å¼ï¼Œä¼°è®¡ä¹Ÿè·Ÿåªåœ¨ç†è®ºä¸Šäº†è§£ã€å´æ²¡è‡ªå·±å®è·µå¯¹æ¯”æœ‰å…³ â€”â€” å°±å¾ˆéš¾ååº”è¿‡æ¥ã€‚</p><p>å› æ­¤è¿™é‡Œå°±å¯¹è¿™äº›æ ¼å¼æŒ¨ä¸ªè¿›è¡Œå°è¯•ã€å¯¹æ¯”ï¼Œæ•´ç†ä¸€ä¸‹è‡ªå·±äº†è§£çš„å·®å¼‚ï¼Œä»¥æœŸå¾—åˆ°æ›´å¥½çš„ç†è§£ã€‚</p><h2 id="å›¾ç‰‡è®¾ç½®"><a class="anchor" href="#å›¾ç‰‡è®¾ç½®">#</a> å›¾ç‰‡è®¾ç½®</h2><p>sRGB é€‰é¡¹ï¼Œæœ¬èº«å¤„äº gamma é¢œè‰²ç©ºé—´å†…æ—¶ï¼Œå‹¾é€‰ä¸å¦éƒ½ä¸å½±å“ã€‚<br />å¤„äºçº¿æ€§é¢œè‰²ç©ºé—´å†…æ—¶ï¼Œå‹¾é€‰åæ‰ä¼šåšæ ¡æ­£ã€‚</p><p>Mipmapï¼šUI è‚¯å®šä¸èƒ½å‹¾ï¼Œ3D æ¨¡å‹å‹¾ä¸å‹¾å–å†³äºæœ‰æ²¡æœ‰ç›¸æœºè¿œè¿‘æ“ä½œåŠå†…å­˜å¹³è¡¡ã€‚</p><h2 id="å›¾ç‰‡å‹ç¼©æ ¼å¼"><a class="anchor" href="#å›¾ç‰‡å‹ç¼©æ ¼å¼">#</a> å›¾ç‰‡å‹ç¼©æ ¼å¼</h2><p>ä¸ºä»€ä¹ˆéœ€è¦å‹ç¼©ï¼Ÿ</p><blockquote><p>å‡å°‘å†…å­˜ã€å‡å°‘æ•°æ®ä¼ è¾“å¸¦å®½éœ€æ±‚ï¼Œå‹ç¼©æ˜¯æœ‰æŸçš„ã€‚</p></blockquote><h3 id="å‹ç¼©æ ¼å¼"><a class="anchor" href="#å‹ç¼©æ ¼å¼">#</a> å‹ç¼©æ ¼å¼</h3><p>å¯¹æ­¤å®˜æ–¹æ–‡æ¡£ä¹Ÿæœ‰åˆ—è¡¨è¯´æ˜ï¼š</p><p><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuLzIwMjEuMi9NYW51YWwvY2xhc3MtVGV4dHVyZUltcG9ydGVyT3ZlcnJpZGUuaHRtbA==">class-TextureImporterOverride</span></p><h4 id="ä¸€-rgba"><a class="anchor" href="#ä¸€-rgba">#</a> ä¸€ã€RGBA</h4><p>RGBA æ ¼å¼ä¸»è¦åˆ†ä¸ºï¼š</p><p>RGBA64ï¼šæ¯ä¸ªåƒç´  64 ä½ï¼Œæ¯ä¸ªé€šé“ 16 ä½<br /> RGBA32ï¼šæ¯ä¸ªåƒç´  32 ä½ï¼Œæ¯ä¸ªé€šé“ 8 ä½<br /> RGBA16ï¼šæ¯ä¸ªåƒç´  16 ä½ï¼Œæ¯ä¸ªé€šé“ 4 ä½</p><p>å…¶ä¸­ RGBA64ã€RGBA32 å‡ä¸ºæ— å‹ç¼©ï¼ŒRGBA16 å®˜æ–¹æ–‡æ¡£è¯´æ˜¯ã€é‡åŒ–ã€æ¨¡å¼ï¼Œå¯èƒ½æ˜¯é ç›´æ¥é‡åŒ–ç¼©æ”¾å‡å°‘åƒç´ ç²¾åº¦ä»¥å‡å°‘å†…å­˜å ç”¨ï¼Œä¸è¿‡è¿™ç§æ¨¡å¼è´¨é‡æŸå¤±å…¶å®æ„Ÿè§‰æœ‰ç‚¹å¤§ï¼Œå¯¹æ¯”äº†ä¸‹è¿˜ä¸å¦‚ ASTC4x4 å‹ç¼©ã€‚</p><p><img data-src="/blogimages/2022/2022-10-26/m_42dd7d724910306bfad9c502639914ee_r.gif" alt="" /><br />åˆ†è¾¨ç‡ 128x128ï¼ŒRGBA32-&gt;ASTC4x4ï¼Œå¤§å°ä¸º 32kb-&gt;16kb (è´¨é‡å’Œå¤§å°éƒ½ä¸å ä¼˜)</p><p>RGBA64 é«˜ç²¾åº¦æ¨¡å¼ï¼Œå›¾ç‰‡æœ¬èº«ä¸æ”¯æŒçš„æƒ…å†µä¸‹ï¼Œè®¾ç½®äº†ä¹Ÿåªæ˜¯æµªè´¹å†…å­˜ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šå¯ä»¥æŠŠ RGBA32 å½“åšã€åŸå›¾ã€çœ‹å¾…ã€‚</p><h4 id="äºŒ-ect1"><a class="anchor" href="#äºŒ-ect1">#</a> äºŒã€ECT1</h4><p>å®‰å“ï¼Œä¸å¸¦ Alpha é€šé“ï¼Œ4bits/pixel<br /> å¼ºè¡Œè¦æ±‚å›¾ç‰‡åˆ†è¾¨ç‡ä¸º 2N æ¬¡æ–¹ã€‚</p><h4 id="ä¸‰-etc2"><a class="anchor" href="#ä¸‰-etc2">#</a> ä¸‰ã€ETC2</h4><p>å®‰å“ï¼Œå¸¦ Alpha é€šé“ 8bits/pixelï¼Œä¸å¸¦ Alpha é€šé“ 4bits/pixelï¼Œè´¨é‡æ¯” ETC1 å¥½ã€‚<br />å¼ºè¡Œè¦æ±‚å›¾ç‰‡åˆ†è¾¨ç‡ä¸º 2N æ¬¡æ–¹ã€‚</p><p>ETC1 ä¸ ETC2 å¯¹æ¯”ï¼ˆ128x128&amp;10.7kbï¼‰ï¼š<br /><img data-src="/blogimages/2022/2022-10-26/m_c127eafb4fe2f0fd9f71884b89aa3b01_r.gif" alt="" /></p><p>(å­—ä½“è¾¹ç¼˜å˜åŒ–æ¨¡ç³Šåº¦æ›´ä½çš„å°±æ˜¯ ETC2)</p><blockquote><p>ETC2 è¿˜æœ‰ä¸€ç§æ”¯æŒé•‚ç©ºå›¾ (æ—  Alpha è¿‡åº¦) çš„æ¨¡å¼ (RGB+1bit Alpha)ï¼Œä¹Ÿæ˜¯ 4 bits/pixelï¼Œè¿™ä¸ªæ ¼å¼ç½‘ä¸Šæ²¡æœ‰è§£é‡Šå¦‚ä½•å¤„ç†çš„ï¼ŒçŒœæµ‹æ˜¯å°† Alpha 0.5 ä¸ºç•Œé™ï¼Œå®Œå…¨é€æ˜æˆ–ä¸é€æ˜ã€‚</p></blockquote><p>æˆ‘ç”¨ PS å¤§æ¦‚ç”»äº†ä¸€å¼ æ¸å˜å›¾è¿›è¡Œæµ‹è¯•ï¼Œè®¾ç½®åå¯¹æ¯”æ•ˆæœå¦‚ä¸‹ï¼š<br /><img data-src="/blogimages/2022/2022-10-26/m_a826a55fc92b56bcb2afebe58984bf6d_r.png" alt="" /></p><p>ä¾‹å¦‚ï¼š<br /><img data-src="/blogimages/2022/2022-10-26/m_609ff492c0b942aa2caa9c7a78074344_r.png" alt="" /><br />å·¦è¾¹ä¸º ETC2 RGB+1bit Alpha 4Bit (8KB)ï¼Œå³è¾¹ä¸º ETC2 RGBA 8Bit (16KB)<br /> æ•´ä½“è´¨é‡ç›¸å¯¹ä¼šå·®ä¸€ç‚¹ï¼Œä¸è¿‡ç›¸æ¯”å¸¸è§„ ETC2 RGBA çœä¸€åŠå†…å­˜ã€‚æ„Ÿè§‰è¿™ç§é€‚åˆæ•ˆæœè¦æ±‚ä¸æ˜¯å¾ˆé«˜ã€å°ä¸€äº›çš„æ— æ¸å˜çš„çº¯é€æ˜å›¾æ ‡ï¼Œä¸è¿‡è¾¹ç¼˜åƒç´ å¿…é¡»å¤„ç†å¥½ï¼Œä¸ç„¶è¾¹ç¼˜å¯èƒ½ä¼šæ¯”è¾ƒæ˜æ˜¾ï¼Œæˆ–è€…å­˜åœ¨é”¯é½¿ã€‚</p><p>æ³¨ï¼šETC å’Œ ETC2 åœ¨ Unity è¿˜æœ‰ç§ Crunched æ¨¡å¼ï¼Œå¯ä»¥è‡ªå·±é€‰æ‹©å‹ç¼©æ¯” (ä¸è¿‡ ETC2 åªæœ‰ RAGB Crunched)ï¼Œè¿™ç§æ¨¡å¼ä¼šå¢åŠ ä¸€å®šè§£å‹æ¶ˆè€—ï¼Œå› ä¸ºå®ƒä¼šåœ¨ CPU ä¸Šå°†è¯¥çº¹ç†è§£å‹ç¼©ä¸º ETC ä¼ ç»™ GPU (è™½ç„¶å®˜æ–¹ç§°è§£å‹è¿‡ç¨‹ã€éå¸¸å¿«ã€)ï¼Œæ›´å¤šè§ <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuLzIwMjEuMS9NYW51YWwvdGV4dHVyZS1jb21wcmVzc2lvbi1mb3JtYXRzLmh0bWw=">å®˜æ–¹æ–‡æ¡£</span> è¯´æ˜ã€‚</p><h4 id="å››-astc"><a class="anchor" href="#å››-astc">#</a> å››ã€ASTC</h4><p>æ–‡æ¡£è¡¨ç¤ºåŒç­‰å‹ç¼©ç‡ä¸‹ï¼Œæ•ˆæœæ¯” ETC2 æ›´å¥½ï¼Œå…¶ blockSize è¶Šå¤§å‹ç¼©ç‡è¶Šé«˜ï¼Œå‹ç¼©åˆ†å—ä» 4x4 åˆ° 12x12 æœ€ç»ˆå¯ä»¥å‹ç¼©åˆ°æ¯ä¸ªåƒç´ å ç”¨ 1bit ä»¥ä¸‹</p><p>å…¶åŸç†æ˜¯å°†å›¾ç‰‡åˆ†å—ï¼Œæ¯å—é¢œè‰²å›ºå®šä¸º 16bytesï¼Œç„¶åé€šè¿‡æ§åˆ¶æ¯å—å­˜æ”¾å¤šå°‘åƒç´  (4x4ã€6x6) æ¥æ§åˆ¶å‹ç¼©ç‡ï¼Œæ‰€ä»¥å­˜æ”¾é¢œè‰²è¶Šå¤šå‹ç¼©ç‡è¶Šé«˜ï¼Œæ•ˆæœå°±è¶Šå·®ã€‚</p><p>ä¸åƒ ETCã€PVRTC å¼ºè¡Œè¦æ±‚åˆ†è¾¨ç‡ 2N æ¬¡æ–¹ï¼Œå½“ç„¶ç¬¦åˆè¿™ä¸ªè§„åˆ™çš„å›¾ç‰‡æœ€å¥½ã€‚<br />å‚è€ƒï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM3NjkyMTUzNi9hbnN3ZXIvMTA2MzI3MjMzNg==">https://www.zhihu.com/question/376921536/answer/1063272336</span></p><p>ä¸ RGBA æ ¼å¼ç›¸æ¯”ï¼š<br /><img data-src="/blogimages/2022/2022-10-26/m_1cdadb33b2ad7d459502ea3928123fdb_r.png" alt="" /></p><p>è®¡ç®—å…¬å¼ä¸ºï¼šå‹ç¼©ååƒç´ å¤§å° = 16bytes/(åˆ†å—å®½é«˜) x8bit</p><p>å°è¯•è®¡ç®—ä¸€å¼  1024x1024 å›¾ç‰‡åœ¨ ASTC 10x10 ä¸‹çš„å¤§å°ï¼š</p><p>å‹ç¼©åæ¯åƒç´ é¢œè‰²å ç”¨ï¼š16/(10x10) x8=1.28bit<br /> åŸæœ¬å¤§å°ï¼š1024x1024x32=4MB<br />4MB/(32/1.28)=1024x1024x1.28=1342177.28bit=163.84KB</p><p>ASTC çš„ Alpha é€šé“æ˜¯è‡ªåŠ¨è¯†åˆ«çš„ (ç‰¹æŒ‡å®‰å“å¹³å°ï¼Œios å€’æ˜¯å¯ä»¥å•ç‹¬é€‰æ‹©æ˜¯å¦å¸¦ Alpha é€šé“æ ¼å¼)ã€‚å¦‚æœå¸¦ Alpha é€šé“ï¼Œå¯ä»¥è®¾ç½®æ›´ä½çš„ block sizeï¼Œå¦åˆ™å¯ä»¥è®¾ç½®æ›´é«˜çš„ sizeã€‚<br />ä¾‹å¦‚ï¼Œæ ¹æ®å‹ç¼©ç‡çš„å¯¹æ¯”ï¼Œè‹¥å°† 4x4 ä½œä¸ºå¸¦ Alpha é€æ˜é€šé“å›¾ç‰‡æ ‡å‡†ï¼š</p><ul><li>4x4=8bit=RGBA (32bit)= å‹ç¼©ç‡ 4 å€</li><li>ä¸å¸¦ Alpha é€šé“ å‹ç¼©ç‡ 4 å€ = RGB (24bit)/4=6bit~5x5</li></ul><p>å½“ç„¶ï¼Œæ¢ç®—ä¹Ÿä¸ç»å¯¹ï¼Œè¿˜æ˜¯è¦çœ‹å®é™…å›¾ç‰‡æ•ˆæœè¿›è¡Œç¡®å®šï¼Œä¸è¿‡æ„Ÿè§‰ä¸€èˆ¬é€šç”¨å¯ä»¥æŒ‰ç…§è¿™ç§è§„åˆ™æ¥ï¼Œè‹¥æŸäº›ç‰¹å®šå›¾ç‰‡å‡ºç°å¯è§çš„æŸå¤±åˆ™æ‰‹åŠ¨å¤„ç†ã€‚</p><p>å¯¹æ¯”äº†ä¸€ä¸‹ï¼š<br /><img data-src="/blogimages/2022/2022-10-26/m_a3628ccb80bd4c4bf8a34d6efe7dfc91_r.gif" alt="" /><br />åˆ†è¾¨ç‡ 128x128ï¼ŒETC2-&gt;ASTC4x4ï¼Œå¤§å°ä¸º 16kb-&gt;16kb</p><p><img data-src="/blogimages/2022/2022-10-26/m_e08338c3627fd662eaebe5a10151a8c9_r.gif" alt="" /><br />åˆ†è¾¨ç‡ 128x128ï¼ŒETC2-&gt;ASTC5x5ï¼Œå¤§å°ä¸º 16kb-&gt;10.6kb</p><p><img data-src="/blogimages/2022/2022-10-26/m_dce12c80ae66fc19ac3437d779f5a89c_r.gif" alt="" /><br />åˆ†è¾¨ç‡ 128x128ï¼ŒETC2-&gt;ASTC6x6ï¼Œå¤§å°ä¸º 16kb-&gt;7.6kb</p><p><img data-src="/blogimages/2022/2022-10-26/m_5aa5d2788a135af160a24bf2a58eac85_r.gif" alt="" /><br />åˆ†è¾¨ç‡ 128x128ï¼ŒETC2-&gt;ASTC8x8ï¼Œå¤§å°ä¸º 16kb-&gt;4kb</p><p>åŒä¸€å¼ å¸¦ Alpha é€šé“çš„ Icon å›¾ç‰‡ï¼Œç›´åˆ° ASTC8x8 çš„æ—¶å€™æ‰ä¸ ETC2 æœ‰äº†æ¯”è¾ƒæ˜æ˜¾çš„å·®è· (æ¯”ä¹‹æ›´ç³Šç‚¹)ï¼Œä½†æ˜¯å¤§å°å¯æ˜¯å°äº† 4 å€ï¼é‚£æ€• ASTC6x6 ä¹Ÿå°äº†ä¸€å€ä»¥ä¸Šï¼Œä¸”æ•ˆæœæ›´å¥½ã€‚</p><p>æœ€åï¼Œå†åˆ†åˆ«ä½¿ç”¨ ASTC4x4ã€ETC2 ä¸ RGBA32 (ä¹Ÿå°±æ˜¯åŸå›¾) è¿›è¡Œå¯¹æ¯”ï¼š</p><p><img data-src="/blogimages/2022/2022-10-26/m_0725399211d37c2164d73402e59dc5f2_r.gif" alt="" /><br />åˆ†è¾¨ç‡ 128x128ï¼ŒRGBA32-&gt;ASTC4x4ï¼Œå¤§å°ä¸º 64kb-&gt;16kb  â†‘</p><p><img data-src="/blogimages/2022/2022-10-26/m_3e3bb61964458ed75820064d9196d2e1_r.gif" alt="" /><br />åˆ†è¾¨ç‡ 128x128ï¼ŒRGBA32-&gt;ETC2ï¼Œå¤§å°ä¸º 64kb-&gt;16kb â†‘</p><p>å…¶ä¸­ï¼ŒRGBA32-&gt;ASTC4x4 æŸå¤±çš„è´¨é‡å¾ˆå°‘ï¼ŒRGBA32-&gt;ETC2 è´¨é‡æŸå¤±å°±æ¯”è¾ƒæ˜æ˜¾äº†ã€‚</p><p>åç»­è¿˜æµ‹è¯•äº† RGBA32-&gt;ASTC5x5ï¼Œè™½ç„¶å™ªç‚¹æ›´å¤šï¼Œä¸è¿‡åœ¨å®è§‚ä¸Šæ¥çœ‹ï¼Œå¯¹äºå°å›¾æ¥è¯´åŸºæœ¬è·ŸåŸå›¾å·®åˆ«ä¸æ˜¯å¾ˆå¤§ã€‚</p><p>è™½ç„¶æŒ‰ç…§æ–‡æ¡£æ‰€è¯´ï¼ŒASTC æ•ˆæœä¼šæ¯” ETC2 æ›´å¥½ï¼Œä¸è¿‡è®¾ç½®æ›´é«˜çš„ block è·å¾—æ›´é«˜å‹ç¼©ç‡åæ•ˆæœè‚¯å®šè¿˜æ˜¯ä¼šé™ä½ï¼Œè¿™æ˜¯å‹ç¼©ç‡è·Ÿè´¨é‡å¿…ç„¶çš„å–èˆã€‚ä¸è¿‡å¤§çš„ ASTC block å‹ç¼©ç‡æ˜¯çœŸçš„é«˜ï¼Œè€Œä¸” ios å’Œ android éƒ½æ”¯æŒ (é™¤äº†éå¸¸éå¸¸è€çš„è®¾å¤‡ â€”â€”iPhone6 ä»¥å‰ã€android OpenGLES3.0 éƒ¨åˆ†åŠæ‰€æœ‰ OpenGLES3.1 GPU)ã€‚</p><h4 id="äº”-pvrtc"><a class="anchor" href="#äº”-pvrtc">#</a> äº”ã€PVRTC</h4><p>IOS (GPU) ä¸“ç”¨ï¼Œå¼ºè¡Œè¦æ±‚å›¾ç‰‡åˆ†è¾¨ç‡ä¸º 2N æ¬¡æ–¹çš„æ–¹å½¢ã€‚</p><p><img data-src="/blogimages/2022/2022-10-26/m_cfd9379259a7046ae87bffb4e9f287ec_r.png" alt="" /><br />ä»å·¦è‡ªå³åˆ†åˆ«æ˜¯ï¼šASTC4x4 (16kb)-&gt;ASTC6x6 (7.6kb)-&gt;ASTC8x8 (4kb)-&gt;PVRTC_4bit (8kb)-&gt;PVRTC_2bit (4kb)</p><p>å°±å®é™…ç»“æœè€Œè¨€ï¼ŒPVRTC 2bit ç³Šå¾—åŸºæœ¬æ²¡æ³•çœ‹ï¼Œè€Œ PVRTC 4bit å®é™…æ•ˆæœï¼ŒåŸºæœ¬ä¹Ÿå°±è·Ÿ ASTC8x8 å·®ä¸å¤šï¼Œç»†èŠ‚ä¸Šç”šè‡³è¿˜å·®ä¸€ç‚¹ â€”â€” è€Œ ASTC8x8 å®¹é‡å´æ¯”å®ƒä½äº†ä¸€åŠã€‚</p><p>PVRTC 4bit åªèƒ½è¯´æ¯” ASTC10x10 å¥½äº› â€”â€” ä½† ASTC10x10 éƒ½ç›´æ¥å‹ç¼©åˆ° 2.6kb äº†</p><p>æ‰€ä»¥ ASTC åœ¨ ios ä¸Šçš„è´¨é‡ / å‹ç¼©æ¯”ä¼˜åŠ¿æ¯”åœ¨ android å¹³å°æ›´å¤§ï¼Œå¦‚æœç›®æ ‡æœºå‹ä¸æ˜¯ iPhone6 (iPhone6 æ”¯æŒ) ä»¥å‰çš„è®¾å¤‡ï¼Œæœ€å¥½å°±ä½¿ç”¨ ASTC äº†ã€‚</p><h4 id="å…­-å…¶å®ƒ"><a class="anchor" href="#å…­-å…¶å®ƒ">#</a> å…­ã€å…¶å®ƒ</h4><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰éƒ¨åˆ†ã€å…¶å®ƒã€æ ¼å¼ï¼Œä¾‹å¦‚ï¼š</p><ul><li>R8ï¼šæœªå‹ç¼©å•é€šé“ (R)</li><li>Alpha 8ï¼šæœªå‹ç¼©å•é€šé“ (A)</li><li>EACï¼šä¸ ETC ç±»ä¼¼ï¼Œä¸è¿‡åªæœ‰å•é€šé“æˆ–åŒé€šé“ã€‚</li><li>R EAC 4 bit ï¼šå‹ç¼©å•é€šé“ (R)</li><li>RG EAC 8 bit ï¼šå‹ç¼©åŒé€šé“ (RG)</li><li>ç­‰</li></ul><p>è¯¦ç»†è§£é‡Šåœ¨å®˜æ–¹æ–‡æ¡£ <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuLzIwMjEuMi9NYW51YWwvY2xhc3MtVGV4dHVyZUltcG9ydGVyT3ZlcnJpZGUuaHRtbA==">class-TextureImporterOverride</span> ä¹Ÿéƒ½æœ‰è¯´æ˜ï¼Œä¸è¿‡è¿™äº›è¯¸å¦‚æ‹†åˆ†é€šé“çš„æ ¼å¼ï¼ŒåŸºæœ¬ä¸Šä¸å¸¸ç”¨ (æˆ–è€…è¯´æ²¡è§è¿‡ç”¨)ï¼Œæˆ–è®¸æŸäº›æƒ…å†µä¸‹ï¼Œå†™ Shader åªéœ€è¦å•é€šé“ä¹‹ç±»çš„å¯èƒ½ä¼šç”¨åˆ°ï¼Ÿ</p><h2 id="å‹ç¼©åå¯¹-assetbundle-å½±å“"><a class="anchor" href="#å‹ç¼©åå¯¹-assetbundle-å½±å“">#</a> å‹ç¼©åå¯¹ AssetBundle å½±å“</h2><p>åœ¨å¯¹å›¾ç‰‡æ ¼è¿›è¡Œä¸€å †æµ‹è¯•ä¹‹åï¼Œå¿ƒé‡Œå°±å†’å‡ºä¸€ä¸ªæƒ³æ³•ï¼š</p><blockquote><p>æ—¢ç„¶å›¾ç‰‡æœ¬ä½“è¿›è¡Œäº†å‹ç¼©ï¼Œé‚£ä¹ˆå¯¹æœ€ç»ˆèµ„æºå¤§å°æœ‰å½±å“å—ï¼Ÿå¦‚æœå›¾ç‰‡æœ¬èº«å‹ç¼©åï¼ŒAssetBundle æ‰“åŒ…æ— æ³•å‡å°‘æ›´å°ï¼Œæ˜¯å¦å¯ä»¥é€‰æ‹©å¯¹å›¾ç‰‡é‡‡å–ä¸å‹ç¼©ï¼Œæˆ–è€… LZ4 å‹ç¼©æ¨¡å¼ï¼Ÿ</p></blockquote><p>äºæ˜¯æ‰¾äº†ä¸€å¼ å›¾è¿›è¡Œæµ‹è¯•ï¼Œç”±äºè¿™å¼ å›¾ç‰‡ä¸æ˜¯ POT åˆ†è¾¨ç‡ï¼Œå› æ­¤ä»¥ ASTC ä¸ RGBA32 (åŸå›¾) ä¸ºä¾‹ã€‚</p><p>ç®€å•çš„æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"AssetBundleTest/PackSelect(LZMA)"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PackSelectLZMA</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token function">PackSelect</span><span class="token punctuation">(</span>BuildAssetBundleOptions<span class="token punctuation">.</span>DeterministicAssetBundle<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"AssetBundleTest/PackSelect(LZ4)"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PackSelectLZ4</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token function">PackSelect</span><span class="token punctuation">(</span>BuildAssetBundleOptions<span class="token punctuation">.</span>DeterministicAssetBundle <span class="token operator">|</span> BuildAssetBundleOptions<span class="token punctuation">.</span>ChunkBasedCompression<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"AssetBundleTest/PackSelect(Uncompress)"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PackSelectUncompress</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token function">PackSelect</span><span class="token punctuation">(</span>BuildAssetBundleOptions<span class="token punctuation">.</span>DeterministicAssetBundle <span class="token operator">|</span> BuildAssetBundleOptions<span class="token punctuation">.</span>UncompressedAssetBundle<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PackSelect</span><span class="token punctuation">(</span><span class="token class-name">BuildAssetBundleOptions</span> opt<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token class-name">Object</span> o <span class="token operator">=</span> Selection<span class="token punctuation">.</span>activeObject<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> AssetDatabase<span class="token punctuation">.</span><span class="token function">GetAssetPath</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token class-name">AssetImporter</span> importer <span class="token operator">=</span> AssetImporter<span class="token punctuation">.</span><span class="token function">GetAtPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>importer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token class-name">AssetBundleBuild</span> build <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssetBundleBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        build<span class="token punctuation">.</span>assetBundleName <span class="token operator">=</span> importer<span class="token punctuation">.</span>assetBundleName<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        build<span class="token punctuation">.</span>assetNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">&#123;</span> path <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>        BuildPipeline<span class="token punctuation">.</span><span class="token function">BuildAssetBundles</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"MyBundles"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssetBundleBuild<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">&#123;</span> build <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> opt<span class="token punctuation">,</span> EditorUserBuildSettings<span class="token punctuation">.</span>activeBuildTarget<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        AssetDatabase<span class="token punctuation">.</span><span class="token function">Refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å¯¹æ¯”ç»“æœï¼š</p><p><img data-src="/blogimages/2022/2022-10-26/m_45ae9e30c0769a8bf06e42f270e4b5b0_r.png" alt="" /><br />RGBA (1.8M)-&gt;LZMA (449kb [25%])-&gt;LZ4 (755kb [41%])-&gt; ä¸å‹ç¼© (1.85M [102%])</p><p><img data-src="/blogimages/2022/2022-10-26/m_6cb8901537c88400d2f74a18cfbf539f_r.png" alt="" /><br />ASTC4x4 (462.2kb)-&gt;LZMA (273kb [59%])-&gt;LZ4 (303kb [65%])-&gt; ä¸å‹ç¼© (467kb [101%])</p><p><img data-src="/blogimages/2022/2022-10-26/m_143d4ebe0f769145f38441f41cbbe99a_r.png" alt="" /><br />ASTC12x12 (52.1kb)-&gt;LZMA (33kb [63%])-&gt;LZ4 (37kb [71%])-&gt; ä¸å‹ç¼© (57kb [109%])</p><p>ETC2 å‹ç¼©æ¨¡å¼å¯¹äº NPOT çš„å›¾ç‰‡ï¼Œå‹¾é€‰ ToNearest (æ­£å¸¸è¢«å‹ç¼©) ä»¥åŠä¸å‹¾é€‰ (æ— æ³•æ­£å¸¸è¢«å‹ç¼©ä¸º ETC2) çš„å¤§å°ï¼š<br /><img data-src="/blogimages/2022/2022-10-26/m_7625bcb93b3ed36ae3f31571ecd2bf35_r.png" alt="" /></p><p>æ ¹æ®ç»“æœå¯ä»¥å¾—å‡ºç»“è®ºï¼š</p><blockquote><p>è¢«å‹ç¼©è¿‡çš„å›¾ç‰‡ï¼Œæœ€ç»ˆæ‰“å‡ºæ¥çš„ AssetBundle åŒ…å‹ç¼©ç‡ä¹Ÿä¼šæ›´ä½ â€”â€” å½“ç„¶æ— è®ºå¦‚ä½•ï¼Œå›¾ç‰‡æœ¬èº«è¿›è¡Œè¿‡å‹ç¼©æ ¼å¼å‹ç¼©åï¼Œæœ€ç»ˆèµ„æºåŒ…ä½“ä¼šæ›´å°ã€‚<br />ETC ä¸€ç±»å¦‚æœå›¾ç‰‡æ˜¯ NPOT åˆ†è¾¨ç‡ï¼Œåˆ™å‹ç¼©å°†ä¼šæ— æ•ˆ</p></blockquote><p>æ‰€ä»¥ä»ç©ºé—´å ç”¨æ¥è€ƒè™‘ï¼Œæ‰“åŒ…æ—¶ã€é€šå¸¸å‹ç¼©ã€æ ¼å¼ä¾ç„¶è¿˜æ˜¯éœ€è¦é€‰æ‹©å‹ç¼©æ¨¡å¼çš„ã€‚</p><p>ä¸ºä»€ä¹ˆã€é€šå¸¸å‹ç¼©ã€è¦æ‰“é‡ç‚¹ï¼Ÿ</p><p>å› ä¸ºåé¢æˆ‘åœ¨æµ‹è¯• ETC Crunched å‹ç¼©æ¨¡å¼æ—¶ï¼Œç¡®è®¤è¿™ç§é«˜å‹æ¨¡å¼ AssetBundle æ— æ³•å†ä½œå‹ç¼©äº†ã€‚</p><p>ä¾ç„¶ä»¥ä¸Šè¿°å›¾ç‰‡ä¸ºä¾‹ï¼Œè®¾ç½®ä¸º ETC Crunched 100% è´¨é‡ï¼š<br /><img data-src="/blogimages/2022/2022-10-26/m_905a5cbc8b864c77f6b34a21e50bdef8_r.png" alt="" /></p><p>æ‰“åŒ…çš„ AssetBundle å¤§å°åŸºæœ¬è·Ÿ Inspector é¢„è§ˆå·®å¼‚ä¸å¤§ (å¤šäº†ä¸€ç‚¹ AssetBundle æ•°æ®)<br /> æ‰€ä»¥è¦æ˜¯é€‰ç”¨äº† ETC Crunched æ¨¡å¼ï¼Œæ‰“åŒ… AssetBundle å€’æ˜¯å¯ä»¥é‡‡ç”¨ã€ä¸å‹ç¼©ã€æˆ–è€…ã€LZ4ã€æ¥è¿›ä¸€æ­¥èŠ‚çœåŠ è½½æ—¶é—´ã€‚</p><h2 id="æ³¨æ„"><a class="anchor" href="#æ³¨æ„">#</a> æ³¨æ„</h2><p>å°±ç®—æ˜¯ ASTC å‹ç¼©ï¼Œå¦‚æœé€‰æ‹©å¼€å¯äº† Mipmapï¼Œåˆ™åŒæ ·è¦æ±‚å¿…é¡»æ˜¯ POT çš„å›¾ï¼Œå¦åˆ™æ— æ³•å‹ç¼© â€”â€” å¯¹æ­¤é¡¹ Unity ä¼šæœ‰ Warning æç¤ºã€‚</p><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p>æ ¹æ®ä¸Šè¿°å„ç§å¯¹æ¯”ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼š</p><ul><li><p>è´¨é‡ (ç”±é«˜åˆ°ä½)ï¼šRGBA32 (64kb)-&gt;ASTC4x4 (16kb)-&gt;ASTC5x5 (10.6kb)-&gt;ASTC6x6 (7.6kb)-&gt;ETC2 (16kb)-&gt;ASTC8x8 (4kb)~PVRTC4bit (8kb)-&gt;ASTC10x10 (2.6kb)-&gt;PVRTC2bit (4kb)</p></li><li><p>å¤§å° (ç”±é«˜åˆ°ä½)ï¼šRGBA32 (64kb)-&gt;ASTC4x4 (16kb)-&gt;ETC2 (16kb)-&gt;ASTC5x5 (10.6kb)-&gt;PVRTC4bit (8kb)-&gt;ASTC6x6 (7.6kb)-&gt;ASTC8x8 (4kb)-&gt;PVRTC2bit (4kb)-&gt;ASTC10x10 (2.6kb)</p></li></ul><p>æ‰€ä»¥ï¼Œé™¤éå¯¹éå¸¸è€çš„æœºå‹ä¹Ÿæƒ³æ”¯æŒï¼Œå¦åˆ™é»˜è®¤å°±å¯ä»¥ä½¿ç”¨ ASTC6x6 ï¼Œå†è§†æƒ…å†µè€Œå®šå¯¹ Block è¿›è¡Œå¢åŠ æˆ–å‡å°‘ã€‚</p><p>å¦åˆ™:</p><ul><li>å®‰å“ï¼šä¸å¸¦ Alpha ä½¿ç”¨ ETC2 RGBï¼Œå¸¦ Alpha ä½¿ç”¨ ETC2 RGBA</li><li>IOSï¼šä¸å¸¦ Alpha ä½¿ç”¨ PVRTC RGB 4bitï¼Œå¸¦ Alpha ä½¿ç”¨ PVRTC RGBA 4bit<br /><font color=red>æ³¨ 1ï¼šETC è¦æ±‚å›¾ç‰‡ä¸º 2N æ¬¡æ–¹ (é•¿å®½ä¸å¼ºè¡Œè¦æ±‚ä¸€è‡´)</font><br /><font color=red>æ³¨ 2ï¼šPVRTC è¦æ±‚å›¾ç‰‡ä¸º 2N æ¬¡æ–¹çš„æ–¹å½¢ (é•¿å®½å¼ºè¡Œè¦æ±‚ä¸€è‡´)</font><br /><font color=red>æ³¨ 3ï¼šIOS PVRTC å‹¾é€‰ ToNearest åŒæ ·ä¼šè¢«å¼ºè¡Œå‹ç¼©ä¸ºæ­£æ–¹å½¢ï¼Œæ¯”å®‰å“å¹³å°å˜å½¢ä¼šæ›´å¤§ (å½“é•¿å®½å·®è·è¿‡å¤§ ToNearest ä¹Ÿä¼šå¤±è´¥)</font><br /><font color=red>æ³¨ 4ï¼šå‹¾é€‰ ToNearest æ—¶ï¼Œç¼©æ”¾ç®—æ³•å¯ä»¥é€‰ Bilinear ï¼Œä¸ªäººå¯¹æ¯”åè§‰å¾—è¿™ä¸ªç»†èŠ‚æ˜æ˜¾æ›´å¥½ç‚¹ï¼Œé»˜è®¤çš„ Mitchell æ›´ç³Šã€‚</font></li></ul><p>å¦å¤–ï¼Œåœ¨å®åœ¨æ— æ³•å¯ç”¨ ASTCï¼Œä½†æ˜¯åˆæƒ³å‡å°‘åŒ…ä½“å¤§å°çš„æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ ETC Crunched (æœ‰æŸå‹ç¼©) æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å¢åŠ éƒ¨åˆ†è§£å‹ CPU æ¶ˆè€—ï¼Œä»¥æ—¶é—´æ¢å­˜å‚¨ç©ºé—´ï¼Œä¸”å¯¹äºè¿è¡Œæ—¶å†…å­˜ä½¿ç”¨é‡æ²¡æœ‰å½±å“ (åœ¨<span class="exturl" data-url="aHR0cHM6Ly9mb3J1bS51bml0eS5jb20vdGhyZWFkcy9xdWVzdGlvbnMtYWJvdXQtY29tcHJlc3Npb24tZm9ybWF0cy1ldGMyLWNydW5jaC1ldGMuNTExNTYwLw==">åŠ è½½æ—¶è¢«è§£å‹ç¼©</span>ï¼Œå®˜æ–¹ç§° è§£å‹ç¼©é€Ÿåº¦éå¸¸å¿«)ã€‚<br />(ç”±äºå‹ç¼©ç‡å¾ˆé«˜ï¼Œæ–‡ä»¶å¤§å°å‡å°‘ï¼Œå˜ç›¸å‡å°‘äº† IOï¼Œå¯¹æ•´ä½“åŠ è½½æ—¶é—´çš„å½±å“æˆ–è®¸ä¸ä¼šå¤ªå¤§ï¼Ÿ)<br /><font color=red>æ³¨ 1ï¼šETC Crunched æ— æ³•å†è¢« AssetBundle è¿›ä¸€æ­¥å‹ç¼©</font><br /><font color=red>æ³¨ 2ï¼šETC Crunched å‹ç¼©æ¯”éå¸¸é«˜ï¼Œç»è¿‡æµ‹è¯•å¯èƒ½æ¯” ASTC12x12 éƒ½å°</font><br /><font color=red>æ³¨ 3ï¼šå®æµ‹ ETC2 Crunched 100% è´¨é‡ä¹Ÿæ¯”æ™®é€š ETC2 æ›´ç³Šä¸€äº›</font></p><ul><li>éƒ¨åˆ†æ— æ³•å‹ç¼©çš„ NPOT å›¾ç‰‡ï¼Œå‹¾é€‰ ToNearest ä¼šå¯¼è‡´æ•ˆæœå‡ºç°é—®é¢˜ï¼Œæˆ–è€…ä½¿ç”¨çš„ä¸è§„åˆ™å›¾ç‰‡ç„¶åè°ƒç”¨äº† SetNativeSize çš„æƒ…å†µ (ä¸€èˆ¬å‡ºç°äºè€é¡¹ç›®ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æ±‰å®¤å¤å…´)ï¼Œä¹Ÿå¯ä»¥é‡‡å–ä½¿ç”¨ RGB16 æˆ– RGBA16 çš„æ ¼å¼ï¼Œæ¯” 32 ä½å‡å°‘ä¸€åŠå¤§å°ã€‚<br /><font color=red>æ³¨ï¼šä¼˜åŒ–è€é¡¹ç›®æ—¶ (ä¾‹å¦‚æˆ‘ä»¬çš„é¡¹ç›®)ï¼Œå¯¹äºè®¾ç½® ETC2 å’Œ RGBA16 æ—¶å¯ä»¥è¯„ä¼°è€ƒè™‘ä¸¤è€…å…·ä½“å ç”¨å¤§å°ã€æ•ˆæœã€‚</font>ä¾‹å¦‚å¸¦é€æ˜é€šé“ RGBA16 æŸäº›å¤§å›¾å¯èƒ½ä¼šä¼šäº§ç”Ÿã€æ¡çº¹ã€ã€‚éƒ¨åˆ†æƒ…å†µ (RGBA) ä¸‹ ToNearest ETC2 (8bitï¼‰ å ç”¨æ¯” RGBA16 è¿˜è¦é«˜ (512x512x8&gt;300x300x16)ï¼Œå¼ºè¡Œè¦æ±‚æ–¹å½¢çš„ PVRTC (4bit) æç«¯æƒ…å†µä¸‹å¯èƒ½ä¹Ÿæœ‰ç±»ä¼¼é—®é¢˜ (512x512x4&gt;400x100x16)ã€‚å¯ä»¥å†™ä¸ªå·¥å…·è®¡ç®—ä¸¤è€…å“ªä¸ªæ›´åˆ’ç®—å†è¿›è¡Œè®¾ç½®ã€‚</li></ul><p>å…¶å®ƒè¿˜éœ€è¦æ³¨æ„çš„æ˜¯å®˜æ–¹å¯¹å¹³å°ä¸æ”¯æŒçº¹ç†çš„è¯´æ˜ï¼š</p><blockquote><p>å½“ Unity åŠ è½½çš„çº¹ç†å…·æœ‰è®¾å¤‡ä¸æ”¯æŒçš„å‹ç¼©æ ¼å¼æ—¶ï¼Œå®ƒä¼šå°†çº¹ç†è§£å‹ç¼©ä¸ºè¯¥å¹³å°çš„é»˜è®¤æœªå‹ç¼©æ ¼å¼ï¼Œå¹¶å°†æœªå‹ç¼©å‰¯æœ¬ä¸åŸå§‹å‹ç¼©çº¹ç†ä¸€èµ·å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚è¿™ä¼šå¢åŠ çº¹ç†åŠ è½½æ—¶é—´å¹¶ä½¿ç”¨é¢å¤–çš„å†…å­˜ã€‚å½“ Unity åŠ è½½çš„çº¹ç†å…·æœ‰è®¾å¤‡æ”¯æŒçš„å‹ç¼©æ ¼å¼æ—¶ï¼ŒGPU å¯ä»¥ä½¿ç”¨è¯¥æ•°æ®è€Œæ— éœ€ä»»ä½•è½¬æ¢ã€‚</p></blockquote><p>æœ€åï¼š<br />å› ä¸º ETC ä¸æ”¯æŒ Alphaï¼Œä¸€äº›è€é¡¹ç›®ä¼šå‡ºç°å•ç‹¬åˆ†ç¦»é€æ˜é€šé“çš„åšæ³•ã€‚<br />è™½ç„¶ ASTC å·²ç»ä¸å¼ºè¡Œè¦æ±‚ 2N æ¬¡æ–¹äº†ï¼Œä¸è¿‡ POT æœ€å¥½ä¹Ÿè®©ç¾æœ¯éµå®ˆä¸€ä¸‹ï¼Œå¯¹æ€§èƒ½æœ‰ä¸€å®šå¥½å¤„ï¼Œ<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM3NjkyMTUzNi9hbnN3ZXIvMTA2MzI3MjMzNg==">å‚è€ƒ</span>ã€‚</p><h2 id="ç–‘é—®"><a class="anchor" href="#ç–‘é—®">#</a> ç–‘é—®</h2><p>æ—¢ç„¶ ASTC ä¼šæ ¹æ® Alpha è‡ªåŠ¨è®¡ç®—å‹ç¼©æ•ˆæœï¼ŒUnity (2021.3.6f1) ä¸ºå®‰å“å¹³å°æä¾›çš„ ASTC é€‰é¡¹ä¹Ÿæ˜¯åˆå¹¶åœ¨ä¸€å—çš„ï¼Œä¸ºä»€ä¹ˆ IOS å¹³å°åˆæ˜¯åˆ†å¼€è®¾ç½®çš„äº†ï¼Ÿ</p><blockquote><p>æ³¨ï¼šUnity2018.4.36f1 å®‰å“ä¹Ÿæ˜¯åˆ†å¼€çš„ï¼Œåˆ†ä¸º ASTC RGB å’Œ ASTC RGBAï¼Œæ¨æµ‹é«˜ç‰ˆæœ¬ Unity å®‰å“å¹³å°å¢åŠ äº† ASTC HDR æ¨¡å¼åï¼Œå› ä¸ºè®¾ç½®é‡å¤ªå¤šè€Œåˆå¹¶ï¼Ÿ</p></blockquote><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNTg3NDAyNDk=">ASTC çº¹ç†å‹ç¼©æ ¼å¼è¯¦è§£</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuLzIwMjEuMS9NYW51YWwvdGV4dHVyZS1jb21wcmVzc2lvbi1mb3JtYXRzLmh0bWw=">texture-compression-formats</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5LmNuL2NuLzIwMjEuMS9NYW51YWwvY2xhc3MtVGV4dHVyZUltcG9ydGVyT3ZlcnJpZGUuaHRtbA==">class-TextureImporterOverride</span></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;åœ¨ä»Šå¹´ 10 æœˆä»½è¿™æ¬¡è¯„å®¡çš„æ—¶å€™ï¼Œæœ‰é—®åˆ°å›¾ç‰‡è®¾ç½®ç›¸å…³çš„å†…å®¹ï¼Œå½“æ—¶æ„Ÿè§‰ä¹Ÿæ˜¯æ²¡å›ç­”å¤šå¥½ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼ŒETC1 ä¸ ETC2 ç›¸æ¯”æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å›</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="èµ„æºè®¾ç½®" scheme="https://cwhisme.github.io/categories/Unity3D/%E8%B5%84%E6%BA%90%E8%AE%BE%E7%BD%AE/"/>
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/tags/Unity3D/"/>
    
    <category term="æ€§èƒ½ä¼˜åŒ–" scheme="https://cwhisme.github.io/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºçºªå…ƒé¡¹ç›®Demo</title>
    <link href="https://cwhisme.github.io/2022/09/30/%E5%85%B3%E4%BA%8E%E7%BA%AA%E5%85%83%E9%A1%B9%E7%9B%AEDemo/"/>
    <id>https://cwhisme.github.io/2022/09/30/%E5%85%B3%E4%BA%8E%E7%BA%AA%E5%85%83%E9%A1%B9%E7%9B%AEDemo/</id>
    <published>2022-09-29T16:00:00.000Z</published>
    <updated>2022-12-22T03:29:48.148Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>è¿™æ˜¯ä»¥å‰åˆ¶ä½œäººè¿˜åœ¨çš„æ—¶å€™ï¼Œå‘èµ·çš„ä¸€ä¸ª Demoï¼Œä¸è¿‡ç”±äºæ²¡æœ‰æœ€ç»ˆå®šæ€§ï¼Œå› æ­¤åªæ˜¯è®©æˆ‘åœ¨ç©ºä½™æ—¶é—´æä¸€æã€‚</p><p>æ¸¸æˆèƒŒæ™¯ä¹‹ç±»è¿™é‡Œå°±ä¸åšä»‹ç»äº†ã€‚</p><p>è¿™ä¸ª Demo ä¸»è¦å®ç°æœ‰ï¼š</p><ol><li><p>åˆ©ç”¨è…¾è®¯åœ°å›¾ SDK ç»“åˆï¼Œå®ç°å®šä½ + åœ°å›¾æ‰‹åŠ¨ç§»åŠ¨åŠŸèƒ½:</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9sYnMucXEuY29tL21vYmlsZS91bml0eUdlby91bml0eUdlb0d1aWRlL3VuaXR5R2VvT3ZlcnZpZXc=">TencentLocationSdk (å®šä½)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9sYnMucXEuY29tL21vYmlsZS91bml0eVNkay91bml0eVNka0d1aWRlL3VuaXR5T3ZlcnZpZXc=">TencentMapSdk (åœ°å›¾)</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9sYnMucXEuY29tL3NlcnZpY2Uvd2ViU2VydmljZS93ZWJTZXJ2aWNlR3VpZGUvd2ViU2VydmljZU92ZXJ2aWV3">WebService API (è·¯å¾„ä¿¡æ¯)</span></li></ul></li><li><p>åŒæ—¶æ•´åˆäº†æ±‰å®¤å¤å…´çš„æˆ˜æ–—ç³»ç»Ÿé€»è¾‘å±‚ï¼Œå¹¶ä¿®æ”¹ä¸ºå®æ—¶æ“çºµç§»åŠ¨ã€æˆ˜æ–—ï¼ŒåµŒå…¥æ–°çš„è¡¨ç°å±‚</p></li><li><p>ä¸€å¥—ç®€å•çš„ UI ç®¡ç† (ç”±äºåªæ˜¯ Demoï¼Œå› æ­¤å¹¶æœªé‡‡ç”¨å¹³ç§»æ±‰å®¤å¤å…´çš„ UI æ¡†æ¶ï¼Œè‡ªå·±å®ç°äº†ä¸€ä¸ªä»¥æ ˆç»“æ„ä¸ºåŸºç¡€çš„ç®€å• UI ç®¡ç†ç»“æ„)</p></li></ol><h2 id="æ•ˆæœ"><a class="anchor" href="#æ•ˆæœ">#</a> æ•ˆæœ</h2><p>åœ°å›¾ï¼š</p><p><img data-src="/blogimages/2022/2022-09-30/m_3638219618620ffbee8bee495860613a_r.gif" alt="åœ°å›¾" /></p><p>ä¿¡æ¯ï¼š</p><p><img data-src="/blogimages/2022/2022-09-30/m_f2ed7a226ee4957d7f0b6983aeda3df0_r.gif" alt="" /></p><p>ä¿¡æ¯ä¸Šï¼Œå¤ç”¨äº†æ±‰å®¤å¤å…´çš„é…ç½®è¡¨ï¼Œè¿™å„¿åªæ˜¯ç®€å•æŠŠæ‰€æœ‰é“å…·éƒ½æ”¾äº†ä¸€ä¸ªåœ¨åŒ…è£¹ä¸­ã€‚</p><p><img data-src="/blogimages/2022/2022-09-30/m_d6d6172695a9dfa7e8bed36f3ec5dc4c_r.gif" alt="" /></p><p>æˆ˜æ–—ä¸ä¹‹å‰ä¸ä¸€æ ·çš„ä¸»è¦æ˜¯å¯ä»¥å…è®¸ç©å®¶æ‰‹åŠ¨ç§»åŠ¨ã€ç‚¹é€‰ç›®æ ‡ç­‰ï¼Œå¯¹äºè¿™ç§ç¦»çº¿å¸§åŒæ­¥çš„æˆ˜æ–—æ¨¡å¼ï¼Œæ‰€æœ‰ç©å®¶æ“ä½œå‘½ä»¤éƒ½å¿…é¡»ä½œè®°å½•ï¼Œä»¥ä¾¿åç»­ WebServer æ­å»ºå¥½äº†ï¼Œå¯ä»¥ä¸ä»¥å‰ä¸€æ ·è¿›è¡ŒéªŒç®—ã€‚</p><p>è¿™é‡Œç›´æ¥å°†è¿™äº›é¡¹ç›®ä½œä¸ºå¤–éƒ¨æ“ä½œå‘½ä»¤æ–°å¢ï¼Œç”±äºç©å®¶å¯ä»¥ä¸æ–­ç‚¹å‡»ï¼Œå¦‚æœä¼˜åŒ–æŒ‡ä»¤æ•°é‡ (å› ä¸ºä¸€åœºæˆ˜æ–—æœ€å¤šä¼šæœ‰æœ‰ 5400 å¸§ [å³ 3 åˆ†é’Ÿ])ï¼Œå¯ä»¥é€šè¿‡å¢åŠ ç§»åŠ¨é—´éš”ã€å‹ç¼©åŒç±»å‹æŒ‡ä»¤è¿›è¡Œï¼Œä¸è¿‡è¿™é‡Œåªæ˜¯å‰æœŸ Demoï¼Œå› æ­¤æš‚æœªå®ç°ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä»¥å‰åˆ¶ä½œäººè¿˜åœ¨çš„æ—¶å€™ï¼Œå‘èµ·çš„ä¸€ä¸ª Demoï¼Œä¸è¿‡ç”±äºæ²¡æœ‰æœ€ç»ˆå®šæ€§ï¼Œå› æ­¤åªæ˜¯è®©æˆ‘åœ¨ç©ºä½™æ—¶é—´æä¸€æã€‚&lt;/p&gt;
&lt;p&gt;æ¸¸æˆèƒŒæ™¯ä¹‹ç±»è¿™é‡Œå°±ä¸åšä»‹ç»äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="Demo" scheme="https://cwhisme.github.io/categories/Unity3D/Demo/"/>
    
    
    <category term="Demo" scheme="https://cwhisme.github.io/tags/Demo/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³å®ˆæœ›é¡¹ç›®åˆ˜æµ·å±çœŸæœºç™½å±é—®é¢˜è®°å½•</title>
    <link href="https://cwhisme.github.io/2022/09/28/%E8%A7%A3%E5%86%B3%E5%AE%88%E6%9C%9B%E9%A1%B9%E7%9B%AE%E5%88%98%E6%B5%B7%E5%B1%8F%E7%9C%9F%E6%9C%BA%E7%99%BD%E5%B1%8F%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>https://cwhisme.github.io/2022/09/28/%E8%A7%A3%E5%86%B3%E5%AE%88%E6%9C%9B%E9%A1%B9%E7%9B%AE%E5%88%98%E6%B5%B7%E5%B1%8F%E7%9C%9F%E6%9C%BA%E7%99%BD%E5%B1%8F%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</id>
    <published>2022-09-27T16:00:00.000Z</published>
    <updated>2022-12-22T03:29:48.148Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p><strong>æ³¨ï¼šè¯¥é—®é¢˜å¯èƒ½ä»…é€‚ç”¨äºé¡¹ç›®ï¼Œæˆ–è€…å…¬å¸è¯¥é¡¹ç›®è¡ç”Ÿç‰ˆæœ¬ (è¯¥æ˜¯æ²¡æœ‰äº†)</strong></p><p>åœ¨ç»™å¯¹é¢å‡ºäº†æ–°åŒ…ä¹‹åï¼Œç”±äºæˆ‘æ–¹æµ‹è¯•éƒ½åªæœ‰ä½ç«¯æœºï¼Œè¿åˆ˜æµ·éƒ½æ²¡æœ‰ï¼Œå› æ­¤æ²¡æœ‰æµ‹å‡ºè¯¥é—®é¢˜ã€‚</p><p>åç»­ç”±è¿è¥åŒæ­¥è¿‡æ¥ï¼Œæ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-09-28/m_a67c42c71cc70838d1f8a1081d9ec448_r.png" alt="" /></p><p>æè¿°çš„æœåŠ¡å™¨é—®é¢˜å¯ä»¥å¿½ç•¥ï¼Œé‚£ä¸ªæ˜¯å› ä¸ºåå°æ²¡å¼€å¤–ç½‘æµ‹è¯•æœå¯¼è‡´ã€‚</p><p>ç„¶åæˆ‘å°±çœ‹äº†ä¸‹ä»¥å‰<font color=red>ä¸Šä¸€ä¸ªé¡¹ç›®ç»„</font>å‡ºç»™å¯¹é¢çš„ç™½åŒ…æ•ˆæœï¼š</p><p><img data-src="/blogimages/2022/2022-09-28/m_b8f77ca2faa524d65d5da4d97b76443e_r.png" alt="" /></p><p>è¿™æ—§ç‰ˆæœ¬çš„åˆ˜æµ·æ›´å¤§äº†ï¼æ‰€ä»¥è¿˜æ˜¯æ„Ÿè§‰æ–°ç‰ˆå¦‚æœæŠŠåˆ˜æµ·ä¹Ÿæ¸²æŸ“è¿›å»ï¼Œè¡¨ç°æ•ˆæœä¼šæ›´å¥½ä¸€ç‚¹ï¼Œç¨å¾®æŸ¥äº†ä¸€ä¸‹ï¼Œå°±å¾—çŸ¥åˆ˜æµ·æ²¡æœ‰è¢«æ¸²æŸ“çš„åŸå› æ˜¯å› ä¸ºå‡ºåŒ…å·¥ç¨‹ Unity2018.4.36 è¿™ä¸ªç‰ˆæœ¬æ²¡å‹¾ ã€Render outside safe areaã€é€‰é¡¹å¯¼è‡´çš„ï¼Œäºæ˜¯å‹¾ä¸Šé‡æ–°å‡ºåŒ…ã€‚</p><h2 id="é—®é¢˜"><a class="anchor" href="#é—®é¢˜">#</a> é—®é¢˜</h2><p>è¿™æ—¶å€™çœŸçš„é—®é¢˜å°±æ¥äº†ï¼š</p><p>åœ¨æˆ‘è‡ªå·±çš„åˆ˜æµ·å± (çº¢ç±³ K50G) çœŸæœºå®‰è£…åï¼Œä¼šæ­£å¸¸æ‰§è¡Œåˆå§‹çš„ Loading ç•Œé¢ï¼Œåç»­ç«‹åˆ»ç™½å±ï¼</p><p>è¡¨ç°æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-09-28/m_cf7b1733e5867c699e36082f5a3cb43f_r.gif" alt="" /></p><p>çœ‹ç€è¿™ä¸ªè¡¨ç°ï¼Œæœ€å¼€å§‹æ€€ç–‘è¿‡æ˜¯ Unity çš„é—®é¢˜ï¼šå› ä¸ºæˆ‘æ‹¿åˆ°é¡¹ç›®æ—¶ï¼Œç‰ˆæœ¬è™½ç„¶æ˜¯ Unity2018ï¼Œä½†å¹¶ä¸æ˜¯ Unity2018 æœ€æ–°ç‰ˆæœ¬ï¼Œåæ¥ç»™å®ƒå‡çº§åˆ° Unity2018.4.36 äº†ï¼Œå°±çŒœæµ‹æ˜¯ä¸æ˜¯ Unity å‡ºå•¥äº‹äº†ï¼Ÿ</p><p>é¡¹ç›®è®¾ç½®å¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-09-28/m_c53c356eab861de7f5b7b9a6ba011e48_r.png" alt="" /></p><p>2018.4 å®˜æ–¹è¯´æ˜æ–‡æ¡£ï¼š</p><p><img data-src="/blogimages/2022/2022-09-28/m_05c3ec910acdc69b5899d43ad7cd8e72_r.png" alt="" /></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒæŸ¥è¯¢æ–‡æ¡£æ˜¾ç¤º Unity2018 æ–‡æ¡£ä¸Šå¹¶æ²¡æœ‰ Render outside safe area è¿™é€‰é¡¹ï¼Œè·Ÿé¡¹ç›®å®é™…è®¾ç½®è¡¨ç°å¹¶ä¸ä¸€è‡´ï¼Œè¯¥é€‰é¡¹æ˜¯å¦æ˜¯ Unity2018 åç»­æ‰æ›´æ–°ä¸Šå»çš„ï¼Ÿå¯¼è‡´å‡ºç°äº†ä»€ä¹ˆå…¼å®¹æ€§é—®é¢˜ã€‚</p><p>ä¸è¿‡åè¾¹æ ¹æ®è¡¨ç°æƒ…å†µä¸€æƒ³ï¼Œä¹Ÿä¸å¯¹ã€‚</p><p>æ¯•ç«Ÿæœ€å¼€å§‹ Loading éƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºå‡ºæ¥ï¼Œé‚£ä¹ˆè¯´æ˜ Render outside safe area å¹¶æ²¡æœ‰è®©æˆ‘ä»¬çš„çœŸæœºæ•´ä½“çš„æ¸²æŸ“å‡ºç°é—®é¢˜ã€‚</p><p>æ ¹æ®å‘ç”Ÿæƒ…å†µåœ°ç‚¹ï¼šåˆå§‹ Loading ç•Œé¢å®Œæ¯•ï¼ŒUI æ¡†æ¶æ¥ç®¡ä¹‹å â€”â€” é—®é¢˜ææ€•åªå¯èƒ½å‡ºç°åœ¨æˆ‘ä»¬è‡ªå·±çš„ UI æ¡†æ¶ä½œé€‚é…æ€§çš„åœ°æ–¹ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªä¿¡æ¯å¯ä»¥ä½¿å¾— 100% ç¡®å®šæ˜¯é¡¹ç›®çš„é€‚é…è€Œé Unity çš„é—®é¢˜ï¼š</p><p>â€”â€” å¯ä»¥æ‰“å¼€æ—¥å¿—ç•Œé¢ï¼</p><p><img data-src="/blogimages/2022/2022-09-28/m_68a9dc72678952c375016e2d306ca555_r.png" alt="" /></p><p>æ—¥å¿—ç•Œé¢æ˜¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºçš„ï¼Œå› æ­¤å‡ºé—®é¢˜çš„åªå¯èƒ½æ˜¯é¡¹ç›® AorUISystem ä¸­é€‚é…é—®é¢˜ã€‚</p><h2 id="å°è¯•è§£å†³"><a class="anchor" href="#å°è¯•è§£å†³">#</a> å°è¯•è§£å†³</h2><p>å¯¹äºé¡¹ç›®ä¸­é€‚é…çš„åœ°æ–¹ï¼Œæ ¹æ®ä»£ç å¼•ç”¨ä¸€æ­¥ä¸€æ­¥æŸ¥è¯¢ï¼Œå¤§æ¦‚å¯ä»¥æ‰¾å‡ºä¸¤ä¸ªå¯èƒ½ä¼šæ¯”è¾ƒå½±å“ç‚¹ï¼š</p><ul><li>Main.cs ä¸­ AdapteFullScreen () åˆ¤æ–­åˆ˜æµ·æ–¹æ³•</li><li>AorUIManager.cs ä¸­ ScaleMode-&gt;changeScaleMode ()-&gt;updateStageSize ()</li></ul><p>å¼€å§‹è™½ç„¶åŸºæœ¬å¯ä»¥å®šä½æ˜¯è¿™ä¸¤å—çš„é—®é¢˜ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ›´è¯¦ç»†çš„å¤´ç»ªã€‚</p><p>å¹¶çŒœæµ‹ï¼š</p><ul><li>æ˜¯å¦æ˜¯ Stage ç¼©æ”¾å¤§å°è¢«é”™è¯¯è®¾ç½®ä¸º 0ï¼Ÿå› ä¸º Stage scale å…¶å®å¾ˆå°ï¼Œè€Œä¸”æ ¹æ®åˆ†è¾¨ç‡ä¸åŒè¿˜å¯èƒ½æ›´å°<br /><img data-src="/blogimages/2022/2022-09-28/m_debc641d73c783234617782f0234fb8f_r.png" alt="" /></li><li>æ˜¯å¦ç”±äºè¯»å–åˆ°åˆ˜æµ·ï¼ŒStage å‘ç”Ÿäº†ä¸¥é‡çš„é”™è¯¯åç§»ï¼Ÿ</li><li>æ˜¯å¦æ˜¯ MainLayer å±‚çº§æœ‰é®æŒ¡ï¼Ÿ</li></ul><h4 id="å‡ºåŒ…æµ‹è¯•"><a class="anchor" href="#å‡ºåŒ…æµ‹è¯•">#</a> å‡ºåŒ…æµ‹è¯•</h4><p>ä¸ºäº†å¯¹ä¸Šè¿°çŒœæµ‹è¿›éªŒè¯ï¼Œä¸”ç”±äºæ˜¯çœŸæœºã€ç‰¹å®šæœºå‹é—®é¢˜ï¼Œä¸ºäº†æµ‹è¯•ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æ”¹ä¸€æ¬¡ä»£ç ï¼Œå‡ºä¸€ä¸ªåŒ…ï¼Œå¯¼è‡´æ—¶é—´æ¶ˆè€—æ›´åŠ æ‹‰é•¿ã€‚</p><h4 id="injectfix-è¿œç¨‹çƒ­æ›´æµ‹è¯•"><a class="anchor" href="#injectfix-è¿œç¨‹çƒ­æ›´æµ‹è¯•">#</a> Injectfix è¿œç¨‹çƒ­æ›´æµ‹è¯•</h4><p>åæ¥æƒ³ç€è¿™æ ·å¯ä¸æ˜¯åŠæ³•ï¼Œäºæ˜¯æˆ‘æŠŠ Injectfix è¿œç¨‹çƒ­æ›´è°ƒè¯•åŠŸèƒ½ç»™å®ƒæ•´åˆäº†è¿›å»ï¼Œç„¶åæ‰å˜å¾—æ–¹ä¾¿èµ·æ¥ã€‚</p><p>æ‰¾åˆ°æ¸¸æˆç‚¹å‡»å±å¹•å¤„ç†æ–¹æ³•ï¼Œç›´æ¥çƒ­æ›´è¾“å‡ºéœ€è¦çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶æ“ä½œå¯¹çŒœæµ‹è¿›è¯•éªŒï¼š</p><p><img data-src="/blogimages/2022/2022-09-28/m_a2038f3d25baa22c262b0fadcf7b7d68_r.png" alt="" /></p><p>Loading ç»“æŸï¼Œè¿›å…¥æ­£å¼ UI ç®¡ç†åï¼Œå…¶åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-09-28/m_4affba82fd8aabee3e1d63ae7452a1d6_r.png" alt="" /></p><p>å°è¯•ä½¿ç”¨æ’é™¤æ³•ï¼Œæ“ä½œç»“æœåé¦ˆå¦‚ä¸‹ï¼š</p><ul><li>éšè— MainLayerï¼šæ— å˜åŒ–</li><li>éšè— AorUIStage# æ‰€æœ‰å­èŠ‚ç‚¹ï¼šæ— å˜åŒ–</li><li>éšè— AorUIStage#ï¼šæ— å˜åŒ–</li><li>éšè— AorUICanvas#ï¼šæœ‰æ˜æ˜¾å˜åŒ–ï¼Œç™½å±å˜æˆé»‘å±</li><li>éšè— AorUICanvas# æ‰€æœ‰å­èŠ‚ç‚¹ï¼šåŒéšè—çˆ¶ç±»ï¼Œæœ‰æ˜æ˜¾å˜åŒ–ï¼Œç™½å±å˜æˆé»‘å±</li><li>åœ¨ AorUICanvas#ã€AorUIStage# å­èŠ‚ç‚¹åŠ¨æ€åˆ›å»ºè‰²å—ï¼Œæ— å˜åŒ–</li><li>éšè— AorUICanvas# æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œåˆ›å»ºåŠ¨æ€è‰²å—ï¼Œèƒ½çœ‹åˆ°è‰²å—æ˜¾ç¤º</li></ul><h2 id="åŸå› "><a class="anchor" href="#åŸå› ">#</a> åŸå› </h2><p>ç»“åˆä¸Šé¢ä¸€é€šæµ‹è¯•ç»“æœï¼Œä»¥åŠè¾“å‡ºä¿¡æ¯ã€‚</p><p>å¯ä»¥åŸºæœ¬ç¡®è®¤ï¼Œæ˜¯ AorUICanvas# ä¸‹çš„æŸä¸ªå­èŠ‚ç‚¹å‡ºäº†é—®é¢˜ã€‚</p><p>äºæ˜¯å°è¯•ï¼š</p><ul><li>éšè— AorUICanvas# é™¤ AorUIStage# ä»¥å¤–çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œç™»å½•ç•Œé¢æ­£å¸¸å±•ç¤ºï¼</li></ul><p>åœ¨ AorUIStage# å±‚çº§æ›´é«˜çš„èŠ‚ç‚¹ä¸­ï¼Œipx è¿™ä¸ªèŠ‚ç‚¹å°±æ¯”è¾ƒå¯ç–‘ï¼Œå†æ¬¡è¿›è¡Œæµ‹è¯•ï¼Œä»…éšè— ipxï¼Œç™»å½•ç•Œé¢ä¹Ÿæ­£å¸¸æ˜¾ç¤ºï¼Œç™½å±æ¶ˆå¤±ã€‚</p><p>æ­¤æ—¶åŸºæœ¬å¯ä»¥å®šä½é—®é¢˜åŸå› ã€‚</p><p>äºæ˜¯æŸ¥çœ‹ä»£ç ï¼Œæˆ‘å¾ˆå¿«åœ¨ AdapteFullScreen () æ–¹æ³•ä¸­å‘ç°äº†è¿™ä¹ˆäº›å¤„ç†æ–¹æ³•ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span>Application<span class="token punctuation">.</span>platform <span class="token operator">==</span> RuntimePlatform<span class="token punctuation">.</span>Android <span class="token operator">&amp;&amp;</span> Screen<span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token number">2400</span> <span class="token operator">&amp;&amp;</span> Screen<span class="token punctuation">.</span>height <span class="token operator">==</span> <span class="token number">1080</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>isTest <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">// å…³é”®å°±è¿™é‡Œï¼ï¼ï¼ï¼ï¼ï¼</span></pre></td></tr><tr><td data-num="4"></td><td><pre>YKApplication<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>IsIphoneX <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>CommonModel<span class="token punctuation">.</span>Inst<span class="token punctuation">.</span>IsLandscapeLeft <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>mIsFullAdapter <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">//===== ä»£ç çœç•¥ =======</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// ç¼–è¯‘å™¨æµ‹è¯•</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span>isTest <span class="token operator">&amp;&amp;</span> <span class="token keyword">null</span> <span class="token operator">==</span> uiManger<span class="token punctuation">.</span>mCanvasT<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"ipx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// åˆ›å»º ipx ç»„ä»¶ï¼Œè¯¥ç»„ä»¶æ¨¡æ‹Ÿ iphone è¾¹æ¡†è¿›æ˜¾ç¤º</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2022/2022-09-28/m_39da789ee4d022ce3dac2872115e7849_r.png" alt="" /></p><p>å¤§å®¶çœ‹åˆ°äº†å—ï¼Ÿ</p><h5 id="editoronly"><a class="anchor" href="#editoronly">#</a> EditorOnlyï¼</h5><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™å¼ å›¾ç‰‡æ ¹æœ¬ä¸ä¼šæ‰“è¿›çœŸæœºåŒ…é‡Œ â€”â€” ç„¶è€Œä»£ç å´åœ¨å®ä¾‹åŒ–å®ƒï¼Ÿï¼</p><p>å¯¼è‡´å›¾ç‰‡ä¸¢å¤±ï¼Œç›´æ¥æ•´ä¸ªå±å¹•å°±æ˜¯ä¸€å—ç™½è‰²è¦†ç›–ã€‚</p><p>é—®é¢˜å°±æ˜¯è¿™æ ·ï¼šä»£ç æ‰§è¡Œäº†ä¸åº”è¯¥çœŸæœºç”Ÿæ•ˆçš„ä»£ç ï¼Œé”™è¯¯åœ°åˆ›å»ºäº†ä¸€ä¸ªæ ¹æœ¬ä¸åº”è¯¥åˆ›å»ºçš„ä¸œè¥¿ï¼Œå¯¼è‡´å‡ºç°äº†è¿™ä¹ˆä¸€ä¸ªå¾ˆéš¾è®©äººä¸€çœ¼çœ‹å‡ºé—®é¢˜çš„é—®é¢˜ã€‚</p><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p>é—®é¢˜æ˜¯è§£å†³äº†ï¼Œä½†æ˜¯èŠ±äº†ä¸€å¤©å¤šæ—¶é—´è°ƒè¯•ã€‚</p><p>é€ æˆçš„æ ¹æœ¬åŸå› æ˜¯ï¼Œ<font color=red>é¡¹ç›®ä»£ç é‡Œé¢ç›´æ¥å¼ºè¡Œåˆ¤æ–­è‹¥ã€å½“å‰ä¸ºå®‰å“å¹³å°ï¼Œä¸”åˆ†è¾¨ç‡ä¸º 2400x1080ã€ï¼Œå°±ä¼šå®ä¾‹åŒ–æµ‹è¯•è¾¹æ¡†ï¼Œçœ‹èµ·æ¥å®Œå…¨æ˜¯ä¸ºäº†æµ‹è¯•ç”¨ (ç‰¹åˆ«æ˜¯æ³¨é‡Šéƒ½å†™äº†ç¼–è¾‘å™¨æµ‹è¯•çš„)ï¼Œä¸”å›¾ç‰‡åˆæ˜¯è¢«æ ‡è®°ä¸º EditorOnly â€”â€” è€ŒçœŸæœºæ‰§è¡Œï¼Œæµ‹è¯•è¾¹æ¡†çš„å›¾é€šå¸¸æƒ…å†µä¸‹æ ¹æœ¬ä¸ä¼šæ‰“å‡ºå»ï¼Œé‚£å°±åäº†ï¼</font><br />æ³¨ï¼šæˆ‘æ‹¿åˆ°é¡¹ç›®è¿™å¼ å›¾ç‰‡å°±æ˜¯ EditorOnlyï¼Œä»£ç ä¹Ÿæ˜¯è¿™ä¸ªæ ·å­ï¼Œå‡ºåŒ…å·¥ç¨‹ä¹Ÿå¹¶ä¸å­˜åœ¨ Resources ä¸­å›¾ç‰‡çš„è½¯é“¾æ¥</p><p>çœ‹æ³¨é‡Šè¿˜å†™ç€ã€ç¼–è¯‘å™¨æµ‹è¯•ã€ï¼Œæµ‹è¯•ä»£ç ï¼Œå¦‚æœåªæ˜¯æƒ³æµ‹è¯•ç”Ÿæ•ˆï¼Œå°±ä¸åº”è¯¥è¿™æ ·åŠ å…¥æ­£å¸¸ä»£ç æµç¨‹ï¼Œå†ä¸æµç”¨å®Œä¹Ÿåº”è¯¥æ³¨é‡Šå§ï¼Ÿæˆ–è€…å†åŠ ä¸ªç¼–è¾‘å™¨ç”Ÿæ•ˆåˆ¤æ–­ä¹Ÿå¥½ã€‚</p><p>æŠ˜è…¾è¿™ä¹ˆå¤§ä¸€é€šï¼Œå€’ä¹Ÿä¹Ÿä¸ç®—æ²¡æœ‰æ”¶è·ï¼šä¸ºå®ˆæœ›é¡¹ç›®æ•´åˆäº†è¿œç¨‹ä»£ç çƒ­æ›´è°ƒè¯•å·¥å…·ç”¨ï¼Œå¹¶è¯¦ç»†æµ‹äº†ä¸€æ³¢çƒ­æ›´ä»£ç ï¼Œæ‹¿åˆ°å®ˆæœ›é¡¹ç›®ä»£ç ä¹‹åï¼Œçƒ­æ›´ç»“æ„æˆ‘ä¹Ÿæ˜¯åšè¿‡æ”¹åŠ¨çš„ï¼Œå› æ­¤æµ‹è¯•ä¸€æ³¢ä¹Ÿæ˜¯ä¹Ÿæœ‰å¿…è¦ã€‚</p><h3 id="å¦ä¸€ç§è§£å†³æ–¹æ¡ˆ"><a class="anchor" href="#å¦ä¸€ç§è§£å†³æ–¹æ¡ˆ">#</a> å¦ä¸€ç§è§£å†³æ–¹æ¡ˆ</h3><p>ä½†å®é™…ä¸Šè¿˜æœ‰å¦ä¸€ä¸ªæ–¹æ³•ï¼Œè¦æ˜¯ä½¿ç”¨çš„è¯ï¼Œä¸€å¼€å§‹å°±èƒ½å¾ˆå¿«å®šä½å¹¶è§£å†³é—®é¢˜ï¼š</p><h4 id="framedebugger"><a class="anchor" href="#framedebugger">#</a> FrameDebugger</h4><p>è™½ç„¶ Unity2018 çš„ FrameDebugger è¿æ¥çœŸæœºå¹¶ä¸æ€ä¹ˆå¥½ç”¨ï¼Œæ¸²æŸ“å¯¹è±¡è·ŸéšçœŸæœºè€æ˜¯é—ªæ¥é—ªå»ã€‚</p><p>ä¸è¿‡ä½¿ç”¨ FrameDebugger è¿æ¥çœŸæœºåï¼Œè¿˜æ˜¯å¯ä»¥å¤§æ¦‚æŸ¥è¯¢æ¸²æŸ“ç›®æ ‡ï¼Œå¯ä»¥æ¸…æ™°çœ‹å‡ºæ¥ï¼šåŸæœ¬ç™»å½•ç•Œé¢æ˜¯æ­£å¸¸æ¸²æŸ“äº†çš„ï¼Œåªæ˜¯ç™»å½•ç•Œé¢ä¸Šæ›´ä¸Šä¸€å±‚ï¼Œè¢«ç™½è‰²çš„ä¸œè¥¿ç›´æ¥ç›–äº†ä¸ªå½»å½»åº•åº•ã€‚</p><p>è¿›è€Œå®šä½æ¸²æŸ“æ²¡é—®é¢˜ï¼Œè€Œæ˜¯è¦†ç›–é—®é¢˜å¯¼è‡´ã€‚</p><p>å¯æƒœæˆ‘ä¹Ÿæ˜¯åœ¨æŸ¥å‡ºé—®é¢˜åï¼Œæ‰æƒ³èµ·ç”¨è¿™ä¸ªè¿æ¥çœŸæœºè¯•è¯•çš„ï¼Œè¦ä¸ç„¶è‚¯å®šä¼šå°‘è®¸å¤šéº»çƒ¦äº†ã€‚</p><p>é™¤æ­¤ä¹‹å¤– Renderdoc åº”è¯¥ä¹Ÿå¯ä»¥ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;æ³¨ï¼šè¯¥é—®é¢˜å¯èƒ½ä»…é€‚ç”¨äºé¡¹ç›®ï¼Œæˆ–è€…å…¬å¸è¯¥é¡¹ç›®è¡ç”Ÿç‰ˆæœ¬ (è¯¥æ˜¯æ²¡æœ‰äº†)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ç»™å¯¹é¢å‡ºäº†æ–°åŒ…ä¹‹åï¼Œç”±äºæˆ‘æ–¹æµ‹è¯•éƒ½åªæœ‰ä½ç«¯æœºï¼Œ</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="é—®é¢˜" scheme="https://cwhisme.github.io/categories/Unity3D/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="é—®é¢˜è®°å½•" scheme="https://cwhisme.github.io/tags/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºä»Unity2021é™çº§ä¸ºUnity2018çš„é—®é¢˜</title>
    <link href="https://cwhisme.github.io/2022/08/31/%E5%85%B3%E4%BA%8E%E4%BB%8EUnity2021%E9%99%8D%E7%BA%A7%E4%B8%BAUnity2018%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://cwhisme.github.io/2022/08/31/%E5%85%B3%E4%BA%8E%E4%BB%8EUnity2021%E9%99%8D%E7%BA%A7%E4%B8%BAUnity2018%E7%9A%84%E9%97%AE%E9%A2%98/</id>
    <published>2022-08-30T16:00:00.000Z</published>
    <updated>2022-12-22T03:29:48.148Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>ä¹‹å‰ä¸æ˜¯æœ‰å†™è¿‡ ã€å…³äºæ±‰å®¤å¤å…´å‡çº§ Unity2021 çš„é—®é¢˜è®°å½•ã€ è¿™æ–‡ç« ä¹ˆï¼Œå½“æ—¶æ˜¯ä¸ºäº†å°†é¡¹ç›®è¶Šå—ç‰ˆæœ¬ä» Unity2017 å‡çº§ä¸º Unity2021ã€‚</p><p>ä¸»è¦è€ƒè™‘æœ‰ä¸‰ç‚¹ï¼š</p><ul><li>è¶Šå—ç‰ˆæœ¬æ‹–äº†ä¸€å¹´å¤šä¸æ­¢ï¼Œæ–°ç‰ˆå¯ä»¥æ‹‰å¼€ä¸å…¶å®ƒç‰ˆæœ¬å·®å¼‚ï¼Œé™¤æ­¤ä¹‹å¤–å¢åŠ äº†ä¸€äº›è¶Šå—ç‰¹æœ‰ä¼˜åŒ–ï¼Œæ²¡å‡†æœ‰åŠ©äºæå®¡</li><li>è¶Šå—è¿˜æœªä¸Šçº¿ï¼Œå…ˆè¡Œå‡çº§å¯ä»¥å…ˆçœ‹ç›¸å…³å…¼å®¹æ€§</li><li>Hybridclr è‹¥å¯ä»¥ä½¿ç”¨ï¼Œåªè¦æå®¡æˆåŠŸä¸€æ¬¡ï¼Œå°±å¯ä»¥åƒçº¯ xlua é¡¹ç›®ä¸€æ ·æ›´æ–°ï¼Œæœ‰åŠ©äºè¿è¥</li></ul><p>è¶Šå—è¿˜æœªä¸Šçº¿ï¼Œå‡çº§ Unity2021 ä¹‹åæµ‹è¯•ä¹Ÿæµ‹äº†ä¸¤ä¸ªæœˆäº†ï¼ŒåŒ…æ‹¬çœŸæœºæˆ‘ä»¬è¿™è¾¹å’Œå¯¹é¢è¿è¥éƒ½è·‘è¿‡ä¸å°‘æ¬¡ï¼Œè¯¥æœ‰çš„é—®é¢˜é¡µæ”¹å¾—å·®ä¸å¤šäº†ï¼Œç›®å‰å”¯ä¸€çš„é—®é¢˜å°±æ˜¯è¿˜æ²¡æœ‰å¤§è§„æ¨¡åœ°æµ‹è¯•å…¼å®¹æ€§ã€‚</p><p>ä¸è¿‡å¯¹äºå…¼å®¹æ€§è¿™ä¸€ç‚¹ï¼Œæˆ‘ä¹Ÿåå¤è·Ÿæˆ‘ä»¬è¿™è¾¹è¿è¥å¯¹è¿‡ï¼ŒåæœŸä¼šä¸Š TestBird (çœŸçš„èƒ½è¿‡å®¡çš„è¯)ã€‚</p><p>ä¸è¿‡æœ¬å‘¨å‘¨ä¼šçš„æ—¶å€™ï¼Œå‰å‡ æ¬¡ä¸»ç¨‹ä¾‹ä¼šéƒ½æåˆ°è¿‡å‡çº§è¿™ä¸ªäº‹ï¼Œè¿™ä¸€æ¬¡ä¸Šçº§åå¯¹æ„è§æ¯”è¾ƒå¤§ï¼Œå¤§æ¦‚å°±æ˜¯å¾—ä¸æ±‚æœ‰åŠŸï¼Œä½†æ±‚æ— è¿‡ã€‚äºæ˜¯åªèƒ½å†ä½œé™çº§æ“ä½œï¼Œåç»­ç ”ç©¶è®¡åˆ’ä¹Ÿæš‚ä¸”æ”¾å¼ƒäº†ã€‚</p><p>è™½ç„¶ä»ä½ç‰ˆæœ¬å‡çº§ä¸Šå»èµ„æºæ²¡æœ‰å¤ªå¤§é—®é¢˜ï¼Œä½†æ˜¯åè€Œé™çº§æ“ä½œï¼Œä¼šé€ æˆå¤§é‡èµ„æºé—®é¢˜ï¼Œè¿™é‡Œç‰¹è®°å½•ä¸€ä¸‹ã€‚</p><p>ç›®å‰å‘ç°ä¸»è¦æœ‰å‡ ä¸ªç‚¹ï¼š</p><ul><li>åˆ†æ•£åçš„ DLL é‡æ›¿æ¢ï¼ŒUnity2018 å®‰è£…ç›®å½•ä¸‹ä¹Ÿæœ‰åˆ†æ•£ DLLï¼Œç›´æ¥æ›¿æ¢å³å¯</li><li>åœºæ™¯ Unity ç»„ä»¶ä¸¢å¤±ï¼Œä¾‹å¦‚æŒ‚è½½çš„ UGUI ç›¸å…³ StandaloneInputModleã€EventSystem</li><li>å›¾é›†å¼•ç”¨é”™ä¹±ï¼Œé™çº§åï¼ŒåŸæœ‰ Prefab å¼•ç”¨çš„å›¾é›†ä¸­å›¾ç‰‡å…¨ä¹±äº†</li><li>æ‰€æœ‰åœ¨ Unity2021 ä¿®æ”¹è¿‡çš„ Prefab éƒ½æ— æ³•ä½¿ç”¨ï¼ŒUnity ç»„ä»¶ï¼Œä¸»è¦æ˜¯ UGUI å‡ºç° Missing</li></ul><p>åç»­å†ä¸€ä¸€è®°å½•å¤„ç†æ–¹å¼ã€‚</p><h2 id="åœºæ™¯unityç»„ä»¶ä¸¢å¤±"><a class="anchor" href="#åœºæ™¯unityç»„ä»¶ä¸¢å¤±">#</a> åœºæ™¯ Unity ç»„ä»¶ä¸¢å¤±</h2><p><img data-src="/blogimages/2022/2022-08-31/m_a40f0219e30bf832243a14d9802ac50e_r.png" alt="" /></p><p>è¿™ä¸ªæ•‘ä¸äº†ï¼Œçœ‹ä¿®æ”¹è®°å½•å¼•ç”¨ GUID éƒ½æœ‰å˜åŒ–ï¼Œè€Œä¸”é™çº§ä¹‹å Unity å®Œå…¨ä¸ä¼šå¤„ç†è¿™ä¸€å—ï¼Œå·²è¢«è‡ªåŠ¨å‡çº§ä¿®æ”¹çš„ä¹Ÿä¸ä¼šå†è‡ªåŠ¨æ”¹å›å»ï¼ŒMissing äº†ä¹Ÿä¸è§æ€ªï¼Œåªèƒ½è¿˜åŸåˆ°å‡çº§ä¹‹å‰ã€‚</p><h2 id="å›¾é›†å¼•ç”¨é”™ä¹±"><a class="anchor" href="#å›¾é›†å¼•ç”¨é”™ä¹±">#</a> å›¾é›†å¼•ç”¨é”™ä¹±</h2><p><img data-src="/blogimages/2022/2022-08-31/m_1f4e876c1f2f9779eb9c917028000d99_r.png" alt="" /></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒçœŸçš„å¾ˆææ€–ï¼ŒæŸ¥çœ‹ç›¸å…³ç»„ä»¶ï¼Œéƒ¨åˆ†ä¸º Missingï¼Œéƒ¨åˆ†ä¸ºé”™è¯¯çš„ç²¾çµå¼•ç”¨ã€‚</p><p><img data-src="/blogimages/2022/2022-08-31/m_04ade9c242f57b10fd6630e40b23c9fb_r.png" alt="" /></p><p>ç»å¯¹æ¯”å‡çº§ä¸ç°åœ¨é™çº§åçš„ä¿®æ”¹è®°å½•ï¼Œå¯ä»¥æ˜æ˜¾å‘ç°é—®é¢˜ï¼šID å¯¹åº”çš„ç²¾çµåå­—å·²ç»å‘ç”Ÿäº†å˜åŒ–</p><p>è¿™ä¸ªåŒæ ·æ•‘ä¸äº†äº†ï¼Œéœ€è¦è¿˜åŸã€‚</p><p>æ­¤æ—¶å¿…é¡»å…ˆå…³é—­ Unityï¼Œç„¶å Revert æœ¬åœ°æ‰€æœ‰ä¿®æ”¹ (å› ä¸ºä½¿ç”¨ Unity2018 æ‰“å¼€å·²ç»å¯¼è‡´è‡ªåŠ¨é”™è¯¯ä¿®æ”¹äº†å¤§é‡ meta äº†)ï¼Œç„¶åå†é’ˆå¯¹ä¹‹å‰å‡çº§æäº¤è®°å½•è¿›è¡Œè¿˜åŸã€‚</p><p>åœ¨ SVN ä¸Šæ‰¾åˆ°ä¸Šæ¬¡çš„æäº¤è®°å½•ï¼Œé€‰æ‹© ã€Revert changes from this versionã€ï¼Œè¡¨ç¤ºè¿˜åŸæ‰€æœ‰è‡ªæ­¤æ¬¡æäº¤çš„ä¿®æ”¹ï¼š</p><p><img data-src="/blogimages/2022/2022-08-31/m_f5e7234ddc313e2baff6c3a366cb9f56_r.png" alt="" /></p><p>è¿˜åŸæ—¶ä¼šæœ‰å¤§é‡å†²çªï¼Œç”±äºè¿™æ¬¡æäº¤è¿˜åŸçš„ä¸»è¦æ˜¯ meta æ–‡ä»¶ï¼Œå› æ­¤åªéœ€è¦é€‰æ‹© Accept incomming å³å¯ï¼Œmeta æ–‡ä»¶ä¼šè¢«é‡æ–°ä¿®æ”¹ã€‚</p><p>å½“ç„¶å®é™…ä¸Šæ²¡è¿™ä¹ˆç®€å•å°±æ˜¯äº†ï¼Œåœ¨èµ„æºç›®å½•æ€»æäº¤ä¸Šï¼Œæœ‰äº›å†²çª (ä¾‹å¦‚ DLL) ä¼šå¯¼è‡´è¿˜åŸç›´æ¥åŠé€”ç»ˆæ­¢ï¼Œå› æ­¤æœ€ä¿é™©çš„æ–¹å¼è¿˜æ˜¯ä»å­ç›®å½•å¼€å§‹ï¼ŒæŒ¨ä¸ªæ£€æŸ¥æ˜¯å¦æ¶‰åŠåˆ°éœ€è¦è¿˜åŸçš„èµ„æºå†è¿›è¡Œè¿˜åŸã€‚</p><p>å›¾é›†è¿˜åŸä¹‹åï¼Œå†å°†æ‰€æœ‰å›¾é›†éƒ½é‡æ–°æ‰“ä¸€éå°±å¯ä»¥äº†ã€‚</p><blockquote><p>è¿˜å¥½ä¹‹å‰å¸®ç­–åˆ’å†™è¿‡ä¸€ä¸ªä¸€é”®é‡æ‰“å›¾é›†çš„å·¥å…·ï¼</p></blockquote><h2 id="é«˜ç‰ˆæœ¬ä¿®æ”¹åçš„-prefab-æ— æ³•ä½¿ç”¨"><a class="anchor" href="#é«˜ç‰ˆæœ¬ä¿®æ”¹åçš„-prefab-æ— æ³•ä½¿ç”¨">#</a> é«˜ç‰ˆæœ¬ä¿®æ”¹åçš„ Prefab æ— æ³•ä½¿ç”¨</h2><p>å…³äºè¿™ä¸ªï¼Œæ‹¿ä¸€ä¸ª Prefab Missing ç»„ä»¶ä¸¾ä¾‹ï¼Œæ­¤å¤„ä¸ºä¸€ä¸ª Image ç»„ä»¶ï¼š</p><p>ä¿®æ”¹å‰çš„ Unity2017 ç‰ˆæœ¬ï¼š</p><p><img data-src="/blogimages/2022/2022-08-31/m_5afd85c5e555fbb8b1095b1db879c2cb_r.png" alt="" /></p><p>ä»æ•°æ®å¯¹æ¯”ä¸Šæ¥çœ‹ï¼Œå…¶ä¸­ Missing çš„ç»„ä»¶ ID ä¸º 114414057906683420</p><p>ç„¶åæœç´¢å¹¶å¯¹æ¯”ä¿®æ”¹å‰åä¸¤ä¸ªç»„ä»¶çš„å·®å¼‚ï¼š</p><p><img data-src="/blogimages/2022/2022-08-31/m_98e244d2128270bb09b31b0bc60e0d18_r.png" alt="" /></p><p>å¯ä»¥æ³¨æ„åˆ°ï¼Œæ­¤å¤„è™½ç„¶é«˜ç‰ˆæœ¬å¤šäº†ç‚¹ä¸œè¥¿ã€å°‘äº†ç‚¹å•¥ï¼Œå…¶å®è¿™äº›å½±å“éƒ½ä¸å¤§ï¼Œä½†æ˜¯æœ€å…³é”®çš„æ˜¯ m_Scripts å­—æ®µ fileIDã€guid å…¨å˜äº†ï¼</p><p>å°å¿ƒç¿¼ç¿¼åœ°æ‰‹åŠ¨å°† fileIDã€guid æ”¹å›å»ï¼Œåˆ·æ–°ä¸€ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-08-31/m_6563156f7f997661be21d505355c2c11_r.png" alt="" /></p><p>å·²ç» Missing çš„ç»„ä»¶å˜æˆæ­£å¸¸äº†ï¼</p><p>è¯´æ˜å¯¼è‡´ Missing çš„å½±å“è¦ç´ ç¡®å®æ˜¯è¿™ä¸ªé—®é¢˜ã€‚</p><p>æ³¨ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5M2QuY29tL2NuL2N1cnJlbnQvTWFudWFsL0Zvcm1hdERlc2NyaXB0aW9uLmh0bWw=">å®˜æ–¹ meta æ–‡ä»¶æè¿°</span></p><h3 id="è§£å†³æ–¹æ³•"><a class="anchor" href="#è§£å†³æ–¹æ³•">#</a> è§£å†³æ–¹æ³•</h3><p>ç»è¿‡ä¸Šè¿°å°è¯•ï¼Œå¯ä»¥å‘ç°æœ‰ä¸‰ç§å¯ä¾›é€‰æ‹©çš„æ–¹æ³•ï¼š</p><ol><li>ç¢°åˆ°ä¸€ä¸ªä¿®ä¸€ä¸ªï¼Œæ‰‹åŠ¨ä¿®æ”¹ fileIDã€guid<blockquote><p>è¿™ä¸ªç®€ç›´å°±æ˜¯ç¾éš¾ï¼Œå¹¶ä¸”ä¼šèŠ±è´¹å¤§é‡æ—¶é—´ï¼Œæˆ–è®¸å¯ä»¥ç»™å®ä¹ ç”Ÿç»ƒæ‰‹ï¼Ÿä½†æ˜¯æ²¡æœ‰å¿…è¦</p></blockquote></li><li>ç›´æ¥è¿˜åŸè¿™ä¸¤ä¸ªæœˆçš„ Prefab ä¿®æ”¹<blockquote><p>ä¹‹å‰é’ˆå¯¹å¤–æœå†™è¿‡å¤‡ä»½ä¿®æ”¹å·¥å…·ï¼Œå¯ä»¥ä¸€é”®é‡å¯¼å…¥ä¹‹å‰çš„ä¿®æ”¹ã€‚ä½†æ˜¯è¿™æ¶‰åŠåˆ°éƒ¨åˆ†å·¥å…·æ— æ³•å¤„ç†ï¼Œå¿…é¡»æ‰‹åŠ¨ä¿®æ”¹çš„ Prefabï¼Œå¯èƒ½å‡ºç°é—æ¼</p></blockquote></li><li>å†™ä¸ªå·¥å…·ï¼Œç›´æ¥éå†æ‰€æœ‰ Prefabï¼Œå¹¶å°†æŒ‡å®š fileIDã€guid ä½œå¯¹åº”æ›¿æ¢<blockquote><p>æ‰‹åŠ¨æ”¹è‚¯å®šä¸å¯èƒ½ï¼Œä¸è¿‡å°±ç®—å†™å·¥å…·ï¼Œä¹Ÿå¾—ä¸€ä¸ªä¸ªæ‰¾å‡ºè„šæœ¬æ–°æ—§å¯¹åº”çš„ fileIDã€guid ï¼Œå¹¶æ”¹å›å»ï¼Œä½†ç›¸æ¯”å‰ä¸¤ç§æ–¹æ³•ï¼Œå·²ç»ç®—æ˜¯å¯ä»¥æ¥å—çš„ç¨‹åº¦äº†ã€‚</p></blockquote></li></ol><p>æ‰€ä»¥ç»è¿‡è€ƒè™‘ï¼Œé‡‡ç”¨äº†ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œé¦–å…ˆå¯¹ä¸¤ä¸ªç‰ˆæœ¬çš„ç»„ä»¶ fileIDã€guid è¿›è¡Œå¯¹æ¯”ï¼š</p><ul><li><h4 id="unity2018436f1"><a class="anchor" href="#unity2018436f1">#</a> Unity2018.4.36f1ï¼š</h4></li></ul><pre><code>Imageï¼šm_Script: &#123;fileID: -765806418, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;RawImageï¼šm_Script: &#123;fileID: -98529514, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Scroll Viewï¼šm_Script: &#123;fileID: 1367256648, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Scrollbarï¼šm_Script: &#123;fileID: -2061169968, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Sliderï¼šm_Script: &#123;fileID: -113659843, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Toggleï¼šm_Script: &#123;fileID: 2109663825, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Textï¼šm_Script: &#123;fileID: 708705254, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Buttonï¼šm_Script: &#123;fileID: 1392445389, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Dropdownï¼šm_Script: &#123;fileID: 853051423, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;InputFieldï¼šm_Script: &#123;fileID: 575553740, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;ContentSizeFilterï¼šm_Script: &#123;fileID: 1741964061, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Maskï¼šm_Script: &#123;fileID: -1200242548, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;GridLayoutGroupï¼šm_Script: &#123;fileID: -2095666955, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;HorizontalLayouGroupï¼šm_Script: &#123;fileID: -405508275, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;ToggleGroupï¼šm_Script: &#123;fileID: -1184210157, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;CanvasScalerï¼šm_Script: &#123;fileID: 1980459831, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;GraphicRaycasterï¼šm_Script: &#123;fileID: 1301386320, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;Outlineï¼šm_Script: &#123;fileID: -900027084, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;EventTriggerï¼šm_Script: &#123;fileID: -1862395651, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;LayoutElementï¼šm_Script: &#123;fileID: 1679637790, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;VerticalLayoutGroupï¼šm_Script: &#123;fileID: 1297475563, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;AspectRatioFitterï¼šm_Script: &#123;fileID: -1254083943, guid: f70555f144d8491a825f0804e09c671c, type: 3&#125;</code></pre><ul><li><h4 id="unity202136f1"><a class="anchor" href="#unity202136f1">#</a> Unity2021.3.6f1ï¼š</h4></li></ul><pre><code>Imageï¼šm_Script: &#123;fileID: 11500000, guid: fe87c0e1cc204ed48ad3b37840f39efc, type: 3&#125;RawImageï¼šm_Script: &#123;fileID: 11500000, guid: 1344c3c82d62a2a41a3576d8abb8e3ea, type: 3&#125;Scroll Viewï¼šm_Script: &#123;fileID: 11500000, guid: 1aa08ab6e0800fa44ae55d278d1423e3, type: 3&#125;Scrollbarï¼šm_Script: &#123;fileID: 11500000, guid: 2a4db7a114972834c8e4117be1d82ba3, type: 3&#125;Sliderï¼šm_Script: &#123;fileID: 11500000, guid: 67db9e8f0e2ae9c40bc1e2b64352a6b4, type: 3&#125;Toggleï¼šm_Script: &#123;fileID: 11500000, guid: 9085046f02f69544eb97fd06b6048fe2, type: 3&#125;Text (Legacy)ï¼šm_Script: &#123;fileID: 11500000, guid: 5f7201a12d95ffc409449d95f23cf332, type: 3&#125;Button (Legacy)ï¼šm_Script: &#123;fileID: 11500000, guid: 4e29b1a8efbd4b44bb3f3716e73f07ff, type: 3&#125;Dropdown (Legacy)ï¼šm_Script: &#123;fileID: 11500000, guid: 0d0b652f32a2cc243917e4028fa0f046, type: 3&#125;InputField (Legacy)ï¼šm_Script: &#123;fileID: 11500000, guid: d199490a83bb2b844b9695cbf13b01ef, type: 3&#125;ContentSizeFilterï¼šm_Script: &#123;fileID: 11500000, guid: 3245ec927659c4140ac4f8d17403cc18, type: 3&#125;Maskï¼šm_Script: &#123;fileID: 11500000, guid: 31a19414c41e5ae4aae2af33fee712f6, type: 3&#125;GridLayoutGroupï¼šm_Script: &#123;fileID: 11500000, guid: 8a8695521f0d02e499659fee002a26c2, type: 3&#125;HorizontalLayouGroupï¼šm_Script: &#123;fileID: 11500000, guid: 30649d3a9faa99c48a7b1166b86bf2a0, type: 3&#125;ToggleGroupï¼šm_Script: &#123;fileID: 11500000, guid: 2fafe2cfe61f6974895a912c3755e8f1, type: 3&#125;CanvasScalerï¼šm_Script: &#123;fileID: 11500000, guid: 0cd44c1031e13a943bb63640046fad76, type: 3&#125;GraphicRaycasterï¼šm_Script: &#123;fileID: 11500000, guid: dc42784cf147c0c48a680349fa168899, type: 3&#125;Outlineï¼šm_Script: &#123;fileID: 11500000, guid: e19747de3f5aca642ab2be37e372fb86, type: 3&#125;EventTriggerï¼šm_Script: &#123;fileID: 11500000, guid: d0b148fe25e99eb48b9724523833bab1, type: 3&#125;LayoutElementï¼šm_Script: &#123;fileID: 11500000, guid: 306cc8c2b49d7114eaa3623786fc2126, type: 3&#125;VerticalLayoutGroupï¼šm_Script: &#123;fileID: 11500000, guid: 59f8146938fff824cb5fd77236b75775, type: 3&#125;AspectRatioFitterï¼šm_Script: &#123;fileID: 11500000, guid: 86710e43de46f6f4bac7c8e50813a599, type: 3&#125;</code></pre><p><img data-src="/blogimages/2022/2022-08-31/m_022757aefd54eb580eb1ec28b1416276_r.png" alt="" /></p><p><img data-src="/blogimages/2022/2022-08-31/m_672ea79241bf3928186395657de137a7_r.png" alt="" /><br />(æ‰“å°æ˜¯åç»­è°ƒè¯•è¿›è¡Œè¿‡å¥½å‡ æ¬¡çš„æŸ¥æ¼è¡¥ç¼ºæˆªå›¾ï¼Œå› æ­¤æ•°é‡æ‰è¿™ä¹ˆå°‘)</p><p>å¦å¤–éœ€è¦æ³¨æ„åƒä¸‡ä¸å¥½æ··äº†ï¼Œæœ‰ä¸€æ¬¡å°±æ˜¯å¤åˆ¶é‡å¤äº†ï¼Œå¯¼è‡´ç»„ä»¶ä¸Šçš„è„šæœ¬æ˜¯æœ‰äº†ï¼Œä½†å´ä» VerticalLayoutGroup å˜æˆäº† LayoutElementï¼</p><p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> resDir <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"Resources"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> prefabLists <span class="token operator">=</span> Directory<span class="token punctuation">.</span><span class="token function">GetFiles</span><span class="token punctuation">(</span>resDir<span class="token punctuation">,</span> <span class="token string">"*.prefab"</span><span class="token punctuation">,</span> SearchOption<span class="token punctuation">.</span>AllDirectories<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> num <span class="token operator">=</span> prefabLists<span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> linesTemp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token class-name"><span class="token keyword">bool</span></span> doSave<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    EditorUtility<span class="token punctuation">.</span><span class="token function">DisplayProgressBar</span><span class="token punctuation">(</span><span class="token string">"é™çº§ä¿®å¤ä¸­â€¦â€¦"</span><span class="token punctuation">,</span> <span class="token interpolation-string"><span class="token string">$"è¯·ç­‰å¾…ï¼Œæ‰§è¡Œè¿›åº¦ï¼š</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token expression language-csharp">i <span class="token operator">+</span> <span class="token number">1</span></span><span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token expression language-csharp">num</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>i <span class="token operator">/</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    doSave <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    linesTemp <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">ReadAllLines</span><span class="token punctuation">(</span>prefabLists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> lineIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> lineIndex <span class="token operator">&lt;</span> linesTemp<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> lineIndex<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token comment">// éå† 2021 æœ€æ–°çš„ idï¼Œæ£€æµ‹æ¯ä¸€è¡Œæ˜¯å¦æœ‰å¯¹åº”æ•°æ®</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> newIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> newIndex <span class="token operator">&lt;</span> Unity2021<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> newIndex<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>linesTemp<span class="token punctuation">[</span>lineIndex<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>Unity2021<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                <span class="token comment">//2021 æ›¿æ¢ä¸º 2018</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                linesTemp<span class="token punctuation">[</span>lineIndex<span class="token punctuation">]</span> <span class="token operator">=</span> linesTemp<span class="token punctuation">[</span>lineIndex<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>Unity2021<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span><span class="token punctuation">,</span> Unity2018<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                doSave <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>doSave<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"ä¿®å¤å¯¹è±¡ï¼š</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token expression language-csharp">prefabLists<span class="token punctuation">[</span>i<span class="token punctuation">]</span></span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        File<span class="token punctuation">.</span><span class="token function">WriteAllLines</span><span class="token punctuation">(</span>prefabLists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> linesTemp<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>EditorUtility<span class="token punctuation">.</span><span class="token function">ClearProgressBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>AssetDatabase<span class="token punctuation">.</span><span class="token function">Refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>AssetDatabase<span class="token punctuation">.</span><span class="token function">SaveAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ç„¶åè‡ªå·±è·‘äº†ä¸‹ï¼Œå‡ºäº†çœŸæœºåŒ…ä¹Ÿè¯•äº†ä¸€åœˆæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸è¿‡åç»­è¿˜æ˜¯éœ€è¦æµ‹è¯•é‡æ–°è·‘ä¸€æ¬¡å…¨é‡ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰ä¸æ˜¯æœ‰å†™è¿‡ ã€å…³äºæ±‰å®¤å¤å…´å‡çº§ Unity2021 çš„é—®é¢˜è®°å½•ã€ è¿™æ–‡ç« ä¹ˆï¼Œå½“æ—¶æ˜¯ä¸ºäº†å°†é¡¹ç›®è¶Šå—ç‰ˆæœ¬ä» Unity2017 å‡çº§ä¸º Unity2021ã€‚&lt;/p&gt;</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="é—®é¢˜" scheme="https://cwhisme.github.io/categories/Unity3D/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="é—®é¢˜è®°å½•" scheme="https://cwhisme.github.io/tags/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>å¤„ç†Unity2019çš„UGUIé¡¶ç‚¹æ•°æ®æ›´æ–°åçš„å›¾æ–‡æ··æ’é—®é¢˜</title>
    <link href="https://cwhisme.github.io/2022/07/21/%E5%A4%84%E7%90%86Unity2019%E7%9A%84UGUI%E9%A1%B6%E7%82%B9%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E5%90%8E%E7%9A%84%E5%9B%BE%E6%96%87%E6%B7%B7%E6%8E%92%E9%97%AE%E9%A2%98/"/>
    <id>https://cwhisme.github.io/2022/07/21/%E5%A4%84%E7%90%86Unity2019%E7%9A%84UGUI%E9%A1%B6%E7%82%B9%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E5%90%8E%E7%9A%84%E5%9B%BE%E6%96%87%E6%B7%B7%E6%8E%92%E9%97%AE%E9%A2%98/</id>
    <published>2022-07-20T16:00:00.000Z</published>
    <updated>2022-12-22T03:29:48.147Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>ä¹‹å‰å¬åˆ°è¿è¥é‚£è¾¹æŠ¥æˆ‘ä»¬æ¸¸æˆå¯èƒ½ä¼šå‡ºç°å´©æºƒé—®é¢˜ï¼Œä¸»è¦æ˜¯éŸ©æœï¼Œä¸‰æ˜Ÿæœºå™¨ã€‚</p><p>äºæ˜¯æ‹¿äº†æ—¥å¿—æ¥çœ‹ï¼Œä¸»è¦ä¿¡æ¯å¦‚ä¸‹ï¼š</p><pre><code>2022-07-07 14:58:35.666 10105-11685/? E/Unity: Using memoryadresses from more that 16GB of memory         (Filename:  Line: 120)2022-07-07 14:58:36.069 10105-11685/? E/CRASH: signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 00000000005ce87f2022-07-07 14:58:36.069 10105-11685/? E/CRASH: *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***2022-07-07 14:58:36.069 10105-11685/? E/CRASH: Build fingerprint: 'samsung/d1xks/d1x:12/SP1A.210812.016/N971NKSU2HVE9:user/release-keys'2022-07-07 14:58:36.069 10105-11685/? E/CRASH: Revision: '23'2022-07-07 14:58:36.069 10105-11685/? E/CRASH: pid: 10105, tid: 11685, name: Thread-21  &gt;&gt;&gt; com.gamemorefun.sgztw &lt;&lt;&lt;2022-07-07 14:58:36.069 10105-11685/? E/CRASH:     x0   0000000000000000  x1   000000715477cf1c  x2   0000006ec75ced60  x3   0000006d857acc282022-07-07 14:58:36.069 10105-11685/? E/CRASH:     x4   000000000000007c  x5   0000000000000000  x6   000000716ad1c000  x7   000000001fdcdd1e2022-07-07 14:58:36.069 10105-11685/? E/CRASH:     x8   0000000000000000  x9   00000000ffffffff  x10  0000000000000090  x11  00000000000000082022-07-07 14:58:36.069 10105-11685/? E/CRASH:     x12  0000fffffffff3ff  x13  0000000000000020  x14  0000000000800000  x15  00000000000000012022-07-07 14:58:36.069 10105-11685/? E/CRASH:     x16  0000006dad6574b0  x17  00000071546e0b70  x18  0000006d857ad0c4  x19  0000006dad6ff8b02022-07-07 14:58:36.069 10105-11685/? E/CRASH:     x20  0000006cba745fe0  x21  0000006dad6ff8b0  x22  0000006dad6ff8e0  x23  000000000000005d2022-07-07 14:58:36.069 10105-11685/? E/CRASH:     x24  0000006dad6fd050  x25  00000000005ce597  x26  0000000000000018  x27  3fd1d9b7b46c74bd2022-07-07 14:58:36.069 10105-11685/? E/CRASH:     x28  00000000000027d4  x29  0000006d857ad000  x30  0000006dac83d4e42022-07-07 14:58:36.069 10105-11685/? E/CRASH:     sp   0000006d857acfb0  pc   0000006dac83d53c  pstate 00000000600000002022-07-07 14:58:36.069 10105-11685/? E/CRASH: backtrace:</code></pre><p>å…¶ä¸­å…³é”®å­—å°±æ˜¯ ã€Using memoryadresses from more that 16GB of memoryã€ï¼Œé€šè¿‡æŸ¥è¯¢ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€äº›ï¼Œä¾‹å¦‚å®˜æ–¹è®ºå›ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIudW5pdHkuY24vcHJvamVjdHMvNjIyYjMzYTdlZGJjMmEwMDFiNmY3Nzc2">https://developer.unity.cn/projects/622b33a7edbc2a001b6f7776</span></p><p>è¿™é‡Œè§£é‡Šå¾—çŸ¥ï¼Œæ˜¯ç”±äºå®‰å“æ–°ç‰ˆç³»ç»Ÿå†…å­˜åˆ†é…å™¨æ›´æ¢å¯¼è‡´ Unity å‡ºç°çš„ BUGï¼Œå¹¶ä¸” Unity ä¹Ÿåœ¨åç»­ç‰ˆæœ¬æ›´æ–°ä¸­åŒæ­¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œç„¶è€Œä¿®å¤ç‰ˆæœ¬å¹¶ä¸åŒ…æ‹¬ 2017ï¼š</p><ul><li>2018.4.30</li><li>2019.4.15</li><li>2020.1.14</li><li>2020.2.0b12</li><li>2021.1.0a4</li></ul><p>æ°å¥½æˆ‘ä»¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯ Unity2017ï¼Œå› æ­¤è¿™ç§æƒ…å†µé™¤æ›´æ–° Unity ä¹‹å¤–ææ€•ä¹Ÿåˆ«æ— ä»–æ³•ã€‚</p><p>äºæ˜¯å°±æƒ³å‡çº§ï¼Œä¸ªäººå°±å­å­å“§å“§åœ¨è‡ªå·±ç”µè„‘ä¸Šè¿›è¡Œç‰ˆæœ¬å‡çº§çš„å…¼å®¹æ€§æµ‹è¯•äº†ï¼Œå¼€å§‹ç”¨ 2018 æ‰“å¼€ç§äº†ç§ï¼Œå¹¶å‡ºäº†ä¸ª PC åŒ…ï¼Œæ„Ÿè§‰æ²¡å•¥å¤§é—®é¢˜ï¼Œåæ¥ç´¢æ€§åˆç”¨ 2019 æ‰“å¼€äº†æ¥çœ‹ï¼Œç‚¹äº†ç‚¹å‘ç°äº†è¿™ä¹ˆä¸ª UGUI çš„å›¾æ–‡æ··æ’ä»¥åŠè¶…é“¾æ¥å¤±æ•ˆé—®é¢˜ã€‚</p><p>(æ³¨ï¼šå¼€å§‹è¿˜ä»¥ä¸ºåª 2019 è¢«æ”¹äº†ï¼Œäº‹å®è¯æ˜ï¼Œæ–°ç‰ˆæœ¬ Unity2018 å…¶å®ä¹Ÿæœ‰è¿™é—®é¢˜ï¼Œæ®è¯´ Unity2018 ä» 2018.4 ä¹Ÿæ”¹è¿‡äº†ï¼ŒUnity2019 å¤§æ¦‚æ˜¯ä» 2019.2 ä¿®æ”¹)</p><p>æˆ‘ä»¬é¡¹ç›®çš„å›¾æ–‡æ··æ’ä»¥åŠè¶…é“¾æ¥ï¼Œéƒ½æ˜¯é€šè¿‡ä¸€ä¸ªå« AorTextIncSprites è„šæœ¬å®ç°ï¼Œè¯¥è„šæœ¬ç»§æ‰¿äº MaskableGraphic ï¼Œå¹¶å¤åˆ¶äº† Unity5.6 çš„ UGUI æºç ï¼Œåœ¨å…¶åŸºç¡€ä¸ŠåŠ å…¥äº†è¶…é“¾æ¥å’Œè¡¨æƒ…çš„å›¾æ–‡æ··æ’æ”¯æŒ â€”â€” ç›¸å½“å¤è€çš„ä»£ç äº†ï¼Œä¸è¿‡è¿˜èƒ½å·¥ä½œã€‚</p><p>åªæ˜¯æ‹¿åˆ° Unity2019 ä¹‹åï¼Œè¿™ä¸¤ä¸ªé¢å¤–çš„åŠŸèƒ½éƒ½å‡ºç°äº†äº›é—®é¢˜ï¼Œä¾‹å¦‚è¶…é“¾æ¥æœ‰çš„æ— æ³•æ­£ç¡®ç”Ÿæˆç‚¹å‡»åŒºåŸŸå¯¼è‡´æ— æ³•è§¦å‘å¯¹åº”äº‹ä»¶ã€å›¾æ–‡æ··æ’ç›´æ¥ç³Šæ‰ â€”â€” è¡¨ç°ä¸ºç»˜åˆ¶æ•´ä¸ªå›¾é›†ï¼Œå¤§æ¦‚å°±è¿™ä¹ˆä¸ªæ ·å­ï¼š</p><p><img data-src="/blogimages/2022/2022-07-21/m_e7bf620f8dce19917458f506a2afeaa5_r.png" alt="" /></p><h2 id="uguié¡¶ç‚¹æ•°æ®"><a class="anchor" href="#uguié¡¶ç‚¹æ•°æ®">#</a> UGUI é¡¶ç‚¹æ•°æ®</h2><p>UGUI é¡¶ç‚¹æ•°æ®ä¸­ï¼Œæ®è¯´ä» 2019.2ã€2018.4 å¼€å§‹ï¼Œå…¨éƒ½ä¸å†åŒ…å«å¯Œæ–‡æœ¬æ•°æ®ï¼Œå¯¼è‡´ä»¥å¾€æ¶‰åŠåˆ° UGUI é¡¶ç‚¹ä¿®æ”¹çš„ç›¸å…³ä»£ç ï¼Œèƒ½å¤Ÿæ­£å¸¸å·¥ä½œçš„éƒ½ä¸å†æ­£å¸¸ã€‚</p><p>ä¸»è¦å—å½±å“çš„æœ‰ï¼šå›¾æ–‡æ··æ’ã€è¶…é“¾æ¥ã€ç«–è¡Œæ’è¡Œ (VerticalText)</p><h2 id="è¶…é“¾æ¥"><a class="anchor" href="#è¶…é“¾æ¥">#</a> è¶…é“¾æ¥</h2><p>è¶…é“¾æ¥çš„é—®é¢˜ï¼Œä¸»è¦ä½“ç°åœ¨èŠå¤©é¢‘é“ä¸­ï¼ŒæŸäº›å«æœ‰åæ ‡çš„ä¿¡æ¯ï¼Œæ— æ³•ç‚¹å‡»åæ ‡ â€”â€” ç»è¿‡æ£€æŸ¥ï¼Œå†…éƒ¨é—®é¢˜åœ¨äºç‚¹å‡»èŒƒå›´çš„é”™è¯¯å¤„ç†ï¼Œå¯¼è‡´æœªèƒ½æ­£ç¡®ç”ŸæˆåŒ…å›´èŒƒå›´æ•°æ®ã€‚</p><p>åŸä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">/// è·å–è¶…é“¾æ¥è§£æåçš„æœ€åè¾“å‡ºæ–‡æœ¬</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">/// &lt;returns>&lt;/returns></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateHrefInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        s_TextBuilder<span class="token punctuation">.</span>Length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        m_HrefInfos<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token class-name"><span class="token keyword">var</span></span> indexText <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">Match</span> match <span class="token keyword">in</span> s_HrefRegex<span class="token punctuation">.</span><span class="token function">Matches</span><span class="token punctuation">(</span>originalText<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token class-name"><span class="token keyword">string</span></span> replaceText <span class="token operator">=</span> originalText<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span>indexText<span class="token punctuation">,</span> match<span class="token punctuation">.</span>Index <span class="token operator">-</span> indexText<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            s_TextBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>replaceText<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token comment">//s_TextBuilder.Append (string.Format ("&lt;color=&#123;0&#125;>", _href_Color)); // è¶…é“¾æ¥é¢œè‰²</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token class-name"><span class="token keyword">var</span></span> <span class="token keyword">group</span> <span class="token operator">=</span> match<span class="token punctuation">.</span>Groups<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token class-name"><span class="token keyword">var</span></span> hrefInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HrefInfo</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                startIndex <span class="token operator">=</span> s_TextBuilder<span class="token punctuation">.</span>Length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// è¶…é“¾æ¥é‡Œçš„æ–‡æœ¬èµ·å§‹é¡¶ç‚¹ç´¢å¼•</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                endIndex <span class="token operator">=</span> <span class="token punctuation">(</span>s_TextBuilder<span class="token punctuation">.</span>Length <span class="token operator">+</span> match<span class="token punctuation">.</span>Groups<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                name <span class="token operator">=</span> <span class="token keyword">group</span><span class="token punctuation">.</span>Value</pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            m_HrefInfos<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>hrefInfo<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>            s_TextBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>match<span class="token punctuation">.</span>Groups<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token comment">//s_TextBuilder.Append("&lt;/color>");</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            indexText <span class="token operator">=</span> match<span class="token punctuation">.</span>Index <span class="token operator">+</span> match<span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        s_TextBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>originalText<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span>indexText<span class="token punctuation">,</span> originalText<span class="token punctuation">.</span>Length <span class="token operator">-</span> indexText<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token comment">//return s_TextBuilder.ToString();</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ä¸»è¦é—®é¢˜åœ¨äºï¼Œå…¶ä¸­è®¡ç®— ã€è¶…é“¾æ¥é‡Œçš„æ–‡æœ¬èµ·å§‹é¡¶ç‚¹ç´¢å¼•ã€ä¸­ï¼Œç›´æ¥æ‹¿åŸæ–‡è¿›è¡Œè®¡ç®—ï¼Œæ²¡æœ‰å¿½ç•¥å¯Œæ–‡æœ¬ä¿¡æ¯ï¼Œä¸Šè¾¹æåˆ°è¿‡ï¼Œæ–°ç‰ˆ UGUI å·²ç»ä¸å†åŒ…å«å¯Œæ–‡æœ¬æ•°æ®ã€‚</p><p>å› æ­¤è¶…é“¾æ¥é—®é¢˜ä¿®æ”¹ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œåœ¨æ­¤å¤„ç­›é™¤æ‰å¯Œæ–‡æœ¬ä¿¡æ¯ï¼Œç„¶åå†å–é•¿åº¦å³å¯ã€‚</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// çœç•¥ =============</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> length <span class="token operator">=</span> <span class="token function">ReplaceRichText</span><span class="token punctuation">(</span>s_TextBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token class-name"><span class="token keyword">var</span></span> hrefInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HrefInfo</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>startIndex <span class="token operator">=</span> length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// è¶…é“¾æ¥é‡Œçš„æ–‡æœ¬èµ·å§‹é¡¶ç‚¹ç´¢å¼•</span></pre></td></tr><tr><td data-num="6"></td><td><pre>endIndex <span class="token operator">=</span> <span class="token punctuation">(</span>length <span class="token operator">+</span> match<span class="token punctuation">.</span>Groups<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>name <span class="token operator">=</span> <span class="token keyword">group</span><span class="token punctuation">.</span>Value</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// çœç•¥ =============</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//Unity2019 å¯Œæ–‡æœ¬ä»€ä¹ˆçš„é¡¶ç‚¹ä¿¡æ¯éƒ½æ²¡äº†ï¼Œè®¡ç®—é•¿åº¦æ—¶å‰”é™¤å¯Œæ–‡æœ¬</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ReplaceRichText</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> str<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>str <span class="token operator">=</span> Regex<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">@"&lt;color=(.+?)>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"&lt;/color>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"&lt;b>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"&lt;/b>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"&lt;i>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"&lt;/i>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"\r"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">return</span> str<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="å›¾æ–‡æ··æ’"><a class="anchor" href="#å›¾æ–‡æ··æ’">#</a> å›¾æ–‡æ··æ’</h2><p>è¿™ä¸ªé—®é¢˜è·Ÿè¶…é“¾æ¥ç±»ä¼¼ï¼Œéƒ½æ˜¯ç”±äº UGUI ä¸å†è®°å½•å¯Œæ–‡æœ¬ä¿¡æ¯å¯¼è‡´å¤±æ•ˆã€‚</p><p>è™½ç„¶çŸ¥é“äº†è¿™ç‚¹ï¼Œä½†æ˜¯ç”±äºå›¾æ–‡æ··æ’æ“ä½œæ›´å¤šï¼Œå³ä½¿é—®é¢˜ä¸€æ ·ï¼Œä¿®å¤å›¾æ–‡æ··æ’è¿˜æ˜¯è¦éº»çƒ¦å¾—å¤šã€‚</p><h3 id="åŸºç¡€ä¿®å¤"><a class="anchor" href="#åŸºç¡€ä¿®å¤">#</a> åŸºç¡€ä¿®å¤</h3><p>æ¥åˆ°ç»˜åˆ¶è¡¨æƒ…çš„æ–¹æ³•ï¼Œè¿™å„¿ä½äº OnPopulateMeshï¼ŒåŸæœ¬ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">MatchCollection</span> matches <span class="token operator">=</span> Regex<span class="token punctuation">.</span><span class="token function">Matches</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"&lt;quad.+?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> diff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> matches<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token class-name">EmojiInfo</span> info<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token class-name">Match</span> numberMatch <span class="token operator">=</span> Regex<span class="token punctuation">.</span><span class="token function">Match</span><span class="token punctuation">(</span>matches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">,</span> <span class="token string">"[0-9]+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>EmojiIndex<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>numberMatch<span class="token punctuation">.</span>Value<span class="token punctuation">,</span> <span class="token keyword">out</span> info<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        info<span class="token punctuation">.</span>len <span class="token operator">=</span> matches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        emojiDic<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>matches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Index<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        diff <span class="token operator">+=</span> info<span class="token punctuation">.</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        info<span class="token punctuation">.</span>len <span class="token operator">=</span> matches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        emojiDic<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>matches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Index<span class="token punctuation">,</span> EmojiIndex<span class="token punctuation">[</span><span class="token string">"0"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        diff <span class="token operator">+=</span> info<span class="token punctuation">.</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ­¤å¤„å¤„åœ¨æ­£å¼ç»˜åˆ¶ä¹‹å‰ï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œè§£æåŸæœ¬çš„æ–‡å­—å†…å®¹ï¼Œå°†è¡¨æƒ…æ ‡ç­¾å‰”å‡ºæ¥ï¼Œå¹¶ç”Ÿæˆå¯¹åº”å¯¹åº”è¡¨æƒ…æ•°æ®æ”¾åœ¨ä¸€ä¸ªå­—å…¸ä¸­ï¼Œä»¥å¤‡åç”¨ã€‚</p><p>å‡ºç°é—®é¢˜çš„ä¸»è¦åŸå› å°±åœ¨äºåŸæœ¬çš„è¿™ä¸ª  <code>matches[i].Index</code> â€”â€” æ—¢ç„¶æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè·å–åˆ°çš„ä¸‹æ ‡ï¼Œè‡ªç„¶æ˜¯æ²¡æœ‰æ’é™¤ç”¨äºè¡¨æƒ…å ä½æ ‡ç­¾é•¿åº¦çš„ï¼Œä¹‹å‰ UGUI åŒæ ·å­˜å‚¨äº†å¯¹è¿™äº›æ ‡ç­¾çš„å¤„ç†æ•°æ®è¿˜æ²¡äº‹ï¼Œç°åœ¨ UGUI æ•°æ®ä¸­ä¸åœ¨åŒ…å«ï¼Œè·å–çš„æ•°æ®å°±ä¼šæœ‰é—®é¢˜ã€‚</p><p>å› æ­¤ï¼Œæˆ‘åˆè®¡äº†ä¸€ä¸‹  <code>&lt;quad name = XX&gt;</code>  çš„é•¿åº¦ï¼Œè®¡ç®—äº†ä¸€ä¸‹å„ç§ç»„åˆå¯èƒ½çš„é•¿åº¦ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// ä»…è¡¨æƒ…æ ‡ç­¾ï¼Œä¸ç®—è¡¨æƒ… id çš„é•¿åº¦</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token string">"&lt;quad name = >"</span><span class="token punctuation">.</span>Length</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">14</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">//1 ä½è¡¨æƒ… id çš„è¡¨æƒ…æ ‡ç­¾é•¿åº¦</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token string">"&lt;quad name = 2>"</span><span class="token punctuation">.</span>Length</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">15</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// ä¸¤ä¸ªè¿ç»­ 2 ä½è¡¨æƒ…ï¼Œæ€»å…±é•¿åº¦</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token string">"&lt;quad name = 22>&lt;quad name = 22>"</span><span class="token punctuation">.</span>Length</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token number">32</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// ä¸¤ä¸ªè¿ç»­è¡¨æƒ…ï¼Œç¬¬äºŒä¸ªè¡¨æƒ…åæ ‡</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token string">"&lt;quad name = 22>&lt;quad name = 8>"</span><span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"&lt;quad name = 8>"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token number">16</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// ä¸€ä¸ª 2 ä½è¡¨æƒ…æ ‡ç­¾é•¿åº¦</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token string">"&lt;quad name = 22>"</span><span class="token punctuation">.</span>Length</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token number">16</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// ä¸€ä¸ª 1 ä½è¡¨æƒ…æ ‡ç­¾é•¿åº¦</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token string">"&lt;quad name = 8>"</span><span class="token punctuation">.</span>Length</pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token number">15</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// ç¡®è®¤ Unicode ç©ºæ ¼ç¬¦é•¿åº¦</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token string">"\u3000\u3000\u3000\u3000"</span><span class="token punctuation">.</span>Length</pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token number">4</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// æ··åˆè¡¨æƒ…ï¼Œå‰”é™¤ç¬¬ä¸€ä¸ªè¡¨æƒ…æ ‡ç­¾é•¿åº¦</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token string">"bbbbb&lt;quad name = 22>aaaaaa&lt;quad name = 8>"</span><span class="token punctuation">.</span>Length<span class="token operator">-</span><span class="token number">16</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token number">26</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">// æ··åˆè¡¨æƒ…ï¼Œç¬¬äºŒä¸ªè¡¨æƒ…æ ‡ç­¾åæ ‡</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token string">"bbbbb&lt;quad name = 22>aaaaaa&lt;quad name = 8>"</span><span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"&lt;quad name = 8>"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">16</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token number">11</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// è¿ç»­ä¸¤ä¸ªè¡¨æƒ…æ ‡ç­¾ï¼Œå‰”é™¤ç¬¬ä¸€ä¸ªè¡¨æƒ…æ ‡ç­¾åç¬¬äºŒä¸ªè¡¨æƒ…æ ‡ç­¾åæ ‡</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token string">"&lt;quad name = 22>&lt;quad name = 8>"</span><span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">"&lt;quad name = 8>"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">16</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token number">0</span></pre></td></tr></table></figure><p>å¦‚æ­¤ï¼Œæ‰¾å‡ºä¸€ä¸ªæ¯”è¾ƒå…±æ€§çš„ä¸€ç‚¹ï¼Œä½¿å¾—è®¡ç®—æ—¶å‰”é™¤ <code>&lt;quad name = XX&gt;</code>  çš„é•¿åº¦ä¹‹åè¿›è¡Œå°è¯•æ€§ä¿®æ”¹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">MatchCollection</span> matches <span class="token operator">=</span> Regex<span class="token punctuation">.</span><span class="token function">Matches</span><span class="token punctuation">(</span><span class="token function">ReplaceRichText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"&lt;quad.+?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> diff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// è¡¨æƒ…å¯Œæ–‡æœ¬çš„é•¿åº¦ (é™¤è¡¨æƒ… id)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> richMarkLength <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// ä¸Šä¸€ä¸ªè¡¨æƒ… index</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> lastEmojiIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> matches<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token class-name">EmojiInfo</span> info<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token class-name">Match</span> numberMatch <span class="token operator">=</span> Regex<span class="token punctuation">.</span><span class="token function">Match</span><span class="token punctuation">(</span>matches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">,</span> <span class="token string">"[0-9]+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token class-name"><span class="token keyword">int</span></span> dicIndexId <span class="token operator">=</span> matches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Index <span class="token operator">-</span> lastEmojiIndex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token comment">// å¤„ç†è¿ç»­è¡¨æƒ…æ ‡ç­¾</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>emojiDic<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>dicIndexId<span class="token punctuation">)</span><span class="token punctuation">)</span> dicIndexId <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>EmojiIndex<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>numberMatch<span class="token punctuation">.</span>Value<span class="token punctuation">,</span> <span class="token keyword">out</span> info<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>emojiDic<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>dicIndexId<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">else</span></pre></td></tr><tr><td data-num="17"></td><td><pre>emojiDic<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>dicIndexId<span class="token punctuation">,</span> EmojiIndex<span class="token punctuation">[</span><span class="token string">"0"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    info<span class="token punctuation">.</span>len <span class="token operator">=</span> matches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Length<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    diff <span class="token operator">+=</span> info<span class="token punctuation">.</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token comment">// å¤„ç†å¤šä¸ªè¡¨æƒ…ï¼Œç”±äº Unity2019 å»æ‰äº†å¯Œæ–‡æœ¬é¡¶ç‚¹ä¹‹ç±»ä¿¡æ¯ï¼Œåç»­è¡¨æƒ…éœ€è¦å‡å»ä¹‹å‰è¡¨æƒ…æ ‡ç­¾é•¿åº¦</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    lastEmojiIndex <span class="token operator">+=</span> <span class="token punctuation">(</span>richMarkLength<span class="token operator">+</span> numberMatch<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>Length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2022/2022-07-21/m_e9d161e6ad216065fb732a400cee7a62_r.png" alt="" /></p><h3 id="æœ€åä¸€ä½ç¼ºå¤±"><a class="anchor" href="#æœ€åä¸€ä½ç¼ºå¤±">#</a> æœ€åä¸€ä½ç¼ºå¤±</h3><p>æœ€åï¼Œå¯èƒ½ä¼šå‘ç°æœ€åä¸€ä¸ªè¡¨æƒ… (/ æ–‡å­—) æ— æ³•æ˜¾ç¤ºï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼Œæ ¹æ®æ³¨é‡Šæ„æ€ï¼Œåˆ é™¤å‡æ‰çš„ 4 ä¸ªé¡¶ç‚¹ä»£ç å³å¯ã€‚</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//Last 4 verts are always a new line...</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> vertCount <span class="token operator">=</span> verts<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æŒ‰ç…§ä¸Šè¿°è§„åˆ™ï¼Œè¡¨ç°çœ‹èµ·æ¥è²Œä¼¼åŸºæœ¬ä¸Šæ­£å¸¸äº†ã€‚</p><h3 id="åŒ…å«é¢å¤–å¯Œæ–‡æœ¬ä¿®å¤"><a class="anchor" href="#åŒ…å«é¢å¤–å¯Œæ–‡æœ¬ä¿®å¤">#</a> åŒ…å«é¢å¤–å¯Œæ–‡æœ¬ä¿®å¤</h3><p>ä½†æ˜¯åè¾¹å‘ç°ï¼Œè¦æ˜¯æ’å…¥äº†å…¶å®ƒå¯Œæ–‡æœ¬çš„ä¿¡æ¯ï¼Œåˆä¼šå¯¼è‡´å˜æˆä¹±ç äº†ã€‚</p><p><img data-src="/blogimages/2022/2022-07-21/m_5a74fd06cdaf1fd35da83e7e9eed5227_r.png" alt="" /></p><p>åŸå› æ˜¯ä¸Šè¿°æ–¹å¼è™½ç„¶æ’é™¤äº†è¡¨æƒ…æ ‡ç­¾çš„å½±å“ï¼Œä½†è²Œä¼¼å¹¶æœªå‰”é™¤å…¶å®ƒå¯Œæ–‡æœ¬æ ‡ç­¾å½±å“ â€”â€” è¯´èµ·æ¥è¿™ä¸ªæˆ‘è¿˜æ˜¯åè¾¹æ‰å‘è§‰ã€‚</p><p>ä¸ºæ­¤å¯ä»¥åœ¨æ­£å¼ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œç­›é€‰è¡¨æƒ…æ ‡ç­¾ä¹‹å‰ï¼Œå‰”é™¤å¯Œæ–‡æœ¬ä¿¡æ¯ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">MatchCollection</span> matches <span class="token operator">=</span> Regex<span class="token punctuation">.</span><span class="token function">Matches</span><span class="token punctuation">(</span><span class="token function">ReplaceRichText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"&lt;quad.+?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ç”±äºå‰”é™¤ä¹ŸåŒ…æ‹¬ç©ºæ ¼ï¼Œå› æ­¤è¿™å„¿éœ€è¦é‡æ–°è®¡ç®—</p><p>ä»¥ä¸‰ä¸ªè¿ç»­çš„è¡¨æƒ…ä¸ºä¾‹ï¼š</p><pre><code>//æœªå‰”é™¤ä¹‹å‰é•¿åº¦&quot;&lt;quad name = 21&gt;&lt;quad name = 22&gt;&lt;quad name = 23&gt;&quot;.Length  48//å‰”é™¤æ‰€æœ‰å¯Œæ–‡æœ¬æ•°æ®åå†…å®¹ReplaceRichText(text) &quot;&lt;quadname=21&gt;&lt;quadname=22&gt;&lt;quadname=23&gt;&quot;//å‰”é™¤æ‰€æœ‰å¯Œæ–‡æœ¬æ•°æ®åé•¿åº¦ReplaceRichText(text).Length39//ä¸€ä¸ªè¡¨æƒ…æ ‡ç­¾çš„é•¿åº¦&quot;&lt;quadname=23&gt;&quot;.Length13//å–ç¬¬äºŒä½è¡¨æƒ…åæ ‡&quot;&lt;quadname=21&gt;&lt;quadname=22&gt;&lt;quadname=23&gt;&quot;.IndexOf(&quot;&lt;quadname=22&gt;&quot;)13//ä»…è¡¨æƒ…æ ‡ç­¾ï¼Œä¸ç®—è¡¨æƒ…idçš„é•¿åº¦&quot;&lt;quadname=&gt;&quot;.Length11</code></pre><p>å¯å¾—å‡ºä¿®æ”¹æ–¹å¼ï¼š</p><ul><li>å°† text è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼æœç´¢ä¹‹å‰ï¼Œå‰”é™¤å¯Œæ–‡æœ¬æ•°æ®</li><li>å°† richMarkLength å­—æ®µé»˜è®¤å€¼æ”¹ä¸º 11</li></ul><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token class-name">MatchCollection</span> matches <span class="token operator">=</span> Regex<span class="token punctuation">.</span><span class="token function">Matches</span><span class="token punctuation">(</span><span class="token function">ReplaceRichText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"&lt;quad.+?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> diff <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// è¡¨æƒ…å¯Œæ–‡æœ¬çš„é•¿åº¦ (é™¤è¡¨æƒ… id)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> richMarkLength <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¿®æ”¹ä»£ç åï¼Œä»¥è¿ç»­ä¸‰ä¸ªè¡¨æƒ…ä¸ºä¾‹ï¼Œæ­£å¸¸èŠå¤©é¢‘é“è¡¨ç°æ­£å¸¸ï¼Œä¸»ç•Œé¢é¢å¤–èŠå¤©ä¿¡æ¯å±•ç¤ºæ–‡æœ¬å†…å®¹ä¸ºï¼š</p><pre><code>&quot;&lt;color=#ffc800&gt;ã€ä¸–ç•Œã€‘&lt;/color&gt;10:&lt;quad name = 21&gt;&lt;quad name = 22&gt;&lt;quad name = 23&gt;&quot;</code></pre><p>æ•ˆæœï¼š</p><p><img data-src="/blogimages/2022/2022-07-21/m_da92c3ca6f573d9afc4a312cc15f2b9f_r.png" alt="" /></p><h2 id="æ–‡å­—ç«–è¡Œæ’ç‰ˆåŠŸèƒ½é—®é¢˜"><a class="anchor" href="#æ–‡å­—ç«–è¡Œæ’ç‰ˆåŠŸèƒ½é—®é¢˜">#</a> æ–‡å­—ç«–è¡Œæ’ç‰ˆåŠŸèƒ½é—®é¢˜</h2><p>æˆ‘ä»¬é¡¹ç›®ä¸­å«åš ã€VirticalTextã€(æ„Ÿè§‰å‘½åä¹Ÿé”™äº†ï¼Œä¸æ˜¯åº”è¯¥ VerticalText å—ï¼Ÿ)</p><p>è¿™ä»½ä»£ç æ˜¯é€šè¿‡æ“ä½œ Text æ—‹è½¬é¡¶ç‚¹å®ç°ç«–è¡Œæ’ç‰ˆçš„ï¼Œè¿™ä»½ä»£ç ç›´æ¥æ²¡æ³•è·‘ï¼ŒæŠ¥é”™äº†ã€‚</p><p>ç»è¿‡æ£€æŸ¥ï¼Œå‘ç°åŒæ ·æ˜¯æ–°ç‰ˆ Unity çš„ UGUI é¡¶ç‚¹æ•°æ®é—®é¢˜å¯¼è‡´ï¼Œè€Œä¸”è™½ç„¶ UGUI å†…éƒ¨ä¸å­˜å‚¨å¯Œæ–‡æœ¬æ•°æ®äº†ï¼Œä½†æ˜¯è¿™é‡Œéå¸¸ä¸å¯æ€è®®çš„æ˜¯ï¼ŒåŒæ ·ä» UGUI ç³»ç»Ÿå†…éƒ¨è·å–çš„ UILineInfo ç«Ÿç„¶åŒ…æ‹¬äº†æ¢è¡Œç¬¦ï¼</p><p>ç„¶åä½¿ç”¨ UILineInfo ç»™å‡ºçš„æ•°æ®å»è°ƒç”¨ VertexHelper PopulateUIVertex è·å–æ–‡å­— UIVertex å°±ä¼šæŠ¥ä¸‹æ ‡é”™è¯¯ã€‚</p><p>ç”±äº UILineInfo æ•°æ®åŒ…æ‹¬äº†æ¢è¡Œç¬¦ï¼Œé¡¶ç‚¹æ•°æ®é‡Œè¾¹å´ä¸åŒ…æ‹¬ï¼Œå°±å¯¼è‡´äº†æœ€ç»ˆçš„å–å€¼æŠ¥é”™ â€”â€” éƒ½æ˜¯ UGUI çš„æ•°æ®ï¼Œè¿™å®Œå…¨æ•´å¾— UGUI è‡ªå·±çš„å†…éƒ¨æ•°æ®éƒ½ä¸ä¸€è‡´äº†ï¼Œä¸ç¡®å®šæ˜¯ UGUI æ›´æ–°æ¼äº†ï¼Œè¿˜æ˜¯æ•…æ„è¿™æ ·è®¾è®¡ã€‚</p><p>åæ­£æˆ‘çš„å¤„ç†æ–¹å¼æ˜¯ï¼Œç›´æ¥æŠŠè€çš„é‚£å¨ä»¥ UILineInfo ä½œä¸ºæ•°æ®æºçš„æ–¹æ³•å»æ‰ï¼Œè‡ªå·±å†™äº†ä¸€å—ç›´æ¥é€šè¿‡å­—ç¬¦ä¸²è§£ææ¥è§£å†³ã€‚</p><p><img data-src="/blogimages/2022/2022-07-21/m_11e5f18549940abf2a4ab5c75fccdd77_r.png" alt="" /></p><p>é¦–å…ˆï¼Œç›´æ¥é€šè¿‡ ã€\nã€ è¿™ä¸ªé€šç”¨æ¢è¡Œç¬¦è¿›è¡Œ Split è·å–æ–‡å­—è¡Œæ•°ï¼Œç†è®ºä¸Šè·Ÿ UILineInfo æ•°é‡ä¸€è‡´ã€‚</p><p>ç„¶åå¾ªç¯ä¿®æ”¹ï¼Œæ³¨æ„åœ¨å–æ¯ä¸€è¡Œæ–‡å­—çš„æ—¶å€™ï¼ŒåŒæ ·å¢åŠ ç­›é™¤å¯Œæ–‡æœ¬æ•°æ®åˆ¤æ–­å³å¯ã€‚</p><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-21/m_6024846ceddaf0a1df8ca1aa026afa47_r.png" alt="" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰å¬åˆ°è¿è¥é‚£è¾¹æŠ¥æˆ‘ä»¬æ¸¸æˆå¯èƒ½ä¼šå‡ºç°å´©æºƒé—®é¢˜ï¼Œä¸»è¦æ˜¯éŸ©æœï¼Œä¸‰æ˜Ÿæœºå™¨ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æ‹¿äº†æ—¥å¿—æ¥çœ‹ï¼Œä¸»è¦ä¿¡æ¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;2022-07-</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="é—®é¢˜" scheme="https://cwhisme.github.io/categories/Unity3D/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="é—®é¢˜è®°å½•" scheme="https://cwhisme.github.io/tags/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºæ±‰å®¤å¤å…´å‡çº§Unity2021çš„é—®é¢˜è®°å½•</title>
    <link href="https://cwhisme.github.io/2022/07/20/%E5%85%B3%E4%BA%8E%E6%B1%89%E5%AE%A4%E5%A4%8D%E5%85%B4%E5%8D%87%E7%BA%A7Unity2021%E7%9A%84%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>https://cwhisme.github.io/2022/07/20/%E5%85%B3%E4%BA%8E%E6%B1%89%E5%AE%A4%E5%A4%8D%E5%85%B4%E5%8D%87%E7%BA%A7Unity2021%E7%9A%84%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</id>
    <published>2022-07-19T16:00:00.000Z</published>
    <updated>2022-12-22T03:29:48.147Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€-ugui"><a class="anchor" href="#ä¸€-ugui">#</a> ä¸€ã€UGUI</h2><ol><li><h3 id="è¶…é“¾æ¥"><a class="anchor" href="#è¶…é“¾æ¥">#</a> è¶…é“¾æ¥</h3><p><font color=blue>å·²è§£å†³</font>ï¼Œè¶…é“¾æ¥ç‚¹å‡»è¿”å›å‰”é™¤å¯Œæ–‡æœ¬ä¿¡æ¯</p><p>è¯¦ç»†å¯è§å¦ä¸€ç¯‡æ–‡æ¡£ï¼š<a href="">å¤„ç† Unity2019 çš„ UGUI é¡¶ç‚¹æ•°æ®æ›´æ–°åçš„å›¾æ–‡æ··æ’é—®é¢˜</a></p></li><li><h3 id="å›¾æ–‡æ··æ’"><a class="anchor" href="#å›¾æ–‡æ··æ’">#</a> å›¾æ–‡æ··æ’</h3><p><font color=blue>å·²è§£å†³</font>ï¼Œè®¡ç®—è¡¨æƒ…ç»˜åˆ¶ä¸‹æ ‡æ—¶å‰”é™¤è¡¨æƒ…æ ‡ç­¾ã€å‰”é™¤å¯Œæ–‡æœ¬ä¿¡æ¯</p><p>è¯¦ç»†å¯è§å¦ä¸€ç¯‡æ–‡æ¡£ï¼š<a href="">å¤„ç† Unity2019 çš„ UGUI é¡¶ç‚¹æ•°æ®æ›´æ–°åçš„å›¾æ–‡æ··æ’é—®é¢˜</a></p></li><li><h3 id="ç«–è¡Œæ’ç‰ˆ"><a class="anchor" href="#ç«–è¡Œæ’ç‰ˆ">#</a> ç«–è¡Œæ’ç‰ˆ</h3><p>ç”±äº Unity æœ¬èº«æä¾›çš„ UILineInfo åŒ…å«äº†æ¢è¡Œç¬¦ä¿¡æ¯ã€è€Œé¡¶ç‚¹æ•°æ®å¹¶ä¸åŒ…æ‹¬å¯¼è‡´ã€‚</p><p><font color=blue>å·²è§£å†³</font>ï¼Œè‡ªè¡Œé€šè¿‡ã€\nã€ åˆ†å‰²æ–‡æœ¬ï¼Œå¹¶å‰”é™¤å¯Œæ–‡æœ¬ä¿¡æ¯å†ä½œè®¡ç®—ã€‚</p><p>è¯¦ç»†å¯è§å¦ä¸€ç¯‡æ–‡æ¡£ï¼š<a href="">å¤„ç† Unity2019 çš„ UGUI é¡¶ç‚¹æ•°æ®æ›´æ–°åçš„å›¾æ–‡æ··æ’é—®é¢˜</a></p></li><li><h3 id="aortextincsprites-ç¼ºå°‘æœ€åä¸€ä½å†…å®¹"><a class="anchor" href="#aortextincsprites-ç¼ºå°‘æœ€åä¸€ä½å†…å®¹">#</a> AorTextIncSprites ç¼ºå°‘æœ€åä¸€ä½å†…å®¹</h3><p><img data-src="/blogimages/2022/2022-07-20/m_439c7a477ded75b326cac421a41d65fd_r.png" alt="" /></p><p>æŸ¥çœ‹ä»£ç ï¼Œå¹¶ç»è¿‡è°ƒè¯•ï¼Œæœ€åå‘ç°æ˜¯å› ä¸ºç»˜åˆ¶æ—¶æ‰‹åŠ¨å‡æ‰äº†æœ€å 4 ä½é¡¶ç‚¹ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//Last 4 verts are always a new line...</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">int</span></span> vertCount <span class="token operator">=</span> verts<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¿™é‡Œæ ¹æ®æ³¨é‡Šï¼Œå°±å¯ä»¥æ˜ç™½äº†ï¼Œæœ€åä¸€ä½ä»¥å‰æ˜¯å½“æ¢è¡Œç¬¦å»æ‰äº†ï¼Œæ–°ç‰ˆé¡¶ç‚¹å¹¶æ— è¿™äº›ä¿¡æ¯ï¼Œä¸å†å‡å» 4 ä¸ªé¡¶ç‚¹å³å¯ã€‚</p></li><li><h3 id="è¡Œå†›çº¿ç»˜åˆ¶"><a class="anchor" href="#è¡Œå†›çº¿ç»˜åˆ¶">#</a> è¡Œå†›çº¿ç»˜åˆ¶</h3><p>ä½¿ç”¨ UGUI + è‡ªå®šä¹‰ Shader å®ç°</p><p>ç”±äºè‡ªå®šä¹‰ UGUI é¡¶ç‚¹ç»˜åˆ¶ï¼Œæ–°ç‰ˆ Unity æ— æ³•æ­£å¸¸å·¥ä½œï¼Œé€šè¿‡ç¦ç”¨ raycastTarget å¯ä»¥é¿å…æŠ¥é”™ï¼Œèµ°ä¸Šæ­£å¸¸é€»è¾‘ï¼Œä½†ä¸å¯è§ã€‚</p><ul><li>2022.7.22 æ‰“å‡ºæ¥çœŸæœºåŒ…å¯è§ï¼Œæ­¤æ—¶æš‚æ—¶å¯æ’é™¤é¡¶ç‚¹ç»˜åˆ¶å‡½æ•°æœ¬èº«é€»è¾‘ä¸å…¼å®¹å«Œç–‘</li><li>åè¿›è¡Œè°ƒè¯•ï¼Œå‘ç°æ–°æ–°å†›çº¿ç»˜åˆ¶ä»£ç  OnPopulateMesh æ— è°ƒç”¨</li><li>åæŸ¥è¯¢ UGUI Graphic æºç ï¼Œå¾—çŸ¥æ›´æ–°æ¡ä»¶éœ€è¦ CanvasRender<br /><img data-src="/blogimages/2022/2022-07-20/m_d50be37f3cd0c49e815f66e70b787669_r.png" alt="" /></li><li>å¹¶ç»è°ƒè¯•æŸ¥è¯¢ï¼Œå‘ç°å†…éƒ¨æœ‰ç¼ºå¤± CanvasRender æŠ¥é”™<br /><img data-src="/blogimages/2022/2022-07-20/m_c943e0bf3357ca87f645cd426145353d_r.png" alt="" /></li><li>ç”±æ­¤å¯çŸ¥ CanvasRender æ˜¯ä¸€ä¸ªå…³é”®ç‚¹</li><li>å°è¯•è¿è¡Œæ—¶æ‰‹åŠ¨æ·»åŠ ï¼Œæ— æ•ˆ</li><li>å°è¯•æŒ‰ç…§æºç è§„åˆ™è°ƒç”¨ï¼Œå‘ç°è·å–å¤±è´¥<br /><img data-src="/blogimages/2022/2022-07-20/m_7ecd4aafe84f4752c9fe73b537f8d171_r.png" alt="" /></li><li>ä¸”ä¿®æ”¹è°ƒç”¨æ–¹å¼  <code>gameObject.GetComponent&lt;CanvasRenderer&gt;()</code>  å¯ä»¥è·å–<br /><img data-src="/blogimages/2022/2022-07-20/m_d85b58ad27084a3c2efae6d069e95f63_r.png" alt="" /></li><li>è¯¥ç±»ç›´æ¥æ”¾ç½®äºå¦ä¸€ä¸ªç±»è„šæœ¬ä¸­ï¼ŒæŒ‰ç†è¯´æŒ‚è½½çš„è„šæœ¬éƒ½æ˜¯å•ç‹¬ä¸€ä¸ªç±»ï¼Œä¸”ç±»åéœ€ä¸ä»£ç æ–‡ä»¶åä¸€è‡´ï¼Œæ€€ç–‘æ˜¯å¦å› æ­¤é—®é¢˜å¯¼è‡´ (<font color=red>å°è¯•åè¡¨æ˜äºæ­¤æ— å…³</font>)</li><li>è¯•å›¾æ·»åŠ æ­¤ç»˜åˆ¶ç»„ä»¶å‰ï¼Œå…ˆæ·»åŠ  CanvasRenderï¼Œcull ç½®ä¸º false</li></ul><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre>obj<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CanvasRenderer<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cull <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr></table></figure><p><font color=blue>å·²è§£å†³</font><br /><img data-src="/blogimages/2022/2022-07-20/m_33c2313e54dd4d1f7cb1dc921dec1a06_r.png" alt="" /></p><p>æ³¨ï¼šå…¶å® UGUI æºä»£ç ä¸­ï¼Œå¯¹äº CanvasRenderer çš„è·å–ï¼Œä¹Ÿæ˜¯åšäº†é¢å¤–åˆ¤æ–­çš„ï¼Œè‹¥è·å–ç©ºåˆ™ä¼šæ·»åŠ ï¼Œä¸æ¸…æ¥šæ˜¯ä»€ä¹ˆæ¡ä»¶é€ æˆäº†æ·»åŠ ä»£ç æ— æ•ˆçš„ã€‚<br /><img data-src="/blogimages/2022/2022-07-20/m_b47fe4fe20e60f187a188c892533a313_r.png" alt="" /></p></li><li><h3 id="aoruistage-è‡ªé€‚åº”å­èŠ‚ç‚¹é•¿å®½ä¸º-nan"><a class="anchor" href="#aoruistage-è‡ªé€‚åº”å­èŠ‚ç‚¹é•¿å®½ä¸º-nan">#</a> AorUIStage# è‡ªé€‚åº”å­èŠ‚ç‚¹é•¿å®½ä¸º NaN</h3><p>å¯ç¡®å®šç”± AorUiRuntimeUtility åŠ¨æ€åˆ›å»º AorUIStage# åï¼Œå†åŠ¨æ€åˆ›å»ºå¯è‡ªé€‚åº”å¤§å°çš„ MainLayer å­å®¹å™¨å¯¼è‡´</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//AorUIStage</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name">GameObject</span> stage <span class="token operator">=</span> <span class="token function">CreatePrefab_UIBase</span><span class="token punctuation">(</span>canv<span class="token punctuation">.</span>transform<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">512f</span><span class="token punctuation">,</span> <span class="token number">512f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>stage<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"AorUIStage#"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//AorUIStage.mainLayer</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token class-name">GameObject</span> ml <span class="token operator">=</span> <span class="token function">CreatePrefab_UIBase</span><span class="token punctuation">(</span>stage<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>ml<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"MainLayer"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token class-name">GameObject</span> tl <span class="token operator">=</span> <span class="token function">CreatePrefab_UIBase</span><span class="token punctuation">(</span>stage<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>tl<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"TopLayer"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¿®æ”¹ AorUIManager updateStageSize æ–¹æ³•ï¼Œå¢åŠ é‡ç½®è®¡ç®—</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">updateStageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span>Application<span class="token punctuation">.</span>isEditor <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Application<span class="token punctuation">.</span>isPlaying<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isAwakeInit <span class="token operator">||</span> <span class="token operator">!</span>isInit<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">switch</span> <span class="token punctuation">(</span>_scaleMode<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">case</span> ScaleModeType<span class="token punctuation">.</span>widthBase<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">set2WidthBaseMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">case</span> ScaleModeType<span class="token punctuation">.</span>heightBase<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token function">set2HeightBaseMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">case</span> ScaleModeType<span class="token punctuation">.</span>fitScreen<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token function">set2FitScreenMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">case</span> ScaleModeType<span class="token punctuation">.</span>envelopeScreen<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token function">set2EnvelopeScreenMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">default</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// å‡çº§ 2019 åï¼Œè‡ªé€‚åº”å­èŠ‚ç‚¹ä¼šå‡ºç°é—®é¢˜ï¼Œè¿™é‡Œå¼ºåˆ¶é‡è®¾ä¸€æ¬¡</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Stage<span class="token punctuation">.</span>childCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token class-name">RectTransform</span> rt <span class="token operator">=</span> Stage<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token class-name">RectTransform</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>rt<span class="token punctuation">.</span>anchoredPosition <span class="token operator">=</span> Vector2<span class="token punctuation">.</span>zero<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>rt<span class="token punctuation">.</span>sizeDelta <span class="token operator">=</span> Vector2<span class="token punctuation">.</span>zero<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><font color=blue>å·²è§£å†³</font><br />æ³¨ï¼šè§£å†³æ–¹å¼åº”å½“ä¸æ­¢è¿™ç§ã€‚</p></li></ol><h2 id="äºŒ-socket-è¿æ¥"><a class="anchor" href="#äºŒ-socket-è¿æ¥">#</a> äºŒã€Socket è¿æ¥</h2><p>åœ¨ç¼–è¾‘å™¨ / çœŸæœºåŒ… è¿”å›ç™»å½•ç•Œé¢æ—¶è§¦å‘ã€‚</p><p><img data-src="/blogimages/2022/2022-07-20/m_ed85e95c10d4bbb8684ab4b6b7720062_r.png" alt="" /></p><p>æŸ¥è¯¢æ˜¯ç”±äºè°ƒç”¨  <code>socket.Disconnect(true);</code>  å¯¼è‡´ï¼Œä¼°è®¡æ˜¯ä»¥å‰æƒ³å¤ç”¨ Socket å®ä¾‹ï¼Œä¸è¿‡æŸ¥äº†ä¸‹ä»£ç ï¼Œæ¯æ¬¡ open å®é™…ä¸Šéƒ½æ˜¯é‡æ–°åˆ›å»ºçš„ä¸€ä¸ªï¼Œå°† Disconnect çš„è°ƒç”¨æ›¿æ¢ä¸ºå¦‚ä¸‹ä»£ç è§£å†³ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">try</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    socket<span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span>SocketShutdown<span class="token punctuation">.</span>Both<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">//Do Nothing</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>socket<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="ä¸‰-è‡ªå®šä¹‰dllçš„åº“æ–‡ä»¶å¼•ç”¨"><a class="anchor" href="#ä¸‰-è‡ªå®šä¹‰dllçš„åº“æ–‡ä»¶å¼•ç”¨">#</a> ä¸‰ã€è‡ªå®šä¹‰ DLL çš„åº“æ–‡ä»¶å¼•ç”¨</h2><p><font color=blue>å·²è§£å†³</font></p><p>DLL æ¡†æ¶ç‰ˆæœ¬è®¾ç½®ä¸º 4.0 ä»¥ä¸Š (æˆ‘æ˜¯ 4.5)</p><p>å¹¶é‡æ–°åˆ†æ•£å¼•ç”¨ Unity å†…éƒ¨ DLLï¼Œè·¯å¾„ä½äºå¯¹åº” Unity å®‰è£…ç›®å½•</p><p><a href="">Unity 2021.3.0f1\Editor\Data\Managed\UnityEngine</a></p><p>æ³¨ï¼šé‡æ–°å¼•ç”¨åæ³¨æ„ä¿®æ”¹ DLL å¤åˆ¶æœ¬åœ° ä¸º false</p><h2 id="å››-æ‰“-assetbundle-åŒ…å‡ºç°èµ„æºåå¤importé—®é¢˜"><a class="anchor" href="#å››-æ‰“-assetbundle-åŒ…å‡ºç°èµ„æºåå¤importé—®é¢˜">#</a> å››ã€æ‰“ Assetbundle åŒ…å‡ºç°èµ„æºåå¤ Import é—®é¢˜</h2><p>è¡¨ç°ä¸ºåˆå§‹åŒ–ç¯å¢ƒæ—¶ï¼Œè¿˜æ²¡è½®åˆ°æ­£å¼æ‰“ Assetbundleï¼Œæ¯ä¸ª prefab çš†å‡ºç° Import æç¤º</p><p>ç»è¿‡è°ƒè¯•ï¼Œå‘ç°æ–°ç‰ˆ Unity åœ¨æ¯æ¬¡æ‰“åŒ…ä¹‹å‰é‡è®¾æ ‡ç­¾æ—¶ï¼Œéƒ½ä¼šå¯¼è‡´é‡æ–°å¯¼å…¥ä¸€æ¬¡èµ„æºï¼Œå¢åŠ å¤§é‡é¢å¤–æ—¶é—´æ¶ˆè€—ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_84ff6d5065eaba746ae2036b355a1e39_r.png" alt="" /></p><p><font color=blue>å·²è§£å†³</font>ï¼Œé‡è®¾æ ‡ç­¾æ—¶ï¼Œåˆ¤æ–­æ—§æ ‡ç­¾æ˜¯å¦ä¸æ–°æ ‡ç­¾ä¸€è‡´ã€‚</p><p>ä»£ç ä½äº AssetBundleTool AddLabel</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddLabel</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> label<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">//ClearLabel(obj);</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token class-name">UnityEngine<span class="token punctuation">.</span>Object</span> _object <span class="token operator">=</span> obj<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> _object<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span> _labelList <span class="token operator">=</span> AssetDatabase<span class="token punctuation">.</span><span class="token function">GetLabels</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token comment">// å¯¹è±¡ç›®å‰å·²æœ‰æ ‡ç­¾ä¸è®¾ç½®æ ‡ç­¾ä¸ä¸€è‡´ï¼Œæˆ–è€…å¯¹è±¡æ‹¥æœ‰å¤šä¸ªæ ‡ç­¾ (ä¸åˆæ³•)ï¼Œåˆ™é‡è®¾æ ‡ç­¾</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_labelList<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span> <span class="token operator">||</span> _labelList<span class="token punctuation">.</span>Count <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            <span class="token function">ClearLabel</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            AssetDatabase<span class="token punctuation">.</span><span class="token function">SetLabels</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">&#123;</span> label <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">// å¦‚æœè¿™ä¸ªç‰©ä½“æœ¬æ¥å°±æœ‰æŒ‡å®šçš„ labelï¼Œå°±ä¸éœ€è¦é‡å¤å¤„ç†äº†</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token comment">//AssetDatabase.SetLabels(obj, _labelList.ToArray());</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ³¨ï¼šæ–¹æ³•å¼€å£æœ‰è°ƒç”¨ ClearLabelï¼Œå¯çŸ¥ä¸€ä¸ªå¯¹è±¡åªä¼šå­˜åœ¨ä¸€ä¸ªæ ‡ç­¾ï¼Œå› æ­¤æ­¤å¤„ç›´æ¥åˆ¤æ–­è®¾ç½®æ ‡ç­¾æ˜¯å¦ç›¸ç­‰å³å¯ã€‚</p><h2 id="äº”-æ‰“-assetbundle-åŒ…å´©æºƒ"><a class="anchor" href="#äº”-æ‰“-assetbundle-åŒ…å´©æºƒ">#</a> äº”ã€æ‰“ Assetbundle åŒ…å´©æºƒ</h2><p>æŸ¥è¯¢æ—¥å¿—å¾—å‡ºä¸ºæ ˆæº¢å‡ºï¼š</p><pre><code>Couldn't extract exception string from exception of type StackOverflowException (another exception of class 'StackOverflowException' was thrown while processing the stack trace)StackOverflowException: The requested operation caused a stack overflow.  at (wrapper managed-to-native) System.String.FastAllocateString(int)  at System.String.CreateStringFromEncoding (System.Byte* bytes, System.Int32 byteLength, System.Text.Encoding encoding) [0x00013] in &lt;6073cf49ed704e958b8a66d540dea948&gt;:0   at System.Text.Encoding.GetString (System.Byte* bytes, System.Int32 byteCount) [0x00033] in &lt;6073cf49ed704e958b8a66d540dea948&gt;:0   at System.Text.Encoding.GetString (System.ReadOnlySpan`1[T] bytes) [0x00013] in &lt;6073cf49ed704e958b8a66d540dea948&gt;:0   at System.String.Ctor (System.SByte* value, System.Int32 startIndex, System.Int32 length, System.Text.Encoding enc) [0x0006d] in &lt;6073cf49ed704e958b8a66d540dea948&gt;:0   at System.String.CreateString (System.SByte* value, System.Int32 startIndex, System.Int32 length, System.Text.Encoding enc) [0x00000] in &lt;6073cf49ed704e958b8a66d540dea948&gt;:0   at (wrapper managed-to-managed) System.String..ctor(sbyte*,int,int,System.Text.Encoding)  at UnityEngine.StackTraceUtility.ExtractStackTrace () [0x0002c] in &lt;1332c534a8a44623b2e5cc943a0b790e&gt;:0   at (wrapper managed-to-native) UnityEngine.DebugLogHandler.Internal_Log(UnityEngine.LogType,UnityEngine.LogOption,string,UnityEngine.Object)  at UnityEngine.DebugLogHandler.LogFormat (UnityEngine.LogType logType, UnityEngine.Object context, System.String format, System.Object[] args) [0x0000b] in &lt;1332c534a8a44623b2e5cc943a0b790e&gt;:0   at UnityEngine.Logger.Log (UnityEngine.LogType logType, System.Object message) [0x00027] in &lt;1332c534a8a44623b2e5cc943a0b790e&gt;:0   at UnityEngine.Debug.Log (System.Object message) [0x00006] in &lt;1332c534a8a44623b2e5cc943a0b790e&gt;:0   at EditorAssetData.caculateTop () [0x00123] in D:\[Works]\sanguo_release\Unity\Assets\Scripts\Editor\AssetBundleTool\EditorAssetData.cs:184   at EditorAssetData.caculateTop () [0x0013a] in D:\[Works]\sanguo_release\Unity\Assets\Scripts\Editor\AssetBundleTool\EditorAssetData.cs:185   at EditorAssetData.caculateTop () [0x0013a] in D:\[Works]\sanguo_release\Unity\Assets\Scripts\Editor\AssetBundleTool\EditorAssetData.cs:185 //ä½™ä¸‹çœç•¥========================================================//ä½™ä¸‹çœç•¥========================================================//ä½™ä¸‹çœç•¥========================================================</code></pre><p>æŸ¥è¯¢ä»£ç å¯çŸ¥ä¸ºé€’å½’è·å–ä¸Šçº§å¼•ç”¨é—®é¢˜ã€‚</p><p>ç»è¿‡è°ƒè¯•å¯å‘ç°å‡ºç°é—®é¢˜è€…ï¼Œçš†ä¸ºåç§°ä¸æœ¬èº«ä¸ä¸€è‡´çš„å¯¹è±¡ã€‚</p><p>å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_139eb538f8271f47380e2d84617d883e_r.png" alt="" /></p><p>å‡ºç°é—®é¢˜çš„åŸå› ï¼Œå¤šä¸ºç¾æœ¯ (ç‰¹æ•ˆ)ï¼ŒåŸå› æƒ³æ¥å¾ˆç®€å•ï¼Œç¾æœ¯ç›´æ¥å•çº¯å¤åˆ¶å¯¹è±¡ï¼Œæœªåšæ­£ç¡®æ“ä½œã€‚</p><p>ç”±æ­¤å¯ä»¥å¾—å‡ºç»“è®ºï¼Œè€ç‰ˆæœ¬ Unity å¯èƒ½ç›´æ¥æœ‰ä¸€å¥—å…¼å®¹æœºåˆ¶å¤„ç†ï¼Œæ–°ç‰ˆ Unity ç›´æ¥å´©æ‰äº†ã€‚</p><p><font color=blue>å·²è§£å†³</font>ï¼Œé€šè¿‡æ£€æµ‹é€’å½’å±‚æ•°ï¼Œäººä¸ºé™åˆ¶ï¼Œæ•°é‡è¶…å‡ºä¸Šé™åˆ™æ‰“å°é”™è¯¯ä¿¡æ¯ï¼Œä»¥ä¾¿ä¿®å¤ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">int</span></span> _stackOverflowCheck <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">/// ä¸€ç›´å‘ä¸Šé€’å½’ï¼Œç›´åˆ°ä¸Šçº§èµ„æºçš„ä¸Šçº§èµ„æºæ•°ä¸º 0 æˆ–ä¸Šçº§èµ„æºä¸º BuildSingle</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>EditorAssetData<span class="token punctuation">></span></span> <span class="token function">caculateTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>        _stackOverflowCheck<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>_stackOverflowCheck <span class="token operator">></span> <span class="token number">50</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            Debug<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span>LoadPath<span class="token operator">+</span> <span class="token string">" è¶…å‡ºé€’å½’é™åˆ¶ä¸Šé™ï¼Œå¯èƒ½å·²ç»å‡ºç°äº†é—®é¢˜ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token keyword">return</span> TopUpDependenceList<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_bf2570478c346c0d6c1a2d47ee5f736b_r.png" alt="" /></p><h2 id="å…­-æŠ¥-load-il2cpp-å¤±è´¥"><a class="anchor" href="#å…­-æŠ¥-load-il2cpp-å¤±è´¥">#</a> å…­ã€æŠ¥ load IL2CPP å¤±è´¥</h2><p><img data-src="/blogimages/2022/2022-07-20/m_8762aae7da2cb29ab3583dabea704121_r.png" alt="" /></p><p>é€šè¿‡ ADB æ‹‰å–çš„æ—¥å¿—æŸ¥çœ‹ï¼Œä¸€å † Could not load symbol XXX çš„é”™è¯¯</p><p><img data-src="/blogimages/2022/2022-07-20/m_e8ed695b5fa9785369ba71cb85935c29_r.png" alt="" /></p><p>ç»è¿‡å¯¹ Unity å¯¼å‡ºèµ„æºçš„ç›®å½•çš„å¯¹æ¯”ï¼Œå‘ç°æ–°ç‰ˆèµ„æºè·¯å¾„éƒ½å·²ç»ä¸ä¸€æ ·äº†ï¼Œå¤šäº†ä¸ºä¸¤ä¸ªç›®å½• ã€Il2CppOutputProjectã€ã€ã€jniStaticLibsã€, ä¸” jniLibs ç›®å½•ä¸­å°‘äº† <span class="exturl" data-url="aHR0cDovL2xpYmlsMmNwcC5zbw==">libil2cpp.so</span>ï¼Œ</p><p><img data-src="/blogimages/2022/2022-07-20/m_96b794a490972af66945b171a97c4079_r.png" alt="" /><br /><img data-src="/blogimages/2022/2022-07-20/m_549ebbffb5d4210739a18c17ccf60f91_r.png" alt="" /></p><p>ç»è¿‡æŸ¥è¯¢ä¿¡æ¯è¡¨ç¤ºï¼Œæ–°ç‰ˆ Unity å¯¼å‡ºçš„ AndroidStudio å·¥ç¨‹ï¼Œä¸å†ç¼–è¯‘ <span class="exturl" data-url="aHR0cDovL2xpYmlsMmNwcC5zbw==">libil2cpp.so</span> ï¼Œè€Œæ˜¯ç›´æ¥æä¾›æºç ï¼Œå¾—è‡ªå·±å¤„ç†ç¼–è¯‘çš„åŠŸèƒ½ã€‚</p><p>æ‰“å¼€å¯¼å‡ºçš„èµ„æº unityLibrary ç›®å½•ä¸‹çš„ build.gradleï¼Œå…¶ä¸­å°±æœ‰ç¼–è¯‘çš„ä»£ç ï¼š</p><p>// çœç•¥</p><p>å°†å…¶å¤åˆ¶åˆ°æˆ‘ä»¬çš„ SDK ä¸‹ build.gradle ä¸­å¯¹åº”ä½ç½®ï¼Œå¹¶ä¾ç…§æˆ‘ä»¬é¡¹ç›®ä½œå‡ºéƒ¨åˆ†ä¿®æ”¹ï¼š</p><pre><code>android &#123;//å·²æœ‰ä»£ç //çœç•¥//çœç•¥    aaptOptions &#123;        noCompress = ['.unity3d', '.ress', '.resource', '.obb', '.bundle', '.unityexp','.assetbundle']    &#125;    packagingOptions &#123;        doNotStrip '*/armeabi-v7a/*.so'        doNotStrip '*/arm64-v8a/*.so'    &#125;    task BuildIl2CppTask &#123;        doLast &#123;            BuildIl2Cpp(project(':UnitySdk').projectDir.toString().replaceAll('\\\\', '/'), 'Release', 'armv7', 'armeabi-v7a', [  ] as String[]);            BuildIl2Cpp(project(':UnitySdk').projectDir.toString().replaceAll('\\\\', '/'), 'Release', 'arm64', 'arm64-v8a', [  ] as String[]);        &#125;    &#125;    afterEvaluate &#123;        if (project(':UnitySdk').tasks.findByName('mergeDebugJniLibFolders'))            project(':UnitySdk').mergeDebugJniLibFolders.dependsOn BuildIl2CppTask        if (project(':UnitySdk').tasks.findByName('mergeReleaseJniLibFolders'))            project(':UnitySdk').mergeReleaseJniLibFolders.dependsOn BuildIl2CppTask    &#125;    sourceSets &#123;        main &#123;            jni.srcDirs = [&quot;src/main/Il2CppOutputProject&quot;]        &#125;    &#125;&#125;def getSdkDir() &#123;    Properties local = new Properties()    local.load(new FileInputStream(&quot;$&#123;rootDir&#125;/local.properties&quot;))    return local.getProperty('sdk.dir')&#125;def BuildIl2Cpp(String workingDir, String configuration, String architecture, String abi, String[] staticLibraries) &#123;    def commandLineArgs = []    commandLineArgs.add(&quot;--compile-cpp&quot;)    commandLineArgs.add(&quot;--platform=Android&quot;)    commandLineArgs.add(&quot;--architecture=&quot; + architecture)    commandLineArgs.add(&quot;--outputpath=&quot; + workingDir + &quot;/src/main/jniLibs/&quot; + abi + &quot;/libil2cpp.so&quot;)    commandLineArgs.add(&quot;--libil2cpp-static&quot;)    commandLineArgs.add(&quot;--baselib-directory=&quot; + workingDir + &quot;/src/main/jniStaticLibs/&quot; + abi)    commandLineArgs.add(&quot;--incremental-g-c-time-slice=3&quot;)    commandLineArgs.add(&quot;--configuration=&quot; + configuration)    commandLineArgs.add(&quot;--dotnetprofile=unityaot-linux&quot;)    commandLineArgs.add(&quot;--profiler-report&quot;)    commandLineArgs.add(&quot;--profiler-output-file=&quot; + workingDir + &quot;/build/il2cpp_&quot;+ abi + &quot;_&quot; + configuration + &quot;/il2cpp_conv.traceevents&quot;)    commandLineArgs.add(&quot;--print-command-line&quot;)    commandLineArgs.add(&quot;--generatedcppdir=&quot; + workingDir + &quot;/src/main/Il2CppOutputProject/Source/il2cppOutput&quot;)    commandLineArgs.add(&quot;--cachedirectory=&quot; + workingDir + &quot;/build/il2cpp_&quot;+ abi + &quot;_&quot; + configuration + &quot;/il2cpp_cache&quot;)    commandLineArgs.add(&quot;--tool-chain-path=&quot; + android.ndkDirectory)    staticLibraries.eachWithIndex &#123;fileName, i-&gt;        commandLineArgs.add(&quot;--additional-libraries=&quot; + workingDir + &quot;/src/main/jniStaticLibs/&quot; + abi + &quot;/&quot; + fileName)    &#125;    def executableExtension = &quot;&quot;    if (org.gradle.internal.os.OperatingSystem.current().isWindows())        executableExtension = &quot;.exe&quot;    exec &#123;        executable workingDir + &quot;/src/main/Il2CppOutputProject/IL2CPP/build/deploy/il2cpp&quot; + executableExtension        args commandLineArgs        environment &quot;ANDROID_SDK_ROOT&quot;, getSdkDir()    &#125;    delete workingDir + &quot;/src/main/jniLibs/&quot; + abi + &quot;/libil2cpp.sym.so&quot;    ant.move(file: workingDir + &quot;/src/main/jniLibs/&quot; + abi + &quot;/libil2cpp.dbg.so&quot;, tofile: workingDir + &quot;/symbols/&quot; + abi + &quot;/libil2cpp.so&quot;)&#125;</code></pre><p>é‡æ–°æ‰§è¡Œ AS æ‰“åŒ…æ“ä½œ â€”â€” å‘ç° jniLibs æ ¹æœ¬æ²¡æœ‰ç”Ÿæˆå¯¹åº”çš„ <span class="exturl" data-url="aHR0cDovL2xpYmlsMmNwcC5zbw==">libil2cpp.so</span> æ–‡ä»¶ï¼Œå¯¼è‡´æœ€ç»ˆå‡ºæ¥çš„åŒ…è¿˜æ˜¯æœ‰é—®é¢˜ã€‚</p><p>ç»è¿‡ä¸ SDK åŒå­¦ä¸€å—æ£€æŸ¥ï¼Œå‘ç°æˆ‘è¿™è¾¹æ˜¯å‡ºåŒ…çš„æ—¶å€™æ ¹æœ¬æ²¡æ‰§è¡Œ BuildIl2CppTask ä»£ç ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_14c2730fb3ca0de83e909f8f7ae89491_r.png" alt="" /></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå°±ç®—å¦‚æœå¢åŠ äº†ä¸Šè¿°ä»£ç ï¼Œè¦æ˜¯æŒ‰ç…§æ­£å¸¸æµç¨‹æ‰“åŒ…ï¼ŒBuildIl2CppTask ä¼šä¸æ‰§è¡Œï¼Œåè¾¹ç»è¿‡ç ”ç©¶ï¼Œåªèƒ½æ‰‹åŠ¨æ‰§è¡Œ BuildIl2CppTaskï¼Œæ‰‹åŠ¨æ‰§è¡Œè¾“å‡ºä¹Ÿæ˜¯æ­£å¸¸çš„ (ç»è¿‡ä¸ SDK åŒå­¦è®¨è®ºï¼Œæš‚æ—¶ä¹Ÿæ²¡å‘ç°ä¸ºä½•æ²¡æœ‰è‡ªåŠ¨æ‰§è¡Œçš„åŸå› )ã€‚</p><p><img data-src="/blogimages/2022/2022-07-20/m_569e2fc7995ead8fe321bcc78db6033f_r.png" alt="" /></p><p>è¿™ä¸€æ­¥å°è¯•æˆåŠŸåï¼Œå°±å‡ºäº†æ–°åŒ…æµ‹è¯•ï¼Œç¡®è®¤æ— è¯¯å â€”â€” å¦‚æ­¤ç¬¬ä¸€ä¸ªèƒ½è·‘çš„åŒ…ç»ˆäºå‡ºæ¥äº†ï¼</p><h3 id="æ— æ³•æ­£å¸¸è°ƒç”¨-buildil2cpp-ç¼–è¯‘-libil2cppso"><a class="anchor" href="#æ— æ³•æ­£å¸¸è°ƒç”¨-buildil2cpp-ç¼–è¯‘-libil2cppso">#</a> æ— æ³•æ­£å¸¸è°ƒç”¨ BuildIl2Cpp ç¼–è¯‘ <span class="exturl" data-url="aHR0cDovL2xpYmlsMmNwcC5zbw==">libil2cpp.so</span></h3><p>ä¸Šæ–‡æåˆ°äº†ç›´æ¥å‡ºåŒ…ï¼ŒAS æ ¹æœ¬æ²¡æœ‰æ‰§è¡Œé™„åŠ çš„ BuildIl2CppTask è¿™æ¡ä»»åŠ¡</p><p>è¿™ä¸€æ­¥æ“ä½œè‚¯å®šä¸å¯èƒ½æ‰‹åŠ¨æ‰§è¡Œçš„ï¼Œè€Œä¸”æœ‰æ—¶å€™æ¶‰åŠåˆ°æ—§èµ„æºå‡ºåŒ…ï¼Œå°±ç®—èƒ½å¤ŸæˆåŠŸæ‰§è¡Œï¼Œåå¤ç¼–è¯‘ä¹Ÿæ˜¯è´¹æ—¶é—´çš„éº»çƒ¦äº‹</p><p>äºæ˜¯å‘ SDK åŒå­¦è¦äº†å‘½ä»¤ã€./gradlew BuildIl2CppTaskã€ï¼Œä¿®æ”¹äº†æ‰“åŒ…å·¥å…·ï¼Œç›´æ¥åœ¨å‘ AS å¤åˆ¶èµ„æºä¹‹å‰ï¼Œæ‰§è¡Œä¸€æ¬¡ il2cpp çš„æ£€æŸ¥åŠç¼–è¯‘çš„æ“ä½œï¼Œå¹¶å°†ç”Ÿæˆçš„ <span class="exturl" data-url="aHR0cDovL2xpYmlsMmNwcC5zbw==">libil2cpp.so</span> å¤åˆ¶å›æ¥ä½œèµ„æºç¼“å­˜ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//===== ç¼–è¯‘ il2cpp======</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> packil2CppSources <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>packResRootPath<span class="token punctuation">,</span> <span class="token string">"Il2CppOutputProject"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> packjniStaticLibsPath <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>packResRootPath<span class="token punctuation">,</span> <span class="token string">"jniStaticLibs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> sdkil2CppSources <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>sdkMainPath<span class="token punctuation">,</span> <span class="token string">"Il2CppOutputProject"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> sdkjniStaticLibsPath <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>sdkMainPath<span class="token punctuation">,</span> <span class="token string">"jniStaticLibs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">//libil2cpp.so æ–‡ä»¶</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> packIl2cppv8Files <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>packJniPath<span class="token punctuation">,</span> <span class="token string">"arm64-v8a/libil2cpp.so"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> packIl2cppv7Files <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>packJniPath<span class="token punctuation">,</span> <span class="token string">"armeabi-v7a/libil2cpp.so"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> sdkIl2cppv8Files <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>sdkJniPath<span class="token punctuation">,</span> <span class="token string">"arm64-v8a/libil2cpp.so"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> sdkIl2cppv7Files <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>sdkJniPath<span class="token punctuation">,</span> <span class="token string">"armeabi-v7a/libil2cpp.so"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>sdkIl2cppv8Files<span class="token punctuation">)</span><span class="token punctuation">)</span> File<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>sdkIl2cppv8Files<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>sdkIl2cppv7Files<span class="token punctuation">)</span><span class="token punctuation">)</span> File<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>sdkIl2cppv7Files<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä¸å­˜åœ¨ï¼Œç¼–è¯‘</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>packIl2cppv8Files<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>packIl2cppv7Files<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token comment">// æ¸…ç†å¯èƒ½å­˜åœ¨çš„æ—§æ–‡ä»¶</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Directory<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>sdkil2CppSources<span class="token punctuation">)</span><span class="token punctuation">)</span> Directory<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>sdkil2CppSources<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Directory<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>sdkjniStaticLibsPath<span class="token punctuation">)</span><span class="token punctuation">)</span> Directory<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>sdkjniStaticLibsPath<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token comment">// å¤åˆ¶ il2cpp æºç è¿‡å»</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    FileCompare<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>packil2CppSources<span class="token punctuation">,</span> sdkil2CppSources<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    FileCompare<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>packjniStaticLibsPath<span class="token punctuation">,</span> sdkjniStaticLibsPath<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token comment">// æ­£å¼ç¼–è¯‘</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token class-name"><span class="token keyword">string</span></span> rootSdkDir <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">GetDirectoryName</span><span class="token punctuation">(</span>Info<span class="token punctuation">.</span>AndroidSDKPath<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">// åˆ·æ–°</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token function">DoCmd</span><span class="token punctuation">(</span>rootSdkDir<span class="token punctuation">,</span> <span class="token string">"gradlew"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token comment">// ç¼–è¯‘</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token function">DoCmd</span><span class="token punctuation">(</span>rootSdkDir<span class="token punctuation">,</span> <span class="token string">"gradlew"</span><span class="token punctuation">,</span> <span class="token string">"BuildIl2CppTask"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token comment">// å¤åˆ¶å›æ¥ï¼Œé¿å…ç¬¬äºŒæ¬¡å¤ç”¨æ—¶æ‰“åŒ…é‡å¤ç¼–è¯‘</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>sdkIl2cppv8Files<span class="token punctuation">)</span><span class="token punctuation">)</span> FileCompare<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>sdkIl2cppv8Files<span class="token punctuation">,</span> packIl2cppv8Files<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>sdkIl2cppv7Files<span class="token punctuation">)</span><span class="token punctuation">)</span> FileCompare<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>sdkIl2cppv7Files<span class="token punctuation">,</span> packIl2cppv7Files<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">//================</span></pre></td></tr></table></figure><p>ç»æµ‹è¯•æ–°æµç¨‹å¯ä»¥è·‘é€šã€‚</p><p>æ³¨ï¼šæ­¤å¤„è°ƒç”¨çš„ AS å‘½ä»¤å…¶å®ä¹Ÿæ˜¯è°ƒç”¨å¤–éƒ¨è¿›ç¨‹ç¼–è¯‘ï¼Œæ‰€ä»¥ä¸èµ° AS ï¼Œç›´æ¥æ–°å¼€ä¸€ä¸ªæ§åˆ¶å°å‘½ä»¤ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¿™æ ·è¿˜å¯ä»¥çœä¸‹å¤åˆ¶æºç è‡³ AS çš„æ¶ˆè€—ï¼Œåè¾¹å¯ä»¥è€ƒè™‘ä¼˜åŒ–ã€‚</p><h2 id="ä¸ƒ-å®‰å“åŠ è½½-streamingasset-ç›®å½•èµ„æºå¤±è´¥"><a class="anchor" href="#ä¸ƒ-å®‰å“åŠ è½½-streamingasset-ç›®å½•èµ„æºå¤±è´¥">#</a> ä¸ƒã€å®‰å“åŠ è½½ StreamingAsset ç›®å½•èµ„æºå¤±è´¥</h2><p><img data-src="/blogimages/2022/2022-07-20/m_8e73d862fa40a1c3bee9af2218e13568_r.png" alt="" /></p><p>æŸ¥è¯¢å®˜æ–¹æ–‡æ¡£çœ‹åˆ°å¦‚ä¸‹è¯´æ˜ï¼š</p><blockquote><p>Unity ä¼šå°†æ”¾ç½®åœ¨ Unity é¡¹ç›®ä¸­åä¸º StreamingAssets__ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰çš„æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶é€å­—å¤åˆ¶åˆ°ç›®æ ‡è®¡ç®—æœºä¸Šçš„ç‰¹å®šæ–‡ä»¶å¤¹ã€‚è¦è·å–æ­¤æ–‡ä»¶å¤¹ï¼Œè¯·ä½¿ç”¨ Application.streamingAssetsPath å±æ€§ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œæœ€å¥½ä½¿ç”¨ Application.streamingAssetsPath æ¥è·å– StreamingAssets__ æ–‡ä»¶å¤¹çš„ä½ç½®ï¼Œå› ä¸ºå®ƒæ€»æ˜¯æŒ‡å‘è¿è¡Œåº”ç”¨ç¨‹åºçš„å¹³å°ä¸Šçš„æ­£ç¡®ä½ç½®ã€‚</p></blockquote><blockquote><p>Application.streamingAssetsPath è¿”å›çš„ä½ç½®å› å¹³å°è€Œå¼‚ï¼š</p></blockquote><ul><li>å¤§å¤šæ•°å¹³å°ï¼ˆUnity Editorã€Windowsã€Linux æ’­æ”¾å™¨ã€PS4ã€Xbox Oneã€Switchï¼‰ä½¿ç”¨ Application.dataPath + &quot;/StreamingAssets&quot;ã€‚</li><li>macOS æ’­æ”¾å™¨ä½¿ç”¨ Application.dataPath + &quot;/Resources/Data/StreamingAssets&quot;ã€‚</li><li>iOS ä½¿ç”¨ Application.dataPath + &quot;/Raw&quot;ã€‚</li><li>Android ä½¿ç”¨ç»è¿‡å‹ç¼©çš„ APK/JAR æ–‡ä»¶ä¸­çš„æ–‡ä»¶ï¼š&quot;jar:file://&quot; + Application.dataPath + &quot;!/assets&quot;ã€‚</li></ul><p>å…¶ä¸­å®‰å“çš„è·¯å¾„ï¼Œä¸æ—¥å¿—è¾“å‡ºå¹¶ä¸ä¸€è‡´ï¼Œæ€€ç–‘æ˜¯å¦æ­¤å¤„å¼•èµ·äº†å·®å¼‚ï¼Œäºæ˜¯æŸ¥è¯¢æˆ‘ä»¬é¡¹ç›®å†…ç›¸å…³ä»£ç ï¼Œå‘ç°å¯¹è·å– StreamingAssets æœ‰å¦‚ä¸‹ç»„åˆï¼š</p><ul><li>FResourceCommon GetStreamingAssetsPath æ–¹æ³•</li><li>LauncherLoading GetStreamingAssetsPath æ–¹æ³•</li></ul><p>åŸåˆå§‹åŒ– streamingAssetsPath è·¯å¾„çš„ä»£ç ï¼Œåˆ¤æ–­ä¸ºå®‰å“æ²¡æœ‰ç›´æ¥å–ç³»ç»Ÿ Application.streamingAssetsPathï¼Œè€Œä¸”è‡ªå·±ç»„åˆçš„è·¯å¾„ï¼Œæ–°ç‰ˆ Unity å¯èƒ½ä¸å†å¯¹æ­¤ä½œå…¼å®¹æ€§åˆ¤æ–­ï¼Œå¯¼è‡´æ— æ³•å†ä½¿ç”¨ã€‚</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span>Application<span class="token punctuation">.</span>platform <span class="token operator">==</span> RuntimePlatform<span class="token punctuation">.</span>Android<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    STREAMING_ASSET_PATH <span class="token operator">=</span> Application<span class="token punctuation">.</span>dataPath <span class="token operator">+</span> <span class="token string">"!assets"</span><span class="token punctuation">;</span>   <span class="token comment">// å®‰å“å¹³å°</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">else</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    STREAMING_ASSET_PATH <span class="token operator">=</span> Application<span class="token punctuation">.</span>streamingAssetsPath<span class="token punctuation">;</span>  <span class="token comment">// å…¶ä»–å¹³å°</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>å°†å…¶ä¿®æ”¹ä¸ºç›´æ¥å– Application.streamingAssetsPath åï¼ŒåŠ è½½æ­£å¸¸ã€‚</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre>STREAMING_ASSET_PATH <span class="token operator">=</span> Application<span class="token punctuation">.</span>streamingAssetsPath<span class="token punctuation">;</span>  <span class="token comment">// æ–°ç‰ˆæœ¬æ‰€æœ‰å¹³å°å‡ä½¿ç”¨ streamingAssetsPath</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2022/2022-07-20/m_61eb0f83a4730a6fbe37afb9aedcf0cd_r.png" alt="" /></p><h2 id="å…«-æ— æ³•è°ƒè¯•é—®é¢˜"><a class="anchor" href="#å…«-æ— æ³•è°ƒè¯•é—®é¢˜">#</a> å…«ã€æ— æ³•è°ƒè¯•é—®é¢˜</h2><p>å°† DLL è®¾ç½®ä¸­ï¼Œé«˜çº§ç”Ÿæˆè®¾ç½® -&gt; è°ƒè¯•ä¿¡æ¯ è®¾ç½®ä¸ºå¯ç§»æ¤ï¼Œå¹¶åˆ é™¤é¡¹ç›®ä¸­ DLL å·²æœ‰çš„ MDB æ–‡ä»¶ï¼Œé‡æ–°ç¼–è¯‘ã€‚</p><p><img data-src="/blogimages/2022/2022-07-20/m_1796df03e51bcdc557248e52a4afd5fe_r.png" alt="" /></p><h2 id="ä¹-google-åŒ…é»‘å±é—®é¢˜"><a class="anchor" href="#ä¹-google-åŒ…é»‘å±é—®é¢˜">#</a> ä¹ã€Google åŒ…é»‘å±é—®é¢˜</h2><p>è¡¨ç°ä¸ºé—ªå±åé»‘å±ï¼Œä¸”æœ‰ Debug ä¸”å­˜åœ¨éƒ¨åˆ† Unity è¾“å‡º</p><p><img data-src="/blogimages/2022/2022-07-20/m_7691ecd1cd62499ab0bd4d3f7d6aaa78_r.png" alt="" /></p><p>å¢åŠ æ‰“å°å¹¶æ£€æŸ¥æ—¥å¿—ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_6da6afa2a09a767f8f68adf0363529e2_r.png" alt="" /></p><p>ä»æ—¥å¿—ä¸­åŠå¯¹åº”ä»£ç æ¨æµ‹ï¼Œå¯ä»¥æ¨æµ‹ä¸»è¦æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li><h3 id="æ‰“-google-åŒ…-useobbé€‰é¡¹æœªç”Ÿæ•ˆ"><a class="anchor" href="#æ‰“-google-åŒ…-useobbé€‰é¡¹æœªç”Ÿæ•ˆ">#</a> æ‰“ Google åŒ… UseOBB é€‰é¡¹æœªç”Ÿæ•ˆ</h3></li></ul><p>å…¶ä¸­æ¶‰åŠä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"Launcher Awake + "</span><span class="token operator">+</span> UseOBB<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_ANDROID &amp;&amp; !</span><span class="token return-type class-name">UNITY_EDITOR</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        SDKManager<span class="token punctuation">.</span>Inst<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span>SDKManager<span class="token punctuation">.</span>SEND_HAVE_CUTOUT<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>UseOBB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"Launcher Awake + UseOBB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            <span class="token function">InitGoogleOBBResources</span><span class="token punctuation">(</span>ShowUI<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token punctuation">&#125;</span>                </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token preprocessor property">#<span class="token directive keyword">elif</span> UNITY_IPHONE &amp;&amp; !</span><span class="token return-type class-name">UNITY_EDITOR</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        SDKManager<span class="token punctuation">.</span>Inst<span class="token punctuation">.</span><span class="token function">AddEvent</span><span class="token punctuation">(</span>eSDKMngEvent<span class="token punctuation">.</span>GetDynamicUpdateStateSuccess<span class="token punctuation">,</span> OnGetDynamicUpdateStateSuccess<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        SDKManager<span class="token punctuation">.</span>Inst<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span>SDKManager<span class="token punctuation">.</span>SEND_GET_DYNAMIC_UPDATE_NO<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token preprocessor property">#<span class="token directive keyword">endif</span></span></pre></td></tr></table></figure><p>åœ¨åœºæ™¯çš„ Launcher ä¸Šï¼Œå°±æœ‰ UseOBB è¿™ä¸ªé€‰é¡¹ï¼Œç”¨äºæ§åˆ¶æˆ‘ä»¬æ¸¸æˆå†…æ˜¯å¦èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«ä¸º Google åŒ…</p><p><img data-src="/blogimages/2022/2022-07-20/m_c7e9f51fd6518929d6a9a8174df05d06_r.png" alt="" /></p><p>å¢åŠ æ‰“å°åï¼Œæ­¤å¤„å¼€å§‹ä¸º falseï¼ˆ<font color=red>æ³¨ï¼šä¸Šè¿°æ—¥å¿—æˆªå›¾ä¸ºè§£å†³åçš„è¡¨ç°ï¼Œå› æ­¤æ˜¾ç¤ºä¸º true</font>ï¼‰</p><p>è¿™ä¸ª UseOBB é€‰é¡¹ï¼Œä¹‹å‰æ˜¯åœ¨å‡º Google åŒ…æ—¶ï¼Œé€šè¿‡ä»£ç ç›´æ¥è®¾ç½®çš„ã€‚</p><p>ä½†æ˜¯ç»è¿‡ä¸ªäººåå¤æµ‹è¯•ï¼Œå‘ç°æ–°ç‰ˆ Unity åœ¨ä»£ç è®¾ç½®åœºæ™¯ç‰©ä½“å±æ€§åï¼Œè¯¥é¡¹ä¸ä¼šæ­£å¸¸ç”Ÿæ•ˆï¼</p><p>æœ€ç®€å•çš„é‡ç°æ–¹å¼ä¸ºï¼šä»£ç ä¿®æ”¹åœºæ™¯ç‰©ä½“å±æ€§åï¼Œé‡å¯ Unityï¼Œç‰©ä½“å±æ€§è¢«è¿˜åŸ (å³ä½¿ä¿®æ”¹åè°ƒç”¨ä¿å­˜åœºæ™¯åŠèµ„æºçš„æ¥å£ï¼Œä¾ç„¶æ— æ•ˆ)ã€‚</p><p>è§£å†³æ–¹å¼ä¸ºï¼šå°†å‡ºåŒ…æ—¶è‡ªåŠ¨è®¾ç½® UseOBB å±æ€§å¤„ä¿®æ”¹ä¸ºä¸€ä¸ªåˆ¤æ–­ï¼Œè‹¥å‡ºåŒ…ç±»å‹ä¸º Google OBB æ¨¡å¼ï¼Œä¸” UseOBB æœªå‹¾é€‰ï¼Œå¼¹å‡ºæç¤ºéœ€è¦æ‰‹åŠ¨å‹¾é€‰ä¿å­˜ã€‚</p><ul><li><h3 id="obb-æ— æ³•è¢«ä¸»åº”ç”¨æ­£ç¡®è¯†åˆ«"><a class="anchor" href="#obb-æ— æ³•è¢«ä¸»åº”ç”¨æ­£ç¡®è¯†åˆ«">#</a> OBB æ— æ³•è¢«ä¸»åº”ç”¨æ­£ç¡®è¯†åˆ«</h3></li></ul><p>è¿˜æ˜¯æ ¹æ®ä¸Šè¿°æ—¥å¿—åˆ†æï¼Œçœ‹ç€åƒæ˜¯æ²¡æœ‰æ­£ç¡®è¯†åˆ« OBBï¼Œå¯¼è‡´èµ„æºæœªèƒ½æˆåŠŸåŠ è½½è€ŒæŠ¥ç©ºã€‚</p><p>åœ¨ä¹‹å‰æˆ‘ä»¬ Unity2017 å‡ºåŒ…çš„æ—¶å€™ï¼Œå¯¼å‡ºçš„ AS é¡¹ç›®èµ„æºä¸­ï¼Œå…¶ä¸­ AndroidManifest.xml æ–‡ä»¶å­˜åœ¨ä¸€ä¸ª build-id çš„å­—æ®µã€‚</p><p>ä¸è¿‡æ–°ç‰ˆ Unity å¯¼å‡ºèµ„æºä¸­ï¼ŒAndroidManifest.xml å·²ç»æ²¡æœ‰äº†ï¼Œæ‰€ä»¥å¼€å§‹æ˜¯ç›´æ¥æ‰“çš„åŒ…ã€‚</p><p>2021 å‡çº§æ–‡æ¡£ï¼š <a href="https://docs.unity3d.com/Manual/UpgradeGuide2021LTS.html#Android">Upgrading to Unity 2021 LTS<br /></a></p><p>å…¶ä¸­æœ‰è¿™ä¹ˆä¸€ä¸ªæè¿°ï¼š</p><blockquote><p>Changed how Unity checks to see if an obb is compatible with an apk<br />. Both the apk and obb now have unity_obb_guid file inside them and if the contents match between them, Unity treats them as being compatible.</p></blockquote><p>æ„æ€æ˜¯ç°åœ¨ Unity é€šè¿‡ APK åŠ OBB åŒ…ä¸­çš„ä¸€ä¸ªåä¸º unity_obb_guid æ–‡ä»¶æ¥ç¡®è®¤  APK ä¸ OBB æ˜¯å¦ä¸€è‡´ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä» Unity2021 å¼€å§‹ï¼ŒOBB è¯†åˆ«æœºåˆ¶ä¸èµ° build-id ï¼Œè€Œæ˜¯èµ°å¦å¤–æ–‡ä»¶å¯¹æ¯”äº†ã€‚</p><p>è§£åŒ… OBB åï¼Œæœç„¶å‘ç°äº†è¿™ä¸ªä¸œè¥¿ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_f2c167f2345b8c1745c81e089d5570bd_r.png" alt="" /></p><p>åŒæ—¶æ£€æŸ¥æ‰“åŒ…å‡ºæ¥çš„ APKï¼Œå‘ç°ç¼ºå¤±ï¼Œé€šè¿‡æœç´¢ Unity å¯¼å‡ºèµ„æºç›®å½•ï¼Œå¯å‘ç° APK ä¸­è¯¥æ–‡ä»¶ä½äº unityLibrary\src\main\assets\unity_obb_guid</p><p>åœ¨ä¹‹å‰æˆ‘ä»¬çš„æ‰“åŒ…å·¥å…·ä¸­ï¼Œå¯¹ assets ç›®å½•çš„å†…å®¹åªå¤åˆ¶å…¶å­ç›®å½•ï¼Œå¯¼è‡´ç¼ºäº†æ–‡ä»¶ï¼Œä¿®æ”¹æ‰“åŒ…å·¥å…·ä»£ç ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre>assetPaths <span class="token operator">=</span> Directory<span class="token punctuation">.</span><span class="token function">GetDirectories</span><span class="token punctuation">(</span>packAssetsPath<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> assetPaths<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    FileCompare<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>assetPaths<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sdkAssetsPath <span class="token operator">+</span> assetPaths<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>packAssetsPath<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// å¤åˆ¶ unity_obb_guid æ–‡ä»¶</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> packObbGuidFile <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>packAssetsPath<span class="token punctuation">,</span> <span class="token string">"unity_obb_guid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token class-name"><span class="token keyword">string</span></span> sdkObbGuidFile <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>sdkAssetsPath<span class="token punctuation">,</span> <span class="token string">"unity_obb_guid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>FileCompare<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>packObbGuidFile<span class="token punctuation">,</span> sdkObbGuidFile<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¿™æ—¶å€™æœç„¶å°±å¯ä»¥äº†ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_410dbb6736ddf63920ea3aa14242adb1_r.png" alt="" /></p><h2 id="å-è¿›å‡ºæˆ˜æ–—å´©æºƒ"><a class="anchor" href="#å-è¿›å‡ºæˆ˜æ–—å´©æºƒ">#</a> åã€è¿›å‡ºæˆ˜æ–—å´©æºƒ</h2><p>æœ€åˆè¡¨ç°ä¸ºæ‰“å¼€å¼•å¯¼æ—¶ï¼Œæ¦‚ç‡å‘ç”Ÿäºè¿›å…¥æˆ˜æ–—æ—¶å´©æºƒã€‚</p><p>ç¬¬ä¸€æ¬¡æŸ¥è¯¢çš„å´©æºƒæ—¥å¿—å¦‚ä¸‹ï¼š</p><pre><code>Received signal SIGSEGVObtained 50 stack frames0x00007ff7b5c0aceb (Unity) GameObject::SendMessageAny0x00007ff7b607e835 (Unity) Transform::BroadcastMessageAny0x00007ff7b607e899 (Unity) Transform::BroadcastMessageAny0x00007ff7b607e899 (Unity) Transform::BroadcastMessageAny0x00007ff7b688d7f6 (Unity) UI::Canvas::WillDestroyComponent0x00007ff7b5c0d3a1 (Unity) GameObject::WillDestroyGameObject0x00007ff7b5f18901 (Unity) PreDestroyRecursive0x00007ff7b5f16927 (Unity) DestroyObjectHighLevel_Internal0x00007ff7b5f16564 (Unity) DestroyObjectHighLevel0x00007ff7b626638f (Unity) Scripting::DestroyObjectFromScriptingImmediate0x00007ff7b54dd663 (Unity) Object_CUSTOM_DestroyImmediate0x0000018b373dcb35 (Mono JIT Code) (wrapper managed-to-native) UnityEngine.Object:DestroyImmediate (UnityEngine.Object,bool)0x0000018b373dca53 (Mono JIT Code) UnityEngine.Object:DestroyImmediate (UnityEngine.Object)0x0000018c1010bae3 (Mono JIT Code) YoukiaUnity.Resource.PoolManager:CleanPool (string)0x0000018c1219f07b (Mono JIT Code) [BattleStage.cs:85] Demo.Stage.BattleStage:CleanPool () 0x0000018c100fabab (Mono JIT Code) [BattleStage.cs:79] Demo.Stage.BattleStage:OnAsyncHandle () 0x0000018c1219efbb (Mono JIT Code) [BattleStage.cs:116] Demo.Stage.BattleStage:&lt;OnSceneLoaded&gt;b__10_0 () 0x0000018c1219ef76 (Mono JIT Code) [BattleManager.cs:1798] BattleManager:_onCreateFinish () 0x0000018b3af83c05 (Mono JIT Code) YoukiaCore.AsyncCombiner:RefreshAsyncHandles ()0x0000018b3af8d2c3 (Mono JIT Code) YoukiaCore.AsyncCombiner/AsyncHandle:Finish ()0x0000018c1011fbdb (Mono JIT Code) [BattleManager.cs:2004] BattleManager/&lt;&gt;c__DisplayClass139_0:&lt;_onRoleAdd&gt;b__0 () 0x0000018c1219dd26 (Mono JIT Code) [ModelChiefView.cs:147] Demo.ModelChiefView/&lt;&gt;c__DisplayClass10_0:&lt;Create&gt;b__2 () 0x0000018c1219db21 (Mono JIT Code) [ModelChiefView.cs:193] Demo.ModelChiefView/&lt;&gt;c__DisplayClass13_0:&lt;AddMountSkillClip&gt;b__0 (object) 0x0000018b3af41b1c (Mono JIT Code) FrameWork.FProcess:allDone ()0x0000018b3af41573 (Mono JIT Code) FrameWork.FProcess:AssetLoaded (object[])0x0000018b3af40fff (Mono JIT Code) FrameWork.FGameEvent:DispatchEvent (System.Enum,object[])0x0000018b3af40e43 (Mono JIT Code) FrameWork.FEventManager:DispatchEvent (System.Enum,object[])0x0000018b3af40d33 (Mono JIT Code) FrameWork.FProcess:ProcessComplete ()0x0000018b3af3a9ab (Mono JIT Code) FrameWork.FProcess/&lt;_load&gt;d__18:MoveNext ()0x0000018b3862cff0 (Mono JIT Code) UnityEngine.SetupCoroutine:InvokeMoveNext (System.Collections.IEnumerator,intptr)0x0000018b3862d11f (Mono JIT Code) (wrapper runtime-invoke) &lt;Module&gt;:runtime_invoke_void_object_intptr (object,intptr,intptr,intptr)0x00007ffdf5e6e4b4 (mono-2.0-bdwgc) [mini-runtime.c:3445] mono_jit_runtime_invoke 0x00007ffdf5dae764 (mono-2.0-bdwgc) [object.c:3066] do_runtime_invoke 0x00007ffdf5dae8fc (mono-2.0-bdwgc) [object.c:3113] mono_runtime_invoke 0x00007ff7b626dac4 (Unity) scripting_method_invoke0x00007ff7b6268644 (Unity) ScriptingInvocation::Invoke0x00007ff7b621a1df (Unity) Coroutine::Run0x00007ff7b6217c1c (Unity) Coroutine::ContinueCoroutine0x00007ff7b5d35344 (Unity) DelayedCallManager::Update0x00007ff7b5f45d29 (Unity) `InitPlayerLoopCallbacks'::`2'::UpdateScriptRunDelayedDynamicFrameRateRegistrator::Forward0x00007ff7b5f2c89c (Unity) ExecutePlayerLoop0x00007ff7b5f2c973 (Unity) ExecutePlayerLoop0x00007ff7b5f325d9 (Unity) PlayerLoop0x00007ff7b6e7993f (Unity) PlayerLoopController::UpdateScene0x00007ff7b6e77bdf (Unity) Application::TickTimer0x00007ff7b72c37aa (Unity) MainMessageLoop0x00007ff7b72c805b (Unity) WinMain0x00007ff7b864b42e (Unity) __scrt_common_main_seh0x00007ffe3a797034 (KERNEL32) BaseThreadInitThunk0x00007ffe3b5c2651 (ntdll) RtlUserThreadStart</code></pre><p>å¯¹æ¯”ä»£ç å‘ç°ï¼Œæˆ‘ä»¬æ¸¸æˆåœ¨è¿›å…¥æˆ˜æ–—æ—¶ï¼Œä¼šå¼ºåˆ¶æ¸…ç†ä¸€æ¬¡å¯¹è±¡æ± ï¼Œè€Œæ¸…ç†æ–¹å¼åˆ™æ˜¯ç›´æ¥è°ƒç”¨  <code>GameObject.DestroyImmediate</code></p><p>GameObject.DestroyImmediate å’Œ GameObject.Destroy ä¸€ç›´æ˜¯æœ‰åŒºåˆ«çš„ï¼Œè®°å¾—å¾ˆæ—©ä»¥å‰å®˜æ–¹éƒ½æ¨èæ­£å¼ç¯å¢ƒç”¨ Destroy è€Œé DestroyImmediateã€‚</p><p>ä¸ºäº†ç¡®è®¤çœ‹äº†ä¸‹æ–‡æ¡£ï¼š</p><blockquote><p>ç«‹å³é”€æ¯å¯¹è±¡ /obj/ã€‚å¼ºçƒˆå»ºè®®æ‚¨æ”¹ç”¨ Destroyã€‚</p></blockquote><blockquote><p>è¯¥å‡½æ•°åº”åªåœ¨ç¼–å†™ Editor ä»£ç æ—¶ä½¿ç”¨ï¼Œå› ä¸ºåœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ï¼Œ æ°¸è¿œä¸ä¼šè°ƒç”¨å»¶è¿Ÿé”€æ¯ã€‚ åœ¨æ¸¸æˆä»£ç ä¸­ï¼Œæ‚¨åº”è¯¥æ”¹ç”¨ Object.Destroyã€‚Destroy å§‹ç»ˆå»¶è¿Ÿè¿›è¡Œ ï¼ˆä½†åœ¨åŒä¸€å¸§å†…æ‰§è¡Œï¼‰ã€‚ ä½¿ç”¨è¯¥å‡½æ•°æ—¶è¦åŠ¡å¿…å°å¿ƒï¼Œå› ä¸ºå®ƒå¯ä»¥æ°¸ä¹…é”€æ¯èµ„æºï¼ å¦è¯·æ³¨æ„ï¼Œåˆ‡å‹¿å¾ªç¯è®¿é—®æ•°ç»„å¹¶é”€æ¯æ­£åœ¨è¿­ä»£çš„å…ƒç´ ã€‚è¿™ä¼šå¯¼è‡´ä¸¥é‡çš„é—®é¢˜ï¼ˆè¿™æ˜¯ä¸€æ¡é€šç”¨çš„ç¼–ç¨‹å®è·µï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨ Unity ä¸­ï¼‰ã€‚</p></blockquote><p>è¯´æ˜ DestroyImmediate è‚¯å®šæ˜¯æœ‰ä¸€å®šé£é™©çš„ï¼Œç‰¹åˆ«æ˜¯ CleanPool ä¸­çš„ä»£ç ï¼Œè¿˜æ­£å¥½æ˜¯ä¸€ä¸ªå¾ªç¯è°ƒç”¨çš„ DestroyImmediateã€‚</p><p>äºæ˜¯æ€€ç–‘æ˜¯å¦è¿™é‡Œçš„å½±å“ï¼Œå°è¯•å°†å…¶ä¿®æ”¹ä¸º Destroyã€‚</p><p>å¦‚æ­¤ä¹‹å â€”â€”â€”â€” è¿˜æ˜¯å´©æºƒäº†ï¼Œæ—¥å¿—å˜æˆå¦‚ä¸‹ï¼š</p><pre><code>Asset Pipeline Refresh: Total: 0.027 seconds - Initiated by RefreshV2(AllowForceSynchronousImport)Received signal SIGSEGVObtained 22 stack frames0x00007ff7b5c0aceb (Unity) GameObject::SendMessageAny0x00007ff7b607e835 (Unity) Transform::BroadcastMessageAny0x00007ff7b607e899 (Unity) Transform::BroadcastMessageAny0x00007ff7b607e899 (Unity) Transform::BroadcastMessageAny0x00007ff7b688d7f6 (Unity) UI::Canvas::WillDestroyComponent0x00007ff7b5c0d3a1 (Unity) GameObject::WillDestroyGameObject0x00007ff7b5f18901 (Unity) PreDestroyRecursive0x00007ff7b5f16927 (Unity) DestroyObjectHighLevel_Internal0x00007ff7b5f16564 (Unity) DestroyObjectHighLevel0x00007ff7b5d3345b (Unity) DelayedDestroyCallback0x00007ff7b5d35344 (Unity) DelayedCallManager::Update0x00007ff7b5f457b9 (Unity) `InitPlayerLoopCallbacks'::`2'::PostLateUpdateScriptRunDelayedDynamicFrameRateRegistrator::Forward0x00007ff7b5f2c89c (Unity) ExecutePlayerLoop0x00007ff7b5f2c973 (Unity) ExecutePlayerLoop0x00007ff7b5f325d9 (Unity) PlayerLoop0x00007ff7b6e7993f (Unity) PlayerLoopController::UpdateScene0x00007ff7b6e77bdf (Unity) Application::TickTimer0x00007ff7b72c37aa (Unity) MainMessageLoop0x00007ff7b72c805b (Unity) WinMain0x00007ff7b864b42e (Unity) __scrt_common_main_seh0x00007ffe3a797034 (KERNEL32) BaseThreadInitThunk0x00007ffe3b5c2651 (ntdll) RtlUserThreadStart</code></pre><p>ç”±äºè¿™æ¬¡å±äºå»¶æ—¶é”€æ¯ï¼Œæ‰€ä»¥ä¸å†æœ‰å®é™…è°ƒç”¨é”€æ¯çš„å †æ ˆæ‰“å°ï¼Œä¸è¿‡æœ€ç»ˆèµ°åˆ°çš„å´©æºƒä½ç½®è¿˜æ˜¯ä¸€æ ·:  <code>GameObject::SendMessageAny</code></p><p>åœ¨æ­¤å¤„å¢åŠ å¯¹åº”é”€æ¯ç‰©ä½“æ‰“å°ï¼Œåªçœ‹åˆ°ä¸€ä¸ª TS_MainButtomView</p><pre><code>&lt;color=lightblue&gt;1660365391&lt;/color&gt; Debug:é”€æ¯ï¼šTS_MainButtomView </code></pre><p>é€ æˆå´©æºƒå¯¹è±¡å¯èƒ½å°±æ˜¯è¿™ä¸ª Prefabï¼Œåœ¨æˆ‘ä»¬é¡¹ç›®æ˜¯ä¸€ä¸ª UI ç»„ä»¶ã€‚</p><p>å¹¶ä¸”åç»­ç»è¿‡å°è¯•ï¼Œè‹¥ä¸é”€æ¯è¯¥å¯¹è±¡ï¼ŒåŒæ ·æœ‰å¯èƒ½å´©æºƒï¼Œä¸”ä¼šå‘ç”Ÿäºé€€å‡ºæˆ˜æ–—æ—¶ä¹Ÿå¯èƒ½å´©æºƒã€‚</p><p>è¿™æ—¶å€™åŸºæœ¬ä¸Šå·²ç»ç›¸å½“æ€€ç–‘è¿™ä¸ªå¯¹è±¡äº†ï¼Œåªæ˜¯ç”±äºæ¯æ¬¡ç¢°åˆ°çš„å´©æºƒæœ€ç»ˆå †æ ˆä¿¡æ¯éƒ½è¿˜ä¸å°½ç›¸åŒï¼Œæ‰€ä»¥æ— æ³•å®šæ€§ï¼Œå¸¸è§æœ‰ï¼š</p><ul><li>é”€æ¯</li><li>åˆ›å»º</li><li>åˆ·æ–°ç²¾çµ Sprite<blockquote><p>tlsf_free<br />DynamicHeapAllocator::Deallocate</p></blockquote></li></ul><p>æ­£å‡†å¤‡è¯•è¯•å®˜æ–¹æ–‡æ¡£ä»‹ç»çš„ <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVuaXR5M2QuY29tL01hbnVhbC9XaW5kb3dzRGVidWdnaW5nLmh0bWw=">Debug æ–¹å¼</span> çš„æ—¶å€™ï¼Œåç»­æµ‹è¯•åŒå­¦ç«Ÿè¿˜æ‰¾åˆ°äº†ä¸€ä¸ªç¨³å®šå¤ç°ä¹‹å¤„ï¼Œå†ç»ä¸ªäººåå¤å°è¯•å’ŒæŸ¥è¯¢ï¼Œæœ€ç»ˆå¾—åˆ°å¦‚ä¸‹æŒ‡å‘æ¯”è¾ƒæ¸…æ™°ä¸€ç‚¹æ—¥å¿—ï¼š</p><pre><code>Received signal SIGSEGVObtained 51 stack frames0x00007ff7e8a5f2a4 (Unity) UI::CanvasManager::AddCanvas0x00007ff7e8a73633 (Unity) UI::Canvas::AddToManager0x00007ff7e8a73c65 (Unity) UI::Canvas::AwakeFromLoad0x00007ff7e8512fe7 (Unity) AwakeFromLoadQueue::InvokeAwakeFromLoad0x00007ff7e850e003 (Unity) AwakeFromLoadQueue::AwakeFromLoadAllQueues0x00007ff7e7df417a (Unity) GameObject::ActivateAwakeRecursively0x00007ff7e7dfb719 (Unity) GameObject::SetSelfActive0x00007ff7e767fd9b (Unity) GameObject_CUSTOM_SetActive0x00000126e405c104 (Mono JIT Code) (wrapper managed-to-native) UnityEngine.GameObject:SetActive (UnityEngine.GameObject,bool)0x00000126f84444fb (Mono JIT Code) [MainButtomView.cs:1442] MainButtomView/&lt;&gt;c__DisplayClass115_0:&lt;OpenView&gt;b__0 (object) </code></pre><p>å´©æºƒç»“æœæŒ‡å‘ï¼Œç•Œé¢çš„å­èŠ‚ç‚¹æŒ‚è½½çš„ Canvasï¼Œè¯¥å¯¹è±¡ (TS_MainButtomView) å±äºä¸»ç•Œé¢ Aorpage çš„ä¸€ä¸ª å­èŠ‚ç‚¹ Prefabï¼Œä¸”è‡ªèº«æŒ‚è½½äº† Canvasã€‚</p><p>è¿™é‡Œç»è¿‡å°è¯•ï¼Œè¡¨æ˜è¯¥ç»„ä»¶å¹¶éæ˜¯å¿…é¡»çš„ã€‚</p><p>äºæ˜¯ç§»é™¤ä¹‹åå°±çœŸçš„å¥½äº†..</p><h2 id="åä¸€-é‡æ‰“å›¾é›†æ··ä¹±"><a class="anchor" href="#åä¸€-é‡æ‰“å›¾é›†æ··ä¹±">#</a> åä¸€ã€é‡æ‰“å›¾é›†æ··ä¹±</h2><p>ä¾‹å¦‚ï¼Œæ›´æ”¹å›¾é›†å¤§å°ï¼Œæœ€æ˜æ˜¾çš„ä¸€ä¸ªé”™è¯¯è¡¨ç°å¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_3dc46ec72951416efa3db5e39d72cf52_r.png" alt="" /></p><p>å¦‚æœç°åœ¨ç‚¹å‡»æäº¤ï¼Œå‘ç° meta æ–‡ä»¶éƒ½æœªè¢«ä¿®æ”¹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_1a847eda1a12e0c8d768a4f928876577_r.png" alt="" /></p><p>è€Œä¸”ç¼–è¾‘å™¨ä¸­ä¹Ÿå¯ä»¥æ˜æ˜¾çœ‹å‡º Position ä¾ç„¶æ˜¯æ—§çš„ â€”â€” ç»è¿‡åˆ†æè°ƒè¯•ï¼Œåœ¨ç¼–è¾‘å™¨å·¥å…·ç”Ÿæˆæ–°çš„å›¾é›†æ•°æ®æ—¶ï¼Œç¡®å®ä¹Ÿæ˜¯èµ‹å€¼äº†æ–°çš„æ•°æ®çš„ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_37d6afb2f1f694e23da5f116b33d1fb9_r.png" alt="" /></p><p>äºæ€€ç–‘æ˜¯ä¸æ˜¯ Unity å†…éƒ¨åˆå‡ºå•¥äº‹äº†ã€‚</p><p>ç»è¿‡æŸ¥è¯¢å…³é”®å­— textureImporter.spritesheetï¼Œæœ‰æ‰¾åˆ°ä¸€ç¯‡å¯èƒ½æœ‰æ‰€å…³è”çš„åšå®¢ <a href="https://blog.csdn.net/rcfalcon/article/details/49743715">unity 2D Sprite ç½‘æ ¼ Slice å·¥å…·<br /></a></p><p>è¿™ç¯‡æ–‡ç« æè¿°äº† Unity çš„ textureImporter.spritesheet å¤§çº¦å­˜åœ¨ä¸€ä¸ª BUGï¼Œå½“å›¾é›†ä¸­å›¾ç‰‡æœªè¢«ä¿®æ”¹ï¼Œä»…å‘ç”Ÿä½ç½®è¡¨åŠ¨æ—¶ï¼Œå°†å¯¼è‡´å…¶æ•°æ®æ— æ³•æ­£å¸¸æ›´æ–°ã€‚è™½ç„¶è¿™ç¯‡åšæ–‡å·²ç»æ—©æ˜¯ 2015 å¹´çš„ä¸œè¥¿äº†ï¼Œä¸è¿‡æœ¬ç€å°è¯•ä¸€ä¸‹çš„æ„Ÿè§‰ï¼Œæ²¡æˆæƒ³çœŸæ˜¯è¿™ä¸ªé—®é¢˜ï¼</p><p>æœ«å°¾ç»™åŠ ä¸Š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre>textureImporter<span class="token punctuation">.</span>mipmapEnabled <span class="token operator">=</span> <span class="token operator">!</span>textureImporter<span class="token punctuation">.</span>mipmapEnabled<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>textureImporter<span class="token punctuation">.</span><span class="token function">SaveAndReimport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>textureImporter<span class="token punctuation">.</span>mipmapEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>textureImporter<span class="token punctuation">.</span><span class="token function">SaveAndReimport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>å°±æ­£å¸¸äº†ï¼Œå…³é”®æ˜¯è¿™ä¸ªåœ¨ä¹‹å‰ Unity2017 è¿˜èƒ½æ­£å¸¸å·¥ä½œçš„ã€‚</p><h2 id="åäºŒ-æ­£å¼åŒ…"><a class="anchor" href="#åäºŒ-æ­£å¼åŒ…">#</a> åäºŒã€æ­£å¼åŒ…</h2><p>å…¶å®ƒæ¯”è¾ƒç®€å•ä¸€ç‚¹ã€æˆ–è€…ä¸€äº›åŠŸèƒ½ä¸Šçš„çš„å‡çº§é—®é¢˜ï¼Œè¿™é‡Œå°±ä¸ä½œè®°å½•äº†ï¼Œæœ€ç»ˆæ­£å¼åŒ…å¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-20/m_01c6a4b39b61c4c75075e6451fd2968e_r.png" alt="" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸€-ugui&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#ä¸€-ugui&quot;&gt;#&lt;/a&gt; ä¸€ã€UGUI&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;h3 id=&quot;è¶…é“¾æ¥&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#è¶…é“¾æ¥&quot;&gt;#&lt;/a&gt; è¶…é“¾æ¥&lt;/h3&gt;
&lt;p&gt;&lt;f</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="é—®é¢˜" scheme="https://cwhisme.github.io/categories/Unity3D/%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="é—®é¢˜è®°å½•" scheme="https://cwhisme.github.io/tags/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨JIRAçš„RichFilterStatisticsç»Ÿè®¡BUGç‡ç­‰ä¿¡æ¯</title>
    <link href="https://cwhisme.github.io/2022/07/01/%E5%88%A9%E7%94%A8JIRA%E7%9A%84RichFilterStatistics%E7%BB%9F%E8%AE%A1BUG%E7%8E%87%E7%AD%89%E4%BF%A1%E6%81%AF/"/>
    <id>https://cwhisme.github.io/2022/07/01/%E5%88%A9%E7%94%A8JIRA%E7%9A%84RichFilterStatistics%E7%BB%9F%E8%AE%A1BUG%E7%8E%87%E7%AD%89%E4%BF%A1%E6%81%AF/</id>
    <published>2022-07-01T09:40:15.000Z</published>
    <updated>2022-12-22T03:29:48.146Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>æœ€è¿‘åœ¨æ€è€ƒå¦‚ä½•å®¢è§‚å¯¹å¤§å®¶çš„ BUG ç‡ å’Œ Reopen ç‡ çš„è¯„åˆ†é—®é¢˜ï¼Œæœ¬æ¥å…¬å¸æœ‰ä¸ªç»Ÿè®¡å¹³å°çš„ï¼Œä½†æ˜¯é‚£ä¸ªç»Ÿè®¡å¹³å°åªä¼šç»Ÿè®¡å¤§å•ï¼Œå°çš„ BUGã€ä»»åŠ¡æ ¹æœ¬æ²¡è®°å½•çš„ï¼Œè€Œä¸”å…³äº â€œæœ€è¿‘ä¸€å‘¨â€ ä¹‹ç±»çš„ä¿¡æ¯çš„æ—¶é—´æ¡ä»¶ä¹Ÿæ²¡å•¥ç»Ÿè®¡æ¥æ”¯æŒï¼Œäºæ˜¯æƒ³åˆ°åˆ©ç”¨ JIRA æ¥ç»Ÿè®¡ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨æˆ‘ä»¬çš„ JIRA ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°ä¸€ä¸ªé—®é¢˜è¿‡æ»¤å™¨ï¼Œä»¥ç»Ÿè®¡å½“å‰ä»»åŠ¡ä¿¡æ¯ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_362028b3455ab338a511e052153eeee3_r.png" alt="" /></p><p>ä½†æ˜¯è‡ªå¸¦çš„é—®é¢˜ç»Ÿè®¡æ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬ä¸Šåªæ”¯æŒé€‰æ‹©ä¸€ä¸ªè‡ªå®šä¹‰çš„è¿‡æ»¤å™¨ï¼Œä»¥åŠéƒ¨åˆ†å›ºå®šçš„å­—æ®µè®¾ç½®ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_00bd1944d47eff69ab3f4694b34f6cfa_r.png" alt="" /></p><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_6777086955245f41d5cf7a7510c040a7_r.png" alt="" /></p><p>ç»Ÿè®¡ç±»å‹éƒ½æ˜¯å›ºå®šçš„ï¼Œä½ é€‰æ‹©äº†å“ªä¸ªç±»å‹ï¼Œåœ¨é—®é¢˜ç»Ÿè®¡ä¸­ï¼Œå°±ä¼šä»¥æŸä¸ªç±»å‹ä¸ºå‡†å°†è¿‡æ»¤å™¨ä¸­æ»¡è¶³æ¡ä»¶çš„ä»»åŠ¡è¿›è¡Œæ’åˆ—ã€‚</p><p>ä¾‹å¦‚å±•ç¤ºå½“å‰å‰å°æ‰€æœ‰çš„ BUG å•</p><p>ç„¶åå°±äº§ç”Ÿäº†ä¸€ä¸ªé—®é¢˜ï¼šBUG å•æµ‹è¯•éƒ½ä¸ä¼šå¡« å¼€å‘è€… æˆ–è€… BUG äº§ç”Ÿè€…ä¹‹ç±»çš„å­—æ®µï¼Œæœ€å¤šæ ‡è®°æ¨¡å—ä¸º å‰å°ï¼Œç„¶ååˆ†ç»™å¯¹åº”äº§ç”Ÿ BUG åŠŸèƒ½çš„äººèº«ä¸Šã€‚</p><p>æ­¤æ—¶æ ¹æ®è‡ªå®šä¹‰è¿‡æ»¤å™¨ç­›é€‰ï¼Œå½“å‰ BUG ç»Ÿè®¡å•æ˜¯å¯ä»¥çœ‹åˆ°çš„ï¼Œä½†æ˜¯å½“è¿™ä¸ªä»»åŠ¡è¢«è§£å†³ï¼Œè¿”å›ç»™æµ‹è¯•ä¹‹åï¼Œå°±éš¾ä»¥æŸ¥å‡ºå¯¹åº”å¯¹è±¡äº† â€”â€” è‡³å°‘ä»ç»Ÿè®¡ç±»å‹ä¸­ï¼Œæ˜¯æ²¡æœ‰è¿™ä¸ªåˆ†ç±»çš„ã€‚</p><p>æŸ¥äº†ä¸€ä¸‹ï¼Œäºæ˜¯æƒ³åˆ°è‡ªå®šä¹‰è¿‡æ»¤å™¨å¯ä»¥æŒ‡å®šå¯¹åº”çš„è§£å†³é—®é¢˜è€…ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç ç­›å‡ºä¸Šå‘¨å®Œç»“çš„ BUGï¼š</p><pre><code>component = å‰å° AND status != Suspend AND type = Sub-bug AND status changed from Open to resolved during (startOfWeek(-1), endOfWeek(-1)) </code></pre><p>ä¸Šè¿°ä»£ç ä»¥è¿‡å»ä¸€å‘¨å†…ï¼Œå‰å°æ‰€æœ‰çŠ¶æ€å˜æ›´ä¸ºå·²è§£å†³ï¼Œä¸”ç›®å‰éæŒ‚èµ·çŠ¶æ€ä¸ºæ¡ä»¶ï¼Œç­›é€‰å‡º</p><p>æ•°æ®æ˜¯æœ‰äº†ï¼Œä½†è¦æ˜¯è¿™æ—¶å€™å°†è¯¥è¿‡æ»¤å™¨æ‹¿åˆ°é—®é¢˜ç»Ÿè®¡æ¥ï¼Œç”±äºç»Ÿè®¡ç±»å‹ä¸­æ ¹æœ¬æ²¡æœ‰ â€œç»æ‰‹äººâ€ ä¿¡æ¯ï¼Œä¹Ÿæ˜¯æ— æ³•å¾—åˆ°æ­£ç¡®çš„ç»“æœçš„ï¼Œ é¡¶å¤šå±•ç¤ºå½“å‰æŒ‚åœ¨æµ‹è¯•èº«ä¸Šçš„ä¸€å † â€œä¸Šå‘¨ BUGâ€ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_50504f276542b578a9970a8bf7ff18f8_r.png" alt="" /></p><h2 id="è¿‚å›çš„å°è¯•"><a class="anchor" href="#è¿‚å›çš„å°è¯•">#</a> è¿‚å›çš„å°è¯•</h2><p>è¿™æ—¶å€™ï¼Œä¸€å¼€å§‹å¤šæ¬¡å°è¯•ä¸è¡Œä¹‹åï¼Œæ²¡åŠæ³•å°±æƒ³æ‰‹åŠ¨æŒ¨ä¸ªå»åˆ›å»ºè¿‡æ»¤å™¨æ¥å±•ç¤ºï¼Œå¤§æ¦‚çš„æƒ³æ³•æ˜¯ï¼š</p><ul><li>åˆ›å»ºä¸€ä¸ª ä¸Šå‘¨å®Œç»“çš„ BUG æ€»è¿‡æ»¤å™¨ï¼Œåˆ›å»ºä¸€ä¸ªé—®é¢˜ç»Ÿè®¡ä»…å±•ç¤ºæ€» BUG æ•°é‡</li><li>åˆ›å»ºä¸€ä¸ª å½“å‰ç”¨æˆ·ä¸Šå‘¨å®Œç»“çš„ BUG è¿‡æ»¤å™¨ï¼Œåˆ›å»ºä¸€ä¸ªé—®é¢˜ç»Ÿè®¡å±•ç¤º â€œè‡ªå·±â€ ä¸Šå‘¨ BUG æ•°é‡</li></ul><p>ä»¥åŠåè¾¹ Reopen å•¥çš„ä¹Ÿéƒ½å¦‚æ­¤ï¼Œå¤§æ¦‚æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_956edaf03cf9709df541ae22be97af05_r.png" alt="" /></p><p>ä¸ç”¨è´¨ç–‘ï¼Œéå¸¸çš„ç¹çã€æ•ˆæœä¹Ÿå·®ï¼Œå±•ç¤ºçš„å†…å®¹åŸºæœ¬ä¸Šæ˜¯åˆ†ç¦»çš„ï¼Œæ— æ³•é“¾æ¥åœ¨ä¸€å—ã€‚<br />å¦‚æœæƒ³è®¡ç®—æŸäººåœ¨ä¸Šå‘¨æ‰€æœ‰ BUG é‡ä¸­çš„å æ¯”ï¼Œæ›´æ˜¯è¿˜éœ€è¦è®¡ç®—ä¸€ç•ªã€‚</p><p>äºæ˜¯åœ¨åˆšåˆ›å»ºäº†è¿™ä¹ˆä¸¤ä¸ªé—®é¢˜ç»Ÿè®¡ä¹‹åï¼Œå°±æ„Ÿè§‰ä¸å¤§è¡Œ â€”â€” è¿™æ ·ä¸€ä¸ªä¸ªæ’åˆ—æ˜¯èƒ½çœ‹ï¼Œä½†æ˜¯å¹¶ä¸å¥½ç”¨ï¼Œäºæ˜¯å°±åœ¨æ·»åŠ å°å·¥å…·é‡Œè¾¹ç¿»ç€é¡µæ‰¾ï¼Œçœ‹åˆ°äº†è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œå¬åå­—å’Œå›¾æ ‡ï¼Œæ„Ÿè§‰æœ‰é‚£ä¹ˆç‚¹æ„å‘³ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_665ff8f93c1990ac2ca124ba6cd5b2bc_r.png" alt="" /></p><p>å…³äºè¿™ä¸ªå°å·¥å…·ï¼Œä»¥å‰å¼€å§‹è‡ªå®šä¹‰ JIRA é¢æ¿çš„æ—¶å€™å…¶å®ä¹Ÿçœ‹åˆ°è¿‡ï¼Œä¸è¿‡é‚£ä¼šéœ€æ±‚æ²¡è¿™ä¹ˆå¤šï¼Œè€Œä¸”åˆ›å»ºä¹‹åéšä¾¿ç‚¹äº†ç‚¹é‚£äº›é€‰é¡¹ï¼Œå› ä¸ºä¹Ÿä¸ä¼šç”¨ï¼Œå°±æ²¡ç®¡äº†ã€‚è¿™æ¬¡å°±æƒ³ç€ç¨å¾®ç ”ç©¶ä¸‹ã€‚</p><h2 id="ä½¿ç”¨-rich-filter-statistics"><a class="anchor" href="#ä½¿ç”¨-rich-filter-statistics">#</a> ä½¿ç”¨ Rich Filter Statistics</h2><p>ç‚¹å‡»åˆ›å»ºä¹‹åï¼Œä¼šæ˜¯è¿™ä¹ˆä¸ªæ ·å­ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_f347e2411f6f1a3b7b21ec7be39ec500_r.png" alt="" /></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒRich filter æ˜¯æ²¡ä»»ä½•å¯é€‰é¡¹çš„ï¼Œå› æ­¤åœ¨è¿™ä¹‹å‰ï¼Œå¿…é¡»ç‚¹çº¢æ¡†çš„è¶…é“¾æ¥ï¼Œåˆ›å»ºä¸€ä¸ªè‡ªå·±çš„ Rich filterã€‚è¿™é‡Œç›´æ¥å…ˆä¸Šä¹‹å‰çš„è‡ªå·±å°è¯•çš„æµç¨‹ï¼š</p><ol><li>ç‚¹å‡»å³ä¸Šè§’ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Rich filter<br /><img data-src="/blogimages/2022/2022-07-01/m_38f40fa9e64fb5744b17fdb46a054eaa_r.png" alt="" /></li><li>åœ¨é€šç”¨é¢æ¿ä¸­é€‰æ‹©ä¹‹å‰è‡ªå·±å·²ç»åˆ›å»ºå¥½çš„æ™®é€šè¿‡æ»¤å™¨<br /><img data-src="/blogimages/2022/2022-07-01/m_18432576ca7c450f19164369ea591eef_r.png" alt="" /><br />æ³¨ï¼šè¿™é‡Œå¯èƒ½éœ€è¦æ‰‹åŠ¨å¤åˆ¶ï¼Œå› ä¸ºæœç´¢åŠŸèƒ½ç›¸å½“ä¸å¥½ä½¿ï¼Œä¸œè¥¿å¤ªå¤šäº†</li><li>é€‰æ‹©å®Œæ¯•ä¹‹åï¼Œä¸‹æ–¹è¿˜ä¼šç›´æ¥å±•ç¤ºè¿‡æ»¤å™¨çš„ä»£ç <br /><img data-src="/blogimages/2022/2022-07-01/m_5dd395d567e8c97a953e36dac123f921_r.png" alt="" /></li><li>æ­¤æ—¶ï¼Œåœ¨ JIRA é¢æ¿ä¸­ï¼Œå·²ç»å¯ä»¥é€‰æ‹©è¯¥ Rich filter äº†ï¼Œä¸è¿‡è¦æ˜¯å°±è¿™æ ·ï¼Œé‚£å®ƒè·Ÿé€šå¸¸çš„ç»Ÿè®¡å™¨ä¹Ÿä¸€æ ·ï¼Œåªèƒ½é€‰æ‹©ç³»ç»Ÿå†…ç½®çš„é‚£å‡ ä¸ªå˜é‡ï¼Œå› æ­¤è¿˜å¿…é¡»å¾—åˆ‡åˆ° Smart filters é¡µç­¾ï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_7a35880194f18678b65d476adfafcdc7_r.png" alt="" /><br />ä¾ç„¶æ˜¯é¦–å…ˆåˆ›å»ºä¸€ä¸ª Smart filters ï¼Œæ ‡æ³¨å¥½åå­—<br />ç°åœ¨ï¼Œç›¸å½“äºæœ‰äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„åˆ†ç±»ï¼Œåœ¨ JIRA é¢æ¿ä¸­å°±å¯ä»¥é€šè¿‡ Statistic type é€‰æ‹©äº†ï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_4e14db5387eb11834cf8f6d44b210916_r.png" alt="" /><br />ä½†æ˜¯è¿™æ ·æ˜¯ä¸å¤Ÿçš„ï¼Œå¦‚æ­¤åªä¼šæŠŠæ‰€æœ‰çš„è¿‡æ»¤å™¨ç»“æœå…¨å±•ç¤ºä¸ºä¸€æ¡ï¼Œè·Ÿæœ€åˆçš„æƒ³æ³•å®Œå…¨ä¸ç¬¦</li><li>å›åˆ° Smart filtersï¼Œå¯ä»¥çœ‹åˆ°æ–°åˆ›å»ºçš„ä¸‹æ–¹æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿<br /><img data-src="/blogimages/2022/2022-07-01/m_302bb48b5ca0b25945e4835b2cc27784_r.png" alt="" /><br />å¯ä»¥æ¥å—è¾“å…¥ç±»å‹ (åå­—)[å¦‚æœåˆ›å»ºæ—¶é€‰äº†é¢œè‰²ï¼Œè¿˜å¯ä»¥è®¾ç½®é¢œè‰²]ï¼Œä»¥åŠ JQL ç­›é€‰ä»£ç ï¼Œè¾“å…¥å®Œæ¯•ç‚¹æ—è¾¹çš„åŠ å·å°±å¯ä»¥æ·»åŠ ï¼Œç­›é€‰çš„ç»“æœåŸºäºåˆ›å»ºæ•´ä¸ª Rich Filter Statistics æœ€åˆçš„é‚£ä¸ªè¿‡æ»¤å™¨ï¼Œå› æ­¤å¯ä»¥çœç•¥æ‰å·²ç»ç­›è¿‡çš„åˆ¤æ–­ï¼Œä¾‹å¦‚ï¼Œç›´æ¥ç­›é€‰æŒ‡å®šçš„åå­—ã€‚</li></ol><p>æœ€åç»“æœå¦‚ä¸‹ï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_b7bbfe6bd20430a1ea1fb41644dbc610_r.png" alt="" /></p><p>å›åˆ° JIRA é¢æ¿ï¼ŒStatistic type é€‰æ‹©æ–°åˆ›å»ºçš„è¿™ä¸ªï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_89050bb6883cd5917ac952cc8054bc04_r.png" alt="" /></p><h2 id="ç»¼åˆç»Ÿè®¡åŠŸèƒ½"><a class="anchor" href="#ç»¼åˆç»Ÿè®¡åŠŸèƒ½">#</a> ç»¼åˆç»Ÿè®¡åŠŸèƒ½</h2><p>ä¸Šè¿°å°±æ˜¯ Rich Filter Statistics ç»Ÿè®¡æœ€åŸºæœ¬æˆ–è€…æœ€ç®€å•çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><p>ä¸è¿‡åè¾¹åˆæƒ³åˆ°ï¼Œæ—¢ç„¶ Rich Filter Statistics ç»Ÿè®¡å¯ä»¥æœ‰æ‰‹å·¥ç­›é€‰å™¨ï¼Œé‚£ä¹ˆå¯ä¸å¯ä»¥æŠŠæœ¬å‘¨å·²å®Œæˆ BUGï¼Œæˆ–è€…å…¶å®ƒæ•°æ®ä¸€å—æ”¾è¿™å„¿å‘¢ï¼Ÿåˆæˆ–è€…æ•´ä¸ªç»“åˆä¸€èµ·ï¼Œæ¯•ç«Ÿçœ‹åˆ›å»ºå°å·¥å…·çš„å›¾æ ‡æ˜¾ç¤ºï¼Œå®ƒè²Œä¼¼è¿˜å¯ä»¥æ”¯æŒç±»è¡¨æ ¼çš„ç»Ÿè®¡å±•ç¤ºçš„ã€‚</p><p>è€Œä¸”é¢å¤–é‚£ä¹ˆå¤šæ ‡ç­¾é¡µå’Œé€‰é¡¹ï¼Œç†è®ºä¸Šéƒ½æ˜¯æœ‰ç”¨çš„ã€‚</p><h3 id="æ·»åŠ -reopen-ç»Ÿè®¡"><a class="anchor" href="#æ·»åŠ -reopen-ç»Ÿè®¡">#</a> æ·»åŠ  Reopen ç»Ÿè®¡</h3><p>äºæ˜¯å°è¯•äº†ä¸€ç•ªï¼Œæ ‡ç­¾é¡µçš„ Custom values å¯ä»¥ç”ŸæˆäºŒç»´è¿‡æ»¤æ¡ä»¶ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_1df8e0ab20f9a7a19871e3bac3a1fcca_r.png" alt="" /></p><p>è¿™é‡Œæˆ‘åˆ›å»ºäº†ä¸€æ¡ç­›é€‰ Reopen å•å­çš„ Custom valuesï¼Œä¹‹ååœ¨ JIRA é¢æ¿å°±å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„å±•ç¤ºå€¼ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_951be46016e09fd3301502edcc95ba76_r.png" alt="" /></p><p>ä¹‹åæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_a4ecc4645a100127ccd9d557c2bc3f76_r.png" alt="" /></p><h4 id="rich-filter-controller"><a class="anchor" href="#rich-filter-controller">#</a> Rich Filter Controller</h4><p>è¿™ä¸ªä¹Ÿæ˜¯åœ¨å·¥å…·é¢æ¿é‡Œè¾¹å¶ç„¶çœ‹åˆ°çš„ï¼Œåˆ›å»ºå‡ºæ¥è¯•äº†ä¸€ä¸‹ï¼Œå¯ä»¥ä½œä¸ºåŠ¨æ€æ§åˆ¶æ˜¾ç¤ºçš„é¢å¤–ç­›é€‰æ¡ä»¶ã€‚<br />æ‰€ä»¥ä¹Ÿç®€å•ä»‹ç»ä¸‹ã€‚</p><p><img data-src="/blogimages/2022/2022-07-01/m_014d0b01ec03f554635cca171fb6d69b_r.png" alt="" /></p><p>è¿™ä¸ªå¯ä»¥çœ‹åšæ˜¯ Rich Filter Statistics çš„ä¸€ä¸ªåŠ¨æ€æ§åˆ¶å™¨ï¼Œç®€å•æ¥è¯´ï¼Œç›®å‰æˆ‘å‘ç°çš„ç”¨å¤„æ˜¯å°±æ˜¯å¯ä»¥é€šè¿‡æŒ‡å®šé¢å¤–çš„ JQL è¯­å¥å†ä½œä¸€æ¬¡ç­›é€‰ã€‚</p><p>JQL è¯­å¥æ”¯æŒäº‹å…ˆå®šä¹‰å¥½çš„ï¼Œä¹Ÿå¯ä»¥å®æ—¶å¡«å†™ã€‚</p><ul><li><p>äº‹å…ˆå®šä¹‰å¥½çš„ç­›é€‰é€‰é¡¹ï¼Œå…¶å®å°±æ˜¯ä¹‹å‰åˆ›å»º Rich Filter å°±çœ‹è§çš„ Static filters é¡µç­¾ï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_01bccc1d2847ccda40efe20654704e53_r.png" alt="" /><br />è¿™å„¿å®šä¹‰çš„å†…å®¹å¯¹ Rich Filter Statistics æœ¬èº«å…¶å®æ˜¯æ²¡ç”¨çš„ (è‡³å°‘è¯•äº†ä¸‹æ²¡æœ‰)ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡ Rich Filter Controller å°å·¥å…·ç›´æ¥å½±å“ Rich Filter Statistics çš„å±•ç¤ºæ•ˆæœ<br />åˆ›å»ºæ–¹å¼å¾ˆç®€å•ï¼Œåå­— + JQL è¯­å¥å³å¯ï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_1c057f599ec9ed4a857c4b1a700b6e96_r.png" alt="" /></p></li><li><p>å®æ—¶æ·»åŠ  JQL æ¥ç­›é€‰çš„è¯ï¼Œåˆ›å»ºé¢æ¿æ—¶éœ€è¦å‹¾é€‰ Enable additional JQL filtering<br /> é€‰é¡¹ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_66acca903d6e3e5e657fb453031c2760_r.png" alt="" /></p></li></ul><p>åŠ¨æ€ç­›é€‰æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_c64152846299252b532932d3af57adaa_r.png" alt="" /></p><p>ç‚¹å‡»é€‰é¡¹æ—¶ï¼Œå¯ä»¥å®æ—¶è·å¾—å¯¹åº”ç­›é€‰åˆ†ç±»ç»“æœã€‚</p><h3 id="å®Œå–„-rich-filter-statistics"><a class="anchor" href="#å®Œå–„-rich-filter-statistics">#</a> å®Œå–„ Rich Filter Statistics</h3><p>ç†è®ºä¸Šä¸Šè¿°çš„ç»Ÿè®¡æ¡ä»¶å·²ç»å¯ä»¥ç”¨äº†ï¼Œä¾‹å¦‚å°†è¿‡å»ä¸€å‘¨æ”¹æˆæœ¬å‘¨ï¼ŒBUG ç­›é€‰æ”¹æˆä»»åŠ¡ã€ä¼˜åŒ–å•ç­›é€‰å°±å¯ä»¥ç»Ÿè®¡æœ¬å‘¨å·¥ä½œé‡ï¼Œè¦è¯´å…¶å®è·Ÿä¸Šä¸€ä¸ª Rich Filter åˆå¹¶éƒ½å¯ä»¥ã€‚</p><h2 id="1å°†æ— bugäº§ç”Ÿè€…çš„bugæŒ‡å®šä¸ºä»»åŠ¡å•"><a class="anchor" href="#1å°†æ— bugäº§ç”Ÿè€…çš„bugæŒ‡å®šä¸ºä»»åŠ¡å•">#</a> 1. å°†æ—  BUG äº§ç”Ÿè€…çš„ BUG æŒ‡å®šä¸ºä»»åŠ¡å•</h2><p>å…¶æ¬¡ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦å°†ä¸€äº›ã€è€ BUGã€ã€å³å·²ç»æ‰¾ä¸ç€ BUG äº§ç”Ÿè€…çš„é—®é¢˜ï¼Œåˆ†é…ç»™æ–°çš„äººè§£å†³ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯èƒ½å°±éœ€è¦åŒºåˆ†ä¸€ä¸‹ï¼Œé¿å… BUG è¢«ç›´æ¥ç»Ÿè®¡åˆ°æ–°äººå¤´ä¸Šã€‚<br />è¿™é‡Œæˆ‘æƒ³çš„æ–¹å¼æ˜¯ï¼šåˆ†é…å•å­æ—¶å¢åŠ ä¸€ä¸ªæŒ‡å®šçš„å¤‡æ³¨ï¼Œç„¶ååœ¨å¦ä¸€è¾¹çš„ jql ç­›é€‰æ—¶ï¼Œå°†å¢åŠ äº†æŒ‡å®šå¤‡æ³¨çš„å•å­ç§»é™¤ BUG ç»Ÿè®¡å•ï¼Œå¹¶å°†å…¶ç»Ÿè®¡ä¸ºä»»åŠ¡å•ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘è¿™å„¿é€‰æ‹©ç”¨ ã€ä»»åŠ¡å•ã€ è¿™ä¸ªå…³é”®å­—è¿›è¡ŒæŒ‡å®šï¼Œç»Ÿè®¡ä¸º BUG å•æ ¸ä»»åŠ¡åˆ†åˆ«å¯ä»¥ä½œå¦‚ä¸‹ä¿®æ”¹ï¼š</p><pre><code>//ä»»åŠ¡å•type = Main-Task OR type = Improvement OR type = Sub-task OR type = Task OR type = Sub-suggestion or comment ~ ä»»åŠ¡å•</code></pre><p>å¡«å†™æ•ˆæœå¦‚ä¸‹ï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_b291f2fdf05af973af31b79e3bc42576_r.png" alt="" /></p><p>ä½¿ç”¨æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_5a777f0aeeb8c309cbd8552c162a46fc_r.png" alt="" /></p><p>ä½†æ˜¯è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå¤‡æ³¨çš„æœç´¢åªæ”¯æŒæœç´¢æŒ‡å®šæ–‡æœ¬ï¼Œä½†æ˜¯ä¸æ”¯æŒç­›é€‰ç»“æœå–å â€”â€” æ¯”å¦‚ã€ä¸åŒ…æ‹¬ã€æŒ‡å®šæ–‡æœ¬å°±æ— æ³•å·¥ä½œï¼Œä¾‹å¦‚ä»¥ä¸‹è¯­å¥ï¼š</p><pre><code>//ç­›é€‰BUGå•ï¼Œä¸”å¤‡æ³¨æ²¡æœ‰æ³¨æ˜ä¸º ä»»åŠ¡å•çš„type = Sub-bug and comment !~ ä»»åŠ¡å•</code></pre><p>ç»è¿‡åç»­ç ”ç©¶ï¼Œå‘ç°æ˜¯ç”±äºå¤‡æ³¨ä¸ºç©ºçš„è¯ï¼Œåˆ™åŒæ ·ä¼šè¢«ç›´æ¥æ’é™¤æ‰ï¼ä¹Ÿå³æ˜¯è¯´ <FONT COLOR=RED>comment æœç´¢ä¸æ”¯æŒæ— å¤‡æ³¨çš„å•å­ï¼æ— å¤‡æ³¨çš„å•å­æ— è®ºæ˜¯åŒ…å«è¿˜æ˜¯ä¸åŒ…å«éƒ½ä¼šè¢«ç›´æ¥æ’é™¤æ‰ï¼</FONT></p><p>æœ€ç»ˆå¯¼è‡´å¾—ä¸åˆ°æ­£å¸¸çš„ç»“æœï¼Œå› æ­¤è™½ç„¶å¯ä»¥å°† BUG å•ç»Ÿè®¡ä¸ºä»»åŠ¡ï¼Œä½†æ˜¯åŒæ ·ä¹Ÿè¿˜æ˜¯ä¼šè®¡ç®—åˆ° BUG å•ä¸­ã€‚</p><h2 id="2-ç»Ÿä¸€ä½¿ç”¨ä¸€ä¸ªç­›é€‰å™¨"><a class="anchor" href="#2-ç»Ÿä¸€ä½¿ç”¨ä¸€ä¸ªç­›é€‰å™¨">#</a> 2. ç»Ÿä¸€ä½¿ç”¨ä¸€ä¸ªç­›é€‰å™¨</h2><p>ä¸ºäº†æ–¹ä¾¿å¤šæ—¶é—´å‘¨æœŸçš„ç»Ÿè®¡ï¼Œä¾‹å¦‚ ä¸Šå‘¨ã€ä¸Šä¸ªæœˆã€æœ¬æœˆ è¿™ç§ï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥åœ¨ä¸€ç³»åˆ—é…ç½®å®Œæˆåï¼Œåœ¨åŸºç¡€ä¸Šå¤åˆ¶ä¸€ä»½å³å¯ Rich Filterã€‚</p><p>åæ¥æˆ‘é‡æ–°å»ºç«‹äº†ä¸€ä¸ªæ™®é€šçš„åŸºç¡€ç­›é€‰å™¨ï¼Œå…¶ä½œç”¨æ˜¯ç­›é€‰æ‰€æœ‰å‰å°ä»»åŠ¡ã€‚åŸºç¡€ç­›é€‰å™¨ä¸­ä¸åŒ…æ‹¬æ—¶é—´åˆ¤æ–­ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œè¿›ä¸€æ­¥ç­›é€‰ã€‚</p><pre><code>status != Suspend AND status changed from Open to resolved by (chenzhihao, wanghan, wangjiaying, huangdong, renjun, chensihao, jiangyunfei, gaozirui) OR status in (Open, &quot;In Progress&quot;, Reopened) AND assignee in (chenzhihao, wanghan, wangjiaying, huangdong, renjun, chensihao, jiangyunfei, gaozirui)</code></pre><p>æ³¨ï¼šåˆ é™¤äº†  <code>during (startOfWeek(), endOfWeek())</code>  åˆ¤æ–­</p><p>é‡Œè¾¹æœ‰ä»»åŠ¡ç»Ÿè®¡ï¼Œä¹Ÿæœ‰å·²ç»å®Œæˆçš„ BUG å•ï¼Œè¿˜åŒ…æ‹¬å½“å‰èº«ä¸Šå­˜åœ¨çš„å…¶å®ƒå„ç§å•å­ã€‚</p><p>å¹¶ä¸”ç”±äºè¿˜ä¼šç»Ÿè®¡é™¤äº† BUG å•ä¹‹å¤–çš„å•å­ï¼Œç„¶åè¿™äº›å•å­æœ‰çš„å¯èƒ½æ˜¯ç­–åˆ’æˆ–è€…è¿è¥å»ºçš„ï¼Œæœ‰æ—¶å€™è¿æ¨¡å—éƒ½ä¸ä¼šå¡«å‰å°ï¼Œä½†æ˜¯å´åˆäº¤ç»™å‰å°è§£å†³ï¼Œæ‰€ä»¥åœ¨æ— æ³•ç¡®å®šé‚£äº›å•å­æ˜¯å¦çœŸæ˜¯ç”±å‰å°å®Œæˆçš„æƒ…å†µä¸‹ï¼Œåªæœ‰ç”¨æœ€ç¬¨çš„æ–¹å¼ â€”â€” ç›´æ¥ç­›é€‰æ‰€æœ‰å‰å°å¼€å‘çš„åå­—ï¼Œä»¥ä¿è¯ç»Ÿè®¡ä¸‡æ— ä¸€å¤±ï¼Œé¿å…é—æ¼ã€‚</p><p>åŸºç¡€ç­›é€‰å®Œæ¯•åï¼Œåç»­æ“ä½œåŸºæœ¬å°±è·Ÿä¸Šè¿° ä¸Šå‘¨çš„ BUG ç»Ÿè®¡ ä¸€è‡´äº†ã€‚</p><p>ä¸è¿‡ï¼Œç”±äºæ—¶é—´å‚æ•°è¢«å»æ‰äº†ï¼Œå› æ­¤å¦‚æœç›´æ¥å±•ç¤ºï¼Œæ•ˆæœå°±ä¼šåŒ…æ‹¬æ‰€æœ‰å†å²è®°å½•ï¼Œä¾‹å¦‚ï¼š</p><p><img data-src="/blogimages/2022/2022-07-01/m_aa5d84371e4df635e3d949a1ba5c3ea5_r.png" alt="" /></p><p>è¿™æ—¶å€™æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è§£å†³ã€‚</p><ul><li><h4 id="é…åˆ-rich-filter-controller-æ§åˆ¶æ—¶é—´æ˜¾ç¤º"><a class="anchor" href="#é…åˆ-rich-filter-controller-æ§åˆ¶æ—¶é—´æ˜¾ç¤º">#</a> é…åˆ Rich Filter Controller æ§åˆ¶æ—¶é—´æ˜¾ç¤º</h4></li></ul><p>Static filters å‚æ•°å¦‚ä¸‹ï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_84b681d6cc8e052afd9ab5a59fc97f5a_r.png" alt="" /></p><pre><code>//æœ¬å‘¨ç»Ÿè®¡(status = Open or status changed from Open to resolved during (startOfWeek(), endOfWeek()) )//ä¸Šå‘¨ç»Ÿè®¡status != Suspend AND status changed from Open to resolved during (startOfWeek(-1), endOfWeek(-1)) //æœ¬æœˆç»Ÿè®¡status != Suspend AND status changed from Open to resolved during (startOfMonth(), endOfMonth()) //ä¸Šæœˆç»Ÿè®¡status != Suspend AND status changed from Open to resolved during (startOfMonth(-1), endOfMonth(-1)) </code></pre><p>ç„¶åå°±å¯ä»¥é€šè¿‡ Rich Filter Controller æ§åˆ¶ï¼š<br /><img data-src="/blogimages/2022/2022-07-01/m_0cefb1ba377ddd4714ec154a86a98b77_r.png" alt="" /><br />ä¸è¿‡è¿™ç§æ–¹å¼æœ‰ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯æ§åˆ¶å™¨ä¿®æ”¹åä¼šå½±å“æ‰€æœ‰ä½¿ç”¨è¿™ä¸€æ¡ Rich Filter çš„å°å·¥ã€‚<br />å…¶æ¬¡ï¼Œå…¶å®ƒæˆå‘˜ç¬¬ä¸€æ¬¡è¿›å…¥è¯¥é¡µé¢æ—¶ï¼Œé»˜è®¤æ— ä»»ä½•æ§åˆ¶å™¨ç”Ÿæ•ˆ (å³æ˜¾ç¤ºæ‰€æœ‰ç»“æœ)<br /> é‰´äºæ­¤ï¼Œå¦å¤–ä¸€ä¸ªé€‰æ‹©ç›¸æ¯”å°±å¥½ç”¨äº›äº†ã€‚</p><ul><li><h4 id="åˆ©ç”¨ç»„ä»¶çš„-working-query-å‚æ•°"><a class="anchor" href="#åˆ©ç”¨ç»„ä»¶çš„-working-query-å‚æ•°">#</a> åˆ©ç”¨ç»„ä»¶çš„ Working query å‚æ•°</h4></li></ul><p><img data-src="/blogimages/2022/2022-07-01/m_1841119ed158ad959636358999e52830_r.png" alt="" /><br />å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨åˆ›å»º Rich Filter Statistics é¢æ¿æ—¶ï¼Œå¯ä»¥å‘ç°ç¼–è¾‘å™¨é¡µæœ‰ä¸€ä¸ª Working query çš„å‚æ•°ã€‚<br />è¿™ä¸ªå‚æ•°å¯ä»¥å¯¹ç­›é€‰çš„ç»“æœå†ä½œä¸€æ¬¡æœ€ç»ˆç­›é€‰ï¼Œè·Ÿä¸Šä¸€ç§æ–¹å¼ç†è®ºä¸€è‡´ã€‚<br />å› æ­¤å¯ä»¥ç›´æ¥å¤åˆ¶ä¸Šè¿°ä»£ç ï¼Œåˆ†åˆ«åˆ›å»ºå¯¹åº”ç»Ÿè®¡é¢æ¿æ—¶æŒ‰ç…§éœ€æ±‚ç²˜ä¸Šå»ï¼Œæ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="æ€»ç»“"><a class="anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2><p>å¯ä»¥ç»Ÿè®¡ä¸Šå‘¨ï¼Œä¹Ÿå¯ä»¥ç»Ÿè®¡æœ¬å‘¨ï¼Œä»¥åŠæœ¬å‘¨åšè¿‡çš„ä¼˜åŒ–ã€ä»»åŠ¡ï¼Œç›®å‰éœ€æ±‚æš‚ä¸”ç®—æ˜¯å¯ä»¥äº†ã€‚</p><p>åè¾¹å‡†å¤‡å†ç ”ç©¶è¯•è¯•å…¶å®ƒé‡‡ç”¨ Rich Filter çš„é¢æ¿ï¼Œæ¯•ç«Ÿçœ‹ç€æœ‰äº›å‚æ•°ï¼Œåœ¨ Rich Filter Statistics æ ¹æœ¬æ²¡æœ‰ä½“ç°å‡ºæ¥ï¼Œä¾‹å¦‚ Views ä¹‹ç±»çš„é€‰é¡¹ã€‚</p><ul><li>å‚è€ƒæ–‡æ¡£ï¼š<ul><li><span class="exturl" data-url="aHR0cHM6Ly9jb25mbHVlbmNlLmF0bGFzc2lhbi5jb20vamlyYXNvZnR3YXJlc2VydmVyMDgwL2FkdmFuY2VkLXNlYXJjaGluZy05Njc4OTk2NDYuaHRtbA==">åŸºæœ¬æ–‡æ¡£</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9jb25mbHVlbmNlLmF0bGFzc2lhbi5jb20vamlyYXNvZnR3YXJlc2VydmVyMDgwL3NlYXJjaC1zeW50YXgtZm9yLXRleHQtZmllbGRzLTk2Nzg5OTY2NC5odG1s">æœç´¢å¸®åŠ©</span></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘åœ¨æ€è€ƒå¦‚ä½•å®¢è§‚å¯¹å¤§å®¶çš„ BUG ç‡ å’Œ Reopen ç‡ çš„è¯„åˆ†é—®é¢˜ï¼Œæœ¬æ¥å…¬å¸æœ‰ä¸ªç»Ÿè®¡å¹³å°çš„ï¼Œä½†æ˜¯é‚£ä¸ªç»Ÿè®¡å¹³å°åªä¼šç»Ÿè®¡å¤§å•ï¼Œå°çš„ BUGã€ä»»åŠ¡æ ¹æœ¬æ²¡è®°å½•çš„ï¼Œè€Œä¸”</summary>
      
    
    
    
    <category term="å…¶å®ƒ" scheme="https://cwhisme.github.io/categories/%E5%85%B6%E5%AE%83/"/>
    
    
    <category term="Jira" scheme="https://cwhisme.github.io/tags/Jira/"/>
    
  </entry>
  
  <entry>
    <title>æ–°å‡ºçš„Huatuoçƒ­æ›´çš„ä¸€ç‚¹å°è¯•</title>
    <link href="https://cwhisme.github.io/2022/06/14/%E6%96%B0%E5%87%BA%E7%9A%84Huatuo%E7%83%AD%E6%9B%B4%E7%9A%84%E4%B8%80%E7%82%B9%E5%B0%9D%E8%AF%95/"/>
    <id>https://cwhisme.github.io/2022/06/14/%E6%96%B0%E5%87%BA%E7%9A%84Huatuo%E7%83%AD%E6%9B%B4%E7%9A%84%E4%B8%80%E7%82%B9%E5%B0%9D%E8%AF%95/</id>
    <published>2022-06-14T09:39:16.000Z</published>
    <updated>2022-12-22T03:29:48.146Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZvY3VzLWNyZWF0aXZlLWdhbWVzL2h1YXR1bw==">Huatuo</span> æ˜¯å‰ä¸€é˜µå­å°±å¬è¯´è¿‡çš„æ–°çš„çƒ­æ›´æ¡†æ¶ï¼Œå…¶åŸç†åŸºäºå¯¹ Unity il2cpp çš„æ‰©å±•ã€‚å¯ä»¥ä½¿æˆ‘ä»¬ç›®å‰ç›´æ¥æ‰“åŒ…å‡ºæ¥çš„ çº¯ &quot;AOT Runtime&quot; å˜æˆ &quot;AOT+Interpreter&quot; æ··åˆ Runtime.</p><p>å®˜æ–¹å³è‡ªç§°ä¸º åˆ’æ—¶ä»£ çš„çƒ­æ›´æ–°æ¡†æ¶ï¼Œæ›´è¯¦ç»†çš„åŸç†è§£é‡Šå¯ä»¥ç›´æ¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œå¯ä»¥ç®€å•æ¦‚æ‹¬ä¸¤ç‚¹è®©äººæ„Ÿè§‰æ¯”è¾ƒå‰å®³çš„ï¼š</p><ul><li>ä¸åƒ XLuaã€ILruntime ç­‰ç”±äºé‡‡ç”¨ VM æ‰§è¡Œçƒ­æ›´ä»£ç ï¼Œå¯¼è‡´éœ€è¦äº‹å…ˆåšå¥½å„ç§å¤„ç†ï¼ŒHuatuo å€ŸåŠ© il2cpp åŠè‡ªå·±çš„ä¸€å¥—æŒ‡ä»¤é›†ç›´æ¥è§£é‡Šæ‰§è¡Œã€‚å› æ­¤å¯ä»¥éšæ„è°ƒç”¨ C# å„é¡¹ç‰¹æ€§ï¼Œä¸éœ€è¦ç”Ÿæˆä»£ç æˆ–è€…å†™é€‚é…å™¨ã€‚</li><li>Huatuo ä¸­ Unity å·¥ä½œæµä¸åŸç”Ÿå‡ ä¹å®Œå…¨ç›¸åŒï¼Œä¸éçƒ­æ›´ä»£ç å¼€å‘æ–¹å¼åŸºæœ¬ä¸€è‡´ï¼Œéå¸¸æ–¹ä¾¿ã€‚</li></ul><p>æ ¹æ®å®˜æ–¹ä»‹ç»ï¼Œç¬é—´æ„Ÿè§‰å°±è¢«å¸å¼•äº†ï¼Œäºæ˜¯ä¸‹è½½ä¸‹æ¥ç®€å•è¯•äº†ä¸€ä¸‹ã€‚</p><h2 id="è¯´æ˜"><a class="anchor" href="#è¯´æ˜">#</a> è¯´æ˜</h2><p>æŒ‰ç…§ç›®å‰äº†è§£çš„ä¿¡æ¯ï¼ŒHuatuo ä¿®æ”¹çš„ il2cpp åº•å±‚åœ¨åŠ è½½ä»£ç ä¹‹åï¼Œä¼šåˆ¤æ–­æ‰§è¡Œçš„ä»£ç æ˜¯å¦æ˜¯å±äº AOTï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™é€šè¿‡ Huatuo è§£é‡Šæ‰§è¡Œ â€”â€” è€Œè¿™ä¸€åˆ‡éƒ½æ˜¯åº•å±‚çš„åˆ¤æ–­ï¼Œè€Œä¸”è§£é‡Šæ‰§è¡Œæ¨¡å¼åˆåŸºäº il2cpp ï¼Œå› æ­¤æ€§èƒ½ä¸Šç†è®ºä¸Šä¸ç”¨æ€€ç–‘ï¼Œå…·ä½“æ€§èƒ½æµ‹è¯•ç›¸å…³å¯ä»¥æŸ¥çœ‹ <span class="exturl" data-url="aHR0cHM6Ly9mb2N1cy1jcmVhdGl2ZS1nYW1lcy5naXRodWIuaW8vaHVhdHVvL3BlcmZvcm1hbmNlL2JlbmNobWFyay8jJUU2JTgwJUE3JUU4JTgzJUJEJUU2JUI1JThCJUU4JUFGJTk1JUU2JThBJUE1JUU1JTkxJThB">æ€§èƒ½æµ‹è¯•æŠ¥å‘Š</span></p><h2 id="å®‰è£…"><a class="anchor" href="#å®‰è£…">#</a> å®‰è£…</h2><p>ä½¿ç”¨çš„ Unity ç‰ˆæœ¬ä¸º Unity 2021.3.0f1 , å¯¹äº Huatuo çš„å®‰è£…æ–¹å¼ï¼Œé‡‡ç”¨äº†æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ Unity Package Manager å®‰è£…</p><p>ç®€å•æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>åœ¨ Unity ä¸­ï¼Œç‚¹å‡» Edit-&gt;Project Settingsï¼Œé€‰æ‹© Package Manager</li><li>åœ¨ Scoped Registries ä¸­æ·»åŠ ä¸‹é¢ä¿¡æ¯<ul><li>Name: <span class="exturl" data-url="aHR0cDovL3BhY2thZ2Uub3BlbnVwbS5jbg==">package.openupm.cn</span></li><li>URL: <span class="exturl" data-url="aHR0cHM6Ly9wYWNrYWdlLm9wZW51cG0uY24=">https://package.openupm.cn</span></li><li>Scope(s): com.focus-creative-games.huatuo<br /><img data-src="/blogimages/2022/2022-06-14/step1.png" alt="" /></li></ul></li><li>ç‚¹å‡» Apply</li><li>æ‰“å¼€ Edit-&gt;Project Settings-&gt;Package Manager ç•Œé¢ï¼Œåˆ‡æ¢åˆ° Window-&gt;Package Manager-&gt;Packages: My Registries ä¸­å°†çœ‹åˆ°åä¸º huatuo Tookit for Unity çš„åŒ…ï¼Œç›´æ¥å®‰è£…å³å¯ã€‚<br /><img data-src="/blogimages/2022/2022-06-14/step2.png" alt="" /></li></ol><p>æ³¨ï¼šå®‰è£…å¹¶éä¸€æ¬¡æ€§çš„ï¼ŒHuatuo è¿™ä¸ªç¼–è¾‘å™¨å·¥å…·ï¼Œå¹¶é Huatuo æœ¬èº«ï¼Œå› ä¸º Hutuo æ˜¯ç›´æ¥ä¿®æ”¹æ›¿æ¢çš„æˆ‘ä»¬å®‰è£…çš„ Unity ç¼–è¾‘å™¨ ç›®å½•ä¸‹ il2cpp æ–‡ä»¶</p><p>ä¾‹å¦‚æˆ‘çš„è·¯å¾„ä½äºï¼šUnity 2021.3.0f1\Editor\Data\il2cpp\libil2cpp</p><p>å› æ­¤ï¼Œå®‰è£…ä¹‹åå¯ä»¥è·¨é¡¹ç›®ä½¿ç”¨ï¼Œåœ¨ä¸€ä¸ªé¡¹ç›®å®‰è£…ä¹‹åï¼Œå…¶å®ƒé¡¹ç›®ä¹Ÿä¼šå—åˆ°å½±å“ã€‚<br />ä¸è¿‡å·¥å…·ä¼šè‡ªåŠ¨åˆ›å»º il2cpp å¤‡ä»½å°±æ˜¯äº†ï¼Œå¦‚æœå“ªå¤©ä¸æƒ³ç”¨äº†ï¼Œå¯ä»¥ç”¨å¤‡ä»½è¿˜åŸä¸ºåŸå§‹ç‰ˆæœ¬ã€‚</p><p>å¤‡ä»½ç›®å½•å°±åœ¨ Unity å®‰è£…ç›®å½•ä¸‹çš„ il2cpp åŒçº§ï¼Œä¾‹å¦‚æˆ‘çš„æ˜¯ï¼šUnity 2021.3.0f1\Editor\Data\il2cpp\libil2cpp_original_unity</p><h2 id="æµ‹è¯•-huatuo_trial-é¡¹ç›®"><a class="anchor" href="#æµ‹è¯•-huatuo_trial-é¡¹ç›®">#</a> æµ‹è¯• huatuo_trial é¡¹ç›®</h2><h3 id="è¯´æ˜-2"><a class="anchor" href="#è¯´æ˜-2">#</a> è¯´æ˜</h3><p>huatuo_trial æ˜¯ Huatuo å®˜æ–¹æä¾›çš„ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ã€‚</p><p>å®‰è£…å®Œæ¯•ä¹‹åï¼Œä¸ºäº†å…ˆè¿›ä¸€æ­¥è®¤è¯†ä¸€ä¸‹ï¼Œå› æ­¤å¹¶æ²¡æœ‰è¯´è‡ªå·±ç›´æ¥å°è¯•ä½¿ç”¨ï¼Œè€Œä¸”å‡†å¤‡å…ˆçœ‹çœ‹å®˜æ–¹ç¤ºä¾‹é¡¹ç›®çš„ç”¨æ³•ï¼Œæœä¸å…¶ç„¶ï¼Œè¿˜æ˜¯äº†è§£åˆ°æœ‰äº›æ³¨æ„ç‚¹çš„ã€‚</p><h3 id="ç»“æ„"><a class="anchor" href="#ç»“æ„">#</a> ç»“æ„</h3><p>å®˜æ–¹ç¤ºä¾‹é¡¹ç›®ä¸­ï¼Œæ‰€æœ‰ä»£ç éƒ½æ˜¯ç›´æ¥æ”¾åœ¨é¡¹ç›®ä¸­çš„ï¼Œä¸è¿‡é€šè¿‡åˆ›å»ºä¸åŒçš„ *.asmdef ç¨‹åºé›†æè¿°æ–‡ä»¶ï¼Œå°†å…¶åˆ†ç±»æˆäº†ä¸‰ä¸ªç¨‹åºé›†ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>Main</li><li>HotFix</li><li>HotFix2</li></ul><p>å…¶ä¸­ï¼ŒMain è´Ÿè´£ä½œä¸ºåŠ è½½ HotFix åŠ HotFix2 ä¸¤ä¸ªç¨‹åºé›†çš„å…¥å£ï¼Œä¹Ÿå°±æ˜¯è¯´ Main å°±ç±»ä¼¼äºä¸€èˆ¬æ¸¸æˆçš„ Launcherï¼Œä¸»è¦ç”¨äºåŠ è½½ã€ä¸å¯çƒ­æ›´ã€‚</p><p>å…¶ä¸­ä¸ºä»€ä¹ˆåœ¨æµ‹è¯•é¡¹ç›®ä¸­çƒ­æ›´ DLL åˆ†ä¸ºäº†ä¸¤ä¸ªç¨‹åºé›†ï¼Œå¯ä»¥çœ‹ HuaTuo_BuildProcessor_2020_1_OR_NEWER.cs çš„ä»£ç ï¼Œè¿™ä¸€ä»½è²Œä¼¼æ˜¯ä½œä¸º â€œé…ç½®â€ å­˜åœ¨çš„ï¼Œé‡Œè¾¹åˆ†åˆ«æ ‡è®°äº†ä¸¤è€…çš„ä½œç”¨ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"><span>s</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token comment">/// éœ€è¦åœ¨ Prefab ä¸ŠæŒ‚è„šæœ¬çš„çƒ­æ›´ dll åç§°åˆ—è¡¨ï¼Œä¸éœ€è¦æŒ‚åˆ° Prefab ä¸Šçš„è„šæœ¬å¯ä»¥ä¸æ”¾åœ¨è¿™é‡Œ</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token comment">/// ä½†æ”¾åœ¨è¿™é‡Œçš„ dll å³ä½¿å‹¾é€‰äº† AnyPlatform ä¹Ÿä¼šåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­è¢«æ’é™¤</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token comment">/// </span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token comment">/// å¦å¤–è¯·åŠ¡å¿…æ³¨æ„ï¼ï¼š éœ€è¦æŒ‚è„šæœ¬çš„ dll çš„åå­—æœ€å¥½åˆ«æ”¹ï¼Œå› ä¸ºè¿™ä¸ªåˆ—è¡¨æ— æ³•çƒ­æ›´ï¼ˆä¸Šçº¿ååˆ é™¤æˆ–æ·»åŠ æŸäº›éæŒ‚è„šæœ¬ dll æ²¡é—®é¢˜ï¼‰</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">static</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span> s_monoHotUpdateDllNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>            <span class="token string">"HotFix.dll"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token comment">/// &lt;summary></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">/// æ‰€æœ‰çƒ­æ›´æ–° dll åˆ—è¡¨</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token comment">/// &lt;/summary></span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span> s_allHotUpdateDllNames <span class="token operator">=</span> s_monoHotUpdateDllNames<span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token comment">// è¿™é‡Œæ”¾é™¤äº† s_monoHotUpdateDllNames ä»¥å¤–çš„è„šæœ¬ä¸éœ€è¦æŒ‚åˆ°èµ„æºä¸Šçš„ dll åˆ—è¡¨</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token string">"HotFix2.dll"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨é…ç½®ç±»ä¸­ OnFilterAssemblies æ–¹æ³•é»˜è®¤æ’é™¤äº†çƒ­æ›´ç¨‹åºé›†ï¼Œå¦‚æœæ˜¯è‡ªå·±åˆ›å»º DLL æ–‡ä»¶ä½œä¸ºæ¸¸æˆé€»è¾‘éœ€è¦çƒ­æ›´ä¸”æ”¾åœ¨é¡¹ç›®ä¸­çš„ï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œå½“ç„¶è·Ÿå®˜æ–¹ä¸€æ ·ä¸ç”¨é¢å¤– DLL ä¹Ÿå¯ä»¥ã€‚</p><p>æ ¹æ®æ³¨é‡Šè¯´æ˜ï¼Œè¡¨ç¤º HotFix å¯ä»¥å…è®¸åœ¨ Prefab ä¸ŠæŒ‚è½½è„šæœ¬ï¼ŒHotFix2 åˆ™ä¸å…è®¸ï¼Œé™¤æ­¤ä¹‹å¤–ä¸¤è€…ä½¿ç”¨æ–¹å¼éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæ·»åŠ ã€åˆ é™¤ç»„ä»¶éƒ½æ˜¯å…è®¸çš„ã€‚</p><p>ç¤ºä¾‹é¡¹ç›®å°±å±•ç¤ºäº†è¿™ä¸€ç‚¹ï¼šåœ¨ HotFix2 ä¸­åˆ›å»ºäº†ä¸€ä¸ªç©ºç‰©ä½“ï¼Œå¹¶æ·»åŠ äº† HotFix ä¸­çš„è„šæœ¬ã€‚</p><h2 id="æµ‹è¯•"><a class="anchor" href="#æµ‹è¯•">#</a> æµ‹è¯•</h2><p>æµ‹è¯•å…¶å®å¾ˆç®€å•ï¼Œç”¨ Unity å°†ç¤ºä¾‹é¡¹ç›®æ‰“å¼€ä¹‹ååªè¦ä¸æŠ¥é”™ï¼Œåªéœ€è¦å‡ºåŒ…ï¼Œç„¶åéšä¾¿æ”¹ HotFixã€HotFix2 ç¨‹åºé›†ä¸­çš„ä»£ç ï¼Œå®Œäº†ç‚¹å‡»èœå•çš„ Huatuo-&gt;BuildBundles-&gt;ActiveBuiuldTarget å³å¯ã€‚</p><p><img data-src="/blogimages/2022/2022-06-14/step3.png" alt="" /></p><p>èœå•è¿™ä¸ªç¼–è¾‘å™¨å·¥å…·ä¼šå°† Prefabs ç›®å½•ä¸‹çš„é¢„åˆ¶ä½“ä»¥åŠä¸Šè¿°ä¸¤ä¸ªç¨‹åºé›†çš„ä»£ç ï¼Œå…±åŒæ‰“æˆä¸€ä¸ªå« common çš„ Bundle æ–‡ä»¶ï¼Œæ”¾åœ¨ StreamingAssets ä¸‹ã€‚</p><p>å°† common æ›¿æ¢æ‰çœŸæœºåŒ…çš„æ–‡ä»¶å°±å¯ä»¥çœ‹å‡ºæ•ˆæœäº†ã€‚</p><p><img data-src="/blogimages/2022/2022-06-14/step4.png" alt="" /></p><p>æ­¤å¤„æˆ‘åœ¨ HotFix2 App.csã€HotFix CreateByHotFix2.cs,PrintHello.cs éƒ½éšä¾¿ä¿®æ”¹äº†ä¸€æ³¢ï¼ŒåŸºç¡€çš„çƒ­æ›´è¡¨ç°ä¸Šéƒ½æ²¡å•¥é—®é¢˜ã€‚</p><p>è™½ç„¶é…ç½®ä»£ç æœ‰æ³¨é‡Šè¯´æ˜ï¼Œå…è®¸æŒ‚è½½é¢„åˆ¶ä½“åˆ çš„è„šæœ¬ç¨‹åºé›†æ˜¯åœ¨ AddBackHotFixAssembliesToJson æ–¹æ³•ä¸­æ‰“åŒ…æ—¶åšäº†ç‰¹æ®Šå¤„ç†çš„ï¼Œ<br />ä¸è¿‡åè¾¹è¿˜æ˜¯å¤´é“è¯•äº†ä¸‹åœ¨ HotFix2 åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ MonoBehaviour è„šæœ¬ï¼Œç»™å®ƒç›´æ¥æŒ‚è½½åˆ°åŸæœ‰çš„é‚£ä¸ª HotUpdatePrefab ä¸Šï¼Œæœä¸å…¶ç„¶æ˜¯ä¸è¡Œçš„ï¼š</p><figure class="highlight cs"><figcaption data-lang="C#"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewBehaviourScript</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"HotFix çƒ­æ›´ MonoBehaviourï¼PrefabName:"</span><span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="/blogimages/2022/2022-06-14/step5.png" alt="" /></p><p>ä¸è¿‡ç›´æ¥å°†å…¶æŒªåˆ° HotFix ç›®å½•ä¸‹ï¼Œé‡æ–°å‡ºä¸€ä¸‹å°±å¯ä»¥äº†ï¼š</p><p><img data-src="/blogimages/2022/2022-06-14/step6.png" alt="" /></p><h2 id="ç»“è¯­"><a class="anchor" href="#ç»“è¯­">#</a> ç»“è¯­</h2><p>ä»ä»¥ä¸Šå¯ä»¥çœ‹å‡ºï¼Œå®˜æ–¹å°†å…¶åˆ†ç±»ä¸º é€»è¾‘ç¨‹åºé›† å’Œ Mono ç¨‹åºé›†ï¼Œä¼°è®¡ä¹Ÿæ˜¯åƒè¿™æ ·æ¨èã€‚</p><p>ä½¿ç”¨äº†ä¸€ä¸‹è¿™ä¸ªçƒ­æ›´æ–¹å¼ä¹‹åï¼Œæœ€å¤§çš„æ„Ÿå—å°±æ˜¯ä½¿ç”¨æ–¹å¼ç®€å•ã€æ¥å…¥æ–¹ä¾¿ï¼Œä¸”çƒ­æ›´ä»£ç å¼€å‘æ–¹å¼å¯¹äºå¼€å‘è€…æ¥è¯´éå¸¸æ— æ„Ÿï¼Œä¸åƒå…¶å®ƒä¸“ä¸ºçƒ­æ›´è€Œç”Ÿçš„ InjectFix æˆ– ILRuntimeï¼Œæ¥å…¥ä»¥åŠå¼€å‘è¿‡ç¨‹ä¸­éƒ½æœ‰ä¸å°‘è¦æ³¨æ„çš„ã€‚è¦ä¸æ˜¯ç›®å‰å®˜æ–¹æœ€å¤šæ”¯æŒåˆ° Unity2019ï¼Œè¿˜çœŸæƒ³æ¥å®é™…è¯•è¯•ã€‚</p><p>è¦æ˜¯é¡¹ç›®å¯ä»¥çœŸçš„æ¨å¹¿ä½¿ç”¨å°±å¥½äº†ï¼Œå› ä¸ºå®åœ¨ä¸å–œæ¬¢ Xlua é‚£äº›å¼±ç±»å‹è¯­è¨€ã€‚</p><hr /><p>Huatuo åœ¨çŸ¥ä¹è¿˜å¼€äº†ä¸€ä¸ª<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL2NvbHVtbi9jXzE0ODk1NDkzOTYwMzU4NzA3MjA=">çŸ¥ä¹ä¸“æ </span>ï¼Œè™½ç„¶ç›®å‰æ–‡ç« æŒºå°‘</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly9naXRodWIuY29tL2ZvY3VzLWNyZWF0aXZlLWdhbWV</summary>
      
    
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/categories/Unity3D/"/>
    
    <category term="çƒ­æ›´" scheme="https://cwhisme.github.io/categories/Unity3D/%E7%83%AD%E6%9B%B4/"/>
    
    
    <category term="Unity3D" scheme="https://cwhisme.github.io/tags/Unity3D/"/>
    
    <category term="çƒ­æ›´" scheme="https://cwhisme.github.io/tags/%E7%83%AD%E6%9B%B4/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨CEæŒ‡é’ˆæ‰«ææŸ¥æ‰¾åŸºå€</title>
    <link href="https://cwhisme.github.io/2021/12/28/%E4%BD%BF%E7%94%A8CE%E6%8C%87%E9%92%88%E6%89%AB%E6%8F%8F%E6%9F%A5%E6%89%BE%E5%9F%BA%E5%9D%80/"/>
    <id>https://cwhisme.github.io/2021/12/28/%E4%BD%BF%E7%94%A8CE%E6%8C%87%E9%92%88%E6%89%AB%E6%8F%8F%E6%9F%A5%E6%89%BE%E5%9F%BA%E5%9D%80/</id>
    <published>2021-12-28T03:10:35.000Z</published>
    <updated>2022-12-22T03:29:48.145Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="anchor" href="#å‰è¨€">#</a> å‰è¨€</h2><p>å‰æ–‡æåˆ°è¿‡ï¼Œæƒ³è¦ä¿®æ”¹ä¸€ä¸ªè¿›ç¨‹å†…æŒ‡å®šå†…å­˜åœ°å€çš„æ•°æ®ï¼Œé¦–å…ˆå¾—å–å¾—ã€åŸºå€ã€ã€‚</p><p>ä¸ªäººæ„Ÿè§‰ï¼Œã€åŸºå€ã€å¯ä»¥çœ‹åšä¸€ä¸ªåº”ç”¨åœ¨å†…å­˜ä¸­æŸä¸ªå€¼çš„ã€é”šç‚¹ã€ï¼Œå–å¾—é”šç‚¹ä¹‹åï¼Œåªè¦è¯¥åº”ç”¨æ²¡æœ‰è¿›è¡Œå¤§çš„æ›´æ–°ï¼Œæ— è®ºå¦‚ä½•æ›´æ¢è®¾å¤‡ã€ç³»ç»Ÿï¼Œå…¶åœ°å€éƒ½èƒ½ç›´æ¥é€šè¿‡è®¡ç®—ã€ç¡®å®šã€ã€‚</p><p>åä¹‹è‹¥æ²¡æœ‰åŸºå€ï¼Œé‡‡ç”¨æ‰‹åŠ¨æ–¹æ³•è·å–äº†æŸä¸ªå€¼çš„åœ°å€ï¼Œå¯èƒ½å…³é—­åº”ç”¨å†æ‰“å¼€å°±æ²¡æ•ˆæœäº†ã€‚</p><p>æœ€æ‰¾å‡ºæ¥çš„è¿™ä¸ªé”šç‚¹ï¼Œä¸€èˆ¬æ˜¯æŸä¸ª  exe ã€æˆ–è€… dll ç»“å°¾çš„æ¨¡å—åï¼Œåœ¨ CE ä¸­ä¸€èˆ¬è¡¨ç°ä¸ºç»¿è‰²ã€‚</p><p>æ ¹æ®ç›®å‰äº†è§£ï¼Œé€šè¿‡ CE æ‰¾é”šç‚¹çš„æ–¹å¼ï¼Œä¸»è¦æœ‰ä¸¤ç§ï¼š</p><ul><li>äººå·¥æœç´¢ï¼Œé€šè¿‡æ‰¾æŒ‡å‘åœ°å€å€¼çš„æŒ‡é’ˆï¼Œå†æ‰¾æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ.... å¾ªç¯å¾€å¤çŸ¥ç›´åˆ°ç»¿è‰²çš„åŸºå€</li><li>é€šè¿‡æŒ‡é’ˆçƒ§æ‰«æè‡ªåŠ¨æŸ¥æ‰¾</li></ul><p>ç¬¬ä¸€ä¸ªæ–¹å¼é€‚åˆåŸºå€åç§»é‡ä¸é«˜çš„åœ°å€ï¼Œä¾‹å¦‚ CE è‡ªå¸¦çš„ç¤ºä¾‹ï¼Œè‹¥æ˜¯åç§»å±‚æ•°æ¯”è¾ƒé«˜ï¼Œè¿™å°±æ˜¯ä¸€é¡¹å¤§å·¥ç¨‹äº†ã€‚</p><p>ä½•å†µç°åœ¨çœŸæ­£çš„æ¸¸æˆåç§»ä¸€èˆ¬éƒ½ä¸å¯èƒ½ä½ï¼Œæ‰¾çš„è¿‡ç¨‹ä¸­è¿˜å¾—ä¸€è¾¹åˆ†æé€»è¾‘ï¼Œç¨å¾®ä¸æ³¨æ„ï¼Œå¯èƒ½è¦é‡æ‰¾ï¼Œæ€»ä¹‹å°±æ˜¯éå¸¸ç¹çéº»çƒ¦ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæœ€å¤§çš„é—®é¢˜å°±æ˜¯ï¼ŒçœŸå®æ¸¸æˆçš„åŸºå€ï¼Œç”šè‡³æ˜¯æ— æ³•é€šè¿‡è¿™ç§å¼•ç”¨å…³ç³»æ‰¾å‡ºçš„ï¼Œå› ä¸ºæ‰¾ä¸ªä¸€ä¸¤å±‚ã€æˆ–è®¸å°±ç»ˆæ­¢åœ¨äº†æŸä¸ª espã€ebp å‡½æ•°è°ƒç”¨ä¹‹ç±»ï¼Œå•çº¯é€šè¿‡ CE æ— æ³•æŸ¥æ‰¾ä¸‹å»çš„åœ°æ–¹äº†ã€‚</p><p>è¿™æ—¶å€™å°±éœ€è¦å€Ÿç”¨ ollydbg ä¹‹ç±»çš„å·¥å…·ç»§ç»­è¿›è¡Œäº†ã€‚</p><p>ç›¸æ¯”æ‰‹åŠ¨æŸ¥æ‰¾æ–¹å¼ï¼ŒæŒ‡é’ˆæ‰«ææˆ‘è‡ªå·±ç”¨äº†ä¸‹ï¼Œæ„Ÿè§‰ç€å®æ–¹ä¾¿ï¼Œåªéœ€è¦æ‰«æ -&gt; æ›´æ–°åœ°å€ -&gt; å†æ‰«ææ’é™¤ï¼Œå°±å¯ä»¥æŠŠåŸºå€ç»™å‰©ä¸‹æ¥äº†ã€‚</p><h2 id="ä½¿ç”¨"><a class="anchor" href="#ä½¿ç”¨">#</a> ä½¿ç”¨</h2><p>è¿˜æ˜¯ä»¥ CE çš„ç¤ºä¾‹ä¸ºä¾‹å§ï¼Œæ‰“å¼€ CE çš„æ•™ç¨‹æ¸¸æˆï¼Œç¬¬äºŒå…³ï¼Œæ­¤å¤„ä»¥è¡€é‡ä¸ºä¾‹ï¼Œé¦–å…ˆæŸ¥æ‰¾å½“å‰è¡€é‡åœ°å€ï¼š</p><p><img data-src="/blogimages/2021/2021-12-28/step1.png" alt="" /></p><p>ç„¶åå³é”®åœ°å€ -&gt; æŒ‡é’ˆæ‰«æï¼š</p><p><img data-src="/blogimages/2021/2021-12-28/step2.png" alt="" /></p><p>æœ€å¤§çº§åˆ«ï¼Œä¸€èˆ¬ 5 çº§æˆ–ä»¥ä¸‹å°±è¡Œäº†ï¼Œé€šå¸¸ä¸€ä¸ªåœ°å€æŒ‡é’ˆä¸è‡³äºå 6 çº§ä»¥ä¸Šï¼Œå½“ç„¶æœ€åå®åœ¨æ‰¾ä¸åˆ°å¯ä»¥å°è¯•é«˜çº§åˆ«çš„è®¾ç½®ï¼Œå› ä¸ºçº§åˆ«è¶Šé«˜ï¼Œéœ€è¦æœç´ çš„æ•°æ®é‡å’Œäº§ç”Ÿçš„ç»“æœä¹Ÿè¶Šå¤šã€‚</p><p>è®°å¾—ä¿å­˜å¥½æœç´¢ç»“æœï¼Œä»¥å…ä¸‹æ¬¡æœç´¢ä¸å¯¹ï¼Œå¯ä»¥éšæ—¶å›é€€ã€‚</p><p><img data-src="/blogimages/2021/2021-12-28/step3.png" alt="" /></p><p>ç¬¬ä¸€æ¬¡æœç´¢ï¼Œ5 çº§åç§»ï¼Œäº§ç”Ÿäº† 68090 ä¸ªç»“æœã€‚</p><p>ç°åœ¨å°†æ¸¸æˆå…³é—­ï¼Œå†æ‰“å¼€ï¼Œå¯ä»¥çœ‹è§ï¼Œä¹‹å‰æˆ‘ä»¬æœç´¢å‡ºæ¥çš„è¡€é‡åœ°å€ï¼Œç°åœ¨å·²ç»ä½œåºŸäº†ï¼š</p><p><img data-src="/blogimages/2021/2021-12-28/step4.png" alt="" /></p><p>åˆ é™¤è¿™äº›ä½œåºŸçš„åœ°å€åˆ—è¡¨ï¼ŒæŒ‰ç…§é€šå¸¸æ‰¾å€¼çš„æ–¹å¼å†æ¬¡æ‰¾åˆ°è¡€é‡ã€‚</p><p><img data-src="/blogimages/2021/2021-12-28/step5.png" alt="" /></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¡€é‡æ–°çš„åœ°å€å·²ç»å˜æˆ 0163A2A0 ï¼Œå¤åˆ¶è¿™ä¸ªåœ°å€ã€‚</p><p>å›åˆ°ä¸Šä¸€æ­¥æŒ‡é’ˆæ‰«æç•Œé¢ï¼Œé€‰æ‹©èœå•çš„ æŒ‡é’ˆæ‰«æå™¨ -&gt; é‡æ–°æ‰«æå†…å­˜ï¼š</p><p><img data-src="/blogimages/2021/2021-12-28/step6.png" alt="" /></p><p>å°†æ–°çš„åœ°å€å¡«å…¥ï¼Œç‚¹å‡»æ‰«æ (è®°å¾—ä¿å­˜ä¸ºæ–°çš„æ•°æ®æ–‡ä»¶ï¼Œé¿å…é”™è¯¯æ—¶æ— æ³•å›é€€)ã€‚</p><p>è¿™æ—¶ç»“æœå˜æˆäº† 65538 ä¸ªï¼Œç»§ç»­ä¸Šè¿°æ­¥éª¤ã€‚</p><ul><li>å¾—åˆ°åœ°å€ 0158C730ï¼Œç»“æœå˜æˆ 60922</li><li>å¾—åˆ°åœ°å€ 015AA8F0ï¼Œç»“æœè¿˜æ˜¯ 60922</li></ul><p>è‹¥æ­¤æ—¶ä¸ä¸Šä¸€æ¬¡æŒ‡é’ˆç»“æœæ•°å€¼ä¸€è‡´ï¼Œåé¢å°±æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p><ol><li>æŒ‘å‡ ä¸ªé¡ºçœ¼çš„åŠ å…¥åœ°å€åˆ—è¡¨ï¼Œé‡å¯æ¸¸æˆæŸ¥çœ‹åœ°å€æ˜¯å¦æŒ‡å‘æ­£ç¡®çš„æ•°å€¼</li><li>é‡å¯ç”µè„‘ï¼Œå°†å†…å­˜å®Œå…¨é‡ç½®ï¼Œå†è¿›è¡Œä¸€æ¬¡æŸ¥æ‰¾</li></ol><p>ä¿é™©å½“ç„¶æ˜¯æ˜¯é‡å¯ä¸€æ¬¡ç”µè„‘æ¯”è¾ƒå¥½ï¼Œæ­¤æ—¶ä¸ç®¡åˆ—è¡¨è¿˜å‰©å¤šå°‘é¡¹ï¼Œæ—¢ç„¶é‡å¯ç”µè„‘éƒ½æ— æ³•å½±å“å…¶æŒ‡å‘æ­£ç¡®æ€§ï¼Œé‚£ä¹ˆä¹Ÿå°±å¯ä»¥ç›´æ¥å½“åšåŸºå€ä½¿ç”¨äº†ã€‚</p><p>æŒ‘é€‰ä¹Ÿæœ‰ä¸€äº›è§„åˆ™ï¼Œä¾‹å¦‚ä¼˜å…ˆè¿è¡Œä¸»æ¨¡å—ä¸ºä¸»ã€‚</p><h2 id="åŠ è½½æ‰«æç»“æœ"><a class="anchor" href="#åŠ è½½æ‰«æç»“æœ">#</a> åŠ è½½æ‰«æç»“æœ</h2><p>ä¸Šæ–‡æåˆ°ï¼Œæ¯æ¬¡æŒ‡é’ˆæ‰«æåï¼ŒCE éƒ½ä¼šæç¤ºæˆ‘ä»¬ä¿å­˜ï¼Œä¿å­˜çš„æ–‡ä»¶å°±æ˜¯æ‰«æç»“æœã€‚</p><p>æ­£ç¡®ä¿å­˜åï¼Œå¯ä»¥éšä¾¿åŠ è½½å…¶ä¸­æŸä¸€æ­¥çš„æ‰«æç»“æœã€‚</p><p>åŠ è½½æ–¹å¼ä¸ºï¼š</p><p>éšä¾¿æ‰«æä¸€ä¸ªæ•°å€¼ -&gt; å³é”®åœ°å€ -&gt; åæ±‡ç¼–æ­¤å†…å­˜åŒºåŸŸ -&gt; å·¥å…· -&gt; æŒ‡é’ˆæ‰«æå™¨ -&gt; æ–‡ä»¶ -&gt; æ‰“å¼€ -&gt; é€‰æ‹©ä¿å­˜æ–‡ä»¶</p><p>è·¯å¾„è—å¾—ç¨å¾®æœ‰ä¸€ç‚¹æ·±ï¼Œä¸è¿‡ä¸å½±å“ã€‚</p><h2 id="ç»“è¯­"><a class="anchor" href="#ç»“è¯­">#</a> ç»“è¯­</h2><p>ä»¥ä¸Šä¾¿æ˜¯æŒ‡é’ˆæ‰«æå™¨æ‰«åŸºå€çš„æ–¹å¼ï¼Œä¸ªäººæ„Ÿè§‰æ¯”æ‰‹å·¥çš„æ–¹å¼ç®€å•å’Œå‡†ç¡®ã€‚</p><p>æ­¤å¤„ä½œä¸€ç‚¹è®°å½•ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#å‰è¨€&quot;&gt;#&lt;/a&gt; å‰è¨€&lt;/h2&gt;
&lt;p&gt;å‰æ–‡æåˆ°è¿‡ï¼Œæƒ³è¦ä¿®æ”¹ä¸€ä¸ªè¿›ç¨‹å†…æŒ‡å®šå†…å­˜åœ°å€çš„æ•°æ®ï¼Œé¦–å…ˆå¾—å–å¾—ã€åŸºå€ã€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ªäººæ„Ÿè§‰ï¼Œã€åŸºå€ã€å¯ä»¥çœ‹åšä¸€ä¸ªåº”ç”¨åœ¨å†…å­˜ä¸­æŸä¸ªå€¼çš„ã€é”šç‚¹ã€ï¼Œå–å¾—é”šç‚¹ä¹‹åï¼Œåªè¦</summary>
      
    
    
    
    <category term="æ¸¸æˆ" scheme="https://cwhisme.github.io/categories/%E6%B8%B8%E6%88%8F/"/>
    
    
    <category term="å†…å­˜" scheme="https://cwhisme.github.io/tags/%E5%86%85%E5%AD%98/"/>
    
  </entry>
  
</feed>
